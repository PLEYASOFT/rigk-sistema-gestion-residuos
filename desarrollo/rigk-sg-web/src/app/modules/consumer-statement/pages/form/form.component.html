<div id="">
    <!-- inicio breadcrumbs -->
    <nav class="breadcrumbs d-none d-lg-block" aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#"><i class="fa fa-home" aria-hidden="true"></i> Inicio</a></li>
            <li class="breadcrumb-item active" aria-current="page">Formulario CI</li>
        </ol>
    </nav>
    <!-- fin breadcrumbs -->
    <!-- inicio Formulario CI -->
    <section class="formulario-ci">
        <h1>Formulario CI</h1>
        <div class="row mb-3">
            <div class="col-md-5">
                <p-multiSelect *ngIf="!disableAll" [options]="establishments" optionLabel="name"
                    [(ngModel)]="selectedEstablishment" optionValue="ID_ESTABLISHMENT" [selectionLimit]="1"
                    defaultLabel="Seleccione Establecimiento"
                    [selectedItemsLabel]="'{0} Empresas seleccionadas'"></p-multiSelect>
                <h4 *ngIf="disableAll">Establecimiento: {{establishment}}</h4>
                <!-- <select class="form-select">
                    <option value="0">Seleccione Establecimiento</option>
                </select> -->
            </div>
        </div>
        <!-- inicio Nombre tabla -->
        <div class="table-responsive mb-4" *ngFor="let x of tables; let i = index">
            <h2 class="table-header-div table-header-div-blue"> {{x}}</h2>
            <!-- Tabla Desktop -->
            <table
                class="table table-even table-section table-borderless table-border table-header-green table-align-middle text-nowrap">
                <thead>
                    <tr>
                        <th>Material</th>
                        <th><span class="d-none d-lg-block">Kilogramos</span><span class="d-lg-none">Kg.</span></th>
                        <th><span class="d-none d-lg-block">Fecha de retiro</span><span class="d-lg-none">Fec. de
                                retiro</span></th>
                        <th>Gestor</th>
                        <th colspan="3">Medios de verificación</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let type of materials">

                        <td *ngIf="!type.id" style="background-color: lightgray;">{{type.name}}</td>
                        <td *ngIf="!type.id" style="background-color: lightgray;"></td>
                        <td *ngIf="!type.id" style="background-color: lightgray;"></td>
                        <td *ngIf="!type.id" style="background-color: lightgray;"></td>
                        <td *ngIf="!type.id" colspan="3" style="background-color: lightgray;"></td>

                        <td *ngIf="type.id" style="padding-left: 20px;">{{type.name}}</td>

                        <!-- <td>Papel</td> -->
                        <td *ngIf="type.id">
                            <input [disabled]="disableAll" class="form-control form-control-sm text-end w-50px"
                                id="inp_1_{{i}}_{{type.id}}" type="text" value="0"
                                (change)="updateVal(i,type.id,$event.target)">
                        </td>
                        <td *ngIf="type.id">
                            <input [disabled]="disableAll" class="form-control text-start w-auto" type="date"
                                id="inp_2_{{i}}_{{type.id}}" placeholder="00/00/0000"
                                (change)="updateDate(i,type.id,$event.target)">
                        </td>
                        <td *ngIf="type.id">
                            <select [disabled]="disableAll" class="form-select w-auto" id="inp_3_{{i}}_{{type.id}}"
                                (change)="updateGestor(i,type.id,$event.target)">
                                <option value="0" selected>Seleccione</option>
                                <option value="1">Reciclaje Interno</option>
                                <option value="2">Gestor 1</option>
                                <option value="3">Gestor 2</option>
                                <option value="4">Gestor 3</option>
                            </select>
                        </td>
                        <td *ngIf="type.id">
                            <select id="inp_f_1_{{i}}_{{type.id}}" [disabled]="disableAll" class="form-select"
                                (change)="updateType(i,type.id,$event.target,1)">
                                <option value="0">Seleccione Tipo M.V</option>
                                <option value="1">Factura</option>
                                <option value="2">Guía de Despacho</option>
                                <option value="3">Medios Visuales</option>
                            </select>
                            <input *ngIf="!disableAll" [disabled]="disableAll" type="file" class="form-control"
                                (change)="uploadFile(i,type.id,$event.target,1)">
                                <button *ngIf="disableAll" class="btn  btn-sm" (click)="downloadFile(1)"> <i class="fa fa-file-pdf-o fa-fw fa-lg color-blue"></i> </button>
                        </td>
                        <td *ngIf="type.id">
                            <select id="inp_f_2_{{i}}_{{type.id}}" [disabled]="disableAll" class="form-select"
                                (change)="updateType(i,type.id,$event.target,2)">
                                <option value="0">Seleccione Tipo M.V</option>
                                <option value="1">Factura</option>
                                <option value="2">Guía de Despacho</option>
                                <option value="3">Medios Visuales</option>
                            </select>
                            <input *ngIf="!disableAll" [disabled]="disableAll" type="file" class="form-control"
                                (change)="uploadFile(i,type.id,$event.target,2)">
                                <button *ngIf="disableAll" class="btn  btn-sm" (click)="downloadFile(2)"> <i class="fa fa-file-pdf-o fa-fw fa-lg color-blue"></i> </button>
                        </td>
                        <td *ngIf="type.id">
                            <select id="inp_f_3_{{i}}_{{type.id}}" [disabled]="disableAll" class="form-select"
                                (change)="updateType(i,type.id,$event.target,3)">
                                <option value="0">Seleccione Tipo M.V</option>
                                <option value="1">Factura</option>
                                <option value="2">Guía de Despacho</option>
                                <option value="3">Medios Visuales</option>
                            </select>
                            <input *ngIf="!disableAll" [disabled]="disableAll" type="file" class="form-control"
                                (change)="uploadFile(i,type.id,$event.target,3)">
                                <button *ngIf="disableAll" class="btn  btn-sm" (click)="downloadFile(3)"> <i class="fa fa-file-pdf-o fa-fw fa-lg color-blue"></i> </button>
                        </td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="1">TOTAL:</td>
                        <td colspan="7">{{total_tables[i] | number : '1.2-2'}}</td>
                    </tr>
                </tfoot>
            </table>
        </div>
        <button class="btn btn-primary px-5 mb-4" (click)="saveForm()" *ngIf="!disableAll">Enviar</button>
    </section>
    <!-- fin Formulario CI -->
</div>