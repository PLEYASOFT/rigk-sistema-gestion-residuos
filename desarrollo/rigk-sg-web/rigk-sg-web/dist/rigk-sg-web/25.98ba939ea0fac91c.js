"use strict";(self.webpackChunkrigk_sg_web=self.webpackChunkrigk_sg_web||[]).push([[25],{7025:(ua,Q,m)=>{m.r(Q),m.d(Q,{MantainerModule:()=>da});var p=m(6895),Z=m(5792),se=m(4135),e=m(8256),F=m(2227);let re=(()=>{class a{constructor(t){this.ratesService=t,this.types=["EyE reciclables cart\xf3n","EyE reciclable de metal","EyE de pl\xe1stico","EyE no reciclables","EyE reutilizables","EyE de madera"],this.year=(new Date).getFullYear(),this.rates=[]}ngOnInit(){this.ratesService.getRates(this.year).subscribe(t=>{t.data.forEach(i=>{this.rates.push({name:this.types[i.type-1],price:i.price})})})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(F.z))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-home"]],decls:22,vars:0,consts:[["id","content"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],["aria-current","page",1,"breadcrumb-item"],["aria-hidden","true",1,"fa","fa-home"],[1,"inicio"],[1,"box","box-inicio"],[1,"row"],[1,"col-12","col-md-8"],[1,"h1"],[2,"visibility","hidden"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3),e._UZ(4,"i",4),e._uU(5," Inicio"),e.qZA()()(),e.TgZ(6,"section",5)(7,"h1"),e._uU(8,"Inicio"),e.qZA(),e.TgZ(9,"div",6)(10,"div",7)(11,"div",8)(12,"h2",9),e._uU(13,"Bienvenido/a a M\xf3dulo de Administraci\xf3n"),e.qZA(),e.TgZ(14,"p",10),e._uU(15,"Como parte de las obligaciones que establece la Ley REP, los Productores deben informar la cantidad de EyE no domiciliarios (POM) puestos en el mercado el a\xf1o anterior."),e.qZA(),e.TgZ(16,"p",10),e._uU(17,"ProREP pone a disposici\xf3n de sus socios la plataforma de declaraci\xf3n que dar\xe1 cumplimiento a la obligaci\xf3n de informar sus EyE."),e.qZA(),e.TgZ(18,"p",10),e._uU(19,"La informaci\xf3n deber\xe1 subirse en los meses de enero y febrero."),e.qZA(),e.TgZ(20,"p",10),e._uU(21,"En caso de tener dudas con respecto a su declaraci\xf3n puede ver los tutoriales y preguntas frecuentes."),e.qZA()()()()()())}}),a})();var c=m(433),ne=m(5226),d=m.n(ne),V=m(3224),R=m(8195);function le(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"tr",23)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA(),e.TgZ(21,"td"),e._uU(22),e.qZA(),e.TgZ(23,"td"),e._uU(24),e.qZA(),e.TgZ(25,"td")(26,"div",24)(27,"button",25),e.NdJ("click",function(){const s=e.CHM(t),o=s.$implicit,r=s.index,l=e.oxw();return l.popupModify=!l.popupModify,l.id=o.ID,l.index=r,e.KtG(l.existingCode=o.CODE_BUSINESS)}),e._uU(28,"Modificar"),e.qZA()()(),e.TgZ(29,"td")(30,"div",24)(31,"button",26),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.btnDeleteBusiness(o.ID))}),e._uU(32,"Eliminar"),e.qZA()()()()}if(2&a){const t=n.$implicit;e.xp6(2),e.Oqu(t.CODE_BUSINESS),e.xp6(2),e.Oqu(t.NAME),e.xp6(2),e.Oqu(t.VAT),e.xp6(2),e.Oqu(t.LOC_ADDRESS),e.xp6(2),e.Oqu(t.PHONE),e.xp6(2),e.Oqu(t.EMAIL),e.xp6(2),e.Oqu(t.AM_FIRST_NAME),e.xp6(2),e.Oqu(t.AM_LAST_NAME),e.xp6(2),e.Oqu(t.INVOICE_NAME),e.xp6(2),e.Oqu(t.INVOICE_EMAIL),e.xp6(2),e.Oqu(t.INVOICE_PHONE),e.xp6(2),e.Oqu(t.GIRO)}}const ce=function(a,n){return{"btn-info":a,"btn-primary":n}};function de(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"li")(1,"button",27),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.pagTo(o))}),e._uU(2),e.qZA()()}if(2&a){const t=n.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngClass",e.WLB(2,ce,i.pos===t+1,i.pos!==t+1)),e.xp6(1),e.Oqu(t+1)}}function ue(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El c\xf3digo de la empresa es requerido."),e.qZA())}function _e(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El c\xf3digo de empresa ya existe."),e.qZA())}function pe(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,ue,2,0,"p",61),e.YNc(2,_e,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.code_business.errors.required),e.xp6(1),e.Q6J("ngIf",""!=t.formData.controls.code_business.value&&t.formData.controls.code_business.errors.code_business)}}function me(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El nombre de la empresa es requerido."),e.qZA())}function he(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,me,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.name_business.errors.required)}}function ge(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El rut de la empresa es requerido."),e.qZA())}function fe(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del RUT es inv\xe1lido (Sin puntos y con gui\xf3n)."),e.qZA())}function be(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El digito verificador es incorrecto."),e.qZA())}function Te(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,ge,2,0,"p",61),e.YNc(2,fe,2,0,"p",61),e.YNc(3,be,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.rut.errors.required),e.xp6(1),e.Q6J("ngIf",t.formData.controls.rut.errors.pattern),e.xp6(1),e.Q6J("ngIf",t.formData.controls.rut.errors.rut)}}function Ae(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"La direcci\xf3n de la empresa es requerida."),e.qZA())}function Ee(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,Ae,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.loc_address.errors.required)}}function ve(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El n\xfamero de Tel\xe9fono/Celular de la empresa es requerido (7 - 12 d\xedgitos)."),e.qZA())}function Ze(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del Tel\xe9fono/Celular es inv\xe1lido (7 - 12 d\xedgitos)."),e.qZA())}function Me(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,ve,2,0,"p",61),e.YNc(2,Ze,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.phone.errors.required),e.xp6(1),e.Q6J("ngIf",t.formData.controls.phone.errors.pattern)}}function Ce(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El correo de la empresa es requerido (ejemplo@correo.com)."),e.qZA())}function Ne(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del correo es inv\xe1lido (ejemplo@correo.com)."),e.qZA())}function xe(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,Ce,2,0,"p",61),e.YNc(2,Ne,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.email.errors.required),e.xp6(1),e.Q6J("ngIf",t.formData.controls.email.errors.email)}}function Re(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El nombre del account manager es requerido."),e.qZA())}function Ue(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,Re,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.am_first_name.errors.required)}}function qe(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El apellido del account manager es requerido."),e.qZA())}function Fe(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,qe,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.am_last_name.errors.required)}}function Se(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El nombre contacto de facturaci\xf3n es requerido."),e.qZA())}function Pe(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,Se,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.invoice_name.errors.required)}}function Ie(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El email contacto de facturaci\xf3n es requerido (ejemplo@correo.com)."),e.qZA())}function De(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del correo es inv\xe1lido (ejemplo@correo.com)."),e.qZA())}function ye(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,Ie,2,0,"p",61),e.YNc(2,De,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.invoice_email.errors.required),e.xp6(1),e.Q6J("ngIf",t.formData.controls.invoice_email.errors.email)}}function Oe(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El tel\xe9fono de facturaci\xf3n es requerido (entre 7 y 12 d\xedgitos)."),e.qZA())}function we(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del tel\xe9fono es inv\xe1lido (entre 7 y 12 d\xedgitos)."),e.qZA())}function Le(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,Oe,2,0,"p",61),e.YNc(2,we,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.invoice_phone.errors.required),e.xp6(1),e.Q6J("ngIf",t.formData.controls.invoice_phone.errors.pattern)}}function Be(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El giro de la empresa es requerido."),e.qZA())}function Ye(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,Be,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.giro.errors.required)}}function ke(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"div",28)(1,"form",29,30)(3,"div",31)(4,"label",32)(5,"strong"),e._uU(6,"C\xf3digo de la empresa"),e.qZA()(),e.TgZ(7,"div",33),e._UZ(8,"input",34),e.qZA(),e.YNc(9,pe,3,2,"div",35),e.qZA(),e.TgZ(10,"div",31)(11,"label",36)(12,"strong"),e._uU(13,"Nombre de la empresa"),e.qZA()(),e.TgZ(14,"div",33),e._UZ(15,"input",37),e.qZA(),e.YNc(16,he,2,1,"div",35),e.qZA(),e.TgZ(17,"div",31)(18,"label",38)(19,"strong"),e._uU(20,"Rut de la empresa"),e.qZA()(),e.TgZ(21,"div",33),e._UZ(22,"input",39),e.qZA(),e.YNc(23,Te,4,3,"div",35),e.qZA(),e.TgZ(24,"div",31)(25,"label",40)(26,"strong"),e._uU(27,"Direcci\xf3n de la empresa"),e.qZA()(),e.TgZ(28,"div",33),e._UZ(29,"input",41),e.qZA(),e.YNc(30,Ee,2,1,"div",35),e.qZA(),e.TgZ(31,"div",31)(32,"label",42)(33,"strong"),e._uU(34,"Tel\xe9fono/Celular de la empresa"),e.qZA()(),e.TgZ(35,"div",33),e._UZ(36,"input",43),e.qZA(),e.YNc(37,Me,3,2,"div",35),e.qZA(),e.TgZ(38,"div",31)(39,"label",44)(40,"strong"),e._uU(41,"Correo de la empresa"),e.qZA()(),e.TgZ(42,"div",33),e._UZ(43,"input",45),e.qZA(),e.YNc(44,xe,3,2,"div",35),e.qZA(),e.TgZ(45,"div",31)(46,"label",46)(47,"strong"),e._uU(48,"Nombre Account Manager"),e.qZA()(),e.TgZ(49,"div",33),e._UZ(50,"input",47),e.qZA(),e.YNc(51,Ue,2,1,"div",35),e.qZA(),e.TgZ(52,"div",31)(53,"label",48)(54,"strong"),e._uU(55,"Apellido Account Manager"),e.qZA()(),e.TgZ(56,"div",33),e._UZ(57,"input",49),e.qZA(),e.YNc(58,Fe,2,1,"div",35),e.qZA(),e.TgZ(59,"div",31)(60,"label",50)(61,"strong"),e._uU(62,"Nombre contacto facturaci\xf3n"),e.qZA()(),e.TgZ(63,"div",33),e._UZ(64,"input",51),e.qZA(),e.YNc(65,Pe,2,1,"div",35),e.qZA(),e.TgZ(66,"div",31)(67,"label",52)(68,"strong"),e._uU(69,"Correo contacto facturaci\xf3n"),e.qZA()(),e.TgZ(70,"div",33),e._UZ(71,"input",53),e.qZA(),e.YNc(72,ye,3,2,"div",35),e.qZA(),e.TgZ(73,"div",31)(74,"label",54)(75,"strong"),e._uU(76,"Tel\xe9fono/Celular contacto facturaci\xf3n"),e.qZA()(),e.TgZ(77,"div",33),e._UZ(78,"input",55),e.qZA(),e.YNc(79,Le,3,2,"div",35),e.qZA(),e.TgZ(80,"div",31)(81,"label",56)(82,"strong"),e._uU(83,"Giro empresa"),e.qZA()(),e.TgZ(84,"div",33),e._UZ(85,"input",57),e.qZA(),e.YNc(86,Ye,2,1,"div",35),e.qZA(),e.TgZ(87,"button",58),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return s.btnAddBusiness(),e.KtG(s.pagTo(0))}),e._uU(88,"Aceptar"),e.qZA(),e.TgZ(89,"button",59),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return s.popupVisible=!s.popupVisible,e.KtG(s.formData.reset())}),e._uU(90,"Cancelar"),e.qZA()()()}if(2&a){const t=e.MAs(2),i=e.oxw();e.xp6(1),e.Q6J("formGroup",i.formData),e.xp6(8),e.Q6J("ngIf",i.formData.controls.code_business.errors&&i.formData.controls.code_business.touched),e.xp6(7),e.Q6J("ngIf",i.formData.controls.name_business.errors&&i.formData.controls.name_business.touched),e.xp6(7),e.Q6J("ngIf",i.formData.controls.rut.errors&&i.formData.controls.rut.touched),e.xp6(7),e.Q6J("ngIf",i.formData.controls.loc_address.errors&&i.formData.controls.loc_address.touched),e.xp6(7),e.Q6J("ngIf",i.formData.controls.phone.errors&&i.formData.controls.phone.touched),e.xp6(7),e.Q6J("ngIf",i.formData.controls.email.errors&&i.formData.controls.email.touched),e.xp6(7),e.Q6J("ngIf",i.formData.controls.am_first_name.errors&&i.formData.controls.am_first_name.touched),e.xp6(7),e.Q6J("ngIf",i.formData.controls.am_last_name.errors&&i.formData.controls.am_last_name.touched),e.xp6(7),e.Q6J("ngIf",i.formData.controls.invoice_name.errors&&i.formData.controls.invoice_name.touched),e.xp6(7),e.Q6J("ngIf",i.formData.controls.invoice_email.errors&&i.formData.controls.invoice_email.touched),e.xp6(7),e.Q6J("ngIf",i.formData.controls.invoice_phone.errors&&i.formData.controls.invoice_phone.touched),e.xp6(7),e.Q6J("ngIf",i.formData.controls.giro.errors&&i.formData.controls.giro.touched),e.xp6(1),e.Q6J("disabled",t.invalid)}}function Je(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El c\xf3digo de la empresa es requerido."),e.qZA())}function Qe(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El c\xf3digo de empresa ya existe."),e.qZA())}function Ve(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,Je,2,0,"p",61),e.YNc(2,Qe,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.code_business.errors.required),e.xp6(1),e.Q6J("ngIf",""!=t.formData.controls.code_business.value&&!t.formData.controls.code_business.errors.verifyCode)}}function Ge(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El nombre de la empresa es requerido."),e.qZA())}function He(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,Ge,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.name_business.errors.required)}}function ze(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El rut de la empresa es requerido."),e.qZA())}function $e(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del RUT es inv\xe1lido (Sin puntos y con gui\xf3n)."),e.qZA())}function je(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El digito verificador es incorrecto."),e.qZA())}function Ke(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,ze,2,0,"p",61),e.YNc(2,$e,2,0,"p",61),e.YNc(3,je,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.rut.errors.required),e.xp6(1),e.Q6J("ngIf",t.formData.controls.rut.errors.pattern),e.xp6(1),e.Q6J("ngIf",t.formData.controls.rut.errors.rut)}}function Xe(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"La direcci\xf3n de la empresa es requerida."),e.qZA())}function We(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,Xe,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.loc_address.errors.required)}}function et(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El n\xfamero de Tel\xe9fono/Celular de la empresa es requerido (7 - 12 d\xedgitos)."),e.qZA())}function tt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del Tel\xe9fono/Celular es inv\xe1lido (7 - 12 d\xedgitos)."),e.qZA())}function it(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,et,2,0,"p",61),e.YNc(2,tt,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.phone.errors.required),e.xp6(1),e.Q6J("ngIf",t.formData.controls.phone.errors.pattern)}}function ot(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El correo de la empresa es requerido (ejemplo@correo.com)."),e.qZA())}function at(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del correo es inv\xe1lido (ejemplo@correo.com)."),e.qZA())}function st(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,ot,2,0,"p",61),e.YNc(2,at,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.email.errors.required),e.xp6(1),e.Q6J("ngIf",t.formData.controls.email.errors.email)}}function rt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El nombre del account manager es requerido."),e.qZA())}function nt(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,rt,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.am_first_name.errors.required)}}function lt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El apellido del account manager es requerido."),e.qZA())}function ct(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,lt,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.am_last_name.errors.required)}}function dt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El nombre contacto de facturaci\xf3n es requerido."),e.qZA())}function ut(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,dt,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.invoice_name.errors.required)}}function _t(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El email contacto de facturaci\xf3n es requerido (ejemplo@correo.com)."),e.qZA())}function pt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del correo es inv\xe1lido (ejemplo@correo.com)."),e.qZA())}function mt(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,_t,2,0,"p",61),e.YNc(2,pt,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.invoice_email.errors.required),e.xp6(1),e.Q6J("ngIf",t.formData.controls.invoice_email.errors.email)}}function ht(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El tel\xe9fono de facturaci\xf3n es requerido (7 - 12 d\xedgitos)."),e.qZA())}function gt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del tel\xe9fono es inv\xe1lido (7 - 12 d\xedgitos)."),e.qZA())}function ft(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,ht,2,0,"p",61),e.YNc(2,gt,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.invoice_phone.errors.required),e.xp6(1),e.Q6J("ngIf",t.formData.controls.invoice_phone.errors.pattern)}}function bt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El giro de la empresa es requerido."),e.qZA())}function Tt(a,n){if(1&a&&(e.TgZ(0,"div",60),e.YNc(1,bt,2,0,"p",61),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.giro.errors.required)}}function At(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"div",28)(1,"form",29,62)(3,"div",31)(4,"label",32)(5,"strong"),e._uU(6,"C\xf3digo de la empresa"),e.qZA()(),e.TgZ(7,"div",33)(8,"input",63),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.db[o.index].CODE_BUSINESS=s)}),e.qZA()(),e.YNc(9,Ve,3,2,"div",35),e.qZA(),e.TgZ(10,"div",31)(11,"label",36)(12,"strong"),e._uU(13,"Nombre de la empresa"),e.qZA()(),e.TgZ(14,"div",33)(15,"input",64),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.db[o.index].NAME=s)}),e.qZA()(),e.YNc(16,He,2,1,"div",35),e.qZA(),e.TgZ(17,"div",31)(18,"label",38)(19,"strong"),e._uU(20,"Rut de la empresa"),e.qZA()(),e.TgZ(21,"div",33)(22,"input",65),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.db[o.index].VAT=s)}),e.qZA()(),e.YNc(23,Ke,4,3,"div",35),e.qZA(),e.TgZ(24,"div",31)(25,"label",40)(26,"strong"),e._uU(27,"Direcci\xf3n de la empresa"),e.qZA()(),e.TgZ(28,"div",33)(29,"input",66),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.db[o.index].LOC_ADDRESS=s)}),e.qZA()(),e.YNc(30,We,2,1,"div",35),e.qZA(),e.TgZ(31,"div",31)(32,"label",42)(33,"strong"),e._uU(34,"Tel\xe9fono/Celular de la empresa"),e.qZA()(),e.TgZ(35,"div",33)(36,"input",67),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.db[o.index].PHONE=s)}),e.qZA()(),e.YNc(37,it,3,2,"div",35),e.qZA(),e.TgZ(38,"div",31)(39,"label",44)(40,"strong"),e._uU(41,"Correo de la empresa"),e.qZA()(),e.TgZ(42,"div",33)(43,"input",68),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.db[o.index].EMAIL=s)}),e.qZA()(),e.YNc(44,st,3,2,"div",35),e.qZA(),e.TgZ(45,"div",31)(46,"label",46)(47,"strong"),e._uU(48,"Nombre Account Manager"),e.qZA()(),e.TgZ(49,"div",33)(50,"input",69),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.db[o.index].AM_FIRST_NAME=s)}),e.qZA()(),e.YNc(51,nt,2,1,"div",35),e.qZA(),e.TgZ(52,"div",31)(53,"label",48)(54,"strong"),e._uU(55,"Apellido Account Manager"),e.qZA()(),e.TgZ(56,"div",33)(57,"input",70),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.db[o.index].AM_LAST_NAME=s)}),e.qZA()(),e.YNc(58,ct,2,1,"div",35),e.qZA(),e.TgZ(59,"div",31)(60,"label",50)(61,"strong"),e._uU(62,"Nombre contacto facturaci\xf3n"),e.qZA()(),e.TgZ(63,"div",33)(64,"input",71),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.db[o.index].INVOICE_NAME=s)}),e.qZA()(),e.YNc(65,ut,2,1,"div",35),e.qZA(),e.TgZ(66,"div",31)(67,"label",52)(68,"strong"),e._uU(69,"Correo contacto facturaci\xf3n"),e.qZA()(),e.TgZ(70,"div",33)(71,"input",72),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.db[o.index].INVOICE_EMAIL=s)}),e.qZA()(),e.YNc(72,mt,3,2,"div",35),e.qZA(),e.TgZ(73,"div",31)(74,"label",54)(75,"strong"),e._uU(76,"Tel\xe9fono/Celular contacto facturaci\xf3n"),e.qZA()(),e.TgZ(77,"div",33)(78,"input",73),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.db[o.index].INVOICE_PHONE=s)}),e.qZA()(),e.YNc(79,ft,3,2,"div",35),e.qZA(),e.TgZ(80,"div",31)(81,"label",56)(82,"strong"),e._uU(83,"Giro empresa"),e.qZA()(),e.TgZ(84,"div",33)(85,"input",74),e.NdJ("ngModelChange",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.db[o.index].GIRO=s)}),e.qZA()(),e.YNc(86,Tt,2,1,"div",35),e.qZA(),e.TgZ(87,"button",75),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return s.btnUpdateBusiness(s.id),s.getAllBusiness(),e.KtG(s.pagTo(0))}),e._uU(88,"Aceptar"),e.qZA(),e.TgZ(89,"button",59),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.popupModify=!s.popupModify)}),e._uU(90,"Cancelar"),e.qZA()()()}if(2&a){const t=e.MAs(2),i=e.oxw();e.xp6(1),e.Q6J("formGroup",i.formData),e.xp6(7),e.Q6J("ngModel",i.db[i.index].CODE_BUSINESS),e.xp6(1),e.Q6J("ngIf",i.formData.controls.code_business.errors&&i.formData.controls.code_business.touched),e.xp6(6),e.Q6J("ngModel",i.db[i.index].NAME),e.xp6(1),e.Q6J("ngIf",i.formData.controls.name_business.errors&&i.formData.controls.name_business.touched),e.xp6(6),e.Q6J("ngModel",i.db[i.index].VAT),e.xp6(1),e.Q6J("ngIf",i.formData.controls.rut.errors&&i.formData.controls.rut.touched),e.xp6(6),e.Q6J("ngModel",i.db[i.index].LOC_ADDRESS),e.xp6(1),e.Q6J("ngIf",i.formData.controls.loc_address.errors&&i.formData.controls.loc_address.touched),e.xp6(6),e.Q6J("ngModel",i.db[i.index].PHONE),e.xp6(1),e.Q6J("ngIf",i.formData.controls.phone.errors&&i.formData.controls.phone.touched),e.xp6(6),e.Q6J("ngModel",i.db[i.index].EMAIL),e.xp6(1),e.Q6J("ngIf",i.formData.controls.email.errors&&i.formData.controls.email.touched),e.xp6(6),e.Q6J("ngModel",i.db[i.index].AM_FIRST_NAME),e.xp6(1),e.Q6J("ngIf",i.formData.controls.am_first_name.errors&&i.formData.controls.am_first_name.touched),e.xp6(6),e.Q6J("ngModel",i.db[i.index].AM_LAST_NAME),e.xp6(1),e.Q6J("ngIf",i.formData.controls.am_last_name.errors&&i.formData.controls.am_last_name.touched),e.xp6(6),e.Q6J("ngModel",i.db[i.index].INVOICE_NAME),e.xp6(1),e.Q6J("ngIf",i.formData.controls.invoice_name.errors&&i.formData.controls.invoice_name.touched),e.xp6(6),e.Q6J("ngModel",i.db[i.index].INVOICE_EMAIL),e.xp6(1),e.Q6J("ngIf",i.formData.controls.invoice_email.errors&&i.formData.controls.invoice_email.touched),e.xp6(6),e.Q6J("ngModel",i.db[i.index].INVOICE_PHONE),e.xp6(1),e.Q6J("ngIf",i.formData.controls.invoice_phone.errors&&i.formData.controls.invoice_phone.touched),e.xp6(6),e.Q6J("ngModel",i.db[i.index].GIRO),e.xp6(1),e.Q6J("ngIf",i.formData.controls.giro.errors&&i.formData.controls.giro.touched),e.xp6(1),e.Q6J("disabled",t.invalid)}}let Et=(()=>{class a{constructor(t,i){this.fb=t,this.businessService=i,this.listBusiness=[],this.pos=1,this.db=[],this.cant=0,this.filteredList=[],this.existingCode="",this.popupVisible=!1,this.popupModify=!1,this.id="",this.index=0,this.id_business=[],this.name_business=[],this.rut=[],this.loc_address=[],this.phone=[],this.email=[],this.am_first_name=[],this.am_last_name=[],this.invoice_name=[],this.invoice_email=[],this.invoice_phone=[],this.code_business=[],this.giro=[],this.verifyCode=s=>{const o=s.value;return o&&this.code_business.map(l=>l.toLowerCase()).includes(o.toLowerCase())&&o.toLowerCase()!==this.existingCode.toLowerCase()?{code_business:!0}:null}}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.getAllBusiness(),this.formData=this.fb.group({code_business:["",[c.kI.required,this.verifyCode]],name_business:["",[c.kI.required]],rut:["",[c.kI.required,c.kI.pattern("^[0-9]{1,2}[0-9]{3}[0-9]{3}-[0-9Kk]{1}$"),this.verifyRut]],loc_address:["",[c.kI.required]],phone:["",[c.kI.required,c.kI.pattern("^[0-9]{7,12}$")]],email:["",[c.kI.required,c.kI.email]],am_first_name:["",[c.kI.required]],am_last_name:["",[c.kI.required]],invoice_name:["",[c.kI.required]],invoice_email:["",[c.kI.required,c.kI.email]],invoice_phone:["",[c.kI.required,c.kI.pattern("^[0-9]{7,12}$")]],giro:["",[c.kI.required]]})}getAllBusiness(){this.id_business=[],this.name_business=[],this.rut=[],this.loc_address=[],this.phone=[],this.email=[],this.am_first_name=[],this.am_last_name=[],this.invoice_name=[],this.invoice_email=[],this.invoice_phone=[],this.code_business=[],this.giro=[],this.businessService.getAllBusiness().subscribe({next:t=>{if(this.filteredList=t.status,this.listBusiness=t.status,this.cant=Math.ceil(this.listBusiness.length/10),this.db=this.listBusiness.slice(0,10).sort((i,s)=>s.YEAR_STATEMENT-i.YEAR_STATEMENT),t.status)for(let i=0;i<t.status.length;i++)this.id_business.push(t.status[i].ID),this.name_business.push(t.status[i].NAME),this.rut.push(t.status[i].VAT),this.loc_address.push(t.status[i].LOC_ADDRESS),this.phone.push(t.status[i].PHONE),this.email.push(t.status[i].EMAIL),this.am_first_name.push(t.status[i].AM_FIRST_NAME),this.am_last_name.push(t.status[i].AM_LAST_NAME),this.invoice_name.push(t.status[i].INVOICE_NAME),this.invoice_email.push(t.status[i].INVOICE_EMAIL),this.invoice_phone.push(t.status[i].INVOICE_PHONE),this.code_business.push(t.status[i].CODE_BUSINESS),this.giro.push(t.status[i].GIRO)},error:t=>{d().close(),d().fire({icon:"error",text:t.msg,title:"\xa1Ups!"})}})}btnAddBusiness(){const{name_business:t,rut:i,loc_address:s,phone:o,email:r,am_first_name:l,am_last_name:u,invoice_name:h,invoice_email:g,invoice_phone:f,code_business:A,giro:C}=this.formData.value;if(this.formData.invalid)return d().fire({title:"Validar informaci\xf3n",text:"Debe completar todos los campos",icon:"error"}),void this.getAllBusiness();this.businessService.postBusiness(t,i,s,o,r,l,u,h,g,f,A,C).subscribe({next:E=>{E.status&&(d().fire({title:"Empresa agregada",text:"La empresa fue agregada exitosamente",icon:"success"}),this.popupVisible=!1,this.getAllBusiness(),this.formData.reset())},error:E=>{d().fire({title:"Error",text:"Error al agregar la empresa",icon:"error"})}})}btnDeleteBusiness(t){d().fire({title:"\xbfEst\xe1s seguro que quieres eliminar la empresa?",showDenyButton:!0,confirmButtonText:"Confirmar",denyButtonText:"Cancelar"}).then(i=>{i.isConfirmed&&this.businessService.deleteBusiness(t).subscribe({next:s=>{s.status?(d().fire({title:"Empresa Eliminada",text:"",icon:"error"}),this.getAllBusiness(),this.pagTo(0)):d().fire({title:"Validar informaci\xf3n",text:s.msg,icon:"error"})},error:s=>{d().fire({title:"Formato inv\xe1lido",text:"",icon:"error"})}})})}btnUpdateBusiness(t){const{name_business:i,rut:s,loc_address:o,phone:r,email:l,am_first_name:u,am_last_name:h,invoice_name:g,invoice_email:f,invoice_phone:A,code_business:C,giro:E}=this.formData.value;this.formData.invalid?d().fire({title:"Validar informaci\xf3n",text:"Debe completar todos los campos",icon:"error"}):this.businessService.updateBusiness(t,i,s,o,r,l,u,h,g,f,A,C,E).subscribe({next:b=>{b.status&&(d().fire({title:"Empresa Modificada",text:"",icon:"success"}),this.formData.reset(),this.popupModify=!1,this.getAllBusiness())},error:b=>{d().fire({title:"Error",text:"",icon:"error"})}})}verifyRut(t){return(0,V.validate)(t.value)?null:{rut:!0}}pagTo(t){this.pos=t+1,this.db=this.filteredList.slice(10*t,10*(t+1)).sort((i,s)=>s.YEAR_STATEMENT-i.YEAR_STATEMENT)}next(){this.pos>=this.cant||(this.pos++,this.db=this.filteredList.slice(10*(this.pos-1),10*this.pos).sort((t,i)=>i.YEAR_STATEMENT-t.YEAR_STATEMENT))}previus(){this.pos-1<=0||this.pos>=this.cant+1||(this.pos=this.pos-1,this.db=this.filteredList.slice(10*(this.pos-1),10*this.pos).sort((t,i)=>i.YEAR_STATEMENT-t.YEAR_STATEMENT))}setArrayFromNumber(){return new Array(this.cant)}visiblePageNumbers(){const t=this.setArrayFromNumber().length,i=[];if(t<=15)for(let s=0;s<t;s++)i.push(s);else{let s=Math.max(0,this.pos-Math.floor(7.5)),o=Math.min(t-1,s+14);o-s+1<15&&(o=t-1,s=Math.max(0,o-14));for(let r=s;r<=o;r++)i.push(r)}return i}filter(t){const i=t.value?.toLowerCase();this.pos=1;const s=[];return""!=t.value?(this.cant=1,this.db=this.listBusiness.filter(o=>{(o.NAME?.toLowerCase().indexOf(i)>-1||o.CODE_BUSINESS?.toLowerCase().indexOf(i)>-1||o.LOC_ADDRESS?.toLowerCase().indexOf(i)>-1||o.VAT?.toLowerCase().indexOf(i)>-1||o.PHONE?.toLowerCase().indexOf(i)>-1||o.EMAIL?.toLowerCase().indexOf(i)>-1||o.GIRO?.toLowerCase().indexOf(i)>-1||o.AM_FIRST_NAME?.toLowerCase().indexOf(i)>-1||o.AM_LAST_NAME?.toLowerCase().indexOf(i)>-1||o.INVOICE_NAME?.toLowerCase().indexOf(i)>-1||o.INVOICE_EMAIL?.toLowerCase().indexOf(i)>-1||o.INVOICE_PHONE?.toLowerCase().indexOf(i)>-1)&&s.push(o)}),this.filteredList=s,this.db=s.slice(0,10),this.cant=Math.ceil(s.length/10),this.db):(this.filteredList=this.listBusiness,this.db=this.listBusiness.slice(0,10),this.cant=Math.ceil(this.listBusiness.length/10),this.db)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(c.qu),e.Y36(R.m))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-maintainer-business"]],decls:74,vars:4,consts:[["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],[1,"buttonRight"],[1,"btn","btn-primary",3,"click"],[2,"height","50px"],[1,"row","mb-3"],[1,"col-md-12"],["type","text","placeholder","Filtro de b\xfasqueda",1,"form-control",3,"keyup"],[1,"table-responsive","mb-4"],[1,"row","w-100"],["id","table",1,"w-100"],["table1",""],[1,"w-100"],[1,"table-container","table","table-even","table-section","table-borderless","table-border","table-radius","d-lg-table"],[1,"text-center","w-100"],["class","text-end w-100",4,"ngFor","ngForOf"],["aria-label","Navegaci\xf3n resultados"],[1,"pagination"],[4,"ngFor","ngForOf"],["class","dark-background ",4,"ngIf"],[1,"text-end","w-100"],[1,"btn-group"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"border","btn","btn-sm",3,"ngClass","click"],[1,"dark-background"],["autocomplete","off",1,"popup",2,"overflow-y","scroll","scroll-behavior","smooth","height","800px",3,"formGroup"],["miFormulario","ngForm"],[1,"mb-4"],["for","code_business",2,"color","rgb(0, 138, 92)"],[1,"input-group"],["type","code_business","id","code_business","formControlName","code_business","placeholder","C\xf3digo de la empresa",1,"form-control"],["class","text-danger pl-0",4,"ngIf"],["for","name_business",2,"color","rgb(0, 138, 92)"],["type","name_business","id","name_business","formControlName","name_business","placeholder","Nombre",1,"form-control"],["for","rut",2,"color","rgb(0, 138, 92)"],["type","rut","id","rut","formControlName","rut","placeholder","Rut",1,"form-control"],["for","loc_address",2,"color","rgb(0, 138, 92)"],["type","loc_address","id","loc_address","formControlName","loc_address","placeholder","Direcci\xf3n",1,"form-control"],["for","phone",2,"color","rgb(0, 138, 92)"],["type","phone","id","phone","formControlName","phone","placeholder","Tel\xe9fono/Celular",1,"form-control"],["for","email",2,"color","rgb(0, 138, 92)"],["type","email","id","email","formControlName","email","placeholder","E-mail",1,"form-control"],["for","am_first_name",2,"color","rgb(0, 138, 92)"],["type","am_first_name","id","am_first_name","formControlName","am_first_name","placeholder","Nombre Account Manager",1,"form-control"],["for","am_last_name",2,"color","rgb(0, 138, 92)"],["type","am_last_name","id","am_last_name","formControlName","am_last_name","placeholder","Apellido Account Manager",1,"form-control"],["for","invoice_name",2,"color","rgb(0, 138, 92)"],["type","invoice_name","id","invoice_name","formControlName","invoice_name","placeholder","Nombre contacto facturaci\xf3n",1,"form-control"],["for","invoice_email",2,"color","rgb(0, 138, 92)"],["type","invoice_email","id","invoice_email","formControlName","invoice_email","placeholder","Correo contacto facturaci\xf3n",1,"form-control"],["for","invoice_phone",2,"color","rgb(0, 138, 92)"],["type","invoice_phone","id","invoice_phone","formControlName","invoice_phone","placeholder","Tel\xe9fono/Celular contacto facturaci\xf3n",1,"form-control"],["for","giro",2,"color","rgb(0, 138, 92)"],["type","giro","id","giro","formControlName","giro","placeholder","Giro Empresa",1,"form-control"],["type","submit",1,"btn","btn-primary",2,"width","150px","margin-left","400px",3,"disabled","click"],["type","button",1,"btn","btn-secondary","buttonRight",2,"width","150px",3,"click"],[1,"text-danger","pl-0"],[4,"ngIf"],["miFormulari02","ngForm"],["type","code_business","id","code_business","formControlName","code_business","placeholder","C\xf3digo de la empresa",1,"form-control",3,"ngModel","ngModelChange"],["type","name_business","id","name_business","formControlName","name_business","placeholder","Nombre",1,"form-control",3,"ngModel","ngModelChange"],["type","rut","id","rut","formControlName","rut","placeholder","Rut",1,"form-control",3,"ngModel","ngModelChange"],["type","loc_address","id","loc_address","formControlName","loc_address","placeholder","Direcci\xf3n",1,"form-control",3,"ngModel","ngModelChange"],["type","phone","id","phone","formControlName","phone","placeholder","Tel\xe9fono/Celular",1,"form-control",3,"ngModel","ngModelChange"],["type","email","id","email","formControlName","email","placeholder","E-mail",1,"form-control",3,"ngModel","ngModelChange"],["type","am_first_name","id","am_first_name","formControlName","am_first_name","placeholder","Nombre Account Manager",1,"form-control",3,"ngModel","ngModelChange"],["type","am_last_name","id","am_last_name","formControlName","am_last_name","placeholder","Apellido Account Manager",1,"form-control",3,"ngModel","ngModelChange"],["type","invoice_name","id","invoice_name","formControlName","invoice_name","placeholder","Nombre contacto facturaci\xf3n",1,"form-control",3,"ngModel","ngModelChange"],["type","invoice_email","id","invoice_email","formControlName","invoice_email","placeholder","Correo contacto facturaci\xf3n",1,"form-control",3,"ngModel","ngModelChange"],["type","invoice_phone","id","invoice_phone","formControlName","invoice_phone","placeholder","Tel\xe9fono/Celular contacto facturaci\xf3n",1,"form-control",3,"ngModel","ngModelChange"],["type","giro","id","giro","formControlName","giro","placeholder","Giro Empresa",1,"form-control",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-primary",2,"width","150px","margin-left","400px",3,"disabled","click"]],template:function(t,i){1&t&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"i",4),e._uU(5," Inicio"),e.qZA()(),e.TgZ(6,"li",2)(7,"a",3),e._uU(8,"Mantener Empresas"),e.qZA()()()(),e.TgZ(9,"h1"),e._uU(10,"Empresas"),e.qZA(),e.TgZ(11,"div",5)(12,"button",6),e.NdJ("click",function(){return i.popupVisible=!i.popupVisible,i.formData.reset()}),e._uU(13,"Agregar Empresa"),e.qZA()(),e._UZ(14,"div",7),e.TgZ(15,"div",8)(16,"div",9)(17,"label"),e._uU(18,"Filtro:"),e.qZA(),e.TgZ(19,"input",10),e.NdJ("keyup",function(o){return i.filter(o.target)}),e.qZA()()(),e.TgZ(20,"div",11)(21,"section")(22,"div",12)(23,"div",13,14)(25,"div",15)(26,"table",16)(27,"thead")(28,"tr",17)(29,"th"),e._uU(30,"C\xd3DIGO EMPRESA"),e.qZA(),e.TgZ(31,"th"),e._uU(32,"NOMBRE"),e.qZA(),e.TgZ(33,"th"),e._uU(34,"RUT"),e.qZA(),e.TgZ(35,"th"),e._uU(36,"DIRECCI\xd3N"),e.qZA(),e.TgZ(37,"th"),e._uU(38,"TEL\xc9FONO"),e.qZA(),e.TgZ(39,"th"),e._uU(40,"E-MAIL"),e.qZA(),e.TgZ(41,"th"),e._uU(42,"NOMBRE ACCOUNT MANAGER"),e.qZA(),e.TgZ(43,"th"),e._uU(44,"APELLIDO ACCOUNT MANAGER"),e.qZA(),e.TgZ(45,"th"),e._uU(46,"NOMBRE CONTACTO FACTURACI\xd3N"),e.qZA(),e.TgZ(47,"th"),e._uU(48,"EMAIL CONTACTO FACTURACI\xd3N"),e.qZA(),e.TgZ(49,"th"),e._uU(50,"TEL\xc9FONO CONTACTO FACTURACI\xd3N"),e.qZA(),e.TgZ(51,"th"),e._uU(52,"GIRO"),e.qZA(),e._UZ(53,"th")(54,"th"),e.qZA()(),e.TgZ(55,"tbody"),e.YNc(56,le,33,12,"tr",18),e.qZA()(),e.TgZ(57,"nav",19)(58,"ul",20)(59,"li")(60,"button",6),e.NdJ("click",function(){return i.pagTo(0)}),e._uU(61,"Primero"),e.qZA()(),e.TgZ(62,"li")(63,"button",6),e.NdJ("click",function(){return i.previus()}),e._uU(64,"Anterior"),e.qZA()(),e.YNc(65,de,3,5,"li",21),e.TgZ(66,"li")(67,"button",6),e.NdJ("click",function(){return i.next()}),e._uU(68,"Siguiente"),e.qZA()(),e.TgZ(69,"li")(70,"button",6),e.NdJ("click",function(){return i.pagTo(i.cant-1)}),e._uU(71,"\xdaltimo"),e.qZA()()()(),e.YNc(72,ke,91,14,"div",22),e.YNc(73,At,91,26,"div",22),e.qZA()()()()()),2&t&&(e.xp6(56),e.Q6J("ngForOf",i.db),e.xp6(9),e.Q6J("ngForOf",i.visiblePageNumbers()),e.xp6(7),e.Q6J("ngIf",i.popupVisible),e.xp6(1),e.Q6J("ngIf",i.popupModify))},dependencies:[p.mk,p.sg,p.O5,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u],styles:[".list-process__dot[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]{width:100%!important;padding:1%}.red-button[_ngcontent-%COMP%]{background-color:red}.popup[_ngcontent-%COMP%]{position:absolute;top:calc(45% + 10px);left:60%;transform:translate(-50%,-50%);background-color:#fff;border:1px solid rgb(17,165,128);padding:20px;width:800px;border-radius:10px}@media (max-width: 768px){.popup[_ngcontent-%COMP%]{width:100%}}.btnLeft[_ngcontent-%COMP%]{margin-left:400px}@media (max-width: 768px){.btnLeft[_ngcontent-%COMP%]{margin-left:0}}.buttonRight[_ngcontent-%COMP%]{position:absolute;right:40px}.dark-background[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#00000080;z-index:1}.table-container[_ngcontent-%COMP%]{word-wrap:break-word;table-layout:fixed;width:100%;height:auto;overflow-x:hidden}"]}),a})();var G=m(263);let vt=(()=>{class a{constructor(t,i,s){this.fb=t,this.authService=i,this.router=s,this.pos="right",this.horaIngreso=new Date,this.formData=this.fb.group({actual:["",[c.kI.required]],password:["",[c.kI.required,c.kI.minLength(3)]],repeatPassword:["",[c.kI.required,c.kI.minLength(3)]]})}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.horaIngreso=new Date(sessionStorage.getItem("horaIngreso")),localStorage.removeItem("statementsState")}btnrecovery(){const{actual:t,password:i,repeatPassword:s}=this.formData.value;this.authService.modifyPassword(i,s,t).subscribe({next:o=>{o.status?(d().fire({title:"Cambio de contrase\xf1a",text:"La contrase\xf1a fue cambiada exitosamente",icon:"success"}),this.router.navigate(["/mantenedor/home"])):(d().fire({title:"Validar informaci\xf3n",text:o.msg,icon:"error"}),this.formData.reset())},error:o=>{d().fire({title:"Formato inv\xe1lido",text:"Contrase\xf1a debe contener al menos 8 caracteres",icon:"error"})}})}displayModifyPassword(){this.pos="right"==this.pos?"down":"right"}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(c.qu),e.Y36(G.e),e.Y36(Z.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-profile"]],decls:81,vars:16,consts:[[1,"container","mt-4"],[1,"mi-perfil"],[1,"box","box-mi-perfil","mb-5","d-flex","align-items-start"],[1,"list","list-data","list-data-title-green","column-md-2","gap-0","list-unstyled"],[1,"list-data__title"],[1,"list-data__text"],[1,"color-verde"],[1,"list","list-links","list-unstyled"],["id","accordionPanelsStayOpenExample",1,"accordion","accordion-flush"],[1,"accordion-item"],["id","panelsStayOpen-headingOne",1,"accordion-header"],["data-bs-toggle","collapse","data-bs-target","#panelsStayOpen-collapseOne",3,"click"],["aria-hidden","true"],["id","panelsStayOpen-collapseOne","aria-labelledby","panelsStayOpen-headingOne",1,"accordion-collapse","collapse"],[1,"accordion-body"],["autocomplete","off",1,"form-recovery",3,"formGroup"],[1,"mb-4"],[1,"input-group"],[1,"input-group-text","input-group-text-left"],["aria-hidden","true",1,"fa","fa-lock","fa-fw"],["type","password","id","password","formControlName","actual","placeholder","Contrase\xf1a actual",1,"form-control"],["type","password","id","password","formControlName","password","placeholder","Nueva contrase\xf1a",1,"form-control"],["type","password","id","repeatPassword","formControlName","repeatPassword","placeholder","Repetir contrase\xf1a",1,"form-control"],["type","button",1,"btn","btn-primary","btn-fa","w-100",3,"click"],["aria-hidden","true",1,"fa","fa-long-arrow-right","fa-fw"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"section",1)(2,"h1"),e._uU(3,"Mi Perfil"),e.qZA(),e.TgZ(4,"div",2)(5,"ul",3)(6,"li")(7,"span",4),e._uU(8,"Nombre Usuario"),e.qZA(),e.TgZ(9,"span",5),e._uU(10),e.qZA()(),e.TgZ(11,"li")(12,"span",4),e._uU(13,"Perfil"),e.qZA(),e.TgZ(14,"span",5),e._uU(15),e.qZA()(),e.TgZ(16,"li")(17,"span",4),e._uU(18,"Tel\xe9fono"),e.qZA(),e.TgZ(19,"span",5),e._uU(20),e.qZA()(),e.TgZ(21,"li")(22,"span",4),e._uU(23,"Correo"),e.qZA(),e.TgZ(24,"span",5),e._uU(25),e.qZA()(),e.TgZ(26,"li")(27,"span",4),e._uU(28,"Instituci\xf3n"),e.qZA(),e.TgZ(29,"span",5),e._uU(30),e.qZA()(),e.TgZ(31,"li")(32,"span",4),e._uU(33,"Cargo"),e.qZA(),e.TgZ(34,"span",5),e._uU(35),e.qZA()(),e.TgZ(36,"li")(37,"span",4),e._uU(38,"Tel\xe9fono Oficina"),e.qZA(),e.TgZ(39,"span",5),e._uU(40),e.qZA()(),e.TgZ(41,"li")(42,"span",4)(43,"b"),e._uU(44,"Fecha/ Hora ingreso"),e.qZA()(),e.TgZ(45,"span",5),e._uU(46),e.ALo(47,"date"),e.qZA()()()(),e.TgZ(48,"h2",6),e._uU(49,"Acciones"),e.qZA(),e.TgZ(50,"ul",7)(51,"div",8)(52,"div",9)(53,"h2",10)(54,"li",11),e.NdJ("click",function(){return i.displayModifyPassword()}),e.TgZ(55,"a")(56,"span"),e._uU(57,"Cambio de contrase\xf1a"),e.qZA(),e._UZ(58,"i",12),e.qZA()()(),e.TgZ(59,"div",13)(60,"div",14)(61,"form",15)(62,"div",16)(63,"div",17)(64,"button",18),e._UZ(65,"i",19),e.qZA(),e._UZ(66,"input",20),e.qZA()(),e.TgZ(67,"div",16)(68,"div",17)(69,"button",18),e._UZ(70,"i",19),e.qZA(),e._UZ(71,"input",21),e.qZA()(),e.TgZ(72,"div",16)(73,"div",17)(74,"button",18),e._UZ(75,"i",19),e.qZA(),e._UZ(76,"input",22),e.qZA()(),e.TgZ(77,"div",16)(78,"button",23),e.NdJ("click",function(){return i.btnrecovery()}),e._uU(79," Enviar "),e._UZ(80,"i",24),e.qZA()()()()()()()()()()),2&t&&(e.xp6(10),e.AsE("",i.userData.FIRST_NAME," ",i.userData.LAST_NAME,""),e.xp6(5),e.Oqu(i.userData.ROL_NAME),e.xp6(5),e.Oqu(i.userData.PHONE),e.xp6(5),e.Oqu(i.userData.EMAIL),e.xp6(5),e.Oqu(i.userData.BUSINESS.join(" || ")),e.xp6(5),e.Oqu(i.userData.POSITION),e.xp6(5),e.Oqu(i.userData.PHONE_OFFICE),e.xp6(6),e.Oqu(e.xi3(47,13,i.horaIngreso,"dd-MM-yyyy H:mm:s")),e.xp6(12),e.Gre("fa fa-chevron-",i.pos,""),e.xp6(3),e.Q6J("formGroup",i.formData))},dependencies:[c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,p.uU]}),a})();var H=m(3813),z=m(9821);function Zt(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"tr",15)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td")(8,"div",52)(9,"button",53),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw();return r.getEstablishment(o.ID),e.KtG(r.index=o.ID)}),e._uU(10,"Establecimientos"),e.qZA()()()()}if(2&a){const t=n.$implicit;e.xp6(2),e.Oqu(t.CODE_BUSINESS),e.xp6(2),e.Oqu(t.NAME),e.xp6(2),e.Oqu(t.LOC_ADDRESS)}}const $=function(a,n){return{"btn-info":a,"btn-primary":n}};function Mt(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"li")(1,"button",54),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.pagTo(o))}),e._uU(2),e.qZA()()}if(2&a){const t=n.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngClass",e.WLB(2,$,i.pos===t+1,i.pos!==t+1)),e.xp6(1),e.Oqu(t+1)}}function Ct(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El nombre del establecimiento es requerido."),e.qZA())}function Nt(a,n){if(1&a&&(e.TgZ(0,"div",55),e.YNc(1,Ct,2,0,"p",51),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.NAME.errors.required)}}function xt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"La direcci\xf3n del establecimiento es requerido."),e.qZA())}function Rt(a,n){if(1&a&&(e.TgZ(0,"div",55),e.YNc(1,xt,2,0,"p",51),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.ADDRESS.errors.required)}}function Ut(a,n){if(1&a&&(e.TgZ(0,"option",56),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.Q6J("value",t.ID),e.xp6(1),e.Oqu(t.NAME)}}function qt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"Debe seleccionar alguna regi\xf3n."),e.qZA())}function Ft(a,n){if(1&a&&(e.TgZ(0,"div",55),e.YNc(1,qt,2,0,"p",51),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.ID_REGION.errors.required)}}function St(a,n){if(1&a&&(e.TgZ(0,"option",56),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.Q6J("value",t.communes_id),e.xp6(1),e.Oqu(t.communes_name)}}function Pt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"Debe seleccionar alguna comuna."),e.qZA())}function It(a,n){if(1&a&&(e.TgZ(0,"div",55),e.YNc(1,Pt,2,0,"p",51),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.ID_COMUNA.errors.required)}}function Dt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El ID de ventanilla \xfanica es requerido."),e.qZA())}function yt(a,n){if(1&a&&(e.TgZ(0,"div",55),e.YNc(1,Dt,2,0,"p",51),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.V_UNIQUE.errors.required)}}function Ot(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"tr",15)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td")(12,"button",59),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.deleteEstablishment(o.ID_ESTABLISHMENT))}),e._uU(13," X "),e.qZA()()()}if(2&a){const t=n.$implicit;e.xp6(2),e.Oqu(t.NAME_ESTABLISHMENT),e.xp6(2),e.Oqu(t.ADDRESS),e.xp6(2),e.Oqu(t.REGION),e.xp6(2),e.Oqu(t.NAME_COMMUNE),e.xp6(2),e.Oqu(t.ID_VU)}}function wt(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"li")(1,"button",54),e.NdJ("click",function(){const o=e.CHM(t).index,r=e.oxw(2);return e.KtG(r.pagTo2(o))}),e._uU(2),e.qZA()()}if(2&a){const t=n.index,i=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.WLB(2,$,i.pos2==t+1,i.pos2!=t+1)),e.xp6(1),e.Oqu(t+1)}}function Lt(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"div"),e._UZ(1,"div",57),e.TgZ(2,"div",6)(3,"div",7)(4,"label"),e._uU(5,"Filtro:"),e.qZA(),e.TgZ(6,"input",58),e.NdJ("keyup",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.filterForm(s.target))}),e.qZA()()(),e.TgZ(7,"table",14)(8,"thead")(9,"tr",15)(10,"th"),e._uU(11,"Establecimiento"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Direcci\xf3n"),e.qZA(),e.TgZ(14,"th"),e._uU(15,"Regi\xf3n"),e.qZA(),e.TgZ(16,"th"),e._uU(17,"Comuna"),e.qZA(),e.TgZ(18,"th"),e._uU(19,"Id VU"),e.qZA(),e.TgZ(20,"th"),e._uU(21,"Eliminar"),e.qZA()()(),e.TgZ(22,"tbody"),e.YNc(23,Ot,14,5,"tr",16),e.qZA()(),e.TgZ(24,"nav",17)(25,"ul",18)(26,"li")(27,"button",19),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.pagTo2(0))}),e._uU(28,"Primero"),e.qZA()(),e.TgZ(29,"li")(30,"button",19),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.previus2())}),e._uU(31,"Anterior"),e.qZA()(),e.YNc(32,wt,3,5,"li",20),e.TgZ(33,"li")(34,"button",19),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.next2())}),e._uU(35,"Siguiente"),e.qZA()(),e.TgZ(36,"li")(37,"button",19),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.pagTo2(s.cant2-1))}),e._uU(38,"\xdaltimo"),e.qZA()()()()()}if(2&a){const t=e.oxw();e.xp6(23),e.Q6J("ngForOf",t.db2),e.xp6(9),e.Q6J("ngForOf",t.setArrayFromNumber2())}}let Bt=(()=>{class a{constructor(t,i,s,o){this.businesService=t,this.managerService=i,this.establishmentService=s,this.fb=o,this.listRegiones=[],this.listComunas=[],this.listCommunesFormated=[],this.listBusiness=[],this.pos=1,this.db=[],this.cant=0,this.establishmentStatus=[],this.pos2=1,this.db2=[],this.cant2=0,this.filteredList=[],this.filteredForm=[],this.index=0,this.NAME=[],this.ADDRESS=[],this.ID_REGION="",this.NAME_REGION="",this.ID_COMUNA="",this.V_UNIQUE=[],this.FILTER="",this.direction="asc",this.directionEstablishment="asc"}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.getAllBusiness(),this.getRegions(),this.getCommunesFormatted(),this.userForm=this.fb.group({NAME:[[],[c.kI.required]],ADDRESS:[[],[c.kI.required]],ID_REGION:["",[c.kI.required]],ID_COMUNA:["",[c.kI.required]],V_UNIQUE:[[],[c.kI.required]],FILTER:[[],[]]})}getRegions(){this.managerService.getAllRegions().subscribe({next:t=>{this.listRegiones=t.data},error:t=>{d().close(),d().fire({icon:"error",text:t.msg,title:"\xa1Ups!"})}})}getCommunesFormatted(){this.managerService.getCommunesFormatted().subscribe({next:t=>{this.listCommunesFormated=t.data},error:t=>{d().close(),d().fire({icon:"error",text:t.msg,title:"\xa1Ups!"})}})}communesFilter(t){const i=+t.target.value,s=t.target.selectedIndex;s>0&&(this.NAME_REGION=this.listRegiones[s-1].NAME),this.listComunas=this.listCommunesFormated.filter(o=>o.regions_id===i),this.listComunas.sort((o,r)=>o.communes_name.localeCompare(r.communes_name)),this.userForm.patchValue({ID_COMUNA:""})}getAllBusiness(){this.businesService.getAllBusiness().subscribe({next:t=>{this.listBusiness=t.status,this.filteredForm=t.status,this.cant=Math.ceil(this.listBusiness.length/10),this.db=this.listBusiness.slice(0,10).sort((i,s)=>s.YEAR_STATEMENT-i.YEAR_STATEMENT)},error:t=>{d().close(),d().fire({icon:"error",text:t.msg,title:"\xa1Ups!"})}})}getEstablishment(t){this.establishmentService.getEstablishment(t).subscribe({next:i=>{i.status?(this.establishmentStatus=i.status,this.filteredList=i.status,this.cant2=Math.ceil(this.establishmentStatus.length/10),this.db2=this.establishmentStatus.slice(0,10).sort((s,o)=>o.ID_ESTABLISHMENT-s.ID_ESTABLISHMENT)):this.establishmentStatus=[],this.reset()},error:i=>{d().close(),d().fire({icon:"error",text:i.msg,title:"\xa1Ups!"}),this.reset()}})}addEstablishment(t){if(this.verificarEstablecimiento()){const{NAME:i,ID_REGION:s,ID_COMUNA:o,V_UNIQUE:r,ADDRESS:l}=this.userForm.value;this.establishmentStatus.push(t),this.establishmentService.addEstablishment(i,this.NAME_REGION,r,s,o,l,t).subscribe({next:u=>{u.status&&(this.pagTo2(0),d().fire({title:"Establecimiento agregado",text:"El establecimiento fue agregado exitosamente",icon:"success"})),this.getEstablishment(t)},error:u=>{d().fire({title:"Error",text:"Error al agregar el establecimiento",icon:"error"})}})}else d().fire({title:"Establecimiento, Regi\xf3n y Comuna ya se encuentran registrados",text:"",icon:"error"})}deleteEstablishment(t){d().fire({title:"\xbfEst\xe1s seguro que quieres eliminar el establecimiento?",showDenyButton:!0,confirmButtonText:"Confirmar",denyButtonText:"Cancelar"}).then(i=>{i.isConfirmed&&(this.pagTo2(0),this.establishmentService.deleteEstablishment(t).subscribe({next:s=>{s.status?(d().fire({title:"Establecimiento Eliminado",text:"",icon:"error"}),this.getEstablishment(this.index)):d().fire({title:"Validar informaci\xf3n",text:s.msg,icon:"error"})},error:s=>{d().fire({title:"Formato inv\xe1lido",text:"",icon:"error"})}}))})}pagTo(t){this.pos=t+1,this.db=this.filteredForm.slice(10*t,10*(t+1)).sort((i,s)=>s.YEAR_STATEMENT-i.YEAR_STATEMENT)}next(){this.pos>=this.cant||(this.pos++,this.db=this.filteredForm.slice(10*(this.pos-1),10*this.pos).sort((t,i)=>i.YEAR_STATEMENT-t.YEAR_STATEMENT))}previus(){this.pos-1<=0||this.pos>=this.cant+1||(this.pos=this.pos-1,this.db=this.filteredForm.slice(10*(this.pos-1),10*this.pos).sort((t,i)=>i.YEAR_STATEMENT-t.YEAR_STATEMENT))}setArrayFromNumber(){return new Array(this.cant)}pagTo2(t){this.pos2=t+1,this.db2=this.filteredList.slice(10*t,10*(t+1)).sort((i,s)=>i.ID_ESTABLISHMENT-s.ID_ESTABLISHMENT)}next2(){this.pos2>=this.cant2||(this.pos2++,this.db2=this.filteredList.slice(10*(this.pos2-1),10*this.pos2).sort((t,i)=>t.ID_ESTABLISHMENT-i.ID_ESTABLISHMENT))}previus2(){this.pos2-1<=0||this.pos2>=this.cant2+1||(this.pos2=this.pos2-1,this.db2=this.filteredList.slice(10*(this.pos2-1),10*this.pos2).sort((t,i)=>t.ID_ESTABLISHMENT-i.ID_ESTABLISHMENT))}setArrayFromNumber2(){return new Array(this.cant2)}visiblePageNumbers(){const t=this.setArrayFromNumber().length,i=[];if(t<=15)for(let s=0;s<t;s++)i.push(s);else{let s=Math.max(0,this.pos-Math.floor(7.5)),o=Math.min(t-1,s+14);o-s+1<15&&(o=t-1,s=Math.max(0,o-14));for(let r=s;r<=o;r++)i.push(r)}return i}reset(){this.pagTo2(0),this.userForm.reset(),this.userForm.patchValue({REGION:"",FILTER:""})}verificarEstablecimiento(){const{NAME:t,ID_COMUNA:i}=this.userForm.value;let s=!1;const o=t.trim();for(let r=0;r<this.establishmentStatus.length;r++)if(this.establishmentStatus[r].NAME_ESTABLISHMENT.toLowerCase()===o.toLowerCase()&&this.establishmentStatus[r].REGION===this.NAME_REGION&&this.establishmentStatus[r].ID_COMUNA===parseInt(i)){s=!0;break}return!s}toggleDirection(){this.direction="asc"===this.direction?"desc":"asc",this.listBusiness.reverse(),this.cant=Math.ceil(this.listBusiness.length/10),this.db=this.listBusiness.slice(0,10).sort((t,i)=>i.YEAR_STATEMENT-t.YEAR_STATEMENT)}toggleDirectionEstablishments(){this.directionEstablishment="asc"===this.directionEstablishment?"desc":"asc",this.establishmentStatus.reverse(),this.cant2=Math.ceil(this.establishmentStatus.length/10),this.db2=this.establishmentStatus.slice(0,10).reverse()}filter(t){const i=t.value?.toLowerCase();this.pos=1;const s=[];return""!=t.value?(this.cant=1,this.db=this.listBusiness.filter(o=>{(o.NAME?.toLowerCase().indexOf(i)>-1||o.CODE_BUSINESS?.toLowerCase().indexOf(i)>-1||o.LOC_ADDRESS?.toLowerCase().indexOf(i)>-1)&&s.push(o)}),this.filteredForm=s,this.db=s.slice(0,10),this.cant=Math.ceil(s.length/10),this.db):(this.filteredForm=this.listBusiness,this.db=this.listBusiness.slice(0,10),this.cant=Math.ceil(this.listBusiness.length/10),this.db)}filterForm(t){const i=t.value?.toLowerCase();this.pos2=1;const s=[];return""!=t.value?(this.cant2=1,this.db2=this.establishmentStatus.filter(o=>{(o.NAME_ESTABLISHMENT?.toLowerCase().indexOf(i)>-1||o.ADDRESS?.toLowerCase().indexOf(i)>-1||o.REGION?.toLowerCase().indexOf(i)>-1||o.NAME_COMMUNE?.toLowerCase().indexOf(i)>-1||o.ID_VU?.toLowerCase().indexOf(i)>-1)&&s.push(o)}),this.filteredList=s,this.db2=s.slice(0,10),this.cant2=Math.ceil(s.length/10),this.db2):(this.filteredList=this.establishmentStatus,this.db2=this.establishmentStatus.slice(0,10),this.cant2=Math.ceil(this.establishmentStatus.length/10),this.db2)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(R.m),e.Y36(H.b),e.Y36(z.d),e.Y36(c.qu))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-maintainer-establishment"]],decls:107,vars:12,consts:[["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],[2,"height","30px"],[1,"row","mb-3"],[1,"col-md-12"],["type","text","placeholder","Filtro de b\xfasqueda",1,"form-control",3,"keyup"],[1,"table-responsive","mb-4"],[1,"row","w-100"],["id","table",1,"w-100"],["table1",""],[1,"w-100"],[1,"table-container","table","table-even","table-section","table-borderless","table-border","table-radius","d-lg-table"],[1,"text-center","w-100"],["class","text-center w-100",4,"ngFor","ngForOf"],["aria-label","Navegaci\xf3n resultados"],[1,"pagination"],[1,"btn","btn-primary",3,"click"],[4,"ngFor","ngForOf"],["id","exampleModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title","fs-5"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"container"],[3,"formGroup"],["miFormulario","ngForm"],[1,"row"],[1,"col-md-6"],["for","inp_nom"],[1,"input-group"],["type","text","formControlName","NAME","id","inp_nom","placeholder","Nombre",1,"form-control"],["class","text-danger pl-0",4,"ngIf"],["for","inp_add"],["type","text","formControlName","ADDRESS","id","inp_add","placeholder","Direccion",1,"form-control"],["for","inp_region"],["formControlName","ID_REGION","id","inp_region","required","",1,"form-select",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","inp_comuna"],["formControlName","ID_COMUNA","id","inp_comuna","required","",1,"form-select"],["for","inp_vu"],["type","text","formControlName","V_UNIQUE","id","inp_vu","placeholder","ID Ventanilla \xfanica",1,"form-control"],[1,"modal-footer"],["type","button","id","btnCloseModal","data-bs-dismiss","modal",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[2,"visibility","hidden"],[4,"ngIf"],[1,"btn-group"],["data-bs-toggle","modal","data-bs-target","#exampleModal",1,"btn","btn-success","btn-sm","rounded-pill",3,"click"],[1,"border","btn","btn-sm",3,"ngClass","click"],[1,"text-danger","pl-0"],[3,"value"],[2,"height","50px"],["type","text","id","filterInput","placeholder","Filtro de b\xfasqueda","formControlName","FILTER",1,"form-control",3,"keyup"],["type","button",1,"btn","btn-danger","btn-sm","rounded-pill",3,"click"]],template:function(t,i){if(1&t&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"i",4),e._uU(5," Inicio"),e.qZA()(),e.TgZ(6,"li",2)(7,"a",3),e._uU(8,"Mantenedor Establecimientos"),e.qZA()()()(),e._UZ(9,"div",5),e.TgZ(10,"h1"),e._uU(11,"Establecimientos"),e.qZA(),e.TgZ(12,"div",6)(13,"div",7)(14,"label"),e._uU(15,"Filtro:"),e.qZA(),e.TgZ(16,"input",8),e.NdJ("keyup",function(o){return i.filter(o.target)}),e.qZA()()(),e.TgZ(17,"div",9)(18,"section")(19,"div",10)(20,"div",11,12)(22,"div",13)(23,"table",14)(24,"thead")(25,"tr",15)(26,"th"),e._uU(27,"C\xd3DIGO EMPRESA "),e.qZA(),e.TgZ(28,"th"),e._uU(29,"NOMBRE "),e.qZA(),e.TgZ(30,"th"),e._uU(31,"DIRECCI\xd3N "),e.qZA(),e.TgZ(32,"th"),e._uU(33,"ESTABLECIMIENTOS "),e.qZA()()(),e.TgZ(34,"tbody"),e.YNc(35,Zt,11,3,"tr",16),e.qZA()(),e.TgZ(36,"nav",17)(37,"ul",18)(38,"li")(39,"button",19),e.NdJ("click",function(){return i.pagTo(0)}),e._uU(40,"Primero"),e.qZA()(),e.TgZ(41,"li")(42,"button",19),e.NdJ("click",function(){return i.previus()}),e._uU(43,"Anterior"),e.qZA()(),e.YNc(44,Mt,3,5,"li",20),e.TgZ(45,"li")(46,"button",19),e.NdJ("click",function(){return i.next()}),e._uU(47,"Siguiente"),e.qZA()(),e.TgZ(48,"li")(49,"button",19),e.NdJ("click",function(){return i.pagTo(i.cant-1)}),e._uU(50,"\xdaltimo"),e.qZA()()()()()()()()(),e.TgZ(51,"div",21)(52,"div",22)(53,"div",23)(54,"div",24)(55,"h1",25),e._uU(56,"Formulario Establecimientos"),e.qZA(),e._UZ(57,"button",26),e.qZA(),e.TgZ(58,"div",27)(59,"div",28)(60,"form",29,30)(62,"div",31)(63,"div",32)(64,"label",33),e._uU(65,"NOMBRE:"),e.qZA(),e.TgZ(66,"div",34),e._UZ(67,"input",35),e.qZA(),e.YNc(68,Nt,2,1,"div",36),e.qZA(),e.TgZ(69,"div",32)(70,"label",37),e._uU(71,"DIRECCI\xd3N:"),e.qZA(),e.TgZ(72,"div",34),e._UZ(73,"input",38),e.qZA(),e.YNc(74,Rt,2,1,"div",36),e.qZA(),e.TgZ(75,"div",32)(76,"label",39),e._uU(77,"REGI\xd3N"),e.qZA(),e.TgZ(78,"select",40),e.NdJ("change",function(o){return i.communesFilter(o)}),e.TgZ(79,"option",41),e._uU(80,"Selecciona Regi\xf3n"),e.qZA(),e.YNc(81,Ut,2,2,"option",42),e.qZA(),e.YNc(82,Ft,2,1,"div",36),e.qZA(),e.TgZ(83,"div",32)(84,"label",43),e._uU(85,"COMUNA"),e.qZA(),e.TgZ(86,"select",44)(87,"option",41),e._uU(88,"Selecciona Comuna"),e.qZA(),e.YNc(89,St,2,2,"option",42),e.qZA(),e.YNc(90,It,2,1,"div",36),e.qZA(),e.TgZ(91,"div",32)(92,"label",45),e._uU(93,"ID VENTANILLA \xdaNICA:"),e.qZA(),e.TgZ(94,"div",34),e._UZ(95,"input",46),e.qZA(),e.YNc(96,yt,2,1,"div",36),e.qZA()(),e.TgZ(97,"div",47)(98,"button",48),e.NdJ("click",function(){return i.reset()}),e._uU(99,"Cerrar"),e.qZA(),e.TgZ(100,"button",49),e.NdJ("click",function(){return i.addEstablishment(i.index)}),e._uU(101,"Agregar"),e.qZA()(),e.TgZ(102,"div",50),e._uU(103,"a"),e.qZA(),e.TgZ(104,"div",50),e._uU(105,"a"),e.qZA(),e.YNc(106,Lt,39,2,"div",51),e.qZA()()()()()()),2&t){const s=e.MAs(61);e.xp6(35),e.Q6J("ngForOf",i.db),e.xp6(9),e.Q6J("ngForOf",i.visiblePageNumbers()),e.xp6(16),e.Q6J("formGroup",i.userForm),e.xp6(8),e.Q6J("ngIf",i.userForm.controls.NAME.errors&&i.userForm.controls.NAME.touched),e.xp6(6),e.Q6J("ngIf",i.userForm.controls.ADDRESS.errors&&i.userForm.controls.ADDRESS.touched),e.xp6(7),e.Q6J("ngForOf",i.listRegiones),e.xp6(1),e.Q6J("ngIf",i.userForm.controls.ID_REGION.errors&&i.userForm.controls.ID_REGION.touched),e.xp6(7),e.Q6J("ngForOf",i.listComunas),e.xp6(1),e.Q6J("ngIf",i.userForm.controls.ID_COMUNA.errors&&i.userForm.controls.ID_COMUNA.touched),e.xp6(6),e.Q6J("ngIf",i.userForm.controls.V_UNIQUE.errors&&i.userForm.controls.V_UNIQUE.touched),e.xp6(4),e.Q6J("disabled",s.invalid),e.xp6(6),e.Q6J("ngIf",i.establishmentStatus&&i.establishmentStatus.length>0)}},dependencies:[p.mk,p.sg,p.O5,c._Y,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.JL,c.Q7,c.sg,c.u],styles:['[_nghost-%COMP%]{width:70%!important;padding:1%}th[_ngcontent-%COMP%]{cursor:pointer}.arrow-up[_ngcontent-%COMP%]:before{content:"\\25b2";display:inline-block;margin-right:5px}.arrow-down[_ngcontent-%COMP%]:before{content:"\\25bc";display:inline-block;margin-right:5px}']}),a})();var N=m(371),j=m(2506);function Yt(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"tr",57)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td")(16,"button",58),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.selectUser(o.ID))}),e._uU(17,"Modificar"),e.qZA(),e.TgZ(18,"button",59),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.deleteUser(o.ID))}),e._uU(19,"Eliminar"),e.qZA()()()}if(2&a){const t=n.$implicit,i=e.oxw();e.xp6(2),e.AsE("",t.FIRST_NAME," ",t.LAST_NAME,""),e.xp6(2),e.Oqu(i.showRoles(t)||"No Asignado"),e.xp6(2),e.Oqu(t.PHONE),e.xp6(2),e.Oqu(t.EMAIL),e.xp6(2),e.Oqu(t.PHONE_OFFICE),e.xp6(2),e.Oqu(t.POSITION||"No Asignado"),e.xp6(2),e.hij("",i.showBusiness(t)||"No Asignado"," ")}}const K=function(a,n){return{"btn-info":a,"btn-primary":n}};function kt(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"li")(1,"button",60),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.pagTo(o))}),e._uU(2),e.qZA()()}if(2&a){const t=n.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngClass",e.WLB(2,K,i.pos===t+1,i.pos!==t+1)),e.xp6(1),e.Oqu(t+1)}}function Jt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El nombre del usuario es requerido."),e.qZA())}function Qt(a,n){if(1&a&&(e.TgZ(0,"div",61),e.YNc(1,Jt,2,0,"p",62),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.FIRST_NAME.errors.required)}}function Vt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El apellido del usuario es requerido."),e.qZA())}function Gt(a,n){if(1&a&&(e.TgZ(0,"div",61),e.YNc(1,Vt,2,0,"p",62),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.LAST_NAME.errors.required)}}function Ht(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El tel\xe9fono del usuario es requerido."),e.qZA())}function zt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del tel\xe9fono es inv\xe1lido (entre 7 y 12 d\xedgitos)."),e.qZA())}function $t(a,n){if(1&a&&(e.TgZ(0,"div",61),e.YNc(1,Ht,2,0,"p",62),e.YNc(2,zt,2,0,"p",62),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.PHONE.errors.required),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.PHONE.errors.pattern)}}function jt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El email contacto es requerido (ejemplo@correo.com)."),e.qZA())}function Kt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del correo es inv\xe1lido (ejemplo@correo.com)."),e.qZA())}function Xt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del correo es inv\xe1lido (ejemplo@correo.com)."),e.qZA())}function Wt(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El correo ya se encuentra registrado."),e.qZA())}function ei(a,n){if(1&a&&(e.TgZ(0,"div",61),e.YNc(1,jt,2,0,"p",62),e.YNc(2,Kt,2,0,"p",62),e.YNc(3,Xt,2,0,"p",62),e.YNc(4,Wt,2,0,"p",62),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.EMAIL.errors.required),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.EMAIL.errors.email),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.EMAIL.errors.pattern),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.EMAIL.errors.used)}}function ti(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El tel\xe9fono de la oficina del usuario es requerido (entre 7 y 12 d\xedgitos)."),e.qZA())}function ii(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del tel\xe9fono es inv\xe1lido (entre 7 y 12 d\xedgitos)."),e.qZA())}function oi(a,n){if(1&a&&(e.TgZ(0,"div",61),e.YNc(1,ti,2,0,"p",62),e.YNc(2,ii,2,0,"p",62),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.PHONE_OFFICE.errors.required),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.PHONE_OFFICE.errors.pattern)}}function ai(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El cargo del usuario es requerido."),e.qZA())}function si(a,n){if(1&a&&(e.TgZ(0,"div",61),e.YNc(1,ai,2,0,"p",62),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.POSITION.errors.required)}}function ri(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"button",63),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.loadDJ())}),e._uU(1,"Ver Declaraciones Juradas"),e.qZA()}}function ni(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"Empresa(s) del usuario es requerido."),e.qZA())}function li(a,n){if(1&a&&(e.TgZ(0,"div",61),e.YNc(1,ni,2,0,"p",62),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.BUSINESS.errors.required)}}function ci(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"Rol(es) del usuario es requerido."),e.qZA())}function di(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"Rol(es) del usuario es requerido. "),e.qZA())}function ui(a,n){if(1&a&&(e.TgZ(0,"div",61),e.YNc(1,ci,2,0,"p",62),e.YNc(2,di,2,0,"p",62),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.ROL.errors.required),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.ROL.errors.min)}}function _i(a,n){if(1&a&&(e.TgZ(0,"span",64),e._uU(1),e.qZA()),2&a){const t=n.$implicit,i=e.oxw();e.xp6(1),e.Oqu(i.showName(t))}}function pi(a,n){if(1&a&&(e.TgZ(0,"span",64),e._uU(1),e.qZA()),2&a){const t=n.$implicit,i=e.oxw();e.xp6(1),e.Oqu(i.showRol(t))}}function mi(a,n){1&a&&e._UZ(0,"i",68)}function hi(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"button",69),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit,o=e.oxw();return e.KtG(o.downloadTerminos(s.ID_BUSINESS))}),e._uU(1," Descargar "),e.qZA()}}function gi(a,n){if(1&a&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",65),e.YNc(6,mi,1,0,"i",66),e.YNc(7,hi,2,0,"button",67),e.qZA()()),2&a){const t=n.$implicit;e.xp6(2),e.Oqu(t.CODE_BUSINESS),e.xp6(2),e.Oqu(t.NAME),e.xp6(2),e.Q6J("ngIf",null==t.DJ_FILE),e.xp6(1),e.Q6J("ngIf",null!==t.DJ_FILE)}}function fi(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"li")(1,"button",60),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.pagTo2(o))}),e._uU(2),e.qZA()()}if(2&a){const t=n.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngClass",e.WLB(2,K,i.posP===t+1,i.posP!==t+1)),e.xp6(1),e.Oqu(t+1)}}let bi=(()=>{class a{constructor(t,i,s,o){this.authService=t,this.businesService=i,this.productorService=s,this.fb=o,this.verifyEmailMW=r=>{const l=r.value.toLowerCase().trim();if(!l)return null;let u;return u=this.dbTmp.length>0?this.dbTmp.find(h=>h.EMAIL.toLowerCase().trim()==l):this.listUser.find(h=>h.EMAIL.toLowerCase().trim()===l),u&&u.ID!=this.userForm.value.ID?{used:!0}:null},this.allBusinessUser=[],this.posP=1,this.emailPattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$",this.showErrorEmail=!1,this.business=[],this.listUser=[],this.dbTmp=[],this.listRoles=[],this.isEdit=!1,this.saving=!1,this.userForm=this.fb.group({ID:[],FIRST_NAME:["",[c.kI.required]],LAST_NAME:["",[c.kI.required]],EMAIL:["",[c.kI.required,c.kI.email,this.verifyEmailMW]],ROL:[[],[c.kI.required,c.kI.min(1)]],PHONE:["",[c.kI.required,c.kI.pattern("^[0-9]{7,12}$")]],PHONE_OFFICE:["",[c.kI.required,c.kI.pattern("^[0-9]{7,12}$")]],POSITION:["",[c.kI.required,c.kI.min(1)]],BUSINESS:[[],[c.kI.required]]}),this.pos=1,this.db=[],this.cant=0,this.db2=[],this.cant2=0}ngOnInit(){this.loadUsers(),this.loadBusiness(),this.loadRoles()}loadBusiness(){this.businesService.getAllBusiness().subscribe(t=>{t.status&&(this.business=t.status,this.business.map(i=>{i.view_name=`${i.CODE_BUSINESS} | ${i.NAME}`}),this.business.sort((i,s)=>i.view_name.localeCompare(s.view_name)))})}filter(t){const i=t.value?.toLowerCase();this.pos=1;const s=[];return""!=t.value?(this.cant=1,this.dbTmp=this.listUser.filter(o=>{const r=o.FIRST_NAME?.toLowerCase().indexOf(i)>-1||o.LAST_NAME?.toLowerCase().indexOf(i)>-1||o.PHONE?.toLowerCase().indexOf(i)>-1||o.ROL_NAME?.toLowerCase().indexOf(i)>-1||o.EMAIL?.toLowerCase().indexOf(i)>-1||o.PHONE_OFFICE?.toLowerCase().indexOf(i)>-1||o.POSITION?.toLowerCase().indexOf(i)>-1,l=o.BUSINESS?.some(u=>u.NAME?.toLowerCase().indexOf(i)>-1);(r||l)&&s.push(o)}),this.dbTmp=s,this.db=s.slice(0,10),this.cant=Math.ceil(s.length/10),this.db):(this.dbTmp=this.listUser,this.db=this.listUser.slice(0,10),this.cant=Math.ceil(this.listUser.length/10),this.db)}loadRoles(){this.authService.getRoles.subscribe(t=>{t.status&&(this.listRoles=t.data,this.listRoles.map(i=>{i.view_name=`${i.NAME}`}),this.listRoles.sort((i,s)=>i.view_name.localeCompare(s.view_name)))})}loadUsers(){d().fire({title:"Cargando Datos",text:"Se est\xe1 recuperando datos",timerProgressBar:!0,showConfirmButton:!1,allowEscapeKey:!1,allowOutsideClick:!1}),d().showLoading(),document.getElementById("inp_filter").value="",this.authService.getUsers.subscribe(t=>{t.status&&(this.listUser=t.data,this.dbTmp=t.data,this.cant=Math.ceil(this.listUser.length/10),this.db=this.listUser.slice(0,10).sort((i,s)=>s.YEAR_STATEMENT-i.YEAR_STATEMENT),d().close())})}clearFrom(){this.userForm.reset({ROL:null,EMAIL:""})}showBusiness(t){let i=[];return t.BUSINESS.forEach(s=>{i.push(s.NAME.trim())}),i.join(", ")}showRoles(t){let i=[];return t.ROLES.forEach(s=>{i.push(s.ROL_NAME.trim())}),i.join(", ")}showName(t){const i=this.business.find(s=>s.ID==t);return`${i.CODE_BUSINESS} | ${i.NAME}`}showRol(t){return`${this.listRoles.find(s=>s.ID==t).NAME}`}selectUser(t){this.isEdit=!0;const i=this.db.find(r=>r.ID==t);this.userForm.controls.ID.setValue(i.ID),this.userForm.controls.FIRST_NAME.setValue(i.FIRST_NAME),this.userForm.controls.LAST_NAME.setValue(i.LAST_NAME),this.userForm.controls.EMAIL.setValue(i.EMAIL),this.userForm.controls.PHONE.setValue(i.PHONE),this.userForm.controls.PHONE_OFFICE.setValue(i.PHONE_OFFICE),this.userForm.controls.POSITION.setValue(i.POSITION);const s=i.ROLES?.map(r=>r.ID_ROL);this.userForm.controls.ROL.setValue(s);const o=i.BUSINESS?.map(r=>r.ID_BUSINESS);this.userForm.controls.BUSINESS.setValue(o)}deleteUser(t){const i=this.db.find(s=>s.ID==t);d().fire({icon:"question",text:`\xbfEst\xe1s seguro de eliminar al usuario ${i.FIRST_NAME} ${i.LAST_NAME}?`,showCancelButton:!0,showConfirmButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(s=>{s.isConfirmed&&this.authService.deleteUser(i.ID).subscribe(o=>{o.status&&(d().fire({icon:"success",text:o.msg}),this.loadUsers(),this.pos=1)})})}verifyEmail(){const t=this.userForm.value.EMAIL?.toLowerCase().trim(),i=this.listUser.find(s=>s.EMAIL.toLowerCase().trim()==t);return i&&i.ID!=this.userForm.value.ID?(this.showErrorEmail=!1,!1):(this.showErrorEmail=!0,this.userForm.controls.EMAIL.setErrors({used:!0}),!1)}verifyEmail2(t){return!!t?.notUnique}saveForm(){d().fire({icon:"info",text:"Guardando datos",allowEnterKey:!1,allowEscapeKey:!1,allowOutsideClick:!1}),d().showLoading(),this.saving=!0,!this.userForm.invalid&&(this.isEdit?this.authService.updateUser(this.userForm.value).subscribe({next:t=>{d().close(),t.status&&(this.clearFrom(),document.getElementById("btnCloseModal")?.click(),d().fire({icon:"success",text:t.msg}),this.loadUsers(),this.pos=1,this.saving=!1)},error:t=>{d().close(),d().fire({icon:"error",text:"Algo sali\xf3 mal"})}}):this.authService.registerUser(this.userForm.value).subscribe({next:t=>{d().close(),t.status?(this.clearFrom(),document.getElementById("btnCloseModal")?.click(),d().fire({icon:"success",text:t.msg}),this.loadUsers(),this.pos=1,this.saving=!1):(d().close(),d().fire({icon:"warning",text:t.msg}),this.saving=!1)},error:t=>{d().close(),d().fire({icon:"error",text:"Algo sali\xf3 mal"})}}))}setArrayFromNumber(){return new Array(this.cant)}pagTo(t){this.pos=t+1,this.db=this.dbTmp.slice(10*t,10*(t+1)).sort((i,s)=>s.YEAR_STATEMENT-i.YEAR_STATEMENT)}next(){this.pos>=this.cant||(this.pos++,this.db=this.dbTmp.slice(10*(this.pos-1),10*this.pos).sort((t,i)=>i.YEAR_STATEMENT-t.YEAR_STATEMENT))}previus(){this.pos-1<=0||this.pos>=this.cant+1||(this.pos=this.pos-1,this.db=this.dbTmp.slice(10*(this.pos-1),10*this.pos).sort((t,i)=>i.YEAR_STATEMENT-t.YEAR_STATEMENT))}visiblePageNumbers(){const t=this.setArrayFromNumber().length,i=[];if(t<=15)for(let s=0;s<t;s++)i.push(s);else{let s=Math.max(0,this.pos-Math.floor(7.5)),o=Math.min(t-1,s+14);o-s+1<15&&(o=t-1,s=Math.max(0,o-14));for(let r=s;r<=o;r++)i.push(r)}return i}hasProductorRole(){const t=this.userForm.value.ROL;return Array.isArray(t)&&t.includes(9)}downloadTerminos(t){this.productorService.downloadPdfFirma(t,this.userForm.value.ID).subscribe({next:s=>{if(s){const o=new Blob([s],{type:"application/pdf"});let r=document.createElement("a");r.href=window.URL.createObjectURL(o),r.download="Declaraci\xf3n Jurada Firmada",document.body.appendChild(r),r.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),r.remove(),window.URL.revokeObjectURL(r.href)}}})}loadDJ(){this.productorService.businessUserDJ(this.userForm.value.ID).subscribe(i=>{this.allBusinessUser=i.data.sort((s,o)=>s.CODE_BUSINESS.toString().localeCompare(o.CODE_BUSINESS.toString())),this.cant2=Math.ceil(this.allBusinessUser.length/10),this.db2=this.allBusinessUser.slice(10*(this.posP-1),10*this.posP).sort((s,o)=>s.CODE_BUSINESS.toString().localeCompare(o.CODE_BUSINESS.toString()))})}pagTo2(t){this.posP=t+1,this.db2=this.allBusinessUser.slice(10*t,10*(t+1)).sort((i,s)=>s.YEAR_STATEMENT-i.YEAR_STATEMENT)}next2(){this.posP>=this.cant2||(this.posP++,this.db2=this.allBusinessUser.slice(10*(this.posP-1),10*this.posP).sort((t,i)=>i.YEAR_STATEMENT-t.YEAR_STATEMENT))}previus2(){this.posP-1<=0||this.posP>=this.cant2+1||(this.posP=this.posP-1,this.db2=this.allBusinessUser.slice(10*(this.posP-1),10*this.posP).sort((t,i)=>i.YEAR_STATEMENT-t.YEAR_STATEMENT))}setArrayFromNumber2(){return new Array(this.cant2)}visiblePageNumbers2(){const t=this.setArrayFromNumber2().length,i=[];if(t<=10)for(let s=0;s<t;s++)i.push(s);else{let s=Math.max(0,this.posP-Math.floor(5)),o=Math.min(t-1,s+9);o-s+1<10&&(o=t-1,s=Math.max(0,o-9));for(let r=s;r<=o;r++)i.push(r)}return i}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(G.e),e.Y36(R.m),e.Y36(N.u),e.Y36(c.qu))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-mantainer-users"]],decls:172,vars:21,consts:[["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],[1,"buttonRight"],["data-bs-toggle","modal","data-bs-target","#exampleModal",1,"btn","btn-primary",3,"click"],[2,"height","50px"],[1,"row","mb-3"],[1,"col-md-12"],["id","inp_filter","type","text","placeholder","Filtro de b\xfasqueda",1,"form-control",3,"keyup"],[1,"table-responsive","mb-4"],[1,"row","w-100"],["id","table",1,"w-100"],["table1",""],[1,"w-100"],[1,"table-container","table","table-even","table-section","table-borderless","table-border","table-radius","d-lg-table"],[1,"text-center","w-100"],["class","text-end w-100",4,"ngFor","ngForOf"],["aria-label","Navegaci\xf3n resultados"],[1,"pagination"],[1,"btn","btn-primary",3,"click"],[4,"ngFor","ngForOf"],["id","exampleModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title","fs-5"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"container"],[3,"formGroup"],[1,"row"],[1,"col-md-6"],["for","inp_nom"],["type","text","formControlName","FIRST_NAME","id","inp_nom","placeholder","Nombre",1,"form-control"],["class","text-danger pl-0",4,"ngIf"],["for","inp_ap"],["type","text","formControlName","LAST_NAME","id","inp_ap","placeholder","Apellidos",1,"form-control"],[1,"row","mt-4"],["for","inp_tel"],["type","text","formControlName","PHONE","id","inp_tel","placeholder","912345678",1,"form-control"],["for","inp_email"],["type","text","formControlName","EMAIL","id","inp_email","placeholder","cto@correo.com",1,"form-control"],["type","text","formControlName","PHONE_OFFICE","required","","id","inp_tel","placeholder","912345678",1,"form-control"],["type","text","formControlName","POSITION","id","inp_email","placeholder","Gerente",1,"form-control"],["class","btn btn-primary","data-bs-toggle","modal","data-bs-target","#exampleModalDeclarationes",3,"click",4,"ngIf"],["for",""],["formControlName","BUSINESS","optionLabel","view_name","optionValue","ID","defaultLabel","Seleccione Empresas",3,"options","selectedItemsLabel"],["for","inp_rol"],["formControlName","ROL","optionLabel","view_name","optionValue","ID","defaultLabel","Seleccione Roles",3,"options","selectedItemsLabel"],["class","badge bg-primary m-1",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button","id","btnCloseModal","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["id","exampleModalDeclarationes","tabindex","-1","aria-labelledby","exampleModalDeclarationesLabel","aria-hidden","true",1,"modal","fade",3,"hidden.bs.modal"],["id","exampleModalDeclarationesLabel",1,"modal-title","fs-5"],[1,"text-end","w-100"],["data-bs-toggle","modal","data-bs-target","#exampleModal",1,"btn","btn-info",3,"click"],[1,"btn","btn-danger",3,"click"],[1,"border","btn","btn-sm",3,"ngClass","click"],[1,"text-danger","pl-0"],[4,"ngIf"],["data-bs-toggle","modal","data-bs-target","#exampleModalDeclarationes",1,"btn","btn-primary",3,"click"],[1,"badge","bg-primary","m-1"],[1,"centered-td"],["class","fas fa-times text-danger",4,"ngIf"],["type","button","class","btn btn-primary btn-fa w-100",3,"click",4,"ngIf"],[1,"fas","fa-times","text-danger"],["type","button",1,"btn","btn-primary","btn-fa","w-100",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"i",4),e._uU(5," Inicio"),e.qZA()(),e.TgZ(6,"li",2)(7,"a",3),e._uU(8,"Mantener Usuarios"),e.qZA()()()(),e.TgZ(9,"h1"),e._uU(10,"Usuarios"),e.qZA(),e.TgZ(11,"div",5)(12,"button",6),e.NdJ("click",function(){return i.isEdit=!1,i.clearFrom()}),e._uU(13,"Agregar Usuario"),e.qZA()(),e._UZ(14,"div",7),e.TgZ(15,"div",8)(16,"div",9)(17,"label"),e._uU(18,"Filtro:"),e.qZA(),e.TgZ(19,"input",10),e.NdJ("keyup",function(o){return i.filter(o.target)}),e.qZA()()(),e.TgZ(20,"div",11)(21,"section")(22,"div",12)(23,"div",13,14)(25,"div",15)(26,"table",16)(27,"thead")(28,"tr",17)(29,"th"),e._uU(30,"NOMBRE"),e.qZA(),e.TgZ(31,"th"),e._uU(32,"ROLES"),e.qZA(),e.TgZ(33,"th"),e._uU(34,"TEL\xc9FONO"),e.qZA(),e.TgZ(35,"th"),e._uU(36,"E-MAIL"),e.qZA(),e.TgZ(37,"th"),e._uU(38,"T\xc9LEFONO OFICINA"),e.qZA(),e.TgZ(39,"th"),e._uU(40,"CARGO"),e.qZA(),e.TgZ(41,"th"),e._uU(42,"EMPRESAS"),e.qZA(),e.TgZ(43,"th"),e._uU(44,"OPCIONES"),e.qZA()()(),e.TgZ(45,"tbody"),e.YNc(46,Yt,20,8,"tr",18),e.qZA()(),e.TgZ(47,"nav",19)(48,"ul",20)(49,"li")(50,"button",21),e.NdJ("click",function(){return i.pagTo(0)}),e._uU(51,"Primero"),e.qZA()(),e.TgZ(52,"li")(53,"button",21),e.NdJ("click",function(){return i.previus()}),e._uU(54,"Anterior"),e.qZA()(),e.YNc(55,kt,3,5,"li",22),e.TgZ(56,"li")(57,"button",21),e.NdJ("click",function(){return i.next()}),e._uU(58,"Siguiente"),e.qZA()(),e.TgZ(59,"li")(60,"button",21),e.NdJ("click",function(){return i.pagTo(i.cant-1)}),e._uU(61,"\xdaltimo"),e.qZA()()()()()()()()(),e.TgZ(62,"div",23)(63,"div",24)(64,"div",25)(65,"div",26)(66,"h1",27),e._uU(67,"Formulario Usuario"),e.qZA(),e._UZ(68,"button",28),e.qZA(),e.TgZ(69,"div",29)(70,"div",30)(71,"form",31)(72,"div",32)(73,"div",33)(74,"label",34),e._uU(75,"NOMBRE:"),e.qZA(),e._UZ(76,"input",35),e.YNc(77,Qt,2,1,"div",36),e.qZA(),e.TgZ(78,"div",33)(79,"label",37),e._uU(80,"APELLIDOS:"),e.qZA(),e._UZ(81,"input",38),e.YNc(82,Gt,2,1,"div",36),e.qZA()(),e.TgZ(83,"div",39)(84,"div",33)(85,"label",40),e._uU(86,"TEL\xc9FONO"),e.qZA(),e._UZ(87,"input",41),e.YNc(88,$t,3,2,"div",36),e.qZA(),e.TgZ(89,"div",33)(90,"label",42),e._uU(91,"E-MAIL"),e.qZA(),e._UZ(92,"input",43),e.YNc(93,ei,5,4,"div",36),e.qZA()(),e.TgZ(94,"div",39)(95,"div",33)(96,"label",40),e._uU(97,"TEL\xc9FONO OFICINA"),e.qZA(),e._UZ(98,"input",44),e.YNc(99,oi,3,2,"div",36),e.qZA(),e.TgZ(100,"div",33)(101,"label",42),e._uU(102,"CARGO"),e.qZA(),e._UZ(103,"input",45),e.YNc(104,si,2,1,"div",36),e.qZA(),e._UZ(105,"p"),e.TgZ(106,"div",33),e.YNc(107,ri,2,0,"button",46),e.qZA()(),e.TgZ(108,"div",39)(109,"div",33)(110,"label",47),e._uU(111,"EMPRESAS"),e.qZA(),e._UZ(112,"br")(113,"p-multiSelect",48),e.YNc(114,li,2,1,"div",36),e.qZA(),e.TgZ(115,"div",33)(116,"label",49),e._uU(117,"ROLES"),e.qZA(),e._UZ(118,"p-multiSelect",50),e.YNc(119,ui,3,2,"div",36),e.qZA(),e.TgZ(120,"div",33),e.YNc(121,_i,2,1,"span",51),e.qZA(),e.TgZ(122,"div",33),e.YNc(123,pi,2,1,"span",51),e.qZA()()()()(),e.TgZ(124,"div",52)(125,"button",53),e._uU(126,"Cerrar"),e.qZA(),e.TgZ(127,"button",54),e.NdJ("click",function(){return i.saveForm()}),e._uU(128,"Guardar"),e.qZA()()()()(),e.TgZ(129,"div",55),e.NdJ("hidden.bs.modal",function(){return i.pagTo2(0)}),e.TgZ(130,"div",24)(131,"div",25)(132,"div",26)(133,"h1",56),e._uU(134,"Declaraciones"),e.qZA(),e._UZ(135,"button",28),e.qZA(),e.TgZ(136,"div",29)(137,"div",30)(138,"form")(139,"div",32)(140,"div",33),e._UZ(141,"p"),e.qZA(),e.TgZ(142,"div")(143,"table",16)(144,"thead")(145,"tr",17)(146,"th"),e._uU(147,"C\xf3digo Empresa"),e.qZA(),e.TgZ(148,"th"),e._uU(149,"Nombre Empresa"),e.qZA(),e.TgZ(150,"th"),e._uU(151,"Descargar Declaraci\xf3n Jurada"),e.qZA()()(),e.TgZ(152,"tbody"),e.YNc(153,gi,8,4,"tr",22),e.qZA()(),e.TgZ(154,"nav",19)(155,"ul",20)(156,"li")(157,"button",21),e.NdJ("click",function(){return i.pagTo2(0)}),e._uU(158,"Primero"),e.qZA()(),e.TgZ(159,"li")(160,"button",21),e.NdJ("click",function(){return i.previus2()}),e._uU(161,"Anterior"),e.qZA()(),e.YNc(162,fi,3,5,"li",22),e.TgZ(163,"li")(164,"button",21),e.NdJ("click",function(){return i.next2()}),e._uU(165,"Siguiente"),e.qZA()(),e.TgZ(166,"li")(167,"button",21),e.NdJ("click",function(){return i.pagTo2(i.cant2-1)}),e._uU(168,"\xdaltimo"),e.qZA()()()()()()()()(),e.TgZ(169,"div",52)(170,"button",53),e._uU(171,"Cerrar"),e.qZA()()()()()),2&t&&(e.xp6(46),e.Q6J("ngForOf",i.db),e.xp6(9),e.Q6J("ngForOf",i.visiblePageNumbers()),e.xp6(16),e.Q6J("formGroup",i.userForm),e.xp6(6),e.Q6J("ngIf",i.userForm.controls.FIRST_NAME.errors&&i.userForm.controls.FIRST_NAME.touched),e.xp6(5),e.Q6J("ngIf",i.userForm.controls.LAST_NAME.errors&&i.userForm.controls.LAST_NAME.touched),e.xp6(6),e.Q6J("ngIf",i.userForm.controls.PHONE.errors&&i.userForm.controls.PHONE.touched),e.xp6(5),e.Q6J("ngIf",i.userForm.controls.EMAIL.errors&&i.userForm.controls.EMAIL.touched),e.xp6(6),e.Q6J("ngIf",i.userForm.controls.PHONE_OFFICE.errors&&i.userForm.controls.PHONE_OFFICE.touched),e.xp6(5),e.Q6J("ngIf",i.userForm.controls.POSITION.errors&&i.userForm.controls.POSITION.touched),e.xp6(3),e.Q6J("ngIf",i.isEdit&&i.hasProductorRole()),e.xp6(6),e.Q6J("options",i.business)("selectedItemsLabel","{0} Empresas seleccionadas"),e.xp6(1),e.Q6J("ngIf",i.userForm.controls.BUSINESS.errors&&i.userForm.controls.BUSINESS.touched),e.xp6(4),e.Q6J("options",i.listRoles)("selectedItemsLabel","{0} Roles seleccionados"),e.xp6(1),e.Q6J("ngIf",i.userForm.controls.ROL.errors&&i.userForm.controls.ROL.touched),e.xp6(2),e.Q6J("ngForOf",i.userForm.value.BUSINESS),e.xp6(2),e.Q6J("ngForOf",i.userForm.value.ROL),e.xp6(4),e.Q6J("disabled",i.userForm.invalid||i.saving),e.xp6(26),e.Q6J("ngForOf",i.db2),e.xp6(9),e.Q6J("ngForOf",i.visiblePageNumbers2()))},dependencies:[p.mk,p.sg,p.O5,c._Y,c.Fj,c.JJ,c.JL,c.Q7,c.F,c.sg,c.u,j.NU],styles:["[_nghost-%COMP%]{width:100%!important;padding:1%}.buttonRight[_ngcontent-%COMP%]{position:absolute;right:40px}[_nghost-%COMP%]     .p-multiselect{min-width:15rem;width:100%;border-radius:100px!important}[_nghost-%COMP%]     .p-multiselect .p-multiselect-label{padding:8px!important;border-radius:100px!important;border-color:red!important}.accordion[_ngcontent-%COMP%]{border:none!important}.accordion-item[_ngcontent-%COMP%]{border:none}.accordion[_ngcontent-%COMP%]   .accordion-item[_ngcontent-%COMP%]:last-child{border:none}.accordion[_ngcontent-%COMP%]   .accordion-body[_ngcontent-%COMP%]{border:none}a[_ngcontent-%COMP%]{cursor:pointer}a[_ngcontent-%COMP%]:hover{color:#09a57b}.swal-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px}.centered-td[_ngcontent-%COMP%]{text-align:center}"]}),a})();var Ti=m(9314),P=m(5861),U=m(574),I=m(529),X=m(2340);let D=(()=>{class a{constructor(t){this.http=t,this.url=`${X.N.API_V1_URL}/logs`}get createLog(){return this.http.get(`${this.url}/`)}errorLog(t){return this.http.post(`${this.url}/error`,{error:t})}downloadExcel(t,i){let s=new I.WM;return s=s.set("Accept","application/vnd.ms-excel"),this.http.post(`${this.url}/`,{start:t,end:i},{headers:s,responseType:"blob"})}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(I.eN))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();function Ai(a,n){if(1&a&&(e.TgZ(0,"option",21),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}let Ei=(()=>{class a{constructor(t,i,s){var o=this;this.productorService=t,this.ls=i,this.ratesService=s,this.datos=[],this.resumen=[],this.R_PapelCarton_NP=0,this.R_PapelCarton_P=0,this.R_PapelCarton_Sec=0,this.R_PapelCarton_Ter=0,this.R_PapelCarton_Total=0,this.R_Metal_NP=0,this.R_Metal_P=0,this.R_Metal_Sec=0,this.R_Metal_Ter=0,this.R_Metal_Total=0,this.R_Plastico_NP=0,this.R_Plastico_P=0,this.R_Plastico_Sec=0,this.R_Plastico_Ter=0,this.R_Plastico_Total=0,this.R_Madera_NP=0,this.R_Madera_P=0,this.R_Madera_Sec=0,this.R_Madera_Ter=0,this.R_Madera_Total=0,this.R_Total_Ton=0,this.R_Total_UF=0,this.NR_PapelCarton_NP=0,this.NR_PapelCarton_P=0,this.NR_PapelCarton_Sec=0,this.NR_PapelCarton_Ter=0,this.NR_PapelCarton_Total=0,this.NR_Metal_P=0,this.NR_Metal_NP=0,this.NR_Metal_Sec=0,this.NR_Metal_Ter=0,this.NR_Metal_Total=0,this.NR_Plastico_NP=0,this.NR_Plastico_P=0,this.NR_Plastico_Sec=0,this.NR_Plastico_Ter=0,this.NR_Plastico_Total=0,this.NR_Madera_NP=0,this.NR_Madera_P=0,this.NR_Madera_Sec=0,this.NR_Madera_Ter=0,this.NR_Madera_Total=0,this.NR_Compuestos_NP=0,this.NR_Compuestos_P=0,this.NR_Compuestos_Sec=0,this.NR_Compuestos_Ter=0,this.NR_Compuestos_Total=0,this.NR_Total_Ton=0,this.NR_Total_UF=0,this.RET_PapelCarton_NP=0,this.RET_PapelCarton_P=0,this.RET_PapelCarton_Sec=0,this.RET_PapelCarton_Ter=0,this.RET_PapelCarton_Total=0,this.RET_Metal_NP=0,this.RET_Metal_P=0,this.RET_Metal_Sec=0,this.RET_Metal_Ter=0,this.RET_Metal_Total=0,this.RET_Plastico_NP=0,this.RET_Plastico_P=0,this.RET_Plastico_Sec=0,this.RET_Plastico_Ter=0,this.RET_Plastico_Total=0,this.RET_Madera_NP=0,this.RET_Madera_P=0,this.RET_Madera_Sec=0,this.RET_Madera_Ter=0,this.RET_Madera_Total=0,this.RET_Total_Ton=0,this.RET_Total_UF=0,this.EyE_PapelCarton_Rec=0,this.EyE_Metal_Rec=0,this.EyE_Plastico_Rec=0,this.EyE_NR=0,this.EyE_Ret=0,this.Total_EyE=0,this.EyE_UF_Papel=0,this.EyE_UF_Metal=0,this.EyE_UF_Plastico=0,this.PapelCarton_Rec_Uf=0,this.Metal_Rec_Uf=0,this.Plastico_Rec_Uf=0,this.NR_Uf=0,this.PapelCarton_Neto=0,this.Metal_Neto=0,this.Plastico_Neto=0,this.NR_Neto=0,this.PapelCarton_IVA=0,this.Metal_IVA=0,this.Plastico_IVA=0,this.NR_IVA=0,this.totalIVA=0,this.PapelCarton_Bruto=0,this.Metal_Bruto=0,this.Plastico_Bruto=0,this.NR_Bruto=0,this.TotalBruto=0,this.TotalBruto_IVA=0,this.Total_Uf=0,this.valores=new Array(30).fill(0),this.years=[],this.selectedYear=-1,this.listBusiness=[],this.listStatements=[],this.filteredListBusiness=[],this.allUF=[],this.generarExcel=function(){var l=(0,P.Z)(function*(u){try{const f=parseInt(document.getElementById("f_year").value),A=yield o.productorService.getAllStatementByYear(f).toPromise(),E=(yield o.productorService.getTMP(f).toPromise()).data.res_business;if(A.status){d().fire({title:"Cargando Datos",text:"Se est\xe1 recuperando datos",timerProgressBar:!0,showConfirmButton:!1,allowEscapeKey:!1,allowOutsideClick:!1}),d().showLoading(),o.listStatements=A.data.res_business.sort((_,T)=>_.STATE===T.STATE?_.ID_BUSINESS-T.ID_BUSINESS:T.STATE-_.STATE),o.filteredListBusiness=o.listBusiness.filter(_=>!o.listStatements.some(T=>T.ID_BUSINESS===_.ID));const b=function(){var _=(0,P.Z)(function*(T){const v=E.filter(M=>M.ID_HEADER==T.ID_HEADER),S=E.filter(M=>M.ID_BUSINESS==T.ID_BUSINESS&&M.YEAR_STATEMENT==f-1&&1==M.STATE),x=E.find(M=>M.HEADER_ID==T.ID_HEADER);return{f:v,lt:S,user:{FIRST_NAME:x.FIRST_NAME,LAST_NAME:x.LAST_NAME}}});return function(v){return _.apply(this,arguments)}}();for(const _ of o.listStatements){const{f:T,user:S}=yield b(_);T.forEach(J=>{o.setDeclaration(J)});const x=new Date(_.UPDATED_AT).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"}).split("/").reverse().join("-");-1==o.allUF.findIndex(J=>J.date==x)&&(o.ratesUF=yield o.ratesService.getUfDate(x).toPromise(),o.allUF.push({date:x,data:o.ratesUF.data})),o.calculoAjustes(x,_.STATE,_.HAS_PAPEL,_.HAS_METAL,_.HAS_PLASTICO);const M=new Date(_.UPDATED_AT).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"});o.datos.push({"ID empresa":_.CODE_BUSINESS,"Rut Empresa":_.VAT,"Nombre empresa":_.NAME,"A\xf1o declaraci\xf3n":f.toString(),"Estado declaraci\xf3n":1==_.STATE?"Enviada":2==_.STATE?"Pendiente":"Borrador","Fecha de env\xedo":M,Usuario:S.FIRST_NAME+" "+S.LAST_NAME,"R. Papel/cart\xf3n NP":o.setFormato(o.R_PapelCarton_NP),"R. Papel/cart\xf3n P":o.setFormato(o.R_PapelCarton_P),"R. Papel/cart\xf3n Sec":o.setFormato(o.R_PapelCarton_Sec),"R. Papel/cart\xf3n Ter":o.setFormato(o.R_PapelCarton_Ter),"R. Papel/cart\xf3n TOTAL":o.setFormato(o.R_PapelCarton_Total),"R. Metal NP":o.setFormato(o.R_Metal_NP),"R. Metal P":o.setFormato(o.R_Metal_P),"R. Metal Sec":o.setFormato(o.R_Metal_Sec),"R. Metal Ter":o.setFormato(o.R_Metal_Ter),"R. Metal TOTAL":o.setFormato(o.R_Metal_Total),"R. Pl\xe1stico NP":o.setFormato(o.R_Plastico_NP),"R. Pl\xe1stico P":o.setFormato(o.R_Plastico_P),"R. Pl\xe1stico Sec":o.setFormato(o.R_Plastico_Sec),"R. Pl\xe1stico Ter":o.setFormato(o.R_Plastico_Ter),"R. Pl\xe1stico TOTAL":o.setFormato(o.R_Plastico_Total),"R. Madera NP":o.setFormato(o.R_Madera_NP),"R. Madera P":o.setFormato(o.R_Madera_P),"R. Madera Sec":o.setFormato(o.R_Madera_Sec),"R. Madera Ter":o.setFormato(o.R_Madera_Ter),"R. Madera TOTAL":o.setFormato(o.R_Madera_Total),"R. Total Ton":o.setFormato(o.R_Total_Ton),"NR. Papel/cart\xf3n NP":o.setFormato(o.NR_PapelCarton_NP),"NR. Papel/cart\xf3n P":o.setFormato(o.NR_PapelCarton_P),"NR. Papel/cart\xf3n Sec":o.setFormato(o.NR_PapelCarton_Sec),"NR. Papel/cart\xf3n Ter":o.setFormato(o.NR_PapelCarton_Ter),"NR. Papel/cart\xf3n TOTAL":o.setFormato(o.NR_PapelCarton_Total),"NR. Metal NP":o.setFormato(o.NR_Metal_NP),"NR. Metal P":o.setFormato(o.NR_Metal_P),"NR. Metal Sec":o.setFormato(o.NR_Metal_Sec),"NR. Metal Ter":o.setFormato(o.NR_Metal_Ter),"NR. Metal TOTAL":o.setFormato(o.NR_Metal_Total),"NR. Pl\xe1stico NP":o.setFormato(o.NR_Plastico_NP),"NR. Pl\xe1stico P":o.setFormato(o.NR_Plastico_P),"NR. Pl\xe1stico Sec":o.setFormato(o.NR_Plastico_Sec),"NR. Pl\xe1stico Ter":o.setFormato(o.NR_Plastico_Ter),"NR. Pl\xe1stico TOTAL":o.setFormato(o.NR_Plastico_Total),"NR. Madera NP":o.setFormato(o.NR_Madera_NP),"NR. Madera P":o.setFormato(o.NR_Madera_P),"NR. Madera Sec":o.setFormato(o.NR_Madera_Sec),"NR. Madera Ter":o.setFormato(o.NR_Madera_Ter),"NR. Madera TOTAL":o.setFormato(o.NR_Madera_Total),"NR. Compuestos NP":o.setFormato(o.NR_Compuestos_NP),"NR. Compuestos P":o.setFormato(o.NR_Compuestos_P),"NR. Compuestos Sec":o.setFormato(o.NR_Compuestos_Sec),"NR. Compuestos Ter":o.setFormato(o.NR_Compuestos_Ter),"NR. Compuestos TOTAL":o.setFormato(o.NR_Compuestos_Total),"NR. Total Ton":o.setFormato(o.NR_Total_Ton),"RET. Papel/cart\xf3n NP":o.setFormato(o.RET_PapelCarton_NP),"RET. Papel/cart\xf3n P":o.setFormato(o.RET_PapelCarton_P),"RET. Papel/cart\xf3n Sec":o.setFormato(o.RET_PapelCarton_Sec),"RET. Papel/cart\xf3n Ter":o.setFormato(o.RET_PapelCarton_Ter),"RET. Papel/cart\xf3n TOTAL":o.setFormato(o.RET_PapelCarton_Total),"RET. Metal NP":o.setFormato(o.RET_Metal_NP),"RET. Metal P":o.setFormato(o.RET_Metal_P),"RET. Metal Sec":o.setFormato(o.RET_Metal_Sec),"RET. Metal Ter":o.setFormato(o.RET_Metal_Ter),"RET. Metal TOTAL":o.setFormato(o.RET_Metal_Total),"RET. Pl\xe1stico NP":o.setFormato(o.RET_Plastico_NP),"RET. Pl\xe1stico P":o.setFormato(o.RET_Plastico_P),"RET. Pl\xe1stico Sec":o.setFormato(o.RET_Plastico_Sec),"RET. Pl\xe1stico Ter":o.setFormato(o.RET_Plastico_Ter),"RET. Pl\xe1stico TOTAL":o.setFormato(o.RET_Plastico_Total),"RET. Madera NP":o.setFormato(o.RET_Madera_NP),"RET. Madera P":o.setFormato(o.RET_Madera_P),"RET. Madera Sec":o.setFormato(o.RET_Madera_Sec),"RET. Madera Ter":o.setFormato(o.RET_Madera_Ter),"RET. Madera TOTAL":o.setFormato(o.RET_Madera_Total),"RET. Total Ton":o.setFormato(o.RET_Total_Ton),"EyE Papel/cart\xf3n Rec TOTAL":o.setFormato(o.EyE_PapelCarton_Rec),"EyE Metal Rec TOTAL":o.setFormato(o.EyE_Metal_Rec),"EyE Plastico Rec TOTAL":o.setFormato(o.EyE_Plastico_Rec),"EyE NR TOTAL":o.setFormato(o.EyE_NR),"EyE Ret TOTAL":o.setFormato(o.EyE_Ret),"TOTAL PESO":o.setFormato(o.Total_EyE),"Papel/cart\xf3n Rec Tarifa":o.setFormato(o.rates[0].price),"Metal Rec Tarifa":o.setFormato(o.rates[1].price),"Plastico Rec Tarifa":o.setFormato(o.rates[2].price),"NR Tarifa":o.setFormato(o.rates[3].price),"Papel/cart\xf3n Rec Costo Anual UF":o.setFormato(o.PapelCarton_Rec_Uf),"Metal Rec Costo Anual UF":o.setFormato(o.Metal_Rec_Uf),"Plastico Rec Costo Anual UF":o.setFormato(o.Plastico_Rec_Uf),"NR Costo Anual UF":o.setFormato(o.NR_Uf),"Total Costo Anual (UF)":o.setFormato(o.Total_Uf),"Papel/cart\xf3n Neto CLP":o.setFormato(o.PapelCarton_Neto),"Metal Rec UF Neto CLP":o.setFormato(o.Metal_Neto),"Plastico Rec UF Neto CLP":o.setFormato(o.Plastico_Neto),"NR UF Neto CLP":o.setFormato(o.NR_Neto),"Total Neto (CLP)":o.setFormato(o.TotalBruto),"Papel/cart\xf3n Rec IVA":o.setFormato(o.PapelCarton_IVA),"Metal Rec IVA":o.setFormato(o.Metal_IVA),"Plastico Rec IVA":o.setFormato(o.Plastico_IVA),"NR IVA":o.setFormato(o.NR_IVA),"Total IVA":o.setFormato(o.totalIVA),"Papel/cart\xf3n Bruto CLP":o.setFormato(o.PapelCarton_Bruto),"Metal Rec UF Bruto CLP":o.setFormato(o.Metal_Bruto),"Plastico Rec UF Bruto CLP":o.setFormato(o.Plastico_Bruto),"NR UF Bruto CLP":o.setFormato(o.NR_Bruto),"Total Neto (CLP) + IVA":o.setFormato(o.TotalBruto_IVA)}),o.resetDatos()}for(let _=0;_<o.filteredListBusiness.length;_++)o.datos.push({"ID empresa":o.filteredListBusiness[_].CODE_BUSINESS,"Rut Empresa":o.filteredListBusiness[_].VAT,"Nombre empresa":o.filteredListBusiness[_].NAME,"A\xf1o declaraci\xf3n":"","Estado declaraci\xf3n":"NA","Fecha de env\xedo":"NA",Usuario:"NA"});let w=["Total EyE Productores (Reciclables, No Reciclables, Retornables / Reutilizables)","Total EyE Puestos en el mercado (Reciclables, No Reciclables)","Papel / cart\xf3n TOTAL  (Reciclables, No Reciclables, Retornables / Reutilizables)","Metal TOTAL  (Reciclables, No Reciclables, Retornables / Reutilizables)","Pl\xe1stico TOTAL  (Reciclables, No Reciclables, Retornables / Reutilizables)","Madera TOTAL  (Reciclables, No Reciclables, Retornables / Reutilizables)","Papel /  cart\xf3n TOTAL  (Reciclables, No Reciclables)","Metal  TOTAL (Reciclables, No Reciclables)","Pl\xe1stico  TOTAL (Reciclables, No Reciclables)","Madera  TOTAL (Reciclables, No Reciclables)","Compuestos TOTAL (No Reciclables)","Papel /   cart\xf3n TOTAL (Reciclables)","Metal   TOTAL (Reciclables)","Pl\xe1stico   TOTAL (Reciclables)","Total No Reciclable (No Reciclables)","Total Primarios No Peligrosos (Reciclables, No Reciclables)","Total Primarios Peligrosos (Reciclables, No Reciclables)","Total Secundarios (Reciclables, No Reciclables)","Total Terciarios (Reciclables, No Reciclables)","Papel / cart\xf3n UF TOTAL (Reciclables)","Metal UF TOTAL (Reciclables)","Plastico UF TOTAL (Reciclables)","NR.Total UF (No Reciclables)","Total UF (Reciclables, No Reciclables)","Papel / cart\xf3n Neto CLP (Reciclables)","Metal  Neto CLP (Reciclables)","Plastico Neto CLP (Reciclables)","NR Neto CLP (No Reciclables)","Total Neto(CLP) (Reciclables, No Reciclables)","TOTAL NETO + IVA (Reciclables, No Reciclables)"];for(let _=0;_<w.length;_++)o.resumen.push(_<24?{Items:w[_],Valor:o.setFormato(o.valores[_])}:{Items:w[_],Valor:"$"+o.setFormato(o.valores[_])});const L=U.P6.book_new(),oe=U.P6.json_to_sheet(o.datos),ae=U.P6.json_to_sheet(o.resumen);let B=[];for(let _=0;_<o.datos.length;_++){let T=Object.values(o.datos[_]);for(let v=0;v<T.length;v++)B[v]=30}var h=[];for(let _=0;_<B.length;_++)h.push({width:B[_]});oe["!cols"]=h;let Y=[];for(let _=0;_<o.resumen.length;_++){let T=Object.values(o.resumen[_]);for(let v=0;v<T.length;v++)Y[v]=70}var g=[];for(let _=0;_<Y.length;_++)g.push({width:Y[_]});ae["!cols"]=g,U.P6.book_append_sheet(L,oe,"Datos"),U.P6.book_append_sheet(L,ae,"Resumen totalizadores"),U.NC(L,`${u}_${f}.xlsx`),o.ls.createLog.subscribe(_=>{}),d().close(),o.datos=[],o.resumen=[],o.valores=new Array(30).fill(0)}else o.ls.errorLog("No se encuentran declaraciones asociadas al a\xf1o seleccionado").subscribe(b=>{}),d().fire({title:"\xa1Ups!",icon:"warning",text:"No se encuentran declaraciones asociadas al a\xf1o seleccionado.",showConfirmButton:!0})}catch(f){o.ls.errorLog("Ha sucedido un error al generar el archivo Excel, por favor pruebe de nuevo en unos minutos. Si el problema persiste p\xf3ngase en contacto con administraci\xf3n").subscribe(A=>{}),d().fire({title:"\xa1Ups!",icon:"error",text:"Ha sucedido un error al generar el archivo Excel, por favor pruebe de nuevo en unos minutos. Si el problema persiste p\xf3ngase en contacto con administraci\xf3n.",showConfirmButton:!0}),console.log(f)}});return function(u){return l.apply(this,arguments)}}();const r=(new Date).getFullYear();for(let l=2022;l<=r;l++)this.years.push(l);this.years.sort((l,u)=>u-l)}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.getBusinessByRolProductor(),this.ratesService.getCLP.subscribe({next:t=>{this.rates=t.data},error:t=>{d().close(),d().fire({title:"\xa1Ups!",icon:"error",text:"No se logr\xf3 obtener el valor de la UF",showConfirmButton:!0}),console.log(t)}}),this.ratesService.getUF.subscribe({next:t=>{this.ratesUF=t.data},error:t=>{d().close(),d().fire({title:"\xa1Ups!",icon:"error",text:"No se logr\xf3 obtener el valor de la UF",showConfirmButton:!0}),console.log(t)}})}getBusinessByRolProductor(){this.productorService.getBusinessByRolProductor().subscribe({next:t=>{this.listBusiness=t.data.res_business},error:t=>{d().close(),d().fire({icon:"error",text:t.msg,title:"\xa1Ups!"})}})}setFormato(t){const i="string"==typeof t?parseFloat(t.replace(/,/g,"")):t,s=Math.round(100*i)/100,[o,r]=s.toString().split("."),l=o.replace(/\B(?=(\d{3})+(?!\d))/g,".");return r&&"0"!==r?`${l},${r.padEnd(2,"0")}`:l}setDeclaration(t){const{RECYCLABILITY:i,TYPE_RESIDUE:s,HAZARD:o,PRECEDENCE:r,VALUE:l,AMOUNT:u}=t;1==i?(1==s?1==o?1==r?this.R_PapelCarton_P+=l:2==r?this.R_PapelCarton_Sec+=l:this.R_PapelCarton_Ter+=l:this.R_PapelCarton_NP+=l:2==s?1==o?1==r?this.R_Metal_P+=l:2==r?this.R_Metal_Sec+=l:this.R_Metal_Ter+=l:this.R_Metal_NP+=l:3==s?1==o?1==r?this.R_Plastico_P+=l:2==r?this.R_Plastico_Sec+=l:this.R_Plastico_Ter+=l:this.R_Plastico_NP+=l:4==s&&(1==o?1==r?this.R_Madera_P+=l:2==r?this.R_Madera_Sec+=l:this.R_Madera_Ter+=l:this.R_Madera_NP+=l),this.R_Total_Ton+=l,4!=s&&(this.R_Total_UF+=u)):2==i?(1==s?1==o?1==r?this.NR_PapelCarton_P+=l:2==r?this.NR_PapelCarton_Sec+=l:this.NR_PapelCarton_Ter+=l:this.NR_PapelCarton_NP+=l:2==s?1==o?1==r?this.NR_Metal_P+=l:2==r?this.NR_Metal_Sec+=l:this.NR_Metal_Ter+=l:this.NR_Metal_NP+=l:3==s?1==o?1==r?this.NR_Plastico_P+=l:2==r?this.NR_Plastico_Sec+=l:this.NR_Plastico_Ter+=l:this.NR_Plastico_NP+=l:4==s?1==o?1==r?this.NR_Madera_P+=l:2==r?this.NR_Madera_Sec+=l:this.NR_Madera_Ter+=l:this.NR_Madera_NP+=l:5==s&&(1==o?1==r?this.NR_Compuestos_P+=l:2==r?this.NR_Compuestos_Sec+=l:this.NR_Compuestos_Ter+=l:this.NR_Compuestos_NP+=l),this.NR_Total_Ton+=l,4!=s&&(this.NR_Total_UF+=u)):(1==s?1==o?1==r?this.RET_PapelCarton_P+=l:2==r?this.RET_PapelCarton_Sec+=l:this.RET_PapelCarton_Ter+=l:this.RET_PapelCarton_NP+=l:2==s?1==o?1==r?this.RET_Metal_P+=l:2==r?this.RET_Metal_Sec+=l:this.RET_Metal_Ter+=l:this.RET_Metal_NP+=l:3==s?1==o?1==r?this.RET_Plastico_P+=l:2==r?this.RET_Plastico_Sec+=l:this.RET_Plastico_Ter+=l:this.RET_Plastico_NP+=l:4==s&&(1==o?1==r?this.RET_Madera_P+=l:2==r?this.RET_Madera_Sec+=l:this.RET_Madera_Ter+=l:this.RET_Madera_NP+=l),this.RET_Total_Ton+=l,this.RET_Total_UF+=u)}resetDatos(){this.R_PapelCarton_NP=0,this.R_PapelCarton_P=0,this.R_PapelCarton_Sec=0,this.R_PapelCarton_Ter=0,this.R_Metal_NP=0,this.R_Metal_P=0,this.R_Metal_Sec=0,this.R_Metal_Ter=0,this.R_Plastico_NP=0,this.R_Plastico_P=0,this.R_Plastico_Sec=0,this.R_Plastico_Ter=0,this.R_Madera_NP=0,this.R_Madera_P=0,this.R_Madera_Sec=0,this.R_Madera_Ter=0,this.R_Total_Ton=0,this.R_Total_UF=0,this.NR_PapelCarton_NP=0,this.NR_PapelCarton_P=0,this.NR_PapelCarton_Sec=0,this.NR_PapelCarton_Ter=0,this.NR_Metal_P=0,this.NR_Metal_NP=0,this.NR_Metal_Sec=0,this.NR_Metal_Ter=0,this.NR_Plastico_NP=0,this.NR_Plastico_P=0,this.NR_Plastico_Sec=0,this.NR_Plastico_Ter=0,this.NR_Madera_NP=0,this.NR_Madera_P=0,this.NR_Madera_Sec=0,this.NR_Madera_Ter=0,this.NR_Compuestos_NP=0,this.NR_Compuestos_P=0,this.NR_Compuestos_Sec=0,this.NR_Compuestos_Ter=0,this.NR_Total_Ton=0,this.NR_Total_UF=0,this.RET_PapelCarton_NP=0,this.RET_PapelCarton_P=0,this.RET_PapelCarton_Sec=0,this.RET_PapelCarton_Ter=0,this.RET_Metal_NP=0,this.RET_Metal_P=0,this.RET_Metal_Sec=0,this.RET_Metal_Ter=0,this.RET_Plastico_NP=0,this.RET_Plastico_P=0,this.RET_Plastico_Sec=0,this.RET_Plastico_Ter=0,this.RET_Madera_NP=0,this.RET_Madera_P=0,this.RET_Madera_Sec=0,this.RET_Madera_Ter=0,this.RET_Total_Ton=0,this.RET_Total_UF=0,this.Total_EyE=0,this.TotalBruto=0,this.TotalBruto_IVA=0,this.R_PapelCarton_Total=0,this.R_Metal_Total=0,this.R_Plastico_Total=0,this.R_Madera_Total=0,this.NR_PapelCarton_Total=0,this.NR_Metal_Total=0,this.NR_Plastico_Total=0,this.NR_Madera_Total=0,this.NR_Compuestos_Total=0,this.RET_PapelCarton_Total=0,this.RET_Metal_Total=0,this.RET_Plastico_Total=0,this.RET_Madera_Total=0,this.EyE_PapelCarton_Rec=0,this.EyE_Metal_Rec=0,this.EyE_Plastico_Rec=0,this.EyE_NR=0,this.EyE_Ret=0,this.PapelCarton_Rec_Uf=0,this.Metal_Rec_Uf=0,this.Plastico_Rec_Uf=0,this.NR_Uf=0,this.Total_Uf=0,this.EyE_UF_Papel=0,this.EyE_UF_Metal=0,this.EyE_UF_Plastico=0,this.PapelCarton_Neto=0,this.Metal_Neto=0,this.Plastico_Neto=0,this.NR_Neto=0,this.PapelCarton_Bruto=0,this.Metal_Bruto=0,this.Plastico_Bruto=0,this.NR_Bruto=0,this.PapelCarton_IVA=0,this.Metal_IVA=0,this.Plastico_IVA=0,this.NR_IVA=0,this.totalIVA=0}calculoAjustes(t="",i,s,o,r){""!=t&&(this.ratesUF=this.allUF.find(l=>l.date==t)),this.R_PapelCarton_Total=this.R_PapelCarton_P+this.R_PapelCarton_Sec+this.R_PapelCarton_Ter+this.R_PapelCarton_NP,this.R_Metal_Total=this.R_Metal_P+this.R_Metal_Sec+this.R_Metal_Ter+this.R_Metal_NP,this.R_Plastico_Total=this.R_Plastico_P+this.R_Plastico_Sec+this.R_Plastico_Ter+this.R_Plastico_NP,this.R_Madera_Total=this.R_Madera_P+this.R_Madera_Sec+this.R_Madera_Ter+this.R_Madera_NP,this.NR_PapelCarton_Total=this.NR_PapelCarton_P+this.NR_PapelCarton_Sec+this.NR_PapelCarton_Ter+this.NR_PapelCarton_NP,this.NR_Metal_Total=this.NR_Metal_P+this.NR_Metal_Sec+this.NR_Metal_Ter+this.NR_Metal_NP,this.NR_Plastico_Total=this.NR_Plastico_P+this.NR_Plastico_Sec+this.NR_Plastico_Ter+this.NR_Plastico_NP,this.NR_Madera_Total=this.NR_Madera_P+this.NR_Madera_Sec+this.NR_Madera_Ter+this.NR_Madera_NP,this.NR_Compuestos_Total=this.NR_Compuestos_P+this.NR_Compuestos_Sec+this.NR_Compuestos_Ter+this.NR_Compuestos_NP,this.RET_PapelCarton_Total=this.RET_PapelCarton_P+this.RET_PapelCarton_Sec+this.RET_PapelCarton_Ter+this.RET_PapelCarton_NP,this.RET_Metal_Total=this.RET_Metal_P+this.RET_Metal_Sec+this.RET_Metal_Ter+this.RET_Metal_NP,this.RET_Plastico_Total=this.RET_Plastico_P+this.RET_Plastico_Sec+this.RET_Plastico_Ter+this.RET_Plastico_NP,this.RET_Madera_Total=this.RET_Madera_P+this.RET_Madera_Sec+this.RET_Madera_Ter+this.RET_Madera_NP,this.EyE_PapelCarton_Rec=this.R_PapelCarton_Total,this.EyE_Metal_Rec=this.R_Metal_Total,this.EyE_Plastico_Rec=this.R_Plastico_Total,this.EyE_NR=this.NR_PapelCarton_Total+this.NR_Metal_Total+this.NR_Plastico_Total+this.NR_Compuestos_Total,this.EyE_Ret=this.RET_Total_Ton,s?this.EyE_UF_Papel=this.EyE_PapelCarton_Rec:(this.EyE_UF_Papel=this.EyE_PapelCarton_Rec+this.RET_PapelCarton_P+this.RET_PapelCarton_Sec+this.RET_PapelCarton_Ter+this.RET_PapelCarton_NP,this.EyE_PapelCarton_Rec+=this.RET_PapelCarton_Total,this.EyE_Ret-=this.RET_PapelCarton_Total),o?this.EyE_UF_Metal=this.EyE_Metal_Rec:(this.EyE_UF_Metal=this.EyE_Metal_Rec+this.RET_Metal_P+this.RET_Metal_Sec+this.RET_Metal_Ter+this.RET_Metal_NP,this.EyE_Metal_Rec+=this.RET_Metal_Total,this.EyE_Ret-=this.RET_Metal_Total),r?this.EyE_UF_Plastico=this.EyE_Plastico_Rec:(this.EyE_UF_Plastico=this.EyE_Plastico_Rec+this.RET_Plastico_P+this.RET_Plastico_Sec+this.RET_Plastico_Ter+this.RET_Plastico_NP,this.EyE_Plastico_Rec+=this.RET_Plastico_Total,this.EyE_Ret-=this.RET_Plastico_Total),this.Total_EyE=this.EyE_PapelCarton_Rec+this.EyE_Metal_Rec+this.EyE_Plastico_Rec+this.EyE_NR,this.PapelCarton_Rec_Uf=this.EyE_UF_Papel*this.rates[0].price,this.Metal_Rec_Uf=this.EyE_UF_Metal*this.rates[1].price,this.Plastico_Rec_Uf=this.EyE_UF_Plastico*this.rates[2].price,this.NR_Uf=this.EyE_NR*this.rates[3].price,this.Total_Uf=this.PapelCarton_Rec_Uf+this.Metal_Rec_Uf+this.Plastico_Rec_Uf+this.NR_Uf,this.PapelCarton_Neto=(this.PapelCarton_Rec_Uf*this.ratesUF.data).toFixed(0),this.Metal_Neto=(this.Metal_Rec_Uf*this.ratesUF.data).toFixed(0),this.Plastico_Neto=(this.Plastico_Rec_Uf*this.ratesUF.data).toFixed(0),this.NR_Neto=(this.NR_Uf*this.ratesUF.data).toFixed(0),this.PapelCarton_IVA=this.PapelCarton_Rec_Uf*this.ratesUF.data*1.19-this.PapelCarton_Rec_Uf*this.ratesUF.data,this.Metal_IVA=this.Metal_Rec_Uf*this.ratesUF.data*1.19-this.Metal_Rec_Uf*this.ratesUF.data,this.Plastico_IVA=this.Plastico_Rec_Uf*this.ratesUF.data*1.19-this.Plastico_Rec_Uf*this.ratesUF.data,this.NR_IVA=this.NR_Uf*this.ratesUF.data*1.19-this.NR_Uf*this.ratesUF.data,this.PapelCarton_Bruto=(this.PapelCarton_Rec_Uf*this.ratesUF.data*1.19).toFixed(0),this.Metal_Bruto=(this.Metal_Rec_Uf*this.ratesUF.data*1.19).toFixed(0),this.Plastico_Bruto=(this.Plastico_Rec_Uf*this.ratesUF.data*1.19).toFixed(0),this.NR_Bruto=(this.NR_Uf*this.ratesUF.data*1.19).toFixed(0),this.totalIVA=this.PapelCarton_IVA+this.Metal_IVA+this.Plastico_IVA+this.NR_IVA,this.TotalBruto=parseInt(this.PapelCarton_Neto)+parseInt(this.Metal_Neto)+parseInt(this.Plastico_Neto)+parseInt(this.NR_Neto),this.TotalBruto_IVA=parseInt(this.PapelCarton_Bruto)+parseInt(this.Metal_Bruto)+parseInt(this.Plastico_Bruto)+parseInt(this.NR_Bruto),0!=i&&(this.valores[0]=this.valores[0]+parseFloat(this.Total_EyE)+parseFloat(this.EyE_Ret),this.valores[1]=this.valores[1]+parseFloat(this.Total_EyE),this.valores[2]=this.valores[2]+parseFloat(this.R_PapelCarton_Total)+parseFloat(this.NR_PapelCarton_Total)+parseFloat(this.RET_PapelCarton_Total),this.valores[3]=this.valores[3]+parseFloat(this.R_Metal_Total)+parseFloat(this.NR_Metal_Total)+parseFloat(this.RET_Metal_Total),this.valores[4]=this.valores[4]+parseFloat(this.R_Plastico_Total)+parseFloat(this.NR_Plastico_Total)+parseFloat(this.RET_Plastico_Total),this.valores[5]=this.valores[5]+parseFloat(this.R_Madera_Total)+parseFloat(this.NR_Madera_Total)+parseFloat(this.RET_Madera_Total),this.valores[6]=this.valores[6]+parseFloat(this.R_PapelCarton_Total)+parseFloat(this.NR_PapelCarton_Total),this.valores[7]=this.valores[7]+parseFloat(this.R_Metal_Total)+parseFloat(this.NR_Metal_Total),this.valores[8]=this.valores[8]+parseFloat(this.R_Plastico_Total)+parseFloat(this.NR_Plastico_Total),this.valores[9]=this.valores[9]+parseFloat(this.R_Madera_Total)+parseFloat(this.NR_Madera_Total),this.valores[10]=this.valores[10]+parseFloat(this.NR_Compuestos_Total),this.valores[11]=this.valores[11]+parseFloat(this.R_PapelCarton_Total),this.valores[12]=this.valores[12]+parseFloat(this.R_Metal_Total),this.valores[13]=this.valores[13]+parseFloat(this.R_Plastico_Total),this.valores[14]=this.valores[14]+parseFloat(this.NR_PapelCarton_Total)+parseFloat(this.NR_Metal_Total)+parseFloat(this.NR_Plastico_Total)+parseFloat(this.NR_Compuestos_Total),this.valores[15]=this.valores[15]+parseFloat(this.R_PapelCarton_NP)+parseFloat(this.R_Metal_NP)+parseFloat(this.R_Plastico_NP)+parseFloat(this.R_Madera_NP)+parseFloat(this.NR_PapelCarton_NP)+parseFloat(this.NR_Metal_NP)+parseFloat(this.NR_Plastico_NP)+parseFloat(this.NR_Madera_NP)+parseFloat(this.NR_Compuestos_NP),this.valores[16]=this.valores[16]+parseFloat(this.R_PapelCarton_P)+parseFloat(this.R_Metal_P)+parseFloat(this.R_Plastico_P)+parseFloat(this.R_Madera_P)+parseFloat(this.NR_PapelCarton_P)+parseFloat(this.NR_Metal_P)+parseFloat(this.NR_Plastico_P)+parseFloat(this.NR_Madera_P)+parseFloat(this.NR_Compuestos_P),this.valores[17]=this.valores[17]+parseFloat(this.R_PapelCarton_Sec)+parseFloat(this.R_Metal_Sec)+parseFloat(this.R_Plastico_Sec)+parseFloat(this.R_Madera_Sec)+parseFloat(this.NR_PapelCarton_Sec)+parseFloat(this.NR_Metal_Sec)+parseFloat(this.NR_Plastico_Sec)+parseFloat(this.NR_Madera_Sec)+parseFloat(this.NR_Compuestos_Sec),this.valores[18]=this.valores[18]+parseFloat(this.R_PapelCarton_Ter)+parseFloat(this.R_Metal_Ter)+parseFloat(this.R_Plastico_Ter)+parseFloat(this.R_Madera_Ter)+parseFloat(this.NR_PapelCarton_Ter)+parseFloat(this.NR_Metal_Ter)+parseFloat(this.NR_Plastico_Ter)+parseFloat(this.NR_Madera_Ter)+parseFloat(this.NR_Compuestos_Ter),this.valores[19]=this.valores[19]+parseFloat(this.PapelCarton_Rec_Uf),this.valores[20]=this.valores[20]+parseFloat(this.Metal_Rec_Uf),this.valores[21]=this.valores[21]+parseFloat(this.Plastico_Rec_Uf),this.valores[22]=this.valores[22]+parseFloat(this.NR_Uf),this.valores[23]=this.valores[23]+parseFloat(this.Total_Uf),this.valores[24]=this.valores[24]+parseFloat(this.PapelCarton_Neto),this.valores[25]=this.valores[25]+parseFloat(this.Metal_Neto),this.valores[26]=this.valores[26]+parseFloat(this.Plastico_Neto),this.valores[27]=this.valores[27]+parseFloat(this.NR_Neto),this.valores[28]=this.valores[28]+parseFloat(this.TotalBruto),this.valores[29]=this.valores[29]+parseFloat(this.TotalBruto_IVA))}onChangeYear(){if(this.selectedYear&&-1!==this.selectedYear){const t=parseInt(this.selectedYear.toString())+1;this.ratesService.getRates(t).subscribe({next:i=>{this.rates=i.data},error:i=>{d().close(),d().fire({title:"\xa1Ups!",icon:"error",text:"No se logr\xf3 obtener el valor de la UF",showConfirmButton:!0})}})}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(N.u),e.Y36(D),e.Y36(F.z))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-maintainer-declarations-productor"]],decls:28,vars:3,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"declaracion"],[1,"d-sm-flex","justify-content-between","mb-3","mb-md-0"],[1,"box","box-form","mb-4"],[1,"row","align-items-end"],[1,"col-12","col-xl-8","mb-5","mb-xl-0"],[1,"form-label"],[1,"input-group"],["id","f_year",1,"form-select","col-12","w-100",3,"ngModel","ngModelChange","change"],["value","-1","selected",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-12","col-xl-4","mb-3","mb-xl-0"],[1,"row"],[1,"col-12"],[1,"btn","btn-primary","col-12","btn-lg",3,"disabled","click"],[3,"value"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",6),e._uU(8,"Declaraciones productores"),e.qZA()()(),e.TgZ(9,"section",7)(10,"h1"),e._uU(11,"Declaraciones productores"),e.qZA(),e._UZ(12,"div",8),e.TgZ(13,"div",9)(14,"div",10)(15,"div",11)(16,"label",12),e._uU(17,"A\xf1o:"),e.qZA(),e.TgZ(18,"div",13)(19,"select",14),e.NdJ("ngModelChange",function(o){return i.selectedYear=o})("change",function(){return i.onChangeYear()}),e.TgZ(20,"option",15),e._uU(21,"Seleccionar a\xf1o de declaraci\xf3n"),e.qZA(),e.YNc(22,Ai,2,2,"option",16),e.qZA()()(),e.TgZ(23,"div",17)(24,"div",18)(25,"div",19)(26,"button",20),e.NdJ("click",function(){return i.generarExcel("Declaraciones_productores")}),e._uU(27," Generar Excel "),e.qZA()()()()()()()()),2&t&&(e.xp6(19),e.Q6J("ngModel",i.selectedYear),e.xp6(3),e.Q6J("ngForOf",i.years),e.xp6(4),e.Q6J("disabled",-1===i.selectedYear||"-1"===i.selectedYear.toString()))},dependencies:[p.sg,c.YN,c.Kr,c.EJ,c.JJ,c.On],styles:["[_nghost-%COMP%]{width:40%!important;padding:1%}"]}),a})();function vi(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"tr",15)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td")(8,"div",45)(9,"button",46),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw();return r.getManager(o.ID),e.KtG(r.index=o.ID)}),e._uU(10,"Materiales"),e.qZA()()()()}if(2&a){const t=n.$implicit;e.xp6(2),e.Oqu(t.CODE_BUSINESS),e.xp6(2),e.Oqu(t.NAME),e.xp6(2),e.Oqu(t.LOC_ADDRESS)}}const W=function(a,n){return{"btn-info":a,"btn-primary":n}};function Zi(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"li")(1,"button",47),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.pagTo(o))}),e._uU(2),e.qZA()()}if(2&a){const t=n.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngClass",e.WLB(2,W,i.pos===t+1,i.pos!==t+1)),e.xp6(1),e.Oqu(t+1)}}function Mi(a,n){if(1&a&&(e.TgZ(0,"option"),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.xp6(1),e.Oqu(t)}}function Ci(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"Debe seleccionar algun material."),e.qZA())}function Ni(a,n){if(1&a&&(e.TgZ(0,"div",48),e.YNc(1,Ci,2,0,"p",44),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.MATERIAL.errors.required)}}function xi(a,n){if(1&a&&(e.TgZ(0,"option",49),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.Q6J("value",t.ID),e.xp6(1),e.Oqu(t.NAME)}}function Ri(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"Debe seleccionar alguna regi\xf3n."),e.qZA())}function Ui(a,n){if(1&a&&(e.TgZ(0,"div",48),e.YNc(1,Ri,2,0,"p",44),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.REGION.errors.required)}}function qi(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"tr",15)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"button",52),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.deleteManager(o.ID_MANAGER))}),e._uU(7," X "),e.qZA()()()}if(2&a){const t=n.$implicit;e.xp6(2),e.Oqu(t.MATERIAL),e.xp6(2),e.Oqu(t.REGION)}}function Fi(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"li")(1,"button",47),e.NdJ("click",function(){const o=e.CHM(t).index,r=e.oxw(2);return e.KtG(r.pagTo2(o))}),e._uU(2),e.qZA()()}if(2&a){const t=n.index,i=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.WLB(2,W,i.pos2==t+1,i.pos2!=t+1)),e.xp6(1),e.Oqu(t+1)}}function Si(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"div"),e._UZ(1,"div",50),e.TgZ(2,"div",6)(3,"div",7)(4,"label"),e._uU(5,"Filtro:"),e.qZA(),e.TgZ(6,"input",51),e.NdJ("keyup",function(s){e.CHM(t);const o=e.oxw();return e.KtG(o.filterForm(s.target))}),e.qZA()()(),e.TgZ(7,"table",14)(8,"thead")(9,"tr",15)(10,"th"),e._uU(11,"Material"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Regi\xf3n"),e.qZA(),e.TgZ(14,"th"),e._uU(15,"Eliminar"),e.qZA()()(),e.TgZ(16,"tbody"),e.YNc(17,qi,8,2,"tr",16),e.qZA()(),e.TgZ(18,"nav",17)(19,"ul",18)(20,"li")(21,"button",19),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.pagTo2(0))}),e._uU(22,"Primero"),e.qZA()(),e.TgZ(23,"li")(24,"button",19),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.previus2())}),e._uU(25,"Anterior"),e.qZA()(),e.YNc(26,Fi,3,5,"li",20),e.TgZ(27,"li")(28,"button",19),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.next2())}),e._uU(29,"Siguiente"),e.qZA()(),e.TgZ(30,"li")(31,"button",19),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.pagTo2(s.cant2-1))}),e._uU(32,"\xdaltimo"),e.qZA()()()()()}if(2&a){const t=e.oxw();e.xp6(17),e.Q6J("ngForOf",t.db2),e.xp6(9),e.Q6J("ngForOf",t.setArrayFromNumber2())}}let Pi=(()=>{class a{constructor(t,i,s){this.businesService=t,this.managerService=i,this.fb=s,this.listRegiones=[],this.listMateriales=[],this.filteredList=[],this.filteredForm=[],this.listBusiness=[],this.pos=1,this.db=[],this.cant=0,this.managerStatus=[],this.pos2=1,this.db2=[],this.cant2=0,this.index=0,this.MATERIAL="",this.REGION="",this.FILTER=""}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.getAllBusiness(),this.getMaterials(),this.userForm=this.fb.group({MATERIAL:["",[c.kI.required]],REGION:["",[c.kI.required]],FILTER:[[],[]]}),this.getRegions()}getAllBusiness(){this.businesService.getAllBusiness().subscribe({next:t=>{this.listBusiness=t.status,this.filteredList=t.status,this.cant=Math.ceil(this.listBusiness.length/10),this.db=this.listBusiness.slice(0,10).sort((i,s)=>s.YEAR_STATEMENT-i.YEAR_STATEMENT)},error:t=>{d().close(),d().fire({icon:"error",text:t.msg,title:"\xa1Ups!"})}})}getMaterials(){this.managerService.getAllMaterials().subscribe({next:t=>{this.listMateriales=t.status.map(i=>i.MATERIAL),this.listMateriales.sort((i,s)=>i.localeCompare(s))},error:t=>{d().close(),d().fire({icon:"error",text:t.msg,title:"\xa1Ups!"})}})}getRegions(){this.managerService.getAllRegions().subscribe({next:t=>{this.listRegiones=t.data},error:t=>{d().close(),d().fire({icon:"error",text:t.msg,title:"\xa1Ups!"})}})}getManager(t){this.managerService.getManager(t).subscribe({next:i=>{i.status?(this.managerStatus=i.status,this.filteredForm=i.status,this.cant2=Math.ceil(this.managerStatus.length/10),this.db2=this.managerStatus.slice(0,10).sort((s,o)=>o.ID_MANAGER-s.ID_MANAGER)):this.managerStatus=[],this.reset()},error:i=>{d().close(),d().fire({icon:"error",text:i.msg,title:"\xa1Ups!"}),this.reset()}})}getMaterialID(t){const i=this.listMateriales.find(r=>r===t),s=this.listMateriales.indexOf(i);let o=s>=0?s+1:null;switch(o){case 1:o=4;break;case 3:o=5;break;case 4:o=1;break;case 5:o=3}return o}addManager(t){var i=this;return(0,P.Z)(function*(){if(i.verificarEstablecimiento()){const s=i.getMaterialID(i.userForm.value.MATERIAL),{REGION:o}=i.userForm.value,r=yield i.managerService.getRegionFromID(o).toPromise();i.managerStatus.push(t),i.managerService.addManager(s,r.status[0].NAME,t,o).subscribe({next:l=>{l.status&&(i.pagTo2(0),d().fire({title:"Gestor agregado",text:"El gestor fue agregado exitosamente",icon:"success"})),i.getManager(t)},error:l=>{d().fire({title:"Error",text:"Error al agregar el Gestor",icon:"error"})}})}else d().fire({title:"Material y Regi\xf3n ya se encuentran registrados",text:"",icon:"error"})})()}deleteManager(t){d().fire({title:"\xbfEst\xe1s seguro que quieres eliminar el gestor?",showDenyButton:!0,confirmButtonText:"Confirmar",denyButtonText:"Cancelar"}).then(i=>{i.isConfirmed&&(this.pagTo2(0),this.managerService.deleteManager(t).subscribe({next:s=>{s.status?(d().fire({title:"Gestor Eliminado",text:"",icon:"error"}),this.getManager(this.index)):d().fire({title:"Validar informaci\xf3n",text:s.msg,icon:"error"})},error:s=>{d().fire({title:"Formato inv\xe1lido",text:"",icon:"error"})}}))})}pagTo(t){this.pos=t+1,this.db=this.filteredList.slice(10*t,10*(t+1)).sort((i,s)=>s.YEAR_STATEMENT-i.YEAR_STATEMENT)}next(){this.pos>=this.cant||(this.pos++,this.db=this.filteredList.slice(10*(this.pos-1),10*this.pos).sort((t,i)=>i.YEAR_STATEMENT-t.YEAR_STATEMENT))}previus(){this.pos-1<=0||this.pos>=this.cant+1||(this.pos=this.pos-1,this.db=this.filteredList.slice(10*(this.pos-1),10*this.pos).sort((t,i)=>i.YEAR_STATEMENT-t.YEAR_STATEMENT))}setArrayFromNumber(){return new Array(this.cant)}pagTo2(t){this.pos2=t+1,this.db2=this.filteredForm.slice(10*t,10*(t+1)).sort((i,s)=>i.ID_MANAGER-s.ID_MANAGER)}next2(){this.pos2>=this.cant2||(this.pos2++,this.db2=this.filteredForm.slice(10*(this.pos2-1),10*this.pos2).sort((t,i)=>t.ID_MANAGER-i.ID_MANAGER))}previus2(){this.pos2-1<=0||this.pos2>=this.cant2+1||(this.pos2=this.pos2-1,this.db2=this.filteredForm.slice(10*(this.pos2-1),10*this.pos2).sort((t,i)=>t.ID_MANAGER-i.ID_MANAGER))}setArrayFromNumber2(){return new Array(this.cant2)}visiblePageNumbers(){const t=this.setArrayFromNumber().length,i=[];if(t<=15)for(let s=0;s<t;s++)i.push(s);else{let s=Math.max(0,this.pos-Math.floor(7.5)),o=Math.min(t-1,s+14);o-s+1<15&&(o=t-1,s=Math.max(0,o-14));for(let r=s;r<=o;r++)i.push(r)}return i}reset(){this.pagTo2(0),this.userForm.reset(),this.userForm.patchValue({MATERIAL:"",REGION:"",FILTER:""})}verificarEstablecimiento(){const{MATERIAL:t,REGION:i}=this.userForm.value;let s=!1;const o=t.trim();for(let r=0;r<this.managerStatus.length;r++)if(this.managerStatus[r].MATERIAL.toLowerCase()===o.toLowerCase()&&this.managerStatus[r].ID_REGION===parseInt(i)){s=!0;break}return!s}filter(t){const i=t.value?.toLowerCase();this.pos=1;const s=[];return""!=t.value?(this.cant=1,this.db=this.listBusiness.filter(o=>{(o.NAME?.toLowerCase().indexOf(i)>-1||o.CODE_BUSINESS?.toLowerCase().indexOf(i)>-1||o.LOC_ADDRESS?.toLowerCase().indexOf(i)>-1)&&s.push(o)}),this.filteredList=s,this.db=s.slice(0,10),this.cant=Math.ceil(s.length/10),this.db):(this.filteredList=this.listBusiness,this.db=this.listBusiness.slice(0,10),this.cant=Math.ceil(this.listBusiness.length/10),this.db)}filterForm(t){const i=t.value?.toLowerCase();this.pos2=1;const s=[];return""!=t.value?(this.cant2=1,this.db2=this.managerStatus.filter(o=>{(o.MATERIAL?.toLowerCase().indexOf(i)>-1||o.REGION?.toLowerCase().indexOf(i)>-1)&&s.push(o)}),this.filteredForm=s,this.db2=s.slice(0,10),this.cant2=Math.ceil(s.length/10),this.db2):(this.filteredForm=this.managerStatus,this.db2=this.managerStatus.slice(0,10),this.cant2=Math.ceil(this.managerStatus.length/10),this.db2)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(R.m),e.Y36(H.b),e.Y36(c.qu))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-maintainer-managers"]],decls:90,vars:9,consts:[["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],[2,"height","30px"],[1,"row","mb-3"],[1,"col-md-12"],["type","text","placeholder","Filtro de b\xfasqueda",1,"form-control",3,"keyup"],[1,"table-responsive","mb-4"],[1,"row","w-100"],["id","table",1,"w-100"],["table1",""],[1,"w-100"],[1,"table-container","table","table-even","table-section","table-borderless","table-border","table-radius","d-lg-table"],[1,"text-center","w-100"],["class","text-center w-100",4,"ngFor","ngForOf"],["aria-label","Navegaci\xf3n resultados"],[1,"pagination"],[1,"btn","btn-primary",3,"click"],[4,"ngFor","ngForOf"],["id","exampleModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title","fs-5"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"container"],[3,"formGroup"],["miFormulario","ngForm"],[1,"row"],[1,"col-md-6"],["for","inp_nom"],["formControlName","MATERIAL","id","inp_nom","required","",1,"form-select"],["value",""],["class","text-danger pl-0",4,"ngIf"],["for","inp_region"],["formControlName","REGION","id","inp_region","required","",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button","id","btnCloseModal","data-bs-dismiss","modal",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[2,"visibility","hidden"],[4,"ngIf"],[1,"btn-group"],["data-bs-toggle","modal","data-bs-target","#exampleModal",1,"btn","btn-success","btn-sm","rounded-pill",3,"click"],[1,"border","btn","btn-sm",3,"ngClass","click"],[1,"text-danger","pl-0"],[3,"value"],[2,"height","50px"],["type","text","placeholder","Filtro de b\xfasqueda","formControlName","FILTER",1,"form-control",3,"keyup"],["type","button",1,"btn","btn-danger","btn-sm","rounded-pill",3,"click"]],template:function(t,i){if(1&t&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"i",4),e._uU(5," Inicio"),e.qZA()(),e.TgZ(6,"li",2)(7,"a",3),e._uU(8,"Mantenedor Gestores"),e.qZA()()()(),e._UZ(9,"div",5),e.TgZ(10,"h1"),e._uU(11,"Gestores"),e.qZA(),e.TgZ(12,"div",6)(13,"div",7)(14,"label"),e._uU(15,"Filtro:"),e.qZA(),e.TgZ(16,"input",8),e.NdJ("keyup",function(o){return i.filter(o.target)}),e.qZA()()(),e.TgZ(17,"div",9)(18,"section")(19,"div",10)(20,"div",11,12)(22,"div",13)(23,"table",14)(24,"thead")(25,"tr",15)(26,"th"),e._uU(27,"C\xd3DIGO EMPRESA "),e.qZA(),e.TgZ(28,"th"),e._uU(29,"NOMBRE "),e.qZA(),e.TgZ(30,"th"),e._uU(31,"DIRECCI\xd3N "),e.qZA(),e.TgZ(32,"th"),e._uU(33,"MATERIALES"),e.qZA()()(),e.TgZ(34,"tbody"),e.YNc(35,vi,11,3,"tr",16),e.qZA()(),e.TgZ(36,"nav",17)(37,"ul",18)(38,"li")(39,"button",19),e.NdJ("click",function(){return i.pagTo(0)}),e._uU(40,"Primero"),e.qZA()(),e.TgZ(41,"li")(42,"button",19),e.NdJ("click",function(){return i.previus()}),e._uU(43,"Anterior"),e.qZA()(),e.YNc(44,Zi,3,5,"li",20),e.TgZ(45,"li")(46,"button",19),e.NdJ("click",function(){return i.next()}),e._uU(47,"Siguiente"),e.qZA()(),e.TgZ(48,"li")(49,"button",19),e.NdJ("click",function(){return i.pagTo(i.cant-1)}),e._uU(50,"\xdaltimo"),e.qZA()()()()()()()()(),e.TgZ(51,"div",21)(52,"div",22)(53,"div",23)(54,"div",24)(55,"h1",25),e._uU(56,"Formulario Gestores"),e.qZA(),e._UZ(57,"button",26),e.qZA(),e.TgZ(58,"div",27)(59,"div",28)(60,"form",29,30)(62,"div",31)(63,"div",32)(64,"label",33),e._uU(65,"MATERIAL"),e.qZA(),e.TgZ(66,"select",34)(67,"option",35),e._uU(68,"Selecciona Material"),e.qZA(),e.YNc(69,Mi,2,1,"option",20),e.qZA(),e.YNc(70,Ni,2,1,"div",36),e.qZA(),e.TgZ(71,"div",32)(72,"label",37),e._uU(73,"REGI\xd3N"),e.qZA(),e.TgZ(74,"select",38)(75,"option",35),e._uU(76,"Selecciona Regi\xf3n"),e.qZA(),e.YNc(77,xi,2,2,"option",39),e.qZA(),e.YNc(78,Ui,2,1,"div",36),e._UZ(79,"br"),e.qZA()(),e.TgZ(80,"div",40)(81,"button",41),e.NdJ("click",function(){return i.reset()}),e._uU(82,"Cerrar"),e.qZA(),e.TgZ(83,"button",42),e.NdJ("click",function(){return i.addManager(i.index)}),e._uU(84,"Agregar"),e.qZA()(),e.TgZ(85,"div",43),e._uU(86,"a"),e.qZA(),e.TgZ(87,"div",43),e._uU(88,"a"),e.qZA(),e.YNc(89,Si,33,2,"div",44),e.qZA()()()()()()),2&t){const s=e.MAs(61);e.xp6(35),e.Q6J("ngForOf",i.db),e.xp6(9),e.Q6J("ngForOf",i.visiblePageNumbers()),e.xp6(16),e.Q6J("formGroup",i.userForm),e.xp6(9),e.Q6J("ngForOf",i.listMateriales),e.xp6(1),e.Q6J("ngIf",i.userForm.controls.MATERIAL.errors&&i.userForm.controls.MATERIAL.touched),e.xp6(7),e.Q6J("ngForOf",i.listRegiones),e.xp6(1),e.Q6J("ngIf",i.userForm.controls.REGION.errors&&i.userForm.controls.REGION.touched),e.xp6(5),e.Q6J("disabled",s.invalid),e.xp6(6),e.Q6J("ngIf",i.managerStatus&&i.managerStatus.length>0)}},dependencies:[p.mk,p.sg,p.O5,c._Y,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.JL,c.Q7,c.sg,c.u],styles:["[_nghost-%COMP%]{width:70%!important;padding:1%}"]}),a})(),Ii=(()=>{class a{constructor(t){this.ls=t}ngOnInit(){}generarExcel(){const t=document.getElementById("ds").value,i=document.getElementById("de").value;""!=t?""!=i?new Date(t)>new Date(i)?d().fire({icon:"error",text:"Fecha de inicio debe ser menor a la fecha de t\xe9rmino"}):(d().fire({icon:"info",text:"Generando Excel",timerProgressBar:!0,showConfirmButton:!1,allowEscapeKey:!1,allowOutsideClick:!1}),d().showLoading(),this.ls.downloadExcel(t,i).subscribe(r=>{if(d().close(),r){const l=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});let u=document.createElement("a");u.href=window.URL.createObjectURL(l),u.download="logs_prorep",document.body.appendChild(u),u.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),u.remove(),window.URL.revokeObjectURL(u.href),document.getElementById("ds").value="",document.getElementById("de").value=""}})):d().fire({icon:"error",text:"Debe ingresar fecha de t\xe9rmino"}):d().fire({icon:"error",text:"Debe ingresar fecha de inicio"})}validaBtn(){const t=document.getElementById("ds").value,i=document.getElementById("de").value;return""==t||""==i}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(D))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-logs"]],decls:30,vars:1,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"declaracion"],[1,"d-sm-flex","justify-content-between","mb-3","mb-md-0"],[1,"box","box-form","mb-4"],[1,"row","align-items-end"],[1,"col-12","col-xl-8","mb-5","mb-xl-0"],[1,"form-label"],[1,"input-group"],["type","date","name","","id","ds",1,"form-control"],["type","date","name","","id","de",1,"form-control"],[1,"col-12","col-xl-4","mb-3","mb-xl-0"],[1,"row"],[1,"col-12"],[1,"btn","btn-primary","col-12","btn-lg",3,"disabled","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",6),e._uU(8,"Logs"),e.qZA()()(),e.TgZ(9,"section",7)(10,"h1"),e._uU(11,"Logs de Sistema "),e.qZA(),e._UZ(12,"div",8),e.TgZ(13,"div",9)(14,"div",10)(15,"div",11)(16,"label",12),e._uU(17,"Fecha Inicio:"),e.qZA(),e.TgZ(18,"div",13),e._UZ(19,"input",14),e.qZA()(),e.TgZ(20,"div",11)(21,"label",12),e._uU(22,"Fecha Fin:"),e.qZA(),e.TgZ(23,"div",13),e._UZ(24,"input",15),e.qZA()(),e.TgZ(25,"div",16)(26,"div",17)(27,"div",18)(28,"button",19),e.NdJ("click",function(){return i.generarExcel()}),e._uU(29," Generar Excel "),e.qZA()()()()()()()()),2&t&&(e.xp6(28),e.Q6J("disabled",i.validaBtn()))},styles:["[_nghost-%COMP%]{width:40%!important;padding:1%}"]}),a})();function Di(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"tr",48)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td")(12,"div",49)(13,"button",50),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.modify(o))}),e._uU(14,"Modificar"),e.qZA()()()()}if(2&a){const t=n.$implicit,i=e.oxw();e.xp6(2),e.Oqu(i.getYear(t)),e.xp6(2),e.Oqu(i.getPrice(t,1).toFixed(2).replace(".",",")),e.xp6(2),e.Oqu(i.getPrice(t,2).toFixed(2).replace(".",",")),e.xp6(2),e.Oqu(i.getPrice(t,3).toFixed(2).replace(".",",")),e.xp6(2),e.Oqu(i.getPrice(t,4).toFixed(2).replace(".",","))}}function yi(a,n){1&a&&e._UZ(0,"div",51)}function Oi(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El c\xf3digo de la empresa es requerido."),e.qZA())}function wi(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El c\xf3digo de empresa ya existe."),e.qZA())}function Li(a,n){if(1&a&&(e.TgZ(0,"div",67),e.YNc(1,Oi,2,0,"p",68),e.YNc(2,wi,2,0,"p",68),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.code_business.errors.required),e.xp6(1),e.Q6J("ngIf",""!=t.formData.controls.code_business.value&&!t.formData.controls.code_business.errors.verifyCode)}}function Bi(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El nombre de la empresa es requerido."),e.qZA())}function Yi(a,n){if(1&a&&(e.TgZ(0,"div",67),e.YNc(1,Bi,2,0,"p",68),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.name_business.errors.required)}}function ki(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El rut de la empresa es requerido."),e.qZA())}function Ji(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del RUT es inv\xe1lido (Sin puntos y con gui\xf3n)."),e.qZA())}function Qi(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El digito verificador es incorrecto."),e.qZA())}function Vi(a,n){if(1&a&&(e.TgZ(0,"div",67),e.YNc(1,ki,2,0,"p",68),e.YNc(2,Ji,2,0,"p",68),e.YNc(3,Qi,2,0,"p",68),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.rut.errors.required),e.xp6(1),e.Q6J("ngIf",t.formData.controls.rut.errors.pattern),e.xp6(1),e.Q6J("ngIf",t.formData.controls.rut.errors.rut)}}function Gi(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"La direcci\xf3n de la empresa es requerida."),e.qZA())}function Hi(a,n){if(1&a&&(e.TgZ(0,"div",67),e.YNc(1,Gi,2,0,"p",68),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.loc_address.errors.required)}}function zi(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El n\xfamero de Tel\xe9fono/Celular de la empresa es requerido (7 - 12 d\xedgitos)."),e.qZA())}function $i(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del Tel\xe9fono/Celular es inv\xe1lido (7 - 12 d\xedgitos)."),e.qZA())}function ji(a,n){if(1&a&&(e.TgZ(0,"div",67),e.YNc(1,zi,2,0,"p",68),e.YNc(2,$i,2,0,"p",68),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.phone.errors.required),e.xp6(1),e.Q6J("ngIf",t.formData.controls.phone.errors.pattern)}}function Ki(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El correo de la empresa es requerido (ejemplo@correo.com)."),e.qZA())}function Xi(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del correo es inv\xe1lido (ejemplo@correo.com)."),e.qZA())}function Wi(a,n){if(1&a&&(e.TgZ(0,"div",67),e.YNc(1,Ki,2,0,"p",68),e.YNc(2,Xi,2,0,"p",68),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.email.errors.required),e.xp6(1),e.Q6J("ngIf",t.formData.controls.email.errors.email)}}function eo(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El nombre del account manager es requerido."),e.qZA())}function to(a,n){if(1&a&&(e.TgZ(0,"div",67),e.YNc(1,eo,2,0,"p",68),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.am_first_name.errors.required)}}function io(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El apellido del account manager es requerido."),e.qZA())}function oo(a,n){if(1&a&&(e.TgZ(0,"div",67),e.YNc(1,io,2,0,"p",68),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.am_last_name.errors.required)}}function ao(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El nombre contacto de facturaci\xf3n es requerido."),e.qZA())}function so(a,n){if(1&a&&(e.TgZ(0,"div",67),e.YNc(1,ao,2,0,"p",68),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.invoice_name.errors.required)}}function ro(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El email contacto de facturaci\xf3n es requerido (ejemplo@correo.com)."),e.qZA())}function no(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del correo es inv\xe1lido (ejemplo@correo.com)."),e.qZA())}function lo(a,n){if(1&a&&(e.TgZ(0,"div",67),e.YNc(1,ro,2,0,"p",68),e.YNc(2,no,2,0,"p",68),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.invoice_email.errors.required),e.xp6(1),e.Q6J("ngIf",t.formData.controls.invoice_email.errors.email)}}function co(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El tel\xe9fono de facturaci\xf3n es requerido (7 - 12 d\xedgitos)."),e.qZA())}function uo(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del tel\xe9fono es inv\xe1lido (7 - 12 d\xedgitos)."),e.qZA())}function _o(a,n){if(1&a&&(e.TgZ(0,"div",67),e.YNc(1,co,2,0,"p",68),e.YNc(2,uo,2,0,"p",68),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.invoice_phone.errors.required),e.xp6(1),e.Q6J("ngIf",t.formData.controls.invoice_phone.errors.pattern)}}function po(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1,"El giro de la empresa es requerido."),e.qZA())}function mo(a,n){if(1&a&&(e.TgZ(0,"div",67),e.YNc(1,po,2,0,"p",68),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formData.controls.giro.errors.required)}}function ho(a,n){if(1&a&&(e.TgZ(0,"div",51)(1,"div",52)(2,"label",53)(3,"strong"),e._uU(4,"C\xf3digo de la empresa"),e.qZA()(),e._UZ(5,"div",54),e.YNc(6,Li,3,2,"div",55),e.qZA(),e.TgZ(7,"div",52)(8,"label",56)(9,"strong"),e._uU(10,"Nombre de la empresa"),e.qZA()(),e._UZ(11,"div",54),e.YNc(12,Yi,2,1,"div",55),e.qZA(),e.TgZ(13,"div",52)(14,"label",57)(15,"strong"),e._uU(16,"Rut de la empresa"),e.qZA()(),e._UZ(17,"div",54),e.YNc(18,Vi,4,3,"div",55),e.qZA(),e.TgZ(19,"div",52)(20,"label",58)(21,"strong"),e._uU(22,"Direcci\xf3n de la empresa"),e.qZA()(),e._UZ(23,"div",54),e.YNc(24,Hi,2,1,"div",55),e.qZA(),e.TgZ(25,"div",52)(26,"label",59)(27,"strong"),e._uU(28,"Tel\xe9fono/Celular de la empresa"),e.qZA()(),e._UZ(29,"div",54),e.YNc(30,ji,3,2,"div",55),e.qZA(),e.TgZ(31,"div",52)(32,"label",60)(33,"strong"),e._uU(34,"Correo de la empresa"),e.qZA()(),e._UZ(35,"div",54),e.YNc(36,Wi,3,2,"div",55),e.qZA(),e.TgZ(37,"div",52)(38,"label",61)(39,"strong"),e._uU(40,"Nombre Account Manager"),e.qZA()(),e._UZ(41,"div",54),e.YNc(42,to,2,1,"div",55),e.qZA(),e.TgZ(43,"div",52)(44,"label",62)(45,"strong"),e._uU(46,"Apellido Account Manager"),e.qZA()(),e._UZ(47,"div",54),e.YNc(48,oo,2,1,"div",55),e.qZA(),e.TgZ(49,"div",52)(50,"label",63)(51,"strong"),e._uU(52,"Nombre contacto facturaci\xf3n"),e.qZA()(),e._UZ(53,"div",54),e.YNc(54,so,2,1,"div",55),e.qZA(),e.TgZ(55,"div",52)(56,"label",64)(57,"strong"),e._uU(58,"Correo contacto facturaci\xf3n"),e.qZA()(),e._UZ(59,"div",54),e.YNc(60,lo,3,2,"div",55),e.qZA(),e.TgZ(61,"div",52)(62,"label",65)(63,"strong"),e._uU(64,"Tel\xe9fono/Celular contacto facturaci\xf3n"),e.qZA()(),e._UZ(65,"div",54),e.YNc(66,_o,3,2,"div",55),e.qZA(),e.TgZ(67,"div",52)(68,"label",66)(69,"strong"),e._uU(70,"Giro empresa"),e.qZA()(),e._UZ(71,"div",54),e.YNc(72,mo,2,1,"div",55),e.qZA()()),2&a){const t=e.oxw();e.xp6(6),e.Q6J("ngIf",t.formData.controls.code_business.errors&&t.formData.controls.code_business.touched),e.xp6(6),e.Q6J("ngIf",t.formData.controls.name_business.errors&&t.formData.controls.name_business.touched),e.xp6(6),e.Q6J("ngIf",t.formData.controls.rut.errors&&t.formData.controls.rut.touched),e.xp6(6),e.Q6J("ngIf",t.formData.controls.loc_address.errors&&t.formData.controls.loc_address.touched),e.xp6(6),e.Q6J("ngIf",t.formData.controls.phone.errors&&t.formData.controls.phone.touched),e.xp6(6),e.Q6J("ngIf",t.formData.controls.email.errors&&t.formData.controls.email.touched),e.xp6(6),e.Q6J("ngIf",t.formData.controls.am_first_name.errors&&t.formData.controls.am_first_name.touched),e.xp6(6),e.Q6J("ngIf",t.formData.controls.am_last_name.errors&&t.formData.controls.am_last_name.touched),e.xp6(6),e.Q6J("ngIf",t.formData.controls.invoice_name.errors&&t.formData.controls.invoice_name.touched),e.xp6(6),e.Q6J("ngIf",t.formData.controls.invoice_email.errors&&t.formData.controls.invoice_email.touched),e.xp6(6),e.Q6J("ngIf",t.formData.controls.invoice_phone.errors&&t.formData.controls.invoice_phone.touched),e.xp6(6),e.Q6J("ngIf",t.formData.controls.giro.errors&&t.formData.controls.giro.touched)}}function go(a,n){if(1&a&&(e.TgZ(0,"option",69),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function fo(a,n){if(1&a&&(e.TgZ(0,"option",70),e._uU(1),e.qZA()),2&a){const t=n.$implicit,i=e.oxw();e.Q6J("value",t)("disabled",t!==i.selectedYear),e.xp6(1),e.Oqu(t)}}const bo=function(){return[]};let To=(()=>{class a{constructor(t,i){this.fb=t,this.ratesTsService=i,this.list=[],this.pos=1,this.db=[],this.cant=0,this.existingCode="",this.popupVisible=!1,this.popupModify=!1,this.id="",this.index=0,this.year=[],this.type=[],this.price=[],this.isok=!1,this.defaultYear=[],this.ratesForm=this.fb.group({year:["0",[c.kI.required,c.kI.min(2021)]],type_1:["",[c.kI.required,c.kI.min(0)]],type_2:["",[c.kI.required,c.kI.min(0)]],type_3:["",[c.kI.required,c.kI.min(0)]],type_4:["",[c.kI.required,c.kI.min(0)]]}),this.isEditing=!1,this.dbRates=[],this.rates=[]}modify(t){this.isEditing=!0,this.ratesForm.controls.year.setValue(t.year),this.selectedYear=t.year;const i=parseFloat(t.data.findIndex(b=>1==b.type)),s=parseFloat(t.data.findIndex(b=>2==b.type)),o=parseFloat(t.data.findIndex(b=>3==b.type)),r=parseFloat(t.data.findIndex(b=>4==b.type)),u=parseFloat(t.data[i].price).toFixed(2).replace(".",","),g=parseFloat(t.data[s].price).toFixed(2).replace(".",","),A=parseFloat(t.data[o].price).toFixed(2).replace(".",","),E=parseFloat(t.data[r].price).toFixed(2).replace(".",",");this.ratesForm.controls.type_1.setValue(u),this.ratesForm.controls.type_2.setValue(g),this.ratesForm.controls.type_3.setValue(A),this.ratesForm.controls.type_4.setValue(E)}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.getAllRates(),this.formData=this.fb.group({year:["",[c.kI.required]],type:["",[c.kI.required]],price:["",[c.kI.required]]});for(let t=2021;t<=(new Date).getFullYear()+1;t++)this.defaultYear.push(t)}saveForm(){if(this.ratesForm.invalid)return void d().fire({icon:"warning",text:"Debe ingresar todos los campos. Todas las tarifas deben ser num\xe9ricas mayores o iguales a cero."});const t=/^[0-9]+(,[0-9]+)?$/;t.test(this.ratesForm.value.type_1)&&t.test(this.ratesForm.value.type_2)&&t.test(this.ratesForm.value.type_3)&&t.test(this.ratesForm.value.type_4)?this.isEditing?this.ratesTsService.updateRatesByYear(this.ratesForm.value).subscribe({next:i=>{i.status?(this.getAllRates(),document.getElementById("closeModallll")?.click(),document.getElementById("closeModallll2")?.click()):(document.getElementById("closeModallll")?.click(),document.getElementById("closeModallll2")?.click(),d().fire({icon:"error",text:i.msg+""}))}}):this.ratesTsService.save(this.ratesForm.value).subscribe({next:i=>{i.status?(this.getAllRates(),document.getElementById("closeModallll")?.click()):d().fire({icon:"error",text:i.msg})}}):d().fire({icon:"warning",text:"Separador de miles con punto y separador de decimales con coma. M\xe1ximo 2 decimales"})}getAllRates(){this.rates=[],this.dbRates=[],this.year=[],this.type=[],this.price=[],this.ratesTsService.getAllRates().subscribe({next:t=>{t.status&&(this.dbRates=t.data,this.dbRates.forEach(i=>{const s=this.rates.findIndex(o=>o.year==i.year);s>-1?this.rates[s].data.push(i):this.rates.push({year:i.year,data:[i]})}),this.rates.length==(new Date).getFullYear()-2021+2&&(this.isok=!0))},error:t=>{d().close(),d().fire({icon:"error",text:t.msg,title:"\xa1Ups!"})}})}getYear(t){return t.year}getPrice(t,i){const s=t.data.findIndex(o=>o.type==i);return t.data[s].price||0}btnAddBusiness(){if(this.formData.invalid)return d().fire({title:"Validar informaci\xf3n",text:"Debe completar todos los campos",icon:"error"}),void this.getAllRates()}btnDeleteBusiness(t){d().fire({title:"\xbfEst\xe1s seguro que quieres eliminar la empresa?",showDenyButton:!0,confirmButtonText:"Confirmar",denyButtonText:"Cancelar"}).then(i=>{})}btnUpdateBusiness(t){this.formData.invalid?d().fire({title:"Validar informaci\xf3n",text:"Debe completar todos los campos",icon:"error"}):this.ratesTsService.updateRates(this.id,this.price).subscribe({next:b=>{b.status&&(d().fire({title:"Empresa Modificada",text:"",icon:"success"}),this.formData.reset(),this.popupModify=!1,this.getAllRates())},error:b=>{d().fire({title:"Error",text:"",icon:"error"})}})}verifyRut(t){return(0,V.validate)(t.value)?null:{rut:!0}}pagTo(t){this.pos=t+1,this.db=this.list.slice(10*t,10*(t+1)).sort((i,s)=>s.YEAR_STATEMENT-i.YEAR_STATEMENT)}next(){this.pos>=this.cant||(this.pos++,this.db=this.list.slice(10*(this.pos-1),10*this.pos).sort((t,i)=>i.YEAR_STATEMENT-t.YEAR_STATEMENT))}previus(){this.pos-1<=0||this.pos>=this.cant+1||(this.pos=this.pos-1,this.db=this.list.slice(10*(this.pos-1),10*this.pos).sort((t,i)=>i.YEAR_STATEMENT-t.YEAR_STATEMENT))}setArrayFromNumber(){return new Array(this.cant)}filter(t){const i=t.value?.toLowerCase();this.pos=1;const s=[];return""!=t.value?(this.cant=1,this.db=this.dbRates.filter(o=>{null!=o.YEAR?.toLowerCase().indexOf(i)&&s.push(o)}),this.db=s.slice(0,10),this.cant=Math.ceil(s.length/10),this.db):(this.db=this.dbRates.slice(0,10),this.cant=Math.ceil(this.dbRates.length/10),this.db)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(c.qu),e.Y36(F.z))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-maintainer-rates"]],decls:131,vars:9,consts:[["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],[1,"buttonRight"],["data-bs-toggle","modal","data-bs-target","#exampleModal",1,"btn","btn-primary",3,"disabled","click"],[2,"height","50px"],[1,"row","mb-3"],[1,"col-md-12"],[1,"table-responsive","mb-4"],[1,"row","w-100"],["id","table",1,"w-100"],["table1",""],[1,"w-100"],[1,"table-container","table","table-even","table-section","table-borderless","table-border","table-radius","d-lg-table"],[1,"text-center","w-100"],["class","text-end w-100",4,"ngFor","ngForOf"],["class","dark-background ",4,"ngIf"],["id","exampleModal","tabindex","-1","role","dialog","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title",2,"color","rgb(0, 138, 92)"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[3,"formGroup"],[1,"container"],[1,"row"],[1,"col-md-6"],[2,"color","rgb(0, 138, 92)"],["formControlName","year",1,"form-select","mb-4"],["value","0"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-12","mb-4"],["for","",2,"color","rgb(0, 138, 92)"],["type","text","formControlName","type_1",1,"form-control"],["type","text","formControlName","type_2",1,"form-control"],["type","text","formControlName","type_3",1,"form-control"],["type","text","formControlName","type_4",1,"form-control"],[1,"modal-footer"],["type","button","id","closeModallll","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","button",1,"btn","btn-primary",3,"click"],["id","exampleModal2","tabindex","-1","role","dialog","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],["formControlName","year",1,"form-control","mb-4"],[3,"value","disabled",4,"ngFor","ngForOf"],["type","button","id","closeModallll2","data-bs-dismiss","modal",1,"btn","btn-secondary"],[1,"text-end","w-100"],[1,"btn-group"],["data-bs-toggle","modal","data-bs-target","#exampleModal2",1,"btn","btn-success","btn-sm",3,"click"],[1,"dark-background"],[1,"mb-4"],["for","code_business",2,"color","rgb(0, 138, 92)"],[1,"input-group"],["class","text-danger pl-0",4,"ngIf"],["for","name_business",2,"color","rgb(0, 138, 92)"],["for","rut",2,"color","rgb(0, 138, 92)"],["for","loc_address",2,"color","rgb(0, 138, 92)"],["for","phone",2,"color","rgb(0, 138, 92)"],["for","email",2,"color","rgb(0, 138, 92)"],["for","am_first_name",2,"color","rgb(0, 138, 92)"],["for","am_last_name",2,"color","rgb(0, 138, 92)"],["for","invoice_name",2,"color","rgb(0, 138, 92)"],["for","invoice_email",2,"color","rgb(0, 138, 92)"],["for","invoice_phone",2,"color","rgb(0, 138, 92)"],["for","giro",2,"color","rgb(0, 138, 92)"],[1,"text-danger","pl-0"],[4,"ngIf"],[3,"value"],[3,"value","disabled"]],template:function(t,i){1&t&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"i",4),e._uU(5," Inicio"),e.qZA()(),e.TgZ(6,"li",2)(7,"a",3),e._uU(8,"Mantenedor Tarifa"),e.qZA()()()(),e.TgZ(9,"h1"),e._uU(10,"Tarifas por tonelada (UF)"),e.qZA(),e.TgZ(11,"div",5)(12,"button",6),e.NdJ("click",function(){return i.ratesForm.reset({year:"0"}),i.isEditing=!1}),e._uU(13,"Agregar Tarifa"),e.qZA()(),e._UZ(14,"div",7),e.TgZ(15,"div",8),e._UZ(16,"div",9),e.qZA(),e.TgZ(17,"div",10)(18,"section")(19,"div",11)(20,"div",12,13)(22,"div",14)(23,"table",15)(24,"thead")(25,"tr",16)(26,"th"),e._uU(27,"A\xd1O"),e.qZA(),e.TgZ(28,"th"),e._uU(29,"EyE reciclables de papel/cart\xf3n"),e.qZA(),e.TgZ(30,"th"),e._uU(31,"EyE reciclables de metal"),e.qZA(),e.TgZ(32,"th"),e._uU(33,"EyE reciclables de pl\xe1sticos"),e.qZA(),e.TgZ(34,"th"),e._uU(35,"EyE no reciclables"),e.qZA(),e._UZ(36,"th"),e.qZA()(),e.TgZ(37,"tbody"),e.YNc(38,Di,15,5,"tr",17),e.qZA()(),e.YNc(39,yi,1,0,"div",18),e.YNc(40,ho,73,12,"div",18),e.qZA()()()()(),e.TgZ(41,"div",19)(42,"div",20)(43,"div",21)(44,"div",22)(45,"h5",23),e._uU(46,"Formulario Tarifas"),e.qZA(),e.TgZ(47,"button",24)(48,"span",25),e._uU(49,"\xd7"),e.qZA()()(),e.TgZ(50,"div",26)(51,"form",27)(52,"div",28)(53,"div",29)(54,"div",30)(55,"strong",31),e._uU(56,"A\xf1o"),e.qZA(),e.TgZ(57,"select",32)(58,"option",33),e._uU(59,"Seleccionar a\xf1o"),e.qZA(),e.YNc(60,go,2,2,"option",34),e.qZA()()(),e.TgZ(61,"div",29)(62,"div",35)(63,"label",36)(64,"strong"),e._uU(65,"EyE reciclables de papel/cart\xf3n"),e.qZA()(),e._UZ(66,"input",37),e.qZA(),e.TgZ(67,"div",35)(68,"label",36)(69,"strong"),e._uU(70,"EyE reciclables de metal"),e.qZA()(),e._UZ(71,"input",38),e.qZA(),e.TgZ(72,"div",35)(73,"label",36)(74,"strong"),e._uU(75,"EyE reciclables de pl\xe1sticos"),e.qZA()(),e._UZ(76,"input",39),e.qZA(),e.TgZ(77,"div",35)(78,"label",36)(79,"strong"),e._uU(80,"EyE no reciclables"),e.qZA()(),e._UZ(81,"input",40),e.qZA()()()()(),e.TgZ(82,"div",41)(83,"button",42),e._uU(84,"CANCELAR"),e.qZA(),e.TgZ(85,"button",43),e.NdJ("click",function(){return i.saveForm()}),e._uU(86,"ACEPTAR"),e.qZA()()()()(),e.TgZ(87,"div",44)(88,"div",20)(89,"div",21)(90,"div",22)(91,"h5",23),e._uU(92,"Formulario Tarifas"),e.qZA(),e.TgZ(93,"button",24)(94,"span",25),e._uU(95,"\xd7"),e.qZA()()(),e.TgZ(96,"div",26)(97,"form",27)(98,"div",28)(99,"div",29)(100,"div",30)(101,"strong",31),e._uU(102,"A\xf1o"),e.qZA(),e.TgZ(103,"select",45),e.YNc(104,fo,2,3,"option",46),e.qZA()()(),e.TgZ(105,"div",29)(106,"div",35)(107,"label",36)(108,"strong"),e._uU(109,"EyE reciclables de papel/cart\xf3n"),e.qZA()(),e._UZ(110,"input",37),e.qZA(),e.TgZ(111,"div",35)(112,"label",36)(113,"strong"),e._uU(114,"EyE reciclables de metal"),e.qZA()(),e._UZ(115,"input",38),e.qZA(),e.TgZ(116,"div",35)(117,"label",36)(118,"strong"),e._uU(119,"EyE reciclables de pl\xe1sticos"),e.qZA()(),e._UZ(120,"input",39),e.qZA(),e.TgZ(121,"div",35)(122,"label",36)(123,"strong"),e._uU(124,"EyE no reciclables"),e.qZA()(),e._UZ(125,"input",40),e.qZA()()()()(),e.TgZ(126,"div",41)(127,"button",47),e._uU(128,"CANCELAR"),e.qZA(),e.TgZ(129,"button",43),e.NdJ("click",function(){return i.saveForm()}),e._uU(130,"ACEPTAR"),e.qZA()()()()()),2&t&&(e.xp6(12),e.Q6J("disabled",i.isok),e.xp6(26),e.Q6J("ngForOf",i.rates||e.DdM(8,bo)),e.xp6(1),e.Q6J("ngIf",i.popupVisible),e.xp6(1),e.Q6J("ngIf",i.popupModify),e.xp6(11),e.Q6J("formGroup",i.ratesForm),e.xp6(9),e.Q6J("ngForOf",i.defaultYear),e.xp6(37),e.Q6J("formGroup",i.ratesForm),e.xp6(7),e.Q6J("ngForOf",i.defaultYear))},dependencies:[p.sg,p.O5,c._Y,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.JL,c.sg,c.u],styles:[".list-process__dot[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]{width:100%!important;padding:1%}.red-button[_ngcontent-%COMP%]{background-color:red}.popup[_ngcontent-%COMP%]{position:absolute;top:calc(45% + 10px);left:60%;transform:translate(-50%,-50%);background-color:#fff;border:1px solid rgb(17,165,128);padding:20px;width:800px;border-radius:10px}@media (max-width: 768px){.popup[_ngcontent-%COMP%]{width:100%}}.btnLeft[_ngcontent-%COMP%]{margin-left:400px}@media (max-width: 768px){.btnLeft[_ngcontent-%COMP%]{margin-left:0}}.buttonRight[_ngcontent-%COMP%]{position:absolute;right:40px}.dark-background[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#00000080;z-index:1}.table-container[_ngcontent-%COMP%]{word-wrap:break-word;table-layout:fixed;width:100%;height:auto;overflow-x:hidden}"]}),a})();var ee=m(5332);let te=(()=>{class a{constructor(t){this.http=t,this.url=`${X.N.API_V1_URL}/goals`}getAllGoals(){return this.http.get(`${this.url}/goals`)}saveGoals(t){return this.http.post(`${this.url}/saveGoals`,t)}updateGoals(t){return this.http.put(`${this.url}/updateGoals`,t)}getGoalsYear(t){return this.http.get(`${this.url}/goalsYear/${t}`)}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(I.eN))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var q=m(2894);function Ao(a,n){1&a&&e._UZ(0,"div",37)}function Eo(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"div",33)(1,"div",34),e.NdJ("click",function(){const s=e.CHM(t),o=s.$implicit,r=s.index,l=e.oxw();return e.KtG(!o.isDisabled&&l.selectMonth(r))}),e.TgZ(2,"div",35),e._uU(3),e.qZA()(),e.YNc(4,Ao,1,0,"div",36),e.qZA()}if(2&a){const t=n.$implicit,i=e.oxw();e.ekj("past-month",t.isCurrent),e.xp6(1),e.ekj("selected-month",i.currentMonth===t.num),e.xp6(2),e.hij(" ",t.num," "),e.xp6(1),e.Q6J("ngIf",!i.isLastMonth(t))}}function vo(a,n){if(1&a&&(e.TgZ(0,"option",38),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}let Zo=(()=>{class a{constructor(t,i,s){this.dashboardService=t,this.goalsService=i,this.productorService=s,this.currentYear=(new Date).getFullYear(),this.years=[],this.selectedYear="",this.view=[600,300],this.view2=[500,300],this.bigView=[500,400],this.smallView=[400,300],this.legend=!1,this.colorScheme={domain:["#08a47c","#FCB241","#FFA500","#FF8C00","#FF7F50","#FF6347","#FF4500","#FF0000"]},this.colorBarras={domain:["#6FCF97","#9B51E0","#56CCF2","#F2C94C","#FFA69E","#FFCAD4","#D0F0C0","#F3C4FB"]},this.multi=[],this.multi2=[],this.multi2Original=[],this.showXAxis=!0,this.showYAxis=!0,this.gradient=!1,this.showLegend=!0,this.showXAxisLabel=!0,this.xAxisLabel="Material",this.xAxisLabel2="A\xf1os",this.showYAxisLabel=!0,this.yAxisLabel="Toneladas Valorizadas"}ngOnInit(){this.getDataCum(),this.getDataSemester(),this.getYearlyMaterialWeights(),this.getCountBusiness(),this.getAllTonByYear(),this.getAllGoals(),this.currentMonth=(new Date).getMonth()+1,this.months=[{num:1,name:"Ene",isCurrent:!1,isDisabled:!1},{num:2,name:"Feb",isCurrent:!1,isDisabled:!1},{num:3,name:"Mar",isCurrent:!1,isDisabled:!1},{num:4,name:"Abr",isCurrent:!1,isDisabled:!1},{num:5,name:"May",isCurrent:!1,isDisabled:!1},{num:6,name:"Jun",isCurrent:!1,isDisabled:!1},{num:7,name:"Jul",isCurrent:!1,isDisabled:!1},{num:8,name:"Ago",isCurrent:!1,isDisabled:!1},{num:9,name:"Sep",isCurrent:!1,isDisabled:!1},{num:10,name:"Oct",isCurrent:!1,isDisabled:!1},{num:11,name:"Nov",isCurrent:!1,isDisabled:!1},{num:12,name:"Dic",isCurrent:!1,isDisabled:!1}];for(let t=0;t<this.currentMonth;t++)this.months[t].isCurrent=!0;this.generateYears(),this.setDisabledMonths()}generateYears(){for(let t=2022;t<=this.currentYear;t++)this.years.push(t)}onYearChange(){this.selectedYear?(this.getDataSemester(),this.filterDataBasedOnYear()):this.showAllData()}showAllData(){this.multi2=[...this.multi2Original]}filterDataBasedOnYear(){this.selectedYear&&this.multi2Original&&(this.multi2=this.multi2Original.filter(t=>parseInt(t.name)>=this.selectedYear))}valueFormatting(t){return`${parseFloat(t).toFixed(2)}%`}isLastMonth(t){return!!this.months&&this.months.indexOf(t)===this.months.length-1}getDataCum(){this.dashboardService.getDashboard().subscribe({next:t=>{this.dashboardData=t.data,this.selectMonth(this.currentMonth-1)},error:t=>{console.log(t)}})}getAllTonByYear(){this.dashboardService.getAllTonByYear(this.currentYear-1).subscribe({next:t=>{this.pomPapel=t.data.statements[0].totalToneladas,this.pomMetal=t.data.statements[1].totalToneladas,this.pomPlastico=t.data.statements[2].totalToneladas,this.pomTotal=this.pomPapel+this.pomMetal+this.pomPlastico},error:t=>{console.log(t)}})}getAllGoals(){this.goalsService.getAllGoals().subscribe({next:t=>{const i=(new Date).getFullYear(),s=t.data.filter(o=>o.YEAR===i);for(const o of s)switch(o.TYPE_MATERIAL){case"0":this.globalGoal=o.PERCENTAGE_CUM;break;case"1":this.paperCardboardGoal=o.PERCENTAGE_CUM;break;case"2":this.metalGoal=o.PERCENTAGE_CUM;break;case"3":this.plasticGoal=o.PERCENTAGE_CUM}},error:t=>{console.log(t)}})}getDataSemester(){this.dashboardService.getSemesterDashboard().subscribe({next:t=>{this.multi=this.transformToSemesterData(t.data)},error:t=>{console.log(t)}})}transformToSemesterData(t){const i=[],s={};return t.forEach(o=>{o.year&&o.year>=this.selectedYear&&(s[o.name]||(s[o.name]={name:o.name,series:[]},i.push(s[o.name])),o.series.forEach(r=>{s[o.name].series.push({name:`${r.name} - ${o.year}`,value:r.value})}))}),i}getYearlyMaterialWeights(){this.dashboardService.getYearlyMaterialWeights().subscribe({next:t=>{this.multi2=[...t.data],this.multi2Original=[...t.data],this.selectedYear=this.currentYear,this.onYearChange()},error:t=>{console.log(t)}})}getCountBusiness(){let t;this.productorService.getBusinessByRolProductor().subscribe({next:i=>{i.data.res_business.length>0&&(t=i.data.res_business.length,this.count_business=t)},error:i=>{console.log(i)}})}transformDataForSelectedMonth(t){if(0===t.length)return[];const s=t.filter(l=>l.ANIO===this.currentYear)[0];if(!s)return[];const o=Array(9).fill(0);let r=Math.min(s.percentage,800);o[Math.floor(r/100)]=r%100;for(let l=Math.floor(r/100)-1;l>=0;l--)o[l]=100;return o.map((l,u)=>({name:`${100*u}-${100*(u+1)}`,value:Number(l.toFixed(2)),toneladas:parseFloat(s.value)})).filter(l=>l.value>0)}selectMonth(t){const i=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],s=this.dashboardData.filter(o=>o.MESES_ABREV===i[t]);this.currentMonth=t+1,this.graphCumGlobal=this.transformDataForSelectedMonth(s.filter(o=>"Global"===o.TYPE_MATERIAL)),this.graphCumPapel=this.transformDataForSelectedMonth(s.filter(o=>"Papel/Carton"===o.TYPE_MATERIAL)),this.graphCumMetal=this.transformDataForSelectedMonth(s.filter(o=>"Metal"===o.TYPE_MATERIAL)),this.graphCumPlastico=this.transformDataForSelectedMonth(s.filter(o=>"Plastico"===o.TYPE_MATERIAL)),this.single1=this.graphCumGlobal,this.single2=this.graphCumPapel,this.single3=this.graphCumMetal,this.single4=this.graphCumPlastico}setFormato(t){const i="string"==typeof t?parseFloat(t.replace(/,/g,"")):t,s=Math.round(100*i)/100,[o,r]=s.toString().split("."),l=o.replace(/\B(?=(\d{3})+(?!\d))/g,".");return r&&"0"!==r?`${l},${r.padEnd(2,"0")}`:l}setDisabledMonths(){const t=(new Date).getMonth()+1;for(let i of this.months)i.num>t&&(i.isDisabled=!0)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(ee.s),e.Y36(te),e.Y36(N.u))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-dashboard"]],decls:96,vars:58,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"gauge-container"],[1,"circle-container"],["class","circle-with-line",3,"past-month",4,"ngFor","ngForOf"],[1,"row","justify-content-start"],[1,"col-12","col-lg-6","mb-5"],[1,"gauge-container-graph-big"],[3,"view","scheme","results","valueFormatting"],[1,"chart-subtitle",2,"margin-left","130px"],[1,"toneladas-label",2,"margin-left","190px"],[1,"col-12","col-lg-5","mb-5",2,"margin-left","60px","margin-top","30px"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"table-metas"],[1,"row"],[1,"col-lg-4"],[1,"gauge-container-graph"],[1,"chart-subtitle-small"],[1,"toneladas-label"],[1,"legend"],["id","anioSelector",1,"select-btn",3,"ngModel","ngModelChange","change"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],[1,"chart-container"],[2,"text-align","center","font-size","medium"],[3,"view","scheme","results","gradient","xAxis","yAxis","legend","legendTitle","showXAxisLabel","showYAxisLabel","xAxisLabel","yAxisLabel","showDataLabel","dataLabelFormatting"],[1,"circle-with-line"],[3,"click"],[1,"month-circle"],["class","line",4,"ngIf"],[1,"line"],[3,"value"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",6),e._uU(8,"Dashboard CI - Productores"),e.qZA()()(),e.TgZ(9,"div",7)(10,"div",8),e.YNc(11,Eo,5,6,"div",9),e.qZA(),e.TgZ(12,"div",10)(13,"div",11)(14,"div",12),e._UZ(15,"ngx-charts-gauge",13),e.TgZ(16,"div",14),e._uU(17,"CUMPLIMIENTO GENERAL"),e.qZA(),e.TgZ(18,"p",15),e._uU(19),e.qZA()()(),e.TgZ(20,"div",16)(21,"div",17)(22,"div",18),e._uU(23," Tabla Metas "),e.qZA(),e.TgZ(24,"div",19)(25,"table",20)(26,"tbody")(27,"tr")(28,"td"),e._uU(29,"N\xb0 Socios"),e.qZA(),e.TgZ(30,"td"),e._uU(31),e.qZA()(),e.TgZ(32,"tr")(33,"td"),e._uU(34,"POM Total"),e.qZA(),e.TgZ(35,"td"),e._uU(36),e.qZA()(),e.TgZ(37,"tr")(38,"td"),e._uU(39,"POM Meta 2023"),e.qZA(),e.TgZ(40,"td"),e._uU(41),e.qZA()(),e.TgZ(42,"tr")(43,"td"),e._uU(44,"POM Meta Papel/Cart\xf3n 2023"),e.qZA(),e.TgZ(45,"td"),e._uU(46),e.qZA()(),e.TgZ(47,"tr")(48,"td"),e._uU(49,"POM Meta Metal 2023"),e.qZA(),e.TgZ(50,"td"),e._uU(51),e.qZA()(),e.TgZ(52,"tr")(53,"td"),e._uU(54,"POM Meta Pl\xe1stico 2023"),e.qZA(),e.TgZ(55,"td"),e._uU(56),e.qZA()()()()()()()(),e.TgZ(57,"div",21)(58,"div",22)(59,"div",23),e._UZ(60,"ngx-charts-gauge",13),e.TgZ(61,"div",24),e._uU(62,"CUMPLIMIENTO PAPEL/CART\xd3N"),e.qZA(),e.TgZ(63,"p",25),e._uU(64),e.qZA()()(),e.TgZ(65,"div",22)(66,"div",23),e._UZ(67,"ngx-charts-gauge",13),e.TgZ(68,"div",24),e._uU(69,"CUMPLIMIENTO METAL"),e.qZA(),e.TgZ(70,"p",25),e._uU(71),e.qZA()()(),e.TgZ(72,"div",22)(73,"div",23),e._UZ(74,"ngx-charts-gauge",13),e.TgZ(75,"div",24),e._uU(76,"CUMPLIMIENTO PL\xc1STICO"),e.qZA(),e.TgZ(77,"p",25),e._uU(78),e.qZA()()()(),e._UZ(79,"p",26),e.TgZ(80,"p",26),e._uU(81),e.qZA()(),e.TgZ(82,"select",27),e.NdJ("ngModelChange",function(o){return i.selectedYear=o})("change",function(){return i.onYearChange()}),e.TgZ(83,"option",28),e._uU(84,"Seleccionar A\xf1o"),e.qZA(),e.YNc(85,vo,2,2,"option",29),e.qZA(),e.TgZ(86,"div",30)(87,"div",21)(88,"div",11)(89,"div",31),e._uU(90," TONELADAS VALORIZADAS POR MATERIAL"),e.qZA(),e._UZ(91,"ngx-charts-bar-vertical-stacked",32),e.qZA(),e.TgZ(92,"div",11)(93,"div",31),e._uU(94," TONELADAS VALORIZADAS POR A\xd1O"),e.qZA(),e._UZ(95,"ngx-charts-bar-vertical-stacked",32),e.qZA()()()()),2&t&&(e.xp6(11),e.Q6J("ngForOf",i.months),e.xp6(4),e.Q6J("view",i.bigView)("scheme",i.colorScheme)("results",i.single1)("valueFormatting",i.valueFormatting),e.xp6(4),e.hij("TONELADAS: ",i.setFormato(null==i.single1||null==i.single1[0]?null:i.single1[0].toneladas),""),e.xp6(12),e.Oqu(i.count_business),e.xp6(5),e.hij("",i.setFormato(i.pomTotal)," Ton"),e.xp6(5),e.hij("",i.setFormato((i.pomPapel*i.paperCardboardGoal+i.pomMetal*i.metalGoal+i.pomPlastico*i.plasticGoal)*i.globalGoal)," Ton"),e.xp6(5),e.hij("",i.setFormato(i.pomPapel*i.paperCardboardGoal*i.globalGoal)," Ton"),e.xp6(5),e.hij("",i.setFormato(i.pomMetal*i.metalGoal*i.globalGoal)," Ton"),e.xp6(5),e.hij("",i.setFormato(i.pomPlastico*i.plasticGoal*i.globalGoal)," Ton"),e.xp6(4),e.Q6J("view",i.smallView)("scheme",i.colorScheme)("results",i.single2)("valueFormatting",i.valueFormatting),e.xp6(4),e.hij("TONELADAS: ",i.setFormato(null==i.single2||null==i.single2[0]?null:i.single2[0].toneladas),""),e.xp6(3),e.Q6J("view",i.smallView)("scheme",i.colorScheme)("results",i.single3)("valueFormatting",i.valueFormatting),e.xp6(4),e.hij("TONELADAS: ",i.setFormato(null==i.single3||null==i.single3[0]?null:i.single3[0].toneladas),""),e.xp6(3),e.Q6J("view",i.smallView)("scheme",i.colorScheme)("results",i.single4)("valueFormatting",i.valueFormatting),e.xp6(4),e.hij("TONELADAS: ",i.setFormato(null==i.single4||null==i.single4[0]?null:i.single4[0].toneladas),""),e.xp6(3),e.hij("La informaci\xf3n de este gr\xe1fico corresponde SOLO al a\xf1o ",i.currentYear,"."),e.xp6(1),e.Q6J("ngModel",i.selectedYear),e.xp6(3),e.Q6J("ngForOf",i.years),e.xp6(6),e.Q6J("view",i.view)("scheme",i.colorBarras)("results",i.multi)("gradient",i.gradient)("xAxis",i.showXAxis)("yAxis",i.showYAxis)("legend",i.showLegend)("legendTitle"," ")("showXAxisLabel",i.showXAxisLabel)("showYAxisLabel",i.showYAxisLabel)("xAxisLabel",i.xAxisLabel)("yAxisLabel",i.yAxisLabel)("showDataLabel",!0)("dataLabelFormatting",i.setFormato),e.xp6(4),e.Q6J("view",i.view2)("scheme",i.colorBarras)("results",i.multi2)("gradient",i.gradient)("xAxis",i.showXAxis)("yAxis",i.showYAxis)("legend",i.showLegend)("legendTitle"," ")("showXAxisLabel",i.showXAxisLabel)("showYAxisLabel",i.showYAxisLabel)("xAxisLabel",i.xAxisLabel2)("yAxisLabel",i.yAxisLabel)("showDataLabel",!0)("dataLabelFormatting",i.setFormato))},dependencies:[p.sg,p.O5,c.YN,c.Kr,c.EJ,c.JJ,c.On,q.XK,q.Ob],styles:[".gauge-item[_ngcontent-%COMP%]{position:relative}.gauge-container[_ngcontent-%COMP%]{border:1px solid #08a47c;border-radius:15px;padding:20px;margin-top:20px;margin-bottom:20px;display:flex;flex-direction:column}.gauge-container-graph[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center}.gauge-container-graph-big[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;text-align:left}.gauge-chart[_ngcontent-%COMP%]{align-self:center}.select-btn[_ngcontent-%COMP%]{margin-top:20px;background-color:#08a47c;color:#fff;border:none;border-radius:5px;padding:10px 20px;width:20%;display:flex;justify-content:space-between;align-items:center}.legend[_ngcontent-%COMP%]{font-size:18px;margin-top:20px;text-align:right}.chart-container[_ngcontent-%COMP%]{border:1px solid #08a47c;border-radius:15px;padding:20px;margin-top:20px;margin-bottom:20px}.chart-subtitle[_ngcontent-%COMP%]{font-size:20px;margin-top:-100px}.chart-subtitle-small[_ngcontent-%COMP%]{font-size:18px;margin-top:-60px}.toneladas-label[_ngcontent-%COMP%]{font-size:14px;font-weight:700;text-align:center;margin-top:10px}.progress-months-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-bottom:10px}.month-box[_ngcontent-%COMP%]{border:1px solid #000;padding:1px;margin-left:2px;font-size:.75rem;width:25px;text-align:center;color:#000;background-color:#fff}.card[_ngcontent-%COMP%]{box-shadow:0 4px 8px #0003;transition:.3s;border-radius:5px;border:1px solid #08a47c}.card-header[_ngcontent-%COMP%]{border-bottom:1px solid #08a47c;padding:10px;text-align:center;background-color:#f8f9fa}.card-body[_ngcontent-%COMP%]{padding:20px}.table-metas[_ngcontent-%COMP%]{border-collapse:collapse;width:90%;margin:auto}.table-metas[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:center;border-bottom:1px solid #08a47c;color:#000;background-color:#fff}.table-metas[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table-metas[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:8px}.table-metas[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#000;background-color:#fff}.circle-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.circle-with-line[_ngcontent-%COMP%]{display:flex;align-items:center}.month-circle[_ngcontent-%COMP%]{border:1px solid #000;padding:1px;margin:5px;font-size:.75rem;width:25px;height:25px;text-align:center;color:#000;background-color:#fff;border-radius:50%;display:flex;justify-content:center;align-items:center;cursor:pointer}.line[_ngcontent-%COMP%]{width:50px;height:1px;background-color:#000}.past-month[_ngcontent-%COMP%]   .month-circle[_ngcontent-%COMP%]{background-color:#08a47c;color:#fff}.past-month[_ngcontent-%COMP%]   .month-circle[_ngcontent-%COMP%]:hover{background-color:#8ccfbb;color:#000;transition:background-color .3s ease}.selected-month[_ngcontent-%COMP%]   .month-circle[_ngcontent-%COMP%]{background-color:#6afc76;color:#000}"]}),a})();function Mo(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"tr",52)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td")(8,"div",53)(9,"button",54),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.modify(o))}),e._uU(10,"Modificar"),e.qZA()()()()}if(2&a){const t=n.$implicit,i=e.oxw();e.xp6(2),e.Oqu(i.getYear(t)),e.xp6(2),e.Oqu(i.getMaterial(t)),e.xp6(2),e.Oqu((100*t.goal).toFixed(2).replace(".",","))}}const Co=function(a,n){return{"btn-info":a,"btn-primary":n}};function No(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"li")(1,"button",55),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.pagTo(o))}),e._uU(2),e.qZA()()}if(2&a){const t=n.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngClass",e.WLB(2,Co,i.pos===t+1,i.pos!==t+1)),e.xp6(1),e.Oqu(t+1)}}function xo(a,n){if(1&a&&(e.TgZ(0,"option",56),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function Ro(a,n){if(1&a&&(e.TgZ(0,"option",57),e._uU(1),e.qZA()),2&a){const t=n.$implicit,i=e.oxw();e.Q6J("value",t)("disabled",t!==i.selectedYear),e.xp6(1),e.Oqu(t)}}const Uo=function(){return[]};let qo=(()=>{class a{constructor(t,i){this.fb=t,this.goalsTsService=i,this.list=[],this.pos=1,this.cant=0,this.existingCode="",this.popupVisible=!1,this.popupModify=!1,this.id="",this.index=0,this.year=[],this.type=[],this.price=[],this.isok=!1,this.defaultYear=[],this.dbGoalsYear=[],this.goalsYear=[],this.goalsForm=this.fb.group({year:["0",[c.kI.required,c.kI.min(2021)]],type_0:["",[c.kI.required,c.kI.min(0),c.kI.max(100)]],type_1:["",[c.kI.required,c.kI.min(0),c.kI.max(100)]],type_2:["",[c.kI.required,c.kI.min(0),c.kI.max(100)]],type_3:["",[c.kI.required,c.kI.min(0),c.kI.max(100)]]}),this.isEditing=!1,this.dbGoals=[],this.goals=[]}modify(t){this.isEditing=!0,this.goalsForm.controls.year.setValue(this.getYear(t)),this.selectedYear=this.getYear(t);const i=(100*parseFloat(this.getCumpYear(this.list,this.selectedYear,"0"))).toFixed(2).replace(".",","),s=(100*parseFloat(this.getCumpYear(this.list,this.selectedYear,"1"))).toFixed(2).replace(".",","),o=(100*parseFloat(this.getCumpYear(this.list,this.selectedYear,"2"))).toFixed(2).replace(".",","),r=(100*parseFloat(this.getCumpYear(this.list,this.selectedYear,"3"))).toFixed(2).replace(".",",");this.goalsForm.controls.type_0.setValue(i),this.goalsForm.controls.type_1.setValue(s),this.goalsForm.controls.type_2.setValue(o),this.goalsForm.controls.type_3.setValue(r)}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.getAllGoals(),this.formData=this.fb.group({year:["",[c.kI.required]],type_0:["",[c.kI.required]],type_1:["",[c.kI.required]],type_2:["",[c.kI.required]],type_3:["",[c.kI.required]]});for(let t=2021;t<=(new Date).getFullYear()+1;t++)this.defaultYear.push(t)}saveForm(){if(this.goalsForm.controls.type_0.setValue(this.goalsForm.controls.type_0.getRawValue()?.toString().replace(",",".")||""),this.goalsForm.controls.type_1.setValue(this.goalsForm.controls.type_1.getRawValue()?.toString().replace(",",".")||""),this.goalsForm.controls.type_2.setValue(this.goalsForm.controls.type_2.getRawValue()?.toString().replace(",",".")||""),this.goalsForm.controls.type_3.setValue(this.goalsForm.controls.type_3.getRawValue()?.toString().replace(",",".")||""),this.goalsForm.invalid)return d().fire({icon:"warning",text:"Debe ingresar todos los campos. Todos los cumplimientos deben ser num\xe9ricos y mayores o iguales a 0 y menores o iguales a 100."}),this.goalsForm.controls.type_0.setValue(this.goalsForm.controls.type_0.getRawValue()?.toString().replace(".",",")||""),this.goalsForm.controls.type_1.setValue(this.goalsForm.controls.type_1.getRawValue()?.toString().replace(".",",")||""),this.goalsForm.controls.type_2.setValue(this.goalsForm.controls.type_2.getRawValue()?.toString().replace(".",",")||""),void this.goalsForm.controls.type_3.setValue(this.goalsForm.controls.type_3.getRawValue()?.toString().replace(".",",")||"");this.goalsForm.controls.type_0.setValue(this.goalsForm.controls.type_0.getRawValue()?.toString().replace(".",",")||""),this.goalsForm.controls.type_1.setValue(this.goalsForm.controls.type_1.getRawValue()?.toString().replace(".",",")||""),this.goalsForm.controls.type_2.setValue(this.goalsForm.controls.type_2.getRawValue()?.toString().replace(".",",")||""),this.goalsForm.controls.type_3.setValue(this.goalsForm.controls.type_3.getRawValue()?.toString().replace(".",",")||"");const t=/^[0-9]+(,[0-9]+)?$/;t.test(this.goalsForm.value.type_0)&&t.test(this.goalsForm.value.type_1)&&t.test(this.goalsForm.value.type_2)&&t.test(this.goalsForm.value.type_3)?this.isEditing?this.goalsTsService.updateGoals(this.goalsForm.value).subscribe({next:i=>{i.status?(this.getAllGoals(),document.getElementById("closeModallll")?.click(),document.getElementById("closeModallll2")?.click()):(document.getElementById("closeModallll")?.click(),document.getElementById("closeModallll2")?.click(),d().fire({icon:"error",text:i.msg+""}))}}):this.goalsTsService.saveGoals(this.goalsForm.value).subscribe({next:i=>{i.status?(this.getAllGoals(),document.getElementById("closeModallll")?.click()):d().fire({icon:"error",text:i.msg})}}):d().fire({icon:"warning",text:"Separador de miles con punto y separador de decimales con coma. M\xe1ximo 2 decimales"})}getAllGoals(){this.list=[],this.goals=[],this.dbGoals=[],this.year=[],this.type=[],this.price=[],this.goalsTsService.getAllGoals().subscribe({next:t=>{t.status&&(this.dbGoals=t.data,this.dbGoals.forEach(i=>{const s=this.goals.findIndex(o=>o.year_material==i.YEAR+"_"+i.TYPE_MATERIAL);s>-1?this.goals[s].goal.push(i.PERCENTAGE_CUM):this.goals.push({year_material:i.YEAR+"_"+i.TYPE_MATERIAL,goal:i.PERCENTAGE_CUM})}),this.goals.length==(new Date).getFullYear()-2021+2&&(this.isok=!0),this.list=this.goals,this.cant=Math.ceil(this.goals.length/10)||1,this.goals=this.list.slice(0,10))},error:t=>{d().close(),d().fire({icon:"error",text:t.msg,title:"\xa1Ups!"})}})}getGoalsYear(t){this.goalsYear=[],this.dbGoalsYear=[],this.goalsTsService.getGoalsYear(t).subscribe({next:i=>{i.status&&(this.dbGoalsYear=i.data,this.dbGoalsYear.forEach(s=>{const o=this.goalsYear.findIndex(r=>r.material==s.TYPE_MATERIAL);o>-1?this.goalsYear[o].goal.push(s.PERCENTAGE_CUM):this.goalsYear.push({material:s.TYPE_MATERIAL,goal:s.PERCENTAGE_CUM})}))},error:i=>{d().close(),d().fire({icon:"error",text:i.msg,title:"\xa1Ups!"})}})}getYear(t){return t.year_material.split("_")[0]}getMaterial(t){switch(t.year_material.split("_")[1]){case"1":return"Papel";case"2":return"Metal";case"3":return"Pl\xe1stico";default:return"Global"}}getCumpYear(t,i,s){const o=t.findIndex(r=>r.year_material==i+"_"+s);return this.list[o].goal||0}pagTo(t){this.pos=t+1,this.goals=this.list.slice(10*t,10*(t+1))}next(){this.pos>=this.cant||(this.pos++,this.goals=this.list.slice(10*(this.pos-1),10*this.pos))}previus(){this.pos-1<=0||this.pos>=this.cant+1||(this.pos=this.pos-1,this.goals=this.list.slice(10*(this.pos-1),10*this.pos))}setArrayFromNumber(){return new Array(this.cant)}visiblePageNumbers(){const t=this.setArrayFromNumber().length,i=[];if(t<=15)for(let s=0;s<t;s++)i.push(s);else{let s=Math.max(0,this.pos-Math.floor(7.5)),o=Math.min(t-1,s+14);o-s+1<15&&(o=t-1,s=Math.max(0,o-14));for(let r=s;r<=o;r++)i.push(r)}return i}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(c.qu),e.Y36(te))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-maintainer-goals"]],decls:140,vars:8,consts:[["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],[1,"buttonRight"],["data-bs-toggle","modal","data-bs-target","#addModal",1,"btn","btn-primary",3,"disabled","click"],[2,"height","50px"],[1,"row","mb-3"],[1,"col-md-12"],[1,"table-responsive","mb-4"],[1,"row","w-100"],["id","table",1,"w-100"],["table1",""],[1,"w-100"],[1,"table-container","table","table-even","table-section","table-borderless","table-border","table-radius","d-lg-table"],[1,"text-center","w-100"],["class","text-end w-100",4,"ngFor","ngForOf"],["aria-label","Navegaci\xf3n resultados"],[1,"pagination"],[1,"btn","btn-primary",3,"click"],[4,"ngFor","ngForOf"],["id","addModal","tabindex","-1","role","dialog","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title",2,"color","rgb(0, 138, 92)"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[3,"formGroup"],[1,"container"],[1,"row"],[1,"col-md-6"],[2,"color","rgb(0, 138, 92)"],["formControlName","year",1,"form-select","mb-4"],["value","0"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-12","mb-4"],["for","",2,"color","rgb(0, 138, 92)"],["type","text","formControlName","type_0",1,"form-control"],["type","text","formControlName","type_1",1,"form-control"],["type","text","formControlName","type_2",1,"form-control"],["type","text","formControlName","type_3",1,"form-control"],[1,"modal-footer"],["type","button","id","closeModallll","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","button",1,"btn","btn-primary",3,"click"],["id","exampleModal2","tabindex","-1","role","dialog","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],["formControlName","year",1,"form-control","mb-4"],[3,"value","disabled",4,"ngFor","ngForOf"],["type","text","formControlName","type_0","max","100",1,"form-control"],["type","button","id","closeModallll2","data-bs-dismiss","modal",1,"btn","btn-secondary"],[1,"text-end","w-100"],[1,"btn-group"],["data-bs-toggle","modal","data-bs-target","#exampleModal2",1,"btn","btn-success","btn-sm",3,"click"],[1,"border","btn","btn-sm",3,"ngClass","click"],[3,"value"],[3,"value","disabled"]],template:function(t,i){1&t&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"i",4),e._uU(5," Inicio"),e.qZA()(),e.TgZ(6,"li",2)(7,"a",3),e._uU(8,"Mantenedor Metas"),e.qZA()()()(),e.TgZ(9,"h1"),e._uU(10,"Metas"),e.qZA(),e.TgZ(11,"div",5)(12,"button",6),e.NdJ("click",function(){return i.goalsForm.reset({year:"0"}),i.isEditing=!1}),e._uU(13,"Agregar Metas"),e.qZA()(),e._UZ(14,"div",7),e.TgZ(15,"div",8),e._UZ(16,"div",9),e.qZA(),e.TgZ(17,"div",10)(18,"section")(19,"div",11)(20,"div",12,13)(22,"div",14)(23,"table",15)(24,"thead")(25,"tr",16)(26,"th"),e._uU(27,"A\xf1o"),e.qZA(),e.TgZ(28,"th"),e._uU(29,"Material"),e.qZA(),e.TgZ(30,"th"),e._uU(31,"Cumplimiento"),e.qZA(),e._UZ(32,"th"),e.qZA()(),e.TgZ(33,"tbody"),e.YNc(34,Mo,11,3,"tr",17),e.qZA()(),e.TgZ(35,"nav",18)(36,"ul",19)(37,"li")(38,"button",20),e.NdJ("click",function(){return i.pagTo(0)}),e._uU(39,"Primero"),e.qZA()(),e.TgZ(40,"li")(41,"button",20),e.NdJ("click",function(){return i.previus()}),e._uU(42,"Anterior"),e.qZA()(),e.YNc(43,No,3,5,"li",21),e.TgZ(44,"li")(45,"button",20),e.NdJ("click",function(){return i.next()}),e._uU(46,"Siguiente"),e.qZA()(),e.TgZ(47,"li")(48,"button",20),e.NdJ("click",function(){return i.pagTo(i.cant-1)}),e._uU(49,"\xdaltimo"),e.qZA()()()()()()()()(),e.TgZ(50,"div",22)(51,"div",23)(52,"div",24)(53,"div",25)(54,"h5",26),e._uU(55,"Formulario Metas"),e.qZA(),e.TgZ(56,"button",27)(57,"span",28),e._uU(58,"\xd7"),e.qZA()()(),e.TgZ(59,"div",29)(60,"form",30)(61,"div",31)(62,"div",32)(63,"div",33)(64,"strong",34),e._uU(65,"A\xf1o"),e.qZA(),e.TgZ(66,"select",35)(67,"option",36),e._uU(68,"Seleccionar a\xf1o"),e.qZA(),e.YNc(69,xo,2,2,"option",37),e.qZA()()(),e.TgZ(70,"div",32)(71,"div",38)(72,"label",39)(73,"strong"),e._uU(74,"% Cumplimiento global"),e.qZA()(),e._UZ(75,"input",40),e.qZA(),e.TgZ(76,"div",38)(77,"label",39)(78,"strong"),e._uU(79,"% Cumplimiento papel"),e.qZA()(),e._UZ(80,"input",41),e.qZA(),e.TgZ(81,"div",38)(82,"label",39)(83,"strong"),e._uU(84,"% Cumplimiento metal"),e.qZA()(),e._UZ(85,"input",42),e.qZA(),e.TgZ(86,"div",38)(87,"label",39)(88,"strong"),e._uU(89,"% Cumplimiento pl\xe1stico"),e.qZA()(),e._UZ(90,"input",43),e.qZA()()()()(),e.TgZ(91,"div",44)(92,"button",45),e._uU(93,"CANCELAR"),e.qZA(),e.TgZ(94,"button",46),e.NdJ("click",function(){return i.saveForm()}),e._uU(95,"ACEPTAR"),e.qZA()()()()(),e.TgZ(96,"div",47)(97,"div",23)(98,"div",24)(99,"div",25)(100,"h5",26),e._uU(101,"Formulario Tarifas"),e.qZA(),e.TgZ(102,"button",27)(103,"span",28),e._uU(104,"\xd7"),e.qZA()()(),e.TgZ(105,"div",29)(106,"form",30)(107,"div",31)(108,"div",32)(109,"div",33)(110,"strong",34),e._uU(111,"A\xf1o"),e.qZA(),e.TgZ(112,"select",48),e.YNc(113,Ro,2,3,"option",49),e.qZA()()(),e.TgZ(114,"div",32)(115,"div",38)(116,"label",39)(117,"strong"),e._uU(118,"% Cumplimiento global"),e.qZA()(),e._UZ(119,"input",50),e.qZA(),e.TgZ(120,"div",38)(121,"label",39)(122,"strong"),e._uU(123,"% Cumplimiento papel"),e.qZA()(),e._UZ(124,"input",41),e.qZA(),e.TgZ(125,"div",38)(126,"label",39)(127,"strong"),e._uU(128,"% Cumplimiento metal"),e.qZA()(),e._UZ(129,"input",42),e.qZA(),e.TgZ(130,"div",38)(131,"label",39)(132,"strong"),e._uU(133,"% Cumplimiento pl\xe1stico"),e.qZA()(),e._UZ(134,"input",43),e.qZA()()()()(),e.TgZ(135,"div",44)(136,"button",51),e._uU(137,"CANCELAR"),e.qZA(),e.TgZ(138,"button",46),e.NdJ("click",function(){return i.saveForm()}),e._uU(139,"ACEPTAR"),e.qZA()()()()()),2&t&&(e.xp6(12),e.Q6J("disabled",i.isok),e.xp6(22),e.Q6J("ngForOf",i.goals||e.DdM(7,Uo)),e.xp6(9),e.Q6J("ngForOf",i.visiblePageNumbers()),e.xp6(17),e.Q6J("formGroup",i.goalsForm),e.xp6(9),e.Q6J("ngForOf",i.defaultYear),e.xp6(37),e.Q6J("formGroup",i.goalsForm),e.xp6(7),e.Q6J("ngForOf",i.defaultYear))},dependencies:[p.mk,p.sg,c._Y,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.JL,c.sg,c.u],styles:[".list-process__dot[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]{width:100%!important;padding:1%}.red-button[_ngcontent-%COMP%]{background-color:red}.popup[_ngcontent-%COMP%]{position:absolute;top:calc(45% + 10px);left:60%;transform:translate(-50%,-50%);background-color:#fff;border:1px solid rgb(17,165,128);padding:20px;width:800px;border-radius:10px}@media (max-width: 768px){.popup[_ngcontent-%COMP%]{width:100%}}.btnLeft[_ngcontent-%COMP%]{margin-left:400px}@media (max-width: 768px){.btnLeft[_ngcontent-%COMP%]{margin-left:0}}.buttonRight[_ngcontent-%COMP%]{position:absolute;right:40px}.dark-background[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#00000080;z-index:1}.table-container[_ngcontent-%COMP%]{word-wrap:break-word;table-layout:fixed;width:100%;height:auto;overflow-x:hidden}"]}),a})();function Fo(a,n){if(1&a&&(e.TgZ(0,"option",16),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function So(a,n){if(1&a&&(e.TgZ(0,"option",16),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.Q6J("value",t.ID),e.xp6(1),e.Oqu(t.NAME)}}let Po=(()=>{class a{constructor(t,i){this.dashboardService=t,this.businessService=i,this.years=[],this.currentYear=(new Date).getFullYear(),this.selectedYear=this.currentYear,this.view=[1200,400],this.view_barras=[600,400],this.gradient=!1,this.colorScheme={domain:["#08a47c","#FCB241","#d32f2f","#1976D2","#388E3C","#8E24AA","#FBC02D"]},this.lineChartData=[],this.barChartData=[],this.normalizedBarChartData=[],this.companies=[],this.selectedCompany="Todas"}ngOnInit(){for(let t=2023;t<=this.currentYear;t++)this.years.push(t);this.loadData(),this.loadBarChartData(),this.loadAllStackedChartData(),this.loadCompanies()}loadCompanies(){this.businessService.getAllBusiness().subscribe(t=>{this.companies=[{ID:"Todas",NAME:"Todas"},...t.status]})}loadData(){"Todas"===this.selectedCompany?this.dashboardService.getAllLinearDashboard(this.selectedYear).subscribe(t=>{this.lineChartData=t.data}):this.dashboardService.getLinearDashboard(this.selectedYear,this.selectedCompany).subscribe(t=>{this.lineChartData=t.data})}onYearChange(){this.loadData(),this.loadBarChartData(),this.loadAllStackedChartData()}loadBarChartData(){"Todas"===this.selectedCompany?this.dashboardService.getAllBarChartData(this.selectedYear).subscribe(t=>{this.barChartData=t.data,this.barChartData[0].name=this.barChartData[0].name+" - "+this.selectedYear,this.barChartData[1].name=this.barChartData[1].name+" - "+this.selectedYear}):this.dashboardService.getBarChartDataByCompanyId(this.selectedYear,this.selectedCompany).subscribe(t=>{this.barChartData=t.data,this.barChartData[0].name=this.barChartData[0].name+" - "+this.selectedYear,this.barChartData[1].name=this.barChartData[1].name+" - "+this.selectedYear})}loadAllStackedChartData(){"Todas"===this.selectedCompany?this.dashboardService.getAllStackedBarChartData(this.selectedYear).subscribe(t=>{this.normalizedBarChartData=t.data,this.normalizedBarChartData[0].name=this.normalizedBarChartData[0].name+" - "+this.selectedYear,this.normalizedBarChartData[1].name=this.normalizedBarChartData[1].name+" - "+this.selectedYear,this.normalizedBarChartData[2].name=this.normalizedBarChartData[2].name+" - "+this.selectedYear,this.normalizedBarChartData[3].name=this.normalizedBarChartData[3].name+" - "+this.selectedYear,this.normalizedBarChartData[4].name=this.normalizedBarChartData[4].name+" - "+this.selectedYear}):this.dashboardService.getStackedBarChartDataByCompanyId(this.selectedYear,this.selectedCompany).subscribe(t=>{this.normalizedBarChartData=t.data,this.normalizedBarChartData[0].name=this.normalizedBarChartData[0].name+" - "+this.selectedYear,this.normalizedBarChartData[1].name=this.normalizedBarChartData[1].name+" - "+this.selectedYear,this.normalizedBarChartData[2].name=this.normalizedBarChartData[2].name+" - "+this.selectedYear,this.normalizedBarChartData[3].name=this.normalizedBarChartData[3].name+" - "+this.selectedYear,this.normalizedBarChartData[4].name=this.normalizedBarChartData[4].name+" - "+this.selectedYear})}onCompanyChange(){this.loadData(),this.loadBarChartData(),this.loadAllStackedChartData()}setFormato(t){const i="string"==typeof t?parseFloat(t.replace(/,/g,"")):t,s=Math.round(100*i)/100,[o,r]=s.toString().split("."),l=o.replace(/\B(?=(\d{3})+(?!\d))/g,".");return r&&"0"!==r?`${l},${r.padEnd(2,"0")}`:l}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(ee.s),e.Y36(R.m))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-dashboard-ci-gestores"]],decls:33,vars:45,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"select-container"],[1,"select-btn",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[1,"gauge-container"],[2,"text-align","center","font-size","medium"],[3,"view","scheme","results","gradient","xAxis","yAxis","legend","legendTitle","showXAxisLabel","showYAxisLabel","xAxisLabel","yAxisLabel","yAxisTickFormatting"],[1,"row"],[1,"col-12","col-lg-6","mb-5"],[3,"view","scheme","results","gradient","xAxis","yAxis","legend","legendTitle","showXAxisLabel","showYAxisLabel","xAxisLabel","yAxisLabel","yAxisTickFormatting","dataLabelFormatting"],[3,"value"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",6),e._uU(8,"Dashboard CI - Gestores"),e.qZA()()(),e.TgZ(9,"div",7)(10,"label"),e._uU(11,"A\xf1o:"),e.qZA(),e.TgZ(12,"select",8),e.NdJ("ngModelChange",function(o){return i.selectedYear=o})("change",function(){return i.onYearChange()}),e.YNc(13,Fo,2,2,"option",9),e.qZA()(),e.TgZ(14,"div",7)(15,"label"),e._uU(16,"Empresa:"),e.qZA(),e.TgZ(17,"select",8),e.NdJ("ngModelChange",function(o){return i.selectedCompany=o})("change",function(){return i.onCompanyChange()}),e.YNc(18,So,2,2,"option",9),e.qZA()(),e.TgZ(19,"div",10)(20,"div",11),e._uU(21," TONELADAS VALORIZADAS VS DECLARADAS POR MES"),e.qZA(),e._UZ(22,"ngx-charts-line-chart",12),e.qZA(),e.TgZ(23,"div",10)(24,"div",13)(25,"div",14)(26,"div",11),e._uU(27," TONELADAS VALORIZADAS VS DECLARADAS POR A\xd1O"),e.qZA(),e._UZ(28,"ngx-charts-bar-vertical",15),e.qZA(),e.TgZ(29,"div",14)(30,"div",11),e._uU(31," TONELADAS VALORIZADAS POR MATERIAL Y TRATAMIENTO POR A\xd1O"),e.qZA(),e._UZ(32,"ngx-charts-bar-vertical-stacked",15),e.qZA()()()()),2&t&&(e.xp6(12),e.Q6J("ngModel",i.selectedYear),e.xp6(1),e.Q6J("ngForOf",i.years),e.xp6(4),e.Q6J("ngModel",i.selectedCompany),e.xp6(1),e.Q6J("ngForOf",i.companies),e.xp6(4),e.Q6J("view",i.view)("scheme",i.colorScheme)("results",i.lineChartData)("gradient",i.gradient)("xAxis",!0)("yAxis",!0)("legend",!0)("legendTitle"," ")("showXAxisLabel",!0)("showYAxisLabel",!0)("xAxisLabel","Mes")("yAxisLabel","Toneladas")("yAxisTickFormatting",i.setFormato),e.xp6(6),e.Q6J("view",i.view_barras)("scheme",i.colorScheme)("results",i.barChartData)("gradient",i.gradient)("xAxis",!0)("yAxis",!0)("legend",!0)("legendTitle"," ")("showXAxisLabel",!0)("showYAxisLabel",!0)("xAxisLabel","")("yAxisLabel","Toneladas")("yAxisTickFormatting",i.setFormato)("dataLabelFormatting",i.setFormato),e.xp6(4),e.Q6J("view",i.view_barras)("scheme",i.colorScheme)("results",i.normalizedBarChartData)("gradient",i.gradient)("xAxis",!0)("yAxis",!0)("legend",!0)("legendTitle"," ")("showXAxisLabel",!0)("showYAxisLabel",!0)("xAxisLabel","Material")("yAxisLabel","Toneladas Valorizadas")("yAxisTickFormatting",i.setFormato)("dataLabelFormatting",i.setFormato))},dependencies:[p.sg,c.YN,c.Kr,c.EJ,c.JJ,c.On,q.K$,q.XK,q.Dw],styles:[".select-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:20px}label[_ngcontent-%COMP%]{display:inline-block;width:80px;font-size:18px;font-weight:700;margin-right:10px}.select-btn[_ngcontent-%COMP%]{background-color:#08a47c;color:#fff;border:none;border-radius:5px;padding:10px 20px;width:250px;-webkit-appearance:none;appearance:none;position:relative}.gauge-container[_ngcontent-%COMP%]{border:1px solid #08a47c;border-radius:15px;padding:20px;margin-top:20px;margin-bottom:20px;display:flex;flex-direction:column}"]}),a})();var y=m(554);function Io(a,n){if(1&a&&(e.TgZ(0,"option",21),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}let Do=(()=>{class a{constructor(t,i,s,o,r){this.businesService=t,this.productorService=i,this.consumerService=s,this.ls=o,this.ratesService=r,this.years=[],this.selectedYear=-1,this.listBusiness=[],this.listStatements=[],this.filteredListBusiness=[],this.allUF=[];const l=(new Date).getFullYear();for(let u=2022;u<=l;u++)this.years.push(u);this.years.sort((u,h)=>h-u)}ngOnInit(){}getAllBusiness(){this.businesService.getAllBusiness().subscribe({next:t=>{this.listBusiness=t.status},error:t=>{d().close(),d().fire({icon:"error",text:t.msg,title:"\xa1Ups!"})}})}loadStatements(t){this.productorService.getAllStatementByYear(t).subscribe(i=>{i.status&&(this.listStatements=i.data.res_business.sort((s,o)=>s.STATE===o.STATE?s.ID_BUSINESS-o.ID_BUSINESS:o.STATE-s.STATE),this.filteredListBusiness=this.listBusiness.filter(s=>!this.listStatements.some(o=>o.ID_BUSINESS===s.ID)))})}generarExcel(){const t=parseInt(document.getElementById("f_year").value);d().fire({title:"Generando Excel",text:"Esto puede tardar varios minutos",timerProgressBar:!0,showConfirmButton:!1,allowEscapeKey:!1,allowOutsideClick:!1}),d().showLoading(),this.consumerService.downloadExcelDeclarationCI(t).subscribe({next:i=>{if(i){const s=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});let o=document.createElement("a");o.href=window.URL.createObjectURL(s),o.download=`Declaraciones_CI_${t}`,document.body.appendChild(o),o.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),o.remove(),window.URL.revokeObjectURL(o.href),d().close()}},error:i=>{d().fire({icon:"error",text:"Ha sucedido un error al generar el archivo Excel, por favor pruebe de nuevo en unos minutos. Si el problema persiste p\xf3ngase en contacto con administraci\xf3n"})}})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(R.m),e.Y36(N.u),e.Y36(y.h),e.Y36(D),e.Y36(F.z))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-maintainer-declarations-ci"]],decls:28,vars:3,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"declaracion"],[1,"d-sm-flex","justify-content-between","mb-3","mb-md-0"],[1,"box","box-form","mb-4"],[1,"row","align-items-end"],[1,"col-12","col-xl-8","mb-5","mb-xl-0"],[1,"form-label"],[1,"input-group"],["id","f_year",1,"form-select","col-12","w-100",3,"ngModel","ngModelChange"],["value","-1","selected",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-12","col-xl-4","mb-3","mb-xl-0"],[1,"row"],[1,"col-12"],[1,"btn","btn-primary","col-12","btn-lg",3,"disabled","click"],[3,"value"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",6),e._uU(8,"Declaraciones Consumidores Industriales"),e.qZA()()(),e.TgZ(9,"section",7)(10,"h1"),e._uU(11,"Declaraciones Consumidores Industriales"),e.qZA(),e._UZ(12,"div",8),e.TgZ(13,"div",9)(14,"div",10)(15,"div",11)(16,"label",12),e._uU(17,"A\xf1o:"),e.qZA(),e.TgZ(18,"div",13)(19,"select",14),e.NdJ("ngModelChange",function(o){return i.selectedYear=o}),e.TgZ(20,"option",15),e._uU(21,"Seleccionar a\xf1o de declaraci\xf3n"),e.qZA(),e.YNc(22,Io,2,2,"option",16),e.qZA()()(),e.TgZ(23,"div",17)(24,"div",18)(25,"div",19)(26,"button",20),e.NdJ("click",function(){return i.generarExcel()}),e._uU(27," Generar Excel "),e.qZA()()()()()()()()),2&t&&(e.xp6(19),e.Q6J("ngModel",i.selectedYear),e.xp6(3),e.Q6J("ngForOf",i.years),e.xp6(4),e.Q6J("disabled",-1===i.selectedYear||"-1"===i.selectedYear.toString()))},dependencies:[p.sg,c.YN,c.Kr,c.EJ,c.JJ,c.On],styles:["[_nghost-%COMP%]{width:40%!important;padding:1%}"]}),a})();var yo=m(9300),ie=m(805),O=m(1770);function Oo(a,n){if(1&a&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.xp6(1),e.Oqu(t.label)}}function wo(a,n){if(1&a&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.xp6(1),e.Oqu(t.label)}}function Lo(a,n){if(1&a&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.xp6(1),e.Oqu(t.label)}}function Bo(a,n){if(1&a&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.xp6(1),e.Oqu(t.label)}}function Yo(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"section",28)(3,"input",29),e.NdJ("ngModelChange",function(s){const r=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.checkboxState[r.ID_HEADER]=s)}),e.qZA()()(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.qZA(),e.TgZ(14,"td"),e._uU(15),e.qZA(),e.TgZ(16,"td"),e._uU(17),e.ALo(18,"date"),e.qZA(),e.TgZ(19,"td"),e._UZ(20,"span",30),e.qZA(),e.TgZ(21,"td")(22,"a",31),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.goToDetails(o.ID_HEADER,o.ID_DETAIL))}),e._UZ(23,"i",32),e.qZA()()()}if(2&a){const t=n.$implicit,i=e.oxw();e.xp6(3),e.Q6J("ngModel",i.checkboxState[t.ID_HEADER])("disabled",!t.HAS_MV),e.xp6(2),e.Oqu(t.NAME_BUSINESS),e.xp6(2),e.Oqu(t.NAME_ESTABLISHMENT_REGION),e.xp6(2),e.Oqu(t.TipoTratamiento),e.xp6(2),e.Oqu(t.PRECEDENCE),e.xp6(2),e.Oqu(t.TYPE_RESIDUE),e.xp6(2),e.hij(" ",i.formatValue(t.VALUE)," "),e.xp6(2),e.Oqu(e.xi3(18,10,t.FechaRetiro,"dd-MM-yyyy")),e.xp6(3),e.Q6J("ngClass",t.semaforo?"circle green-circle":"circle red-circle")}}const ko=function(a,n){return{"btn-info":a,"btn-primary":n}};function Jo(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"li")(1,"button",33),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.pagTo(o))}),e._uU(2),e.qZA()()}if(2&a){const t=n.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngClass",e.WLB(2,ko,i.pos===t+1,i.pos!==t+1)),e.xp6(1),e.Oqu(t+1)}}function Vo(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"tr",23)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td")(4,"a",25),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.downloadFile(o.ID,o.FILE_NAME))}),e._uU(5),e.qZA()()()}if(2&a){const t=n.$implicit;e.xp6(2),e.Oqu(t.TYPE_FILE_TIPEADO),e.xp6(3),e.Oqu(t.FILE_NAME)}}function Go(a,n){if(1&a&&(e.TgZ(0,"div"),e._UZ(1,"div",21),e.TgZ(2,"table",22)(3,"thead")(4,"tr",23)(5,"th"),e._uU(6,"Tipo MV"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Nombre Archivo"),e.qZA()()(),e.TgZ(9,"tbody"),e.YNc(10,Vo,6,2,"tr",24),e.qZA()()()),2&a){const t=e.oxw();e.xp6(10),e.Q6J("ngForOf",t.MV_consulta)}}function Ho(a,n){1&a&&(e.TgZ(0,"div",26),e._uU(1," No existen medios de verificaci\xf3n para esta declaraci\xf3n. "),e.qZA())}function $o(a,n){if(1&a&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.xp6(1),e.Oqu(t.label)}}function jo(a,n){if(1&a&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.xp6(1),e.Oqu(t.label)}}function Ko(a,n){if(1&a&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.xp6(1),e.Oqu(t.label)}}function Xo(a,n){if(1&a&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&a){const t=n.$implicit;e.xp6(1),e.Oqu(t.label)}}function Wo(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.ALo(13,"date"),e.qZA(),e.TgZ(14,"td",23)(15,"button",28),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.navigateToForm(o.ID))}),e._uU(16,"Ver detalle "),e._UZ(17,"i",29),e.qZA()()()}if(2&a){const t=n.$implicit;e.xp6(2),e.Oqu(t.CODE_BUSINESS),e.xp6(2),e.Oqu(t.NAME_BUSINESS),e.xp6(2),e.Oqu(t.YEAR_STATEMENT),e.xp6(2),e.Oqu(1==t.STATE?"Enviada":0==t.STATE?"Borrador":"Pendiente"),e.xp6(2),e.Oqu(null!==t.AMOUNT_UF?t.AMOUNT_UF.toFixed(2).replace(".",","):"-"),e.xp6(2),e.Oqu(e.xi3(13,6,t.UPDATED_AT,"dd-MM-yyyy H:mm:ss"))}}const ea=function(a,n){return{"btn-info":a,"btn-primary":n}};function ta(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"li")(1,"button",30),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.pagTo(o))}),e._uU(2),e.qZA()()}if(2&a){const t=n.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngClass",e.WLB(2,ea,i.pos===t+1,i.pos!==t+1)),e.xp6(1),e.Oqu(t+1)}}function oa(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"tr",39)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td")(4,"a",41),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.downloadFile(o.ID,o.FILE_NAME))}),e._uU(5),e.qZA()()()}if(2&a){const t=n.$implicit;e.xp6(2),e.Oqu(t.TYPE_MATERIAL_TIPEADO),e.xp6(3),e.Oqu(t.FILE_NAME)}}function aa(a,n){if(1&a&&(e.TgZ(0,"div")(1,"table",38)(2,"thead")(3,"tr",39)(4,"th"),e._uU(5,"Tipo MV"),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Nombre Archivo"),e.qZA()()(),e.TgZ(8,"tbody"),e.YNc(9,oa,6,2,"tr",40),e.qZA()()()),2&a){const t=e.oxw();e.xp6(9),e.Q6J("ngForOf",t.MV_consulta)}}function sa(a,n){1&a&&(e.TgZ(0,"div",42),e._uU(1," No existen medios de verificaci\xf3n para esta declaraci\xf3n. "),e.qZA())}const na=[{path:"",component:se.$,children:[{path:"home",component:re},{path:"profile",component:vt},{path:"business",component:Et},{path:"establishment",component:Bt},{path:"users",component:bi},{path:"declarations",component:Ei},{path:"declarations-ci",component:Do},{path:"rates",component:To},{path:"goals",component:qo},{path:"faq",component:Ti.v},{path:"managers",component:Pi},{path:"logs",component:Ii},{path:"dashboard-ci-productor",component:Zo},{path:"dashboard-ci-gestor",component:Po},{path:"visualizar-mv",component:(()=>{class a{constructor(t,i,s){this.establishmentService=t,this.consumer=i,this.router=s,this.checkboxState={},this.dbStatements=[],this.db=[],this.pos=1,this.business_name=[],this.establishment_name=[],this.material_name=[],this.treatment_name=[],this.years=[],this.cant=0,this.filteredStatements=[],this.filteredBusinesses=[],this.filteredEstablishments=[],this.filteredMaterial=[],this.filteredYear=[],this.selectedBusiness="-1",this.selectedEstablishment="-1",this.selectedMaterial="-1",this.selectedYear="-1",this.filtersApplied=!1,this.autoFilter=!0,this.router.events.pipe((0,yo.h)(o=>o instanceof Z.m2)).subscribe(o=>{this.isRelevantRoute(o.urlAfterRedirects)||(this.resetFilters(),this.saveState())})}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.loadState(),this.loadStatements().then(()=>{this.updateFilters(),this.filtersApplied||(this.filter(),this.pagTo(this.pos-1),this.filtersApplied=!0)})}isRelevantRoute(t){return"/mantenedor/visualizar-mv"===t||t.startsWith("/mantenedor/visualizar-mv/")&&!t.endsWith("/visualizar-mv")}formatValue(t){return t%1==0?t.toString():t.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})}resetFilters(){this.selectedBusiness="-1",this.selectedEstablishment="-1",this.selectedMaterial="-1",this.selectedYear="-1",this.pos=1}loadStatements(){return new Promise(t=>{d().fire({title:"Cargando Datos",text:"Se est\xe1n recuperando datos",timerProgressBar:!0,showConfirmButton:!1,allowEscapeKey:!1,allowOutsideClick:!1}),d().showLoading(),this.establishmentService.getAllDeclarationEstablishments().subscribe(i=>{if(i.status){const s=new Map;i.status.forEach(r=>{s.has(r.ID_DETAIL)||s.set(r.ID_DETAIL,r)});const o=Array.from(s.values());o.sort((r,l)=>new Date(l.FechaRetiro).getTime()-new Date(r.FechaRetiro).getTime()),o.forEach(r=>{-1==this.business_name.indexOf(r.NAME_BUSINESS)&&this.business_name.push(r.NAME_BUSINESS),-1==this.establishment_name.indexOf(r.NAME_ESTABLISHMENT_REGION)&&this.establishment_name.push(r.NAME_ESTABLISHMENT_REGION),-1==this.years.indexOf(r.FechaRetiroTipeada)&&this.years.push(r.FechaRetiroTipeada),-1==this.material_name.indexOf(r.TYPE_RESIDUE)&&this.material_name.push(r.TYPE_RESIDUE),-1==this.treatment_name.indexOf(r.TipoTratamiento)&&this.treatment_name.push(r.TipoTratamiento)}),this.years.sort((r,l)=>l-r),this.dbStatements=o,this.cant=Math.ceil(this.dbStatements.length/10),this.db=this.dbStatements.slice(10*(this.pos-1),10*this.pos).sort((r,l)=>new Date(l.FechaRetiro).getTime()-new Date(r.FechaRetiro).getTime()).reverse(),d().close()}t()})})}filter(t=!1){const i=this.selectedBusiness?.value||this.selectedBusiness,s=this.selectedEstablishment?.value||this.selectedEstablishment,o=this.selectedMaterial?.value||this.selectedMaterial,r=this.selectedYear?.value||this.selectedYear;t&&!this.autoFilter||(this.filteredStatements=this.dbStatements.filter(l=>!("-1"!==i&&l.NAME_BUSINESS!==i||"-1"!==s&&l.NAME_ESTABLISHMENT_REGION!==s||"-1"!==o&&l.PRECEDENCE!==o||"-1"!==r&&l.FechaRetiroTipeada!==r)),this.db=this.filteredStatements.slice(0,10).sort((l,u)=>new Date(u.FechaRetiro).getTime()-new Date(l.FechaRetiro).getTime()).reverse(),this.cant=Math.ceil(this.filteredStatements.length/10),this.saveState(),this.filtersApplied=!1)}filterBusinesses(t){const i=t.query.toLowerCase();this.filteredBusinesses=this.business_name.filter(s=>s.toLowerCase().includes(i)).map(s=>({label:s,value:s})).sort((s,o)=>s.label.localeCompare(o.label)),0===this.filteredBusinesses.length?this.filteredBusinesses=[{label:"Todos",value:"-1"}]:this.filteredBusinesses.unshift({label:"Todos",value:"-1"})}filterEstablishments(t){const i=t.query.toLowerCase();this.filteredEstablishments=this.establishment_name.filter(s=>s.toLowerCase().includes(i)).map(s=>({label:s,value:s})).sort((s,o)=>s.label.localeCompare(o.label)),0===this.filteredEstablishments.length?this.filteredEstablishments=[{label:"Todos",value:"-1"}]:this.filteredEstablishments.unshift({label:"Todos",value:"-1"})}filterMaterial(t){const i=t.query.toLowerCase();this.filteredMaterial=this.material_name.filter(s=>s.toLowerCase().includes(i)).map(s=>({label:s,value:s})).sort((s,o)=>s.label.localeCompare(o.label)),0===this.filteredMaterial.length?this.filteredMaterial=[{label:"Todos",value:"-1"}]:this.filteredMaterial.unshift({label:"Todos",value:"-1"})}filterYear(t){const i=t.query.toString();this.filteredYear=this.years.filter(s=>s.toString().includes(i)).map(s=>({label:s.toString(),value:s.toString()})),this.filteredYear.length>0?this.filteredYear.unshift({label:"Todos",value:"-1"}):this.filteredYear=[{label:"Todos",value:"-1"}]}updateFilters(){const t=this.selectedBusiness?.value||this.selectedBusiness,i=this.selectedEstablishment?.value||this.selectedEstablishment,s=this.selectedMaterial?.value||this.selectedMaterial,o=this.selectedYear?.value||this.selectedYear;this.business_name=this.dbStatements.filter(r=>!("-1"!==i&&r.NAME_ESTABLISHMENT_REGION!==i||"-1"!==s&&r.PRECEDENCE!==s||"-1"!==o&&r.FechaRetiroTipeada!==o)).map(r=>r.NAME_BUSINESS).filter((r,l,u)=>u.indexOf(r)===l),this.establishment_name=this.dbStatements.filter(r=>!("-1"!==t&&r.NAME_BUSINESS!==t||"-1"!==s&&r.PRECEDENCE!==s||"-1"!==o&&r.FechaRetiroTipeada!==o)).map(r=>r.NAME_ESTABLISHMENT_REGION).filter((r,l,u)=>u.indexOf(r)===l),this.material_name=this.dbStatements.filter(r=>!("-1"!==t&&r.NAME_BUSINESS!==t||"-1"!==i&&r.NAME_ESTABLISHMENT_REGION!==i||"-1"!==o&&r.FechaRetiroTipeada!==o)).map(r=>r.PRECEDENCE).filter((r,l,u)=>u.indexOf(r)===l),this.years=this.dbStatements.filter(r=>!("-1"!==t&&r.NAME_BUSINESS!==t||"-1"!==i&&r.NAME_ESTABLISHMENT_REGION!==i||"-1"!==s&&r.PRECEDENCE!==s)).map(r=>r.FechaRetiroTipeada).filter((r,l,u)=>u.indexOf(r)===l).sort((r,l)=>l-r)}reset(){this.loadStatements()}pagTo(t){this.pos=t+1,this.db=this.filteredStatements.slice(10*t,10*(t+1)).sort((i,s)=>new Date(i.FechaRetiro).getTime()-new Date(s.FechaRetiro).getTime()).reverse()}next(){this.pos>=this.cant||(this.pos++,this.db=this.filteredStatements.slice(10*(this.pos-1),10*this.pos).sort((t,i)=>new Date(t.FechaRetiro).getTime()-new Date(i.FechaRetiro).getTime()).reverse())}previus(){this.pos-1<=0||this.pos>=this.cant+1||(this.pos=this.pos-1,this.db=this.filteredStatements.slice(10*(this.pos-1),10*this.pos).sort((t,i)=>new Date(t.FechaRetiro).getTime()-new Date(i.FechaRetiro).getTime()).reverse())}setArrayFromNumber(){return new Array(this.cant)}visiblePageNumbers(){const t=this.setArrayFromNumber().length,i=[];if(t<=15)for(let s=0;s<t;s++)i.push(s);else{let s=Math.max(0,this.pos-Math.floor(7.5)),o=Math.min(t-1,s+14);o-s+1<15&&(o=t-1,s=Math.max(0,o-14));for(let r=s;r<=o;r++)i.push(r)}return i}saveState(){localStorage.setItem("statementsState",JSON.stringify({selectedBusiness:this.selectedBusiness,selectedEstablishment:this.selectedEstablishment,selectedMaterial:this.selectedMaterial,selectedYear:this.selectedYear,pos:this.pos}))}loadState(){const t=JSON.parse(localStorage.getItem("statementsState")||"{}");t&&(this.selectedBusiness=t.selectedBusiness||"-1",this.selectedEstablishment=t.selectedEstablishment||"-1",this.selectedMaterial=t.selectedMaterial||"-1",this.selectedYear=t.selectedYear||"-1",this.pos=t.pos||1)}goToDetails(t,i){this.saveState(),this.router.navigate(["/mantenedor/visualizar-mv/",t,i])}isAnyCheckboxSelected(){return Object.values(this.checkboxState).some(t=>t)}downloadSelected(){const i=this.dbStatements.filter(s=>this.checkboxState[s.ID_HEADER]).map(s=>{const o=new Date(s.FechaRetiro),r=`${o.getDate().toString().padStart(2,"0")}-${(o.getMonth()+1).toString().padStart(2,"0")}-${o.getFullYear()}`;return{id:s.ID_DETAIL,additionalData:{empresa:s.NAME_BUSINESS,establecimiento:s.NAME_ESTABLISHMENT_REGION,tipoTratamiento:s.TipoTratamiento,material:s.PRECEDENCE,subtipo:s.TYPE_RESIDUE,fechaRetiro:r}}});i.length>0&&this.consumer.downloadMVSelected(i).subscribe(s=>{const o=window.URL.createObjectURL(s),r=document.createElement("a");r.href=o,r.download="medios_de_verificacion.zip",document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(o)},s=>{console.error("Error al descargar los archivos:",s)})}deselectAllCheckboxes(){this.checkboxState={},this.db.forEach(t=>{this.checkboxState[t.ID_HEADER]=!1})}showButtonClicked(){this.deselectAllCheckboxes(),this.filter(),this.pagTo(0)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(z.d),e.Y36(y.h),e.Y36(Z.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-visualizar-mv"]],decls:90,vars:15,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"declaracion"],[1,"box","box-form","mb-4"],[1,"row","align-items-end"],[1,"col-12","col-xl-2","mb-3","mb-xl-0"],[1,"form-label"],[1,"input-group"],["field","label","placeholder","Todos",1,"custom-autocomplete",3,"ngModel","suggestions","dropdown","ngModelChange","completeMethod","onSelect"],["pTemplate","item"],[1,"col-12","col-xl-4","mb-3","mb-xl-0"],[1,"row"],[1,"col-6"],[1,"btn","btn-primary","col-12",3,"click"],[1,"col-12","col-xl-5","mb-3","mb-xl-0"],[1,"btn","btn-primary","col-12",3,"disabled","click"],[1,"table-responsive"],[1,"table","table-even","table-section","table-borderless","table-radius"],[1,"vertical-middle"],[4,"ngFor","ngForOf"],["aria-label","Navegaci\xf3n resultados"],[1,"pagination"],[1,"btn","btn-primary",3,"click"],[1,"example-section"],["type","checkbox",3,"ngModel","disabled","ngModelChange"],[3,"ngClass"],[1,"custom-cursor",3,"click"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","fa-fw","color-verde"],[1,"border","btn","btn-sm",3,"ngClass","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",6),e._uU(8,"Visualizaci\xf3n de medios de verificaci\xf3n"),e.qZA()()(),e.TgZ(9,"section",7)(10,"h1"),e._uU(11,"Visualizaci\xf3n de medios de verificaci\xf3n"),e.qZA(),e.TgZ(12,"div",8)(13,"div",9)(14,"div",10)(15,"label",11),e._uU(16,"Empresa:"),e.qZA(),e.TgZ(17,"div",12)(18,"p-autoComplete",13),e.NdJ("ngModelChange",function(o){return i.selectedBusiness=o})("completeMethod",function(o){return i.filterBusinesses(o)})("onSelect",function(){return i.updateFilters()}),e.YNc(19,Oo,2,1,"ng-template",14),e.qZA()()(),e.TgZ(20,"div",10)(21,"label",11),e._uU(22,"Establecimiento"),e.qZA(),e.TgZ(23,"div",12)(24,"p-autoComplete",13),e.NdJ("ngModelChange",function(o){return i.selectedEstablishment=o})("completeMethod",function(o){return i.filterEstablishments(o)})("onSelect",function(){return i.updateFilters()}),e.YNc(25,wo,2,1,"ng-template",14),e.qZA()()(),e.TgZ(26,"div",10)(27,"label",11),e._uU(28,"Material:"),e.qZA(),e.TgZ(29,"div",12)(30,"p-autoComplete",13),e.NdJ("ngModelChange",function(o){return i.selectedMaterial=o})("completeMethod",function(o){return i.filterMaterial(o)})("onSelect",function(){return i.updateFilters()}),e.YNc(31,Lo,2,1,"ng-template",14),e.qZA()()(),e.TgZ(32,"div",10)(33,"label",11),e._uU(34,"A\xf1o/Mes de retiro:"),e.qZA(),e.TgZ(35,"div",12)(36,"p-autoComplete",13),e.NdJ("ngModelChange",function(o){return i.selectedYear=o})("completeMethod",function(o){return i.filterYear(o)})("onSelect",function(){return i.updateFilters()}),e.YNc(37,Bo,2,1,"ng-template",14),e.qZA()()(),e.TgZ(38,"div",15)(39,"div",16)(40,"div",17)(41,"button",18),e.NdJ("click",function(){return i.showButtonClicked()}),e._uU(42,"Mostrar"),e.qZA()()()(),e._UZ(43,"p")(44,"p"),e.TgZ(45,"div",19)(46,"div",16)(47,"div",17)(48,"button",20),e.NdJ("click",function(){return i.downloadSelected()}),e._uU(49,"Descargar Medios de Verificaci\xf3n"),e.qZA()()()()()(),e.TgZ(50,"div",21)(51,"table",22)(52,"thead",23)(53,"tr"),e._UZ(54,"th"),e.TgZ(55,"th"),e._uU(56,"Empresa"),e.qZA(),e.TgZ(57,"th"),e._uU(58,"Establecimiento"),e.qZA(),e.TgZ(59,"th"),e._uU(60,"Tipo de tratamiento"),e.qZA(),e.TgZ(61,"th"),e._uU(62,"Material"),e.qZA(),e.TgZ(63,"th"),e._uU(64,"Subtipo"),e.qZA(),e.TgZ(65,"th"),e._uU(66,"Peso"),e.qZA(),e.TgZ(67,"th"),e._uU(68,"Fecha Retiro"),e.qZA(),e.TgZ(69,"th"),e._uU(70,"Estado"),e.qZA(),e.TgZ(71,"th"),e._uU(72,"Ver detalle"),e.qZA()()(),e.TgZ(73,"tbody"),e.YNc(74,Yo,24,13,"tr",24),e.qZA()()(),e.TgZ(75,"nav",25)(76,"ul",26)(77,"li")(78,"button",27),e.NdJ("click",function(){return i.pagTo(0)}),e._uU(79,"Primero"),e.qZA()(),e.TgZ(80,"li")(81,"button",27),e.NdJ("click",function(){return i.previus()}),e._uU(82,"Anterior"),e.qZA()(),e.YNc(83,Jo,3,5,"li",24),e.TgZ(84,"li")(85,"button",27),e.NdJ("click",function(){return i.next()}),e._uU(86,"Siguiente"),e.qZA()(),e.TgZ(87,"li")(88,"button",27),e.NdJ("click",function(){return i.pagTo(i.cant-1)}),e._uU(89,"\xdaltimo"),e.qZA()()()()()()),2&t&&(e.xp6(18),e.Q6J("ngModel",i.selectedBusiness)("suggestions",i.filteredBusinesses)("dropdown",!0),e.xp6(6),e.Q6J("ngModel",i.selectedEstablishment)("suggestions",i.filteredEstablishments)("dropdown",!0),e.xp6(6),e.Q6J("ngModel",i.selectedMaterial)("suggestions",i.filteredMaterial)("dropdown",!0),e.xp6(6),e.Q6J("ngModel",i.selectedYear)("suggestions",i.filteredYear)("dropdown",!0),e.xp6(12),e.Q6J("disabled",!i.isAnyCheckboxSelected()),e.xp6(26),e.Q6J("ngForOf",i.db),e.xp6(9),e.Q6J("ngForOf",i.visiblePageNumbers()))},dependencies:[p.mk,p.sg,c.Wl,c.JJ,c.On,ie.jx,O.Qc,p.uU],styles:["[_nghost-%COMP%]{width:90%!important;padding:1%}.circle[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%;display:inline-block;margin-right:5px}.green-circle[_ngcontent-%COMP%]{background-color:green}.red-circle[_ngcontent-%COMP%]{background-color:red}.custom-cursor[_ngcontent-%COMP%]{cursor:pointer}.example-section[_ngcontent-%COMP%]{margin:0 50px}  .custom-autocomplete .p-autocomplete{width:100%;max-height:300px}  .custom-autocomplete .p-autocomplete-dropdown{width:10%;max-height:300px;background-color:#08a47c}  .select .form-select{width:50!important}"]}),a})()},{path:"visualizar-mv/:id_header_/:id_detail",component:(()=>{class a{constructor(t,i,s,o){this.productorService=t,this.ConsumerService=i,this.router=s,this.route=o,this.data_consulta=[],this.detail_consulta=[],this.MV_consulta=[],this.isLoading=!0,this.pendingCalls=0,this.attached=[]}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.loadData(),this.loadDetail()}loadData(){d().fire({title:"Cargando Datos",text:"Se est\xe1n recuperando datos",timerProgressBar:!0,showConfirmButton:!1,allowEscapeKey:!1,allowOutsideClick:!1}),d().showLoading();const t=this.route.snapshot.params.id_header_;this.pendingCalls++,this.ConsumerService.getFormConsulta(t).subscribe(i=>{i.status&&(this.data_consulta=i.data.header[0]),this.pendingCalls--,0===this.pendingCalls&&(this.isLoading=!1),d().close()})}loadDetail(){const t=this.route.snapshot.params.id_header_,i=this.route.snapshot.params.id_detail;this.pendingCalls++,this.ConsumerService.getDeclarationByID(t,i).subscribe(s=>{s.status&&(this.detail_consulta=s.status[0],this.loadMV()),this.pendingCalls--,0===this.pendingCalls&&(this.isLoading=!1)})}loadMV(){this.pendingCalls++,this.ConsumerService.getMV(this.detail_consulta.ID_DETAIL).subscribe(t=>{t.status&&(this.MV_consulta=t.data.header),this.pendingCalls--,0===this.pendingCalls&&(this.isLoading=!1)})}volver(){this.router.navigate(["/mantenedor/visualizar-mv"])}formatValue(t){return null==t?"":t%1==0?t.toString():t.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})}downloadFile(t,i){this.ConsumerService.downloadMV(t).subscribe(s=>{const o=new Blob([s],{type:s.type}),r=window.URL.createObjectURL(o),l=document.createElement("a");l.href=r,l.download=i,l.click(),window.URL.revokeObjectURL(r)},s=>{console.error("Error al descargar el archivo:",s)})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(N.u),e.Y36(y.h),e.Y36(Z.F0),e.Y36(Z.gz))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-visualizar-mv-detail"]],decls:86,vars:17,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["href","#/mantenedor/visualizar-mv"],["aria-current","page",1,"breadcrumb-item","active"],[1,"declaracion"],[1,"table-responsive"],[1,"table-atributos"],[1,"attr-name"],[1,"attr-value"],[1,"separador"],[1,"table","table-even","table-section","table-borderless","table-radius"],[1,"vertical-middle"],[1,"text-center"],[1,"text-end"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[2,"height","50px"],[1,"table-container","table","table-even","table-section","table-borderless","table-border","table-radius","d-lg-table"],[1,"text-center","w-100"],["class","text-center w-100",4,"ngFor","ngForOf"],[1,"file-link",3,"click"],[1,"alert","alert-danger"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",3)(8,"a",6),e._UZ(9,"i",5),e._uU(10," Visualizaci\xf3n de medios de verificaci\xf3n"),e.qZA()(),e.TgZ(11,"li",7),e._uU(12,"Detalle Visualizacion de medios de verificaci\xf3n"),e.qZA()()(),e.TgZ(13,"section",8)(14,"h1"),e._uU(15,"Detalle Visualizacion de medios de verificaci\xf3n"),e.qZA(),e.TgZ(16,"div",9)(17,"table",10)(18,"tbody")(19,"tr")(20,"td",11),e._uU(21,"Nombre de Empresa"),e.qZA(),e.TgZ(22,"td",12),e._uU(23),e.qZA()(),e.TgZ(24,"tr")(25,"td",11),e._uU(26,"ID Consumidor Industrial"),e.qZA(),e.TgZ(27,"td",12),e._uU(28),e.qZA()(),e.TgZ(29,"tr")(30,"td",11),e._uU(31,"Establecimiento"),e.qZA(),e.TgZ(32,"td",12),e._uU(33),e.qZA()(),e.TgZ(34,"tr")(35,"td",11),e._uU(36,"ID Establecimiento VU"),e.qZA(),e.TgZ(37,"td",12),e._uU(38),e.qZA()(),e.TgZ(39,"tr")(40,"td",11),e._uU(41,"Regi\xf3n"),e.qZA(),e.TgZ(42,"td",12),e._uU(43),e.qZA()(),e.TgZ(44,"tr")(45,"td",11),e._uU(46,"Comuna"),e.qZA(),e.TgZ(47,"td",12),e._uU(48),e.qZA()()()()(),e._UZ(49,"div",13),e.TgZ(50,"div",9)(51,"table",14)(52,"thead",15)(53,"tr")(54,"th",16),e._uU(55,"Subcategor\xeda"),e.qZA(),e.TgZ(56,"th",16),e._uU(57,"Tipo de tratamiento"),e.qZA(),e.TgZ(58,"th",16),e._uU(59,"Subtipo"),e.qZA(),e.TgZ(60,"th",16),e._uU(61,"Peso"),e.qZA(),e.TgZ(62,"th",16),e._uU(63,"Fecha Retiro"),e.qZA(),e.TgZ(64,"th",16),e._uU(65,"Gestor"),e.qZA()()(),e.TgZ(66,"tbody")(67,"td",16),e._uU(68),e.qZA(),e.TgZ(69,"td",16),e._uU(70),e.qZA(),e.TgZ(71,"td",16),e._uU(72),e.qZA(),e.TgZ(73,"td"),e._uU(74),e.qZA(),e.TgZ(75,"td",16),e._uU(76),e.ALo(77,"date"),e.qZA(),e.TgZ(78,"td",16),e._uU(79),e.qZA()()()(),e.TgZ(80,"div",17)(81,"button",18),e.NdJ("click",function(){return i.volver()}),e._uU(82,"Volver"),e.qZA()(),e._UZ(83,"p"),e.YNc(84,Go,11,1,"div",19),e.YNc(85,Ho,2,0,"div",20),e.qZA()()),2&t&&(e.xp6(23),e.Oqu(i.data_consulta.NombreEmpresa),e.xp6(5),e.Oqu(i.data_consulta.CodigoEmpresa),e.xp6(5),e.Oqu(i.data_consulta.Establecimiento),e.xp6(5),e.Oqu(i.data_consulta.ID_VU),e.xp6(5),e.Oqu(i.data_consulta.Region),e.xp6(5),e.Oqu(i.data_consulta.Comuna),e.xp6(20),e.Oqu(i.detail_consulta.PRECEDENCETIPEADO),e.xp6(2),e.Oqu(i.detail_consulta.TIPO_TRATAMIENTO_TIPEADO),e.xp6(2),e.Oqu(i.detail_consulta.TYPE_RESIDUE_TIPEADO),e.xp6(2),e.hij(" ",i.formatValue(i.detail_consulta.VALUE)," "),e.xp6(2),e.Oqu(e.xi3(77,14,i.detail_consulta.FechaRetiro,"dd-MM-yyyy")),e.xp6(3),e.Oqu(i.detail_consulta.NombreGestor),e.xp6(5),e.Q6J("ngIf",i.MV_consulta&&i.MV_consulta.length>0),e.xp6(1),e.Q6J("ngIf",!(i.isLoading||i.MV_consulta&&0!==i.MV_consulta.length)))},dependencies:[p.sg,p.O5,p.uU],styles:["table[_ngcontent-%COMP%]{border-collapse:collapse;width:100%}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding:8px;text-align:left;border-bottom:1px solid #ddd}th[_ngcontent-%COMP%]{background-color:#f2f2f2}.table-atributos[_ngcontent-%COMP%]{border-collapse:collapse;width:100%;border-radius:10px;overflow:hidden}.attr-name[_ngcontent-%COMP%]{background-color:#3c7c9c;color:#fff;width:25%}.table-atributos[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{width:25%;background-color:#3c7c9c;color:#fff;border-radius:6px 0 0 6px}.table-atributos[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{width:75%;background-color:#ececec;color:#000;border-radius:0 6px 6px 0}.attr-value[_ngcontent-%COMP%]{background-color:#ececec;width:75%;color:#000}[_nghost-%COMP%]{width:90%!important;padding:1%}.separador[_ngcontent-%COMP%]{height:1px;margin-top:20px;margin-bottom:20px;background-color:#ccc}.text-end[_ngcontent-%COMP%]{position:relative;margin-top:20px}.text-center[_ngcontent-%COMP%]{text-align:center}.file-link[_ngcontent-%COMP%]{color:#00f;text-decoration:underline;cursor:pointer}.file-link[_ngcontent-%COMP%]:hover{text-decoration:none}"]}),a})()},{path:"productor",component:(()=>{class a{constructor(t,i){this.productorService=t,this.router=i,this.dbStatements=[],this.filtered=[],this.db=[],this.pos=1,this.business_name=[],this.business_year=[],this.years=[],this.cant=0,this.selectedYear="-1",this.filteredBusinesses=[],this.filteredYear=[],this.form=new c.cw({BUSINESS:new c.NI(null,c.kI.required),YEAR:new c.NI(null,c.kI.required)})}ngOnInit(){this.loadStatements()}filterBusinesses(t){const i=t.query.toLowerCase();this.filteredBusinesses=this.business_name.filter(s=>s.label.toLowerCase().includes(i)).sort((s,o)=>s.label.localeCompare(o.label)),this.filteredBusinesses.length>0?this.filteredBusinesses.unshift({label:"Todos",value:"-1"}):this.filteredBusinesses=[{label:"Todos",value:"-1"}]}filterYear(t){const i=t.query;this.filteredYear=this.business_year.filter(s=>s.label.toString().startsWith(i)),this.filteredYear.sort((s,o)=>o.label-s.label),this.filteredYear.length>0?this.filteredYear.unshift({label:"Todos",value:"-1"}):this.filteredYear=[{label:"Todos",value:"-1"}]}loadStatements(){this.productorService.getStatements.subscribe(t=>{if(t.status){const i=t.data.sort((r,l)=>r.NAME_BUSINESS<l.NAME_BUSINESS?-1:r.NAME_BUSINESS>l.NAME_BUSINESS?1:l.YEAR_STATEMENT-r.YEAR_STATEMENT);let s=new Set,o=new Set;i.forEach(r=>{s.add(r.CODE_BUSINESS+" \u2014 "+r.NAME_BUSINESS),this.years.includes(r.YEAR_STATEMENT)||(this.years.push(r.YEAR_STATEMENT),o.add(r.YEAR_STATEMENT))}),this.business_year=Array.from(o).map(r=>({label:r,value:r})),this.business_name=Array.from(s).map(r=>({label:r,value:r})),this.years.sort((r,l)=>l-r),this.dbStatements=i,this.filtered=t.data,this.cant=Math.ceil(this.dbStatements.length/10),this.db=this.dbStatements.slice(0,10)}})}updateFiltersBusiness(t){let i;if(t&&"input"==t.type){const r=this.form.get("BUSINESS");r&&r.value&&(i=r.value)}else i=t&&t.value;if("Todos"==i&&(i=-1),-1==i||null==i){let r=new Set,l=this.dbStatements.slice();return this.dbStatements.sort((u,h)=>h.YEAR_STATEMENT-u.YEAR_STATEMENT).forEach(u=>{r.add(u.YEAR_STATEMENT)}),this.business_year=Array.from(r).map(u=>({label:u,value:u})),void(this.dbStatements=l)}i=i.replace(/.* \u2014 \s*/,"");const s=this.dbStatements.filter(r=>{if("-1"!=i&&r.NAME_BUSINESS==i)return r});let o=new Set;s.forEach(r=>{o.add(r.YEAR_STATEMENT)}),this.business_year=Array.from(o).map(r=>({label:r,value:r}))}updateFiltersYears(t){let i;if(t&&"input"==t.type){const r=this.form.get("YEAR");r&&r.value&&(i=r.value)}else i=t&&t.value;if("Todos"==i&&(i=-1),-1==i||null==i){let r=new Set;return this.dbStatements.forEach(l=>{r.add(l.CODE_BUSINESS+" \u2014 "+l.NAME_BUSINESS)}),void(this.business_name=Array.from(r).map(l=>({label:l,value:l})))}i=i.toString().replace(/.* \u2014 \s*/,"");const s=this.dbStatements.filter(r=>{if("-1"!=i&&r.YEAR_STATEMENT==i)return r});let o=new Set;s.forEach(r=>{o.add(r.CODE_BUSINESS+" \u2014 "+r.NAME_BUSINESS)}),this.business_name=Array.from(o).map(r=>({label:r,value:r}))}filter(){let t,i,s,o;const r=this.form.get("BUSINESS"),l=this.form.get("YEAR");if(r&&r.value&&l&&l.value){r.value&&(s="string"==typeof r.value?1:Object.keys(r.value).length),l.value&&(o="string"==typeof l.value?1:Object.keys(l.value).length),s>1?o>1?(t=r.value.value,i=l.value.value):(t=r.value.value,i="Todos"==l.value?-1:l.value):o>1?"Todos"==r.value?(t=-1,i=l.value.value):(t=r.value,i=l.value):"Todos"==r.value?(t=-1,i="Todos"==l.value?-1:l.value):"Todos"==l.value?(t=r.value,i=-1):(t=r.value,i=l.value),-1!=t&&(t=t.toString().replace(/.* \u2014 \s*/,""));let u=this.business_name;if(this.business_name=this.business_name.map(h=>({value:h.value.replace(/.* \u2014 \s*/,""),label:h.label.replace(/.* \u2014 \s*/,"")})),-1==t||this.business_name.some(h=>h.value===t)){if(this.business_name=u,null!=i&&!isNaN(Number(i))){this.business_name=u;const h=this.dbStatements.filter(g=>{if("-1"!=t&&g.NAME_BUSINESS==t){if("-1"==i)return g;if(g.YEAR_STATEMENT==i)return g}if("-1"==t){if("-1"==i)return g;if(g.YEAR_STATEMENT==i)return g}});return this.pos=1,this.filtered=h,this.db=h.slice(0,10).sort((g,f)=>new Date(f.UPDATED_AT).getTime()-new Date(g.UPDATED_AT).getTime()),void(this.cant=Math.ceil(h.length/10))}this.business_name=u,d().fire({title:"Error",text:"Debe ingresar un a\xf1o v\xe1lido.",icon:"error",confirmButtonText:"Aceptar"})}else this.business_name=u,d().fire({title:"Error",text:"Debe ingresar una empresa o a\xf1o v\xe1lido.",icon:"error",confirmButtonText:"Aceptar"})}else d().fire({title:"Error",text:"Debe seleccionar empresa y a\xf1o.",icon:"error",confirmButtonText:"Aceptar"})}reset(){this.loadStatements()}pagTo(t){this.pos=t+1,this.db=this.filtered.slice(10*t,10*(t+1)).sort((i,s)=>i.NAME_BUSINESS<s.NAME_BUSINESS?-1:i.NAME_BUSINESS>s.NAME_BUSINESS?1:s.YEAR_STATEMENT-i.YEAR_STATEMENT)}next(){this.pos>=this.cant||(this.pos++,this.db=this.filtered.slice(10*(this.pos-1),10*this.pos).sort((t,i)=>t.NAME_BUSINESS<i.NAME_BUSINESS?-1:t.NAME_BUSINESS>i.NAME_BUSINESS?1:i.YEAR_STATEMENT-t.YEAR_STATEMENT))}previus(){this.pos-1<=0||this.pos>=this.cant+1||(this.pos=this.pos-1,this.db=this.filtered.slice(10*(this.pos-1),10*this.pos).sort((t,i)=>t.NAME_BUSINESS<i.NAME_BUSINESS?-1:t.NAME_BUSINESS>i.NAME_BUSINESS?1:i.YEAR_STATEMENT-t.YEAR_STATEMENT))}downloadPDF(t,i){d().fire({title:"Espere",text:"Generando PDF",showConfirmButton:!1}),d().showLoading(),this.productorService.downloadPDF(t,i).subscribe(s=>{const o=new Blob([s],{type:"application/pdf"});let r=document.createElement("a");r.href=window.URL.createObjectURL(o),r.download=`Reporte_${i}`,document.body.appendChild(r),r.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),r.remove(),window.URL.revokeObjectURL(r.href),d().close()})}navigateToForm(t){this.router.navigateByUrl(`/mantenedor/productor/${t}`)}setArrayFromNumber(){return new Array(this.cant)}visiblePageNumbers(){const t=this.setArrayFromNumber().length,i=[];if(t<=15)for(let s=0;s<t;s++)i.push(s);else{let s=Math.max(0,this.pos-Math.floor(7.5)),o=Math.min(t-1,s+14);o-s+1<15&&(o=t-1,s=Math.max(0,o-14));for(let r=s;r<=o;r++)i.push(r)}return i}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(N.u),e.Y36(Z.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-maintainer-productor"]],decls:69,vars:7,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"declaracion"],[1,"d-sm-flex","justify-content-between","mb-3","mb-md-0"],[1,"box","box-form","mb-4",3,"formGroup"],[1,"row","align-items-end"],[1,"col-12","col-xl-4","mb-3","mb-xl-0"],[1,"form-label"],["formControlName","BUSINESS","field","label","placeholder","Buscar empresa",1,"custom-autocomplete",3,"suggestions","dropdown","completeMethod","input","onSelect"],["pTemplate","item"],["pTemplate","selectedItem"],["formControlName","YEAR","field","label","placeholder","Buscar A\xf1o",1,"custom-autocomplete",3,"suggestions","dropdown","completeMethod","input","onSelect"],[1,"row"],[1,"col-6"],[1,"btn","btn-primary","col-12",2,"height","2.875rem","border-radius",".25rem",3,"click"],[1,"table-responsive"],[1,"table","table-even","table-section","table-borderless","table-radius"],[1,"vertical-middle"],[1,"text-center","text-nowrap"],[4,"ngFor","ngForOf"],["aria-label","Navegaci\xf3n resultados"],[1,"pagination"],[1,"btn","btn-primary",3,"click"],[1,"btn",2,"border-color","rgb(224, 224, 224)",3,"click"],["aria-hidden","true",1,"fa","fa-search","fa-fw","fa-lg",2,"color","#4f9bff","font-size","medium"],[1,"border","btn","btn-sm",3,"ngClass","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",6),e._uU(8,"Mantenedor Declaraciones Productores"),e.qZA()()(),e.TgZ(9,"section",7)(10,"h1"),e._uU(11,"Mantenedor Declaraciones Productores"),e.qZA(),e._UZ(12,"div",8),e.TgZ(13,"div",9)(14,"div",10)(15,"div",11)(16,"label",12),e._uU(17,"EMPRESAS:"),e.qZA(),e._UZ(18,"br"),e.TgZ(19,"p-autoComplete",13),e.NdJ("completeMethod",function(o){return i.filterBusinesses(o)})("input",function(o){return i.updateFiltersBusiness(o)})("onSelect",function(o){return i.updateFiltersBusiness(o)}),e.YNc(20,$o,2,1,"ng-template",14),e.YNc(21,jo,2,1,"ng-template",15),e.qZA()(),e.TgZ(22,"div",11)(23,"label",12),e._uU(24,"A\xf1o:"),e.qZA(),e._UZ(25,"br"),e.TgZ(26,"p-autoComplete",16),e.NdJ("completeMethod",function(o){return i.filterYear(o)})("input",function(o){return i.updateFiltersYears(o)})("onSelect",function(o){return i.updateFiltersYears(o)}),e.YNc(27,Ko,2,1,"ng-template",14),e.YNc(28,Xo,2,1,"ng-template",15),e.qZA()(),e.TgZ(29,"div",11)(30,"div",17)(31,"div",18)(32,"button",19),e.NdJ("click",function(){return i.filter()}),e._uU(33,"Mostrar"),e.qZA()()()()()(),e.TgZ(34,"div",20)(35,"table",21)(36,"thead",22)(37,"tr")(38,"th"),e._uU(39,"ID Empresa"),e.qZA(),e.TgZ(40,"th"),e._uU(41,"Nombre Empresa"),e.qZA(),e.TgZ(42,"th"),e._uU(43,"A\xf1o Declaraci\xf3n"),e.qZA(),e.TgZ(44,"th"),e._uU(45,"Estado"),e.qZA(),e.TgZ(46,"th"),e._uU(47,"Monto Total (UF)"),e.qZA(),e.TgZ(48,"th"),e._uU(49,"Fecha Env\xedo"),e.qZA(),e.TgZ(50,"th",23),e._uU(51,"Detalle"),e.qZA()()(),e.TgZ(52,"tbody"),e.YNc(53,Wo,18,9,"tr",24),e.qZA()()(),e.TgZ(54,"nav",25)(55,"ul",26)(56,"li")(57,"button",27),e.NdJ("click",function(){return i.pagTo(0)}),e._uU(58,"Primero"),e.qZA()(),e.TgZ(59,"li")(60,"button",27),e.NdJ("click",function(){return i.previus()}),e._uU(61,"Anterior"),e.qZA()(),e.YNc(62,ta,3,5,"li",24),e.TgZ(63,"li")(64,"button",27),e.NdJ("click",function(){return i.next()}),e._uU(65,"Siguiente"),e.qZA()(),e.TgZ(66,"li")(67,"button",27),e.NdJ("click",function(){return i.pagTo(i.cant-1)}),e._uU(68,"\xdaltimo"),e.qZA()()()()()()),2&t&&(e.xp6(13),e.Q6J("formGroup",i.form),e.xp6(6),e.Q6J("suggestions",i.filteredBusinesses)("dropdown",!0),e.xp6(7),e.Q6J("suggestions",i.filteredYear)("dropdown",!0),e.xp6(27),e.Q6J("ngForOf",i.db),e.xp6(9),e.Q6J("ngForOf",i.visiblePageNumbers()))},dependencies:[p.mk,p.sg,c.JJ,c.JL,c.sg,c.u,ie.jx,O.Qc,p.uU],styles:["[_nghost-%COMP%]{width:90%!important;padding:1%}  .custom-autocomplete .p-autocomplete{width:100%;max-height:300px}  .custom-autocomplete .p-autocomplete-dropdown{width:10%;max-height:300px;background-color:#08a47c}  .select .form-select{width:50!important}"]}),a})()},{path:"productor/:id_header",component:(()=>{class a{constructor(t,i,s){this.productorService=t,this.route=i,this.router=s,this.listData=[],this.MV_consulta=[]}ngOnInit(){this.loadData(),this.loadMV()}loadData(){const t=this.route.snapshot.params.id_header;console.log(t),this.productorService.getStatementsById(t).subscribe(i=>{this.listData=i,console.log(this.listData)})}loadMV(){this.productorService.getMV(this.route.snapshot.params.id_header).subscribe(i=>{i.status&&(this.MV_consulta=i.data.header,console.log(this.MV_consulta))})}downloadFile(t,i){this.productorService.downloadMV(t).subscribe(s=>{const o=new Blob([s],{type:s.type}),r=window.URL.createObjectURL(o),l=document.createElement("a");l.href=r,l.download=i,l.click(),window.URL.revokeObjectURL(r)},s=>{console.error("Error al descargar el archivo:",s)})}descargarOC(t){this.productorService.downloadOC(t).subscribe({next:i=>{if(i){const s=new Blob([i],{type:"application/pdf"});let o=document.createElement("a");o.href=window.URL.createObjectURL(s),o.download=`Orden_de_Compra_${this.listData.data[0].YEAR_STATEMENT}`,document.body.appendChild(o),o.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),o.remove(),window.URL.revokeObjectURL(o.href)}},error:i=>{d().fire({icon:"error",text:"error"})}})}isDownloadOCEnabled(){return this.listData.data&&this.listData.data.length>0&&1===this.listData.data[0].STATE}isEstadoPendiente(){return this.listData.data&&this.listData.data.length>0&&2===this.listData.data[0].STATE}isEstadoBorrador(){return this.listData.data&&this.listData.data.length>0&&0===this.listData.data[0].STATE}isEstadoEnviado(){return this.listData.data&&this.listData.data.length>0&&1===this.listData.data[0].STATE}volver(){this.router.navigate(["/mantenedor/productor"])}downloadPDF(t,i){d().fire({title:"Espere",text:"Generando PDF",showConfirmButton:!1}),d().showLoading(),this.productorService.downloadPDF(t,i).subscribe(s=>{const o=new Blob([s],{type:"application/pdf"});let r=document.createElement("a");r.href=window.URL.createObjectURL(o),r.download=`Reporte_${i}`,document.body.appendChild(r),r.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),r.remove(),window.URL.revokeObjectURL(r.href),d().close()})}cambiarAEstadoPendiente(){const t=this.route.snapshot.params.id_header;d().fire({title:"\xbfEst\xe1 seguro?",text:"\xbfEst\xe1 seguro de cambiar a estado Pendiente? La Orden de Compra actual se eliminar\xe1 del sistema y el usuario tendr\xe1 un plazo de 7 d\xedas para subir una nueva Orden de Compra. Pasado este plazo, la declaraci\xf3n volver\xe1 a estado borrador y se recalcular\xe1 el valor de la UF",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Confirmar",cancelButtonText:"Cancelar"}).then(i=>{i.isConfirmed&&this.productorService.updateToPending(t).subscribe(s=>{s.status?d().fire("Cambiado!","El estado ha sido cambiado a Pendiente.","success").then(()=>{this.loadData()}):d().fire("Error!","Hubo un problema al cambiar el estado.","error")},s=>{d().fire("Error!","Hubo un problema al cambiar el estado.","error")})})}cambiarAEstadoBorrador(){const t=this.route.snapshot.params.id_header;d().fire({title:"\xbfEst\xe1 seguro?",text:"\xbfEst\xe1 seguro de cambiar a estado Borrador? La Orden de Compra se eliminar\xe1 del sistema y los valores de la declaraci\xf3n se actualizar\xe1n al valor de la UF de hoy",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Confirmar",cancelButtonText:"Cancelar"}).then(i=>{i.isConfirmed&&this.productorService.updateToDraft(t).subscribe(s=>{s.status?d().fire("Cambiado!","El estado ha sido cambiado a Borrador.","success").then(()=>{this.loadData()}):d().fire("Error!","Hubo un problema al cambiar el estado.","error")},s=>{d().fire("Error!","Hubo un problema al cambiar el estado.","error")})})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(N.u),e.Y36(Z.gz),e.Y36(Z.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-maintainer-productor-detail"]],decls:86,vars:14,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["href","#/mantenedor/productor"],["aria-current","page",1,"breadcrumb-item","active"],[1,"declaracion"],[1,"d-sm-flex","justify-content-between","mb-3","mb-md-0"],[1,"box","box-mi-perfil","mb-5","d-flex","align-items-start",2,"margin-left","20px"],[1,"list","list-data","list-data-title-green","gap-0","column-md-2","list-unstyled"],[1,"list-data__title",2,"margin-left","10px"],[1,"list-data__text",2,"margin-left","10px"],[1,"color-verde"],[1,"list","list-links","list-unstyled"],["id","accordionPanelsStayOpenExample",1,"accordion","accordion-flush"],[1,"accordion-item"],["data-bs-toggle","modal","data-bs-target","#exampleModal",1,"list-data__title","btn","btn-light"],["data-bs-toggle","collapse"],[1,"list-data__title","btn","btn-light",3,"click"],[1,"list-data__title","btn","btn-primary","btn-rounded",2,"margin-left","90%","width","85px",3,"click"],["id","panelsStayOpen-collapseOne","aria-labelledby","panelsStayOpen-headingOne",1,"accordion-collapse","collapse"],[1,"accordion-body"],["id","exampleModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title","fs-5"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"container"],[1,"row"],[1,"col-md-6"],[4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"modal-footer"],["type","button","id","btnCloseModal","data-bs-dismiss","modal",1,"btn","btn-secondary"],[1,"table-container","table","table-even","table-section","table-borderless","table-border","table-radius","d-lg-table"],[1,"text-center","w-100"],["class","text-center w-100",4,"ngFor","ngForOf"],[1,"file-link",3,"click"],[1,"alert","alert-danger"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",3)(8,"a",6),e._uU(9," Mantenedor Declaraciones Productores"),e.qZA()(),e.TgZ(10,"li",7),e._uU(11,"Detalle Declaraci\xf3n Productor"),e.qZA()()(),e.TgZ(12,"section",8)(13,"h1"),e._uU(14,"Detalle Declaraci\xf3n Productor"),e.qZA(),e._UZ(15,"div",9),e.TgZ(16,"div",10)(17,"ul",11)(18,"li")(19,"span",12),e._uU(20,"C\xf3digo de Empresa"),e.qZA(),e.TgZ(21,"span",13),e._uU(22),e.qZA()(),e.TgZ(23,"li")(24,"span",12),e._uU(25,"Nombre de Empresa"),e.qZA(),e.TgZ(26,"span",13),e._uU(27),e.qZA()(),e.TgZ(28,"li")(29,"span",12),e._uU(30,"A\xf1o Declaraci\xf3n"),e.qZA(),e.TgZ(31,"span",13),e._uU(32),e.qZA()(),e.TgZ(33,"li")(34,"span",12),e._uU(35,"Estado"),e.qZA(),e.TgZ(36,"span",13),e._uU(37),e.qZA()()()(),e.TgZ(38,"h2",14),e._uU(39,"Acciones"),e.qZA(),e.TgZ(40,"ul",15)(41,"div",16)(42,"div",17)(43,"li")(44,"a",18)(45,"span"),e._uU(46,"Ver Medios de Verificaci\xf3n"),e.qZA()()(),e.TgZ(47,"li",19)(48,"a",20),e.NdJ("click",function(){return i.isEstadoEnviado()&&i.cambiarAEstadoPendiente()}),e.TgZ(49,"span"),e._uU(50,"Cambiar a estado Pendiente"),e.qZA()()(),e.TgZ(51,"li",19)(52,"a",20),e.NdJ("click",function(){return(i.isEstadoPendiente()||i.isEstadoEnviado())&&i.cambiarAEstadoBorrador()}),e.TgZ(53,"span"),e._uU(54,"Cambiar a estado Borrador"),e.qZA()()(),e.TgZ(55,"li",19)(56,"a",20),e.NdJ("click",function(){return i.isDownloadOCEnabled()&&i.downloadPDF(i.listData.data[0].CODE_BUSINESS,i.listData.data[0].YEAR_STATEMENT)}),e.TgZ(57,"span"),e._uU(58,"Descargar PDF"),e.qZA()()(),e.TgZ(59,"li",19)(60,"a",20),e.NdJ("click",function(){return i.isDownloadOCEnabled()&&i.descargarOC(i.listData.data[0].ID)}),e.TgZ(61,"span"),e._uU(62,"Descargar OC"),e.qZA()()(),e.TgZ(63,"li",19)(64,"button",21),e.NdJ("click",function(){return i.volver()}),e._uU(65," Volver "),e.qZA()(),e.TgZ(66,"div",22),e._UZ(67,"div",23),e.qZA()()()()()(),e.TgZ(68,"div",24)(69,"div",25)(70,"div",26)(71,"div",27)(72,"h1",28),e._uU(73,"Medios de Verificaci\xf3n"),e.qZA(),e._UZ(74,"button",29),e.qZA(),e.TgZ(75,"div",30)(76,"div",31)(77,"form")(78,"div",32)(79,"div",33),e._UZ(80,"p"),e.qZA(),e.YNc(81,aa,10,1,"div",34),e.YNc(82,sa,2,0,"div",35),e.qZA()()()(),e.TgZ(83,"div",36)(84,"button",37),e._uU(85,"Cerrar"),e.qZA()()()()()),2&t&&(e.xp6(22),e.Oqu(i.listData.data[0].CODE_BUSINESS),e.xp6(5),e.Oqu(i.listData.data[0].NAME_BUSINESS),e.xp6(5),e.Oqu(i.listData.data[0].YEAR_STATEMENT),e.xp6(5),e.Oqu(1==i.listData.data[0].STATE?"Enviada":0==i.listData.data[0].STATE?"Borrador":"Pendiente"),e.xp6(11),e.ekj("disabled-link",i.isEstadoPendiente()||i.isEstadoBorrador()),e.xp6(4),e.ekj("disabled-link",i.isEstadoBorrador()),e.xp6(4),e.ekj("disabled-link",!i.isDownloadOCEnabled()),e.xp6(4),e.ekj("disabled-link",!i.isDownloadOCEnabled()),e.xp6(21),e.Q6J("ngIf",i.MV_consulta&&i.MV_consulta.length>0),e.xp6(1),e.Q6J("ngIf",!i.MV_consulta||0===i.MV_consulta.length))},dependencies:[p.sg,p.O5,c._Y,c.JL,c.F],styles:["[_nghost-%COMP%]{width:50%!important;padding:1%}.file-link[_ngcontent-%COMP%]{color:#00f;text-decoration:underline;cursor:pointer}.disabled-link[_ngcontent-%COMP%]{pointer-events:none;color:#ccc}"]}),a})()},{path:"**",redirectTo:"home",pathMatch:"full"}]}];let la=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[Z.Bz.forChild(na),Z.Bz]}),a})();var ca=m(4466);let da=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[p.ez,la,c.u5,c.UX,j.q4,ca.m,q.a4,O.WN]}),a})()}}]);