"use strict";(self.webpackChunkrigk_sg_web=self.webpackChunkrigk_sg_web||[]).push([[730],{3730:(Ye,$,v)=>{v.r($),v.d($,{ConsumerStatementModule:()=>Re});var E=v(6895),x=v(5792),X=v(9314),W=v(4135),G=v(5861),ee=v(5226),o=v.n(ee),e=v(8256),k=v(9821),P=v(554),L=v(8195),te=v(3813),m=v(433),H=v(2506);function ae(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"p-multiSelect",44),e.NdJ("ngModelChange",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.selectedEstablishment=i)})("onChange",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.onEstablishmentChange(i))}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("readonly",-1!=t.id_establishment)("options",t.establishments)("ngModel",t.selectedEstablishment)("selectionLimit",1)("selectedItemsLabel","{0} Empresas seleccionadas")}}function ie(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"div",45)(1,"div",46)(2,"button",47),e.NdJ("click",function(){const s=e.CHM(t).index,u=e.oxw();return e.KtG(u.addRow(s))}),e._uU(3,"Agregar l\xednea"),e.qZA()(),e.TgZ(4,"h2",48),e._uU(5),e.qZA(),e.TgZ(6,"table",49)(7,"thead")(8,"tr")(9,"th"),e._uU(10,"Subcategor\xeda"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Tipo Tratamiento"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Subtipo"),e.qZA(),e.TgZ(15,"th")(16,"span",50),e._uU(17,"Peso (kg)"),e.qZA(),e.TgZ(18,"span",51),e._uU(19,"Kg."),e.qZA()(),e.TgZ(20,"th")(21,"span",50),e._uU(22,"Fecha Retiro"),e.qZA(),e.TgZ(23,"span",51),e._uU(24,"Fec. de retiro"),e.qZA()(),e.TgZ(25,"th"),e._uU(26,"Gestor"),e.qZA(),e.TgZ(27,"th"),e._uU(28,"Medios de verificaci\xf3n"),e.qZA(),e.TgZ(29,"th"),e._uU(30,"Eliminar"),e.qZA()()(),e.TgZ(31,"tbody",52),e._UZ(32,"tr"),e.qZA(),e.TgZ(33,"tfoot")(34,"tr")(35,"td",53),e._uU(36,"TOTAL:"),e.qZA(),e._UZ(37,"td",54),e.TgZ(38,"td",55),e._uU(39,"0"),e.qZA(),e._UZ(40,"td",56),e.qZA()()()()}if(2&n){const t=l.$implicit,a=l.index,i=e.oxw();e.xp6(2),e.Q6J("disabled",-1==i.id_establishment),e.xp6(3),e.hij("",t," "),e.xp6(1),e.MGl("id","table_",a+1,""),e.xp6(25),e.MGl("id","tr_",a+1,""),e.xp6(7),e.MGl("id","table_td_",a+1,"")}}function ne(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"button",57),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.saveForm())}),e._uU(1,"Enviar Declaraci\xf3n"),e.qZA()}}function se(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"button",58),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw();return e.KtG(u.deleteFile(s))}),e._uU(7,"X"),e.qZA()()()}if(2&n){const t=l.$implicit,a=e.oxw();e.xp6(2),e.hij(" ",a.lable_type[t.type-1]," "),e.xp6(2),e.hij(" ",t.file.name," ")}}let z=(()=>{class n{constructor(t,a,i,s,u,f){this.establishmentService=t,this.consumerService=a,this.business=i,this.router=s,this.actived=u,this.managerService=f,this.selectedCategoryId="",this.lastRowNumber=0,this.tables=[""],this.e=1,this.materials=[],this.materials_2=[],this.categories=[],this.treatments=[],this.disableAll=!1,this.treatment_type=["Reciclaje Mec\xe1nico","Valorizaci\xf3n Energ\xe9tica","Disposici\xf3n Final en RS","Reciclaje Interno","Preparaci\xf3n Reutilizaci\xf3n","DF en Relleno Sanitario","DF en Relleno Seguridad"],this.total_tables=[0,0,0],this.id_establishment=-1,this.region="",this.comuna="",this.establishments=[],this.selectedEstablishment=[],this.attached=[],this.managers=[],this.id_business="0",this.year_statement=0,this.establishment="",this.goTo="/consumidor/",this.data=[],this.lable_type=["Guia de Despacho","Factura Gestor","Registro de peso","Fotograf\xeda Retiro","Balance de masas","Otro"],this.business_name="",this.business_code="",this.newData=[],this.rowSelected=0,this.tableSelected=0,this.tmpFile=[],this.filess=[],this.actived.data.subscribe(y=>{y.show?this.disableAll=!0:this.actived.queryParams.subscribe(d=>{this.id_business=d.id_business,this.year_statement=d.year,this.business_code=d.code,this.loadEstablishments(),this.business.getBusiness(d.code).subscribe(I=>{this.business_name=I.status[0].NAME})})})}ngOnInit(){localStorage.removeItem("statementsState"),this.userData=JSON.parse(sessionStorage.getItem("user")),this.getAllSubmaterialFormatted(),this.getAllSubmaterial(),this.getAllMaterials(),this.getAllTreatments()}getAllSubmaterialFormatted(){this.managerService.getAllSubmaterialFormatted().subscribe(t=>{t.status&&(this.materials=t.data)})}getAllSubmaterial(){this.managerService.getAllSubmaterial().subscribe(t=>{t.status&&(this.materials_2=t.data)})}getAllMaterials(){this.managerService.getAllMaterials().subscribe(t=>{t.status&&(this.categories=t.status)})}getAllTreatments(){this.managerService.getAllTreatments().subscribe(t=>{t.status&&(this.treatments=t.status)})}reset(){this.id_establishment=-1;const t=document.getElementById("table_1")?.getElementsByTagName("tbody")[0],a=t?.rows;for(;0!=a.length;)t?.deleteRow(0);this.selectedEstablishment=null,document.getElementById("table_td_1").innerHTML="0",this.newData=[]}getManagersForMaterial(t){return(this.managers.find(i=>i.material===t)?.managers||[]).map(i=>({name:i.BUSINESS_NAME,id:i.ID_BUSINESS}))}onEstablishmentChange(t){this.establishmentService.getEstablishmentByID(this.selectedEstablishment[0]).subscribe(a=>{a.status?(this.id_compare=a.status[0].ID,this.region=a.status[0].REGION,this.comuna=a.status[0].COMUNA_NAME,this.id_establishment=a.status[0].ID_VU?a.status[0].ID_VU:"-",this.fetchManagersForAllMaterials(a.status[0].REGION)):this.managers=[]})}fetchManagersForAllMaterials(t){const a=this.materials_2.filter(i=>void 0!==i.id).map(i=>i.id);this.managerService.getManagersByMaterials(a,t).subscribe(i=>{Array.isArray(i.status)?this.managers=i.status.map(s=>({material:s.COD_MATERIAL,managers:s.BUSINESS_NAME,id_gestor:s.ID_BUSINESS})):console.error("results.status no es un array")})}loadEstablishments(){"0"!=this.id_business&&this.establishmentService.getEstablishment(this.id_business.toString()).subscribe({next:t=>{this.establishments=[],t.status.forEach(a=>{a.name=`${a.NAME_ESTABLISHMENT} - ${a.NAME_COMMUNE} - ${a.REGION}`,this.establishments.push(a)})}})}saveForm(){var t=this;return(0,G.Z)(function*(){if(0==t.newData.length)return void o().fire({icon:"info",text:"Formulario est\xe1 vac\xedo"});let a=null;(!t.selectedEstablishment[0]||0==t.selectedEstablishment[0])&&(a="Falta establecimiento");for(let u=0;u<t.newData.length;u++){const f=t.newData[u];if(0==f.value||""==f.date||"-1"==f.gestor||"-1"==f.treatment||"-1"==f.sub||"-1"==f.precedence){if("-1"==f.precedence){a="Debe seleccionar una Subcategoria";break}if("-1"==f.treatment){a="Debe seleccionar un Tipo Tratamiento";break}if("-1"==f.sub){a="Debe seleccionar un SubTipo";break}if(0==f.value){a="Debe ingresar un peso correcto";break}if(""==f.date){a="Debe ingresar una fecha de retiro";break}if("-1"==f.gestor){a="Debe seleccionar un gestor";break}}}if(null!=a)return void o().fire({icon:"info",text:a});o().fire({icon:"info",title:"Espere...",text:"Enviando formulario"}),o().showLoading();const i={year:t.year_statement,establishment:t.selectedEstablishment[0]};let s=!1;for(let u=0;u<t.newData.length;u++){const f=t.newData[u];f.residue=f.precedence;try{(yield t.consumerService.save({header:i,detail:f}).toPromise()).status||(o().close(),o().fire({icon:"error",text:"Ocurri\xf3 un error mientras se guardaba el formulario."}),s=!0)}catch{o().close(),o().fire({icon:"error",text:"Ocurri\xf3 un error mientras se enviaba el formulario."}),s=!0}}s||(o().close(),o().fire({icon:"success",text:"Declaraci\xf3n guardada satisfactoriamente"}).then(u=>{u.isConfirmed&&t.router.navigate(["/consumidor"])}))})()}goBack(){this.router.navigate([this.goTo])}getId(t){alert("row"+t.parentNode.parentNode.rowIndex+" - column"+t.parentNode.cellIndex)}verifyRow(t,a){this.consumerService.checkRow(t).subscribe({next:i=>{if(!i.status)return o().fire({icon:"info",text:"Ya existe la misma Empresa, Establecimiento, Material, Subtipo, y Gestor para esta Fecha"}),void(a.value="-1")}})}addRow(t){this.lastRowNumber++;const a=document.getElementById(`table_${t+1}`)?.getElementsByTagName("tbody")[0];let i=this.lastRowNumber,s=`\n    <tr id="tr">\n                        <td>\n                          <select class="form-select" id="inp_subcat_${t+1}_${i}">\n                            <option value="-1">Seleccione Subcategor\xeda</option>`;this.categories.forEach(p=>{s+=`<option value="${p.ID}">${p.MATERIAL}</option>`}),s+=`\n                          </select>\n                        </td>\n                        <td style="padding-left: 20px;">\n                            <select class="form-select" id="inp_treatment_${t+1}_${i}">\n                                <option value="-1">Seleccione Tratamiento</option>`,this.treatments.forEach(p=>{s+=`<option value="${p.ID}">${p.NAME}</option>`}),s+=`   \n                            </select>\n                        </td>\n                        <td>\n                            <select class="form-select" id="inp_sub_${t+1}_${i}">\n                                <option value="-1">Seleccione Subtipo</option>\n                            </select>\n                        </td>\n                        <td>\n                            <input [disabled]="disableAll" class="form-control form-control-sm text-end w-50px"\n                                id="inp_value_${t+1}_${i}" type="text" value="0"\n                                >\n                        </td>\n                        <td>\n                            <input [disabled]="disableAll" class="form-control text-start w-auto" type="date"\n                                id="inp_date_${t+1}_${i}" placeholder="00/00/0000"\n                                >\n                        </td>\n                        <td>\n                            <select [disabled]="disableAll" class="form-select w-auto" id="inp_gestor_${t+1}_${i}"\n                                >\n                                <option value="-1" selected>Seleccione</option>\n                                <option value="0">Reciclaje Interno</option>\n                                \x3c!-- <option *ngFor="let manager of getManagersForMaterial(type.id)" [value]="manager">{{\n                                    manager }}</option> --\x3e\n                            </select>\n                        </td>\n                        <td>\n                          <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal" id="btn_${t+1}_${i}_modal">Ver</button>\n                        </td>\n                        <td>\n                            \x3c!-- eliminar --\x3e\n                            <button class="btn btn-sm btn-danger" id="btn_${t+1}_${i}">X</button>\n                        </td>\n                    </tr>\n    `;const u=a?.insertRow(a.rows.length);u.innerHTML=s;const f=document.getElementById(`btn_${t+1}_${i}`),y=document.getElementById(`btn_${t+1}_${i}_modal`),d=this.newData;d.push({precedence:-1,row:i,residue:1,sub:"-1",treatment:"-1",ler:"",value:0,date:"",gestor:"-1",files:[]});const M=(p,g,c,r,b,F)=>{this.verifyRow({treatment:p,sub:g,gestor:c,date:r,idEstablishment:F},b)},A=document.getElementById(`inp_treatment_${t+1}_${i}`);function T(p){var g;for(g=p.options.length-1;g>=0;g--)p.remove(g)}A.onchange=()=>{let p=0;for(let c=0;c<d.length;c++){const r=d[c];r.row!=i&&r.sub==h.value&&r.gestor==Z.value&&r.treatment==A.value&&r.precedence==_.value&&p++}if(p>=1)return o().fire({icon:"info",text:"Mismo tratamiento, material, subtipo y gestor para esta fecha"}),void(A.value="0");M(A.value,h.value,Z.value,C.value,A,this.id_compare);const g=d.findIndex(c=>c.row==i&&c.residue==t+1);-1==g?d.push({precedence:"-1",row:i,residue:t+1,sub:"-1",treatment:A.value,ler:"",value:0,date:"",gestor:"-1",files:[]}):d[g].treatment=A.value};const _=document.getElementById(`inp_subcat_${t+1}_${i}`);_.onchange=()=>{this.selectedCategoryId=parseInt(_.value);const p=this.materials.find(b=>b._id===this.selectedCategoryId),g=p?p.child:[];T(h);let c=document.createElement("option");c.value="-1",c.innerHTML="Seleccione Subtipo",h.appendChild(c),g.forEach(b=>{let F=document.createElement("option");F.value=b.id.toString(),F.innerHTML=b.name,h.appendChild(F)});const r=d.findIndex(b=>b.row==i&&b.residue==t+1);-1==r?d.push({precedence:this.selectedCategoryId,row:i,residue:t+1,sub:"-1",treatment:"-1",ler:"",value:0,date:"",gestor:"-1",files:[]}):(d[r].precedence=this.selectedCategoryId,d[r].sub="-1",d[r].gestor="-1"),function D(){T(Z);let p=document.createElement("option");p.value="-1",p.innerHTML="Seleccione",Z.appendChild(p);let g=document.createElement("option");g.value="0",g.innerHTML="Reciclaje Interno",Z.appendChild(g),Y(_.value).forEach(r=>{let b=document.createElement("option");b.value=r.id_gestor,b.innerHTML=r.name,Z.appendChild(b)})}()};const h=document.getElementById(`inp_sub_${t+1}_${i}`);h.onchange=()=>{let p=0;for(let c=0;c<d.length;c++){const r=d[c];r.row!=i&&r.sub==h.value&&r.gestor==Z.value&&r.treatment==A.value&&r.date==C.value&&r.precedence==_.value&&p++}if(p>=1)return o().fire({icon:"info",text:"Mismo tratamiento, material, subtipo y gestor para esta fecha"}),void(h.value="0");M(A.value,h.value,Z.value,C.value,h,this.id_compare);const g=d.findIndex(c=>c.row==i&&c.residue==t+1);-1==g?d.push({precedence:"-1",row:i,residue:t+1,sub:h.value,treatment:"-1",ler:"",value:0,date:"",gestor:"-1",files:[]}):d[g].sub=h.value};const Y=p=>this.managers.filter(r=>r.material===p).map(r=>({id:r.material,name:r.managers,id_gestor:r.id_gestor})),S=document.getElementById(`inp_value_${t+1}_${i}`);S.onchange=()=>{S.value=S.value.replace(".",","),/^[0-9]+(,[0-9]+)?$/.test(S.value)||(o().fire({icon:"info",text:"Solo se admiten n\xfameros"}),S.value="0");const g=d.findIndex(r=>r.row==i&&r.residue==t+1);-1==g?d.push({precedence:"-1",row:i,residue:t+1,sub:"-1",treatment:"-1",ler:"",value:S.value,date:"",gestor:"-1",files:[]}):d[g].value=S.value;let c=0;for(let r=0;r<d.length;r++){const b=d[r];b.residue==t+1&&(c+=parseFloat(b.value.toString().replace(",",".")))}document.getElementById(`table_td_${t+1}`).innerHTML=c.toFixed(2).toString().replace(".",",")};const C=document.getElementById(`inp_date_${t+1}_${i}`);C.onchange=()=>{let p=0;for(let c=0;c<d.length;c++){const r=d[c];r.row!=i&&r.sub==h.value&&r.gestor==Z.value&&r.treatment==A.value&&r.date==C.value&&r.precedence==_.value&&p++}if(p>=1)return o().fire({icon:"info",text:"Mismo tratamiento, material, subtipo y gestor para esta fecha"}),void(C.value="");M(A.value,h.value,Z.value,C.value,C,this.id_compare);const g=d.findIndex(c=>c.row==i&&c.residue==t+1);-1==g?d.push({precedence:"-1",row:i,residue:t+1,sub:"-1",treatment:"-1",ler:"",value:0,date:C.value,gestor:"-1",files:[]}):d[g].date=C.value};const Z=document.getElementById(`inp_gestor_${t+1}_${i}`);Z.onchange=()=>{let p=0;for(let c=0;c<d.length;c++){const r=d[c];r.row!=i&&r.sub==h.value&&r.gestor==Z.value&&r.treatment==A.value&&r.date==C.value&&r.precedence==_.value&&p++}if(p>=1)return o().fire({icon:"info",text:"Mismo tratamiento, material, subtipo y gestor para esta fecha"}),void(Z.value="-1");M(A.value,h.value,Z.value,C.value,Z,this.id_compare);const g=d.findIndex(c=>c.row==i&&c.residue==t+1);-1==g?d.push({precedence:"-1",row:i,residue:t+1,sub:"-1",treatment:"-1",ler:"",value:0,date:"",gestor:Z.value,files:[]}):d[g].gestor=Z.value},f.onclick=()=>{const p=d.findIndex(r=>r.row==i&&r.residue==t+1);d.splice(p,1);let g=0;for(let r=0;r<d.length;r++){const b=d[r];b.residue==t+1&&(g+=parseFloat(b.value.toString().replace(",",".")))}document.getElementById(`table_td_${t+1}`).innerHTML=g.toFixed(2).toString().replace(".",",");const c=a?.rows;for(let r=0;r<c.length;r++)if(c[r]===u){a?.deleteRow(r);break}},y.onclick=()=>{this.tableSelected=t+1,this.rowSelected=i,document.getElementById("id_table_none").innerHTML=`${t+1}`,document.getElementById("id_row_none").innerHTML=`${i}`,document.getElementById("inp_select_mv").value="0",document.getElementById("inp_file_0").value="";const p=d.findIndex(g=>g.row==i&&g.residue==t+1);if(-1!=p)this.filess=d[p].files||[];else{d.push({precedence:"-1",row:i,residue:t+1,sub:"-1",treatment:"-1",ler:"",value:0,date:"",gestor:"-1",files:[]});const c=d.findIndex(r=>r.row==i&&r.residue==t+1);this.filess=d[c].files}}}addFile(){let t=document.getElementById("inp_select_mv").value;if(!t||"0"==t)return void o().fire({icon:"info",text:"Es necesario seleccionar Tipo MV"});if(0==this.tmpFile.length)return void o().fire({icon:"info",text:"Es necesario seleccionar archivo"});const a=this.newData.findIndex(i=>i.residue==this.tableSelected&&i.row==this.rowSelected);if(-1!=a)return 3==this.newData[a].files.length?(o().fire({icon:"info",text:"Se permite m\xe1ximo 3 medios de verificaci\xf3n"}),document.getElementById("inp_select_mv").value="0",void(document.getElementById("inp_file_0").value="")):this.newData[a].files.findIndex(i=>i.type==t)>-1?(o().fire({icon:"warning",text:"Tipo de Medio de Verificaci\xf3n ya fue agregado"}),document.getElementById("inp_select_mv").value="0",void(document.getElementById("inp_file_0").value="")):(this.newData[a].files.push({type:t,file:this.tmpFile[0]}),document.getElementById("inp_select_mv").value="0",document.getElementById("inp_file_0").value="",void(this.tmpFile=[]));o().fire({icon:"error",text:"Ocurri\xf3 un error!."})}selectFile(t){const a=t.target;if(0==a.files.length&&(document.getElementById("inp_file_0").value="",this.tmpFile=[]),a.files[0].size/1e3>1e3)return o().fire({icon:"info",text:"Archivo excede el tama\xf1o permitido (1Mb)."}),void(document.getElementById("inp_file_0").value="");const i=a.files[0].type.split("/");if(2==i.length&&"jpeg"!=i[1]&&"jpg"!=i[1]&&"pdf"!=i[1])return o().fire({icon:"info",text:"Tipo de archivo no permitido. S\xf3lo se permiten extensiones jpg, jpeg o pdf"}),void(document.getElementById("inp_file_0").value="");this.tmpFile=t.target.files}deleteFile(t){const a=this.newData.findIndex(i=>i.residue==this.tableSelected&&i.row==this.rowSelected);if(a>-1&&this.newData[a].files){const i=this.newData[a].files.findIndex(s=>s.type==t.type&&s.file.name==t.file.name);-1==i&&alert("aa"),this.newData[a].files.splice(i,1)}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(k.d),e.Y36(P.h),e.Y36(L.m),e.Y36(x.F0),e.Y36(x.gz),e.Y36(te.b))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-form"]],decls:112,vars:9,consts:[["id",""],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"formulario-ci"],[1,"btn","btn-primary",3,"click"],[1,"row","mb-3"],[1,"container","text-end"],[1,"btn","btn-sm","btn-warning",3,"click"],[1,"table","table-even","table-section","table-borderless","table-border","table-header-green","table-align-middle","text-nowrap"],[1,"th"],[1,"td"],["optionLabel","name","optionValue","ID_ESTABLISHMENT","defaultLabel","Seleccione Establecimiento",3,"readonly","options","ngModel","selectionLimit","selectedItemsLabel","ngModelChange","onChange",4,"ngIf"],["class","table-responsive mb-4",4,"ngFor","ngForOf"],["class","btn btn-primary px-5 mb-4",3,"click",4,"ngIf"],["id","exampleModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title","fs-5"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"container"],[1,"row"],[1,"col-md-12"],["id","id_table_none",1,"d-none"],["id","id_row_none",1,"d-none"],["id","inp_select_mv",1,"form-select"],["value","0"],["value","1"],["value","2"],["value","3"],["value","4"],["value","5"],["value","6"],["id","inp_file_0","type","file",1,"form-control",3,"change"],[1,"col-md-12","text-end"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"row","mt-5"],[4,"ngFor","ngForOf"],["data-bs-dismiss","modal","aria-label","Close",1,"btn","btn-primary","mt-3"],["optionLabel","name","optionValue","ID_ESTABLISHMENT","defaultLabel","Seleccione Establecimiento",3,"readonly","options","ngModel","selectionLimit","selectedItemsLabel","ngModelChange","onChange"],[1,"table-responsive","mb-4"],[1,"text-end"],[1,"btn","btn-primary","mb-1",3,"disabled","click"],[1,"table-header-div","table-header-div-blue"],[1,"table","table-even","table-section","table-borderless","table-border","table-header-green","table-align-middle","text-nowrap",3,"id"],[1,"d-none","d-lg-block"],[1,"d-lg-none"],[3,"id"],["colspan","1"],["colspan","2"],["colspan","1",1,"text-end",3,"id"],["colspan","5"],[1,"btn","btn-primary","px-5","mb-4",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",6),e._uU(8,"Formulario Consumidor Industrial"),e.qZA()()(),e.TgZ(9,"section",7)(10,"button",8),e.NdJ("click",function(){return a.goBack()}),e._uU(11,"Volver"),e.qZA(),e.TgZ(12,"h1"),e._uU(13,"Formulario Consumidor Industrial"),e.qZA(),e.TgZ(14,"div",9)(15,"div",10)(16,"button",11),e.NdJ("click",function(){return a.reset()}),e._uU(17,"Borrar Formulario"),e.qZA()(),e.TgZ(18,"table",12)(19,"thead")(20,"tr")(21,"th",13),e._uU(22,"Nombre Empresa"),e.qZA(),e.TgZ(23,"td",14),e._uU(24),e.qZA()(),e.TgZ(25,"tr")(26,"th"),e._uU(27,"ID Consumidor Industrial"),e.qZA(),e.TgZ(28,"td",14),e._uU(29),e.qZA()(),e.TgZ(30,"tr")(31,"th"),e._uU(32,"Establecimiento"),e.qZA(),e.TgZ(33,"td",14),e.YNc(34,ae,1,5,"p-multiSelect",15),e.qZA()(),e.TgZ(35,"tr")(36,"th"),e._uU(37,"ID Establecimiento VU"),e.qZA(),e.TgZ(38,"td",14),e._uU(39),e.qZA()(),e.TgZ(40,"tr")(41,"th"),e._uU(42,"Regi\xf3n"),e.qZA(),e.TgZ(43,"td",14),e._uU(44),e.qZA()(),e.TgZ(45,"tr")(46,"th"),e._uU(47,"Comuna"),e.qZA(),e.TgZ(48,"td",14),e._uU(49),e.qZA()()()()(),e.YNc(50,ie,41,5,"div",16),e.YNc(51,ne,2,0,"button",17),e.qZA()(),e.TgZ(52,"div",18)(53,"div",19)(54,"div",20)(55,"div",21)(56,"h1",22),e._uU(57,"Medios de Verificaci\xf3n"),e.qZA(),e._UZ(58,"button",23),e.qZA(),e.TgZ(59,"div",24)(60,"div",25)(61,"div",26)(62,"div",27)(63,"p",28),e._uU(64,"eee"),e.qZA(),e.TgZ(65,"p",29),e._uU(66,"eee"),e.qZA(),e.TgZ(67,"table",12)(68,"thead")(69,"tr")(70,"th"),e._uU(71,"Tipo MV"),e.qZA(),e.TgZ(72,"th"),e._uU(73,"Archivo"),e.qZA()()(),e.TgZ(74,"tbody")(75,"tr")(76,"td")(77,"select",30)(78,"option",31),e._uU(79,"Seleccione Tipo MV"),e.qZA(),e.TgZ(80,"option",32),e._uU(81,"Guia de Despacho"),e.qZA(),e.TgZ(82,"option",33),e._uU(83,"Factura Gestor"),e.qZA(),e.TgZ(84,"option",34),e._uU(85,"Registro de peso"),e.qZA(),e.TgZ(86,"option",35),e._uU(87,"Fotograf\xeda Retiro"),e.qZA(),e.TgZ(88,"option",36),e._uU(89,"Balance de masas"),e.qZA(),e.TgZ(90,"option",37),e._uU(91,"Otro"),e.qZA()()(),e.TgZ(92,"td")(93,"input",38),e.NdJ("change",function(s){return a.selectFile(s)}),e.qZA()()()()()(),e.TgZ(94,"div",39)(95,"button",40),e.NdJ("click",function(){return a.addFile()}),e._uU(96,"Agregar"),e.qZA()()(),e.TgZ(97,"div",41)(98,"div",27)(99,"table",12)(100,"thead")(101,"tr")(102,"th"),e._uU(103,"Tipo MV"),e.qZA(),e.TgZ(104,"th"),e._uU(105,"Nombre Archivo"),e.qZA(),e.TgZ(106,"th"),e._uU(107,"Eliminar"),e.qZA()()(),e.TgZ(108,"tbody"),e.YNc(109,se,8,2,"tr",42),e.qZA()()()()(),e.TgZ(110,"button",43),e._uU(111,"Cerrar"),e.qZA()()()()()),2&t&&(e.xp6(24),e.Oqu(a.business_name),e.xp6(5),e.Oqu(a.business_code),e.xp6(5),e.Q6J("ngIf",!a.disableAll),e.xp6(5),e.Oqu(-1!=a.id_establishment?a.id_establishment:""),e.xp6(5),e.Oqu(-1!=a.id_establishment?a.region:""),e.xp6(5),e.Oqu(-1!=a.id_establishment?a.comuna:""),e.xp6(1),e.Q6J("ngForOf",a.tables),e.xp6(1),e.Q6J("ngIf",!a.disableAll),e.xp6(58),e.Q6J("ngForOf",a.filess))},dependencies:[E.sg,E.O5,m.YN,m.Kr,m.JJ,m.On,H.NU],styles:["[_nghost-%COMP%]{width:90%!important;padding:1%}[_nghost-%COMP%]     .p-multiselect{min-width:15rem;font-size:10px;border-radius:100px!important}.td[_ngcontent-%COMP%]{background-color:#faebd7}.th[_ngcontent-%COMP%]{width:150px!important}"]}),n})();var re=v(2227);let oe=(()=>{class n{constructor(t){this.ratesService=t,this.types=["EyE reciclables de papel/cart\xf3n","EyE reciclables de metal","EyE reciclables de pl\xe1sticos","EyE no reciclables"],this.year=(new Date).getFullYear(),this.rates=[]}ngOnInit(){this.ratesService.getRates(this.year).subscribe(t=>{t.status&&t.data.forEach(a=>{this.rates.push({name:this.types[a.type-1],price:a.price})})}),localStorage.removeItem("statementsState")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(re.z))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-home"]],decls:22,vars:0,consts:[["id","content"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],["aria-current","page",1,"breadcrumb-item"],["aria-hidden","true",1,"fa","fa-home"],[1,"inicio"],[1,"box","box-inicio"],[1,"col-12","col-md-8"],[1,"h1"],[2,"visibility","hidden"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3),e._UZ(4,"i",4),e._uU(5," Inicio"),e.qZA()()(),e.TgZ(6,"section",5)(7,"h1"),e._uU(8,"Inicio"),e.qZA(),e.TgZ(9,"div",6)(10,"div")(11,"div",7)(12,"h2",8),e._uU(13,"Bienvenido/a a M\xf3dulo de Consumidor Industrial"),e.qZA(),e.TgZ(14,"p",9),e._uU(15,"Como parte de las obligaciones que establece la Ley REP, los Productores deben informar la cantidad de EyE no domiciliarios (POM) puestos en el mercado el a\xf1o anterior."),e.qZA(),e.TgZ(16,"p",9),e._uU(17,"ProREP pone a disposici\xf3n de sus socios la plataforma de declaraci\xf3n que dar\xe1 cumplimiento a la obligaci\xf3n de informar sus EyE."),e.qZA(),e.TgZ(18,"p",9),e._uU(19,"La informaci\xf3n deber\xe1 subirse en los meses de enero y febrero."),e.qZA(),e.TgZ(20,"p",9),e._uU(21,"En caso de tener dudas con respecto a su declaraci\xf3n puede ver los tutoriales y preguntas frecuentes."),e.qZA()()()()()())}}),n})();var le=v(263);let ce=(()=>{class n{constructor(t,a,i){this.fb=t,this.authService=a,this.router=i,this.pos="right",this.horaIngreso=new Date,this.formData=this.fb.group({actual:["",[m.kI.required]],password:["",[m.kI.required,m.kI.minLength(3)]],repeatPassword:["",[m.kI.required,m.kI.minLength(3)]]})}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.horaIngreso=new Date(sessionStorage.getItem("horaIngreso")),localStorage.removeItem("statementsState")}btnrecovery(){const{actual:t,password:a,repeatPassword:i}=this.formData.value;this.authService.modifyPassword(a,i,t).subscribe({next:s=>{s.status?(o().fire({title:"Cambio de contrase\xf1a",text:"La contrase\xf1a fue cambiada exitosamente",icon:"success"}),this.router.navigate(["/consumidor/home"])):(o().fire({title:"Validar informaci\xf3n",text:s.msg,icon:"error"}),this.formData.reset())},error:s=>{o().fire({title:"Formato inv\xe1lido",text:"Contrase\xf1a debe contener al menos 8 caracteres",icon:"error"})}})}displayModifyPassword(){this.pos="right"==this.pos?"down":"right"}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m.qu),e.Y36(le.e),e.Y36(x.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-profile"]],decls:81,vars:16,consts:[[1,"container","mt-4"],[1,"mi-perfil"],[1,"box","box-mi-perfil","mb-5","d-flex","align-items-start"],[1,"list","list-data","list-data-title-green","column-md-2","gap-0","list-unstyled"],[1,"list-data__title"],[1,"list-data__text"],[1,"color-verde"],[1,"list","list-links","list-unstyled"],["id","accordionPanelsStayOpenExample",1,"accordion","accordion-flush"],[1,"accordion-item"],["id","panelsStayOpen-headingOne",1,"accordion-header"],["data-bs-toggle","collapse","data-bs-target","#panelsStayOpen-collapseOne",3,"click"],["aria-hidden","true"],["id","panelsStayOpen-collapseOne","aria-labelledby","panelsStayOpen-headingOne",1,"accordion-collapse","collapse"],[1,"accordion-body"],["autocomplete","off",1,"form-recovery",3,"formGroup"],[1,"mb-4"],[1,"input-group"],[1,"input-group-text","input-group-text-left"],["aria-hidden","true",1,"fa","fa-lock","fa-fw"],["type","password","id","password","formControlName","actual","placeholder","Contrase\xf1a actual",1,"form-control"],["type","password","id","password","formControlName","password","placeholder","Nueva contrase\xf1a",1,"form-control"],["type","password","id","repeatPassword","formControlName","repeatPassword","placeholder","Repetir contrase\xf1a",1,"form-control"],["type","button",1,"btn","btn-primary","btn-fa","w-100",3,"click"],["aria-hidden","true",1,"fa","fa-long-arrow-right","fa-fw"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"section",1)(2,"h1"),e._uU(3,"Mi Perfil"),e.qZA(),e.TgZ(4,"div",2)(5,"ul",3)(6,"li")(7,"span",4),e._uU(8,"Nombre Usuario"),e.qZA(),e.TgZ(9,"span",5),e._uU(10),e.qZA()(),e.TgZ(11,"li")(12,"span",4),e._uU(13,"Perfil"),e.qZA(),e.TgZ(14,"span",5),e._uU(15),e.qZA()(),e.TgZ(16,"li")(17,"span",4),e._uU(18,"Tel\xe9fono"),e.qZA(),e.TgZ(19,"span",5),e._uU(20),e.qZA()(),e.TgZ(21,"li")(22,"span",4),e._uU(23,"Correo"),e.qZA(),e.TgZ(24,"span",5),e._uU(25),e.qZA()(),e.TgZ(26,"li")(27,"span",4),e._uU(28,"Instituci\xf3n"),e.qZA(),e.TgZ(29,"span",5),e._uU(30),e.qZA()(),e.TgZ(31,"li")(32,"span",4),e._uU(33,"Cargo"),e.qZA(),e.TgZ(34,"span",5),e._uU(35),e.qZA()(),e.TgZ(36,"li")(37,"span",4),e._uU(38,"Tel\xe9fono Oficina"),e.qZA(),e.TgZ(39,"span",5),e._uU(40),e.qZA()(),e.TgZ(41,"li")(42,"span",4)(43,"b"),e._uU(44,"Fecha/ Hora ingreso"),e.qZA()(),e.TgZ(45,"span",5),e._uU(46),e.ALo(47,"date"),e.qZA()()()(),e.TgZ(48,"h2",6),e._uU(49,"Acciones"),e.qZA(),e.TgZ(50,"ul",7)(51,"div",8)(52,"div",9)(53,"h2",10)(54,"li",11),e.NdJ("click",function(){return a.displayModifyPassword()}),e.TgZ(55,"a")(56,"span"),e._uU(57,"Cambio de contrase\xf1a"),e.qZA(),e._UZ(58,"i",12),e.qZA()()(),e.TgZ(59,"div",13)(60,"div",14)(61,"form",15)(62,"div",16)(63,"div",17)(64,"button",18),e._UZ(65,"i",19),e.qZA(),e._UZ(66,"input",20),e.qZA()(),e.TgZ(67,"div",16)(68,"div",17)(69,"button",18),e._UZ(70,"i",19),e.qZA(),e._UZ(71,"input",21),e.qZA()(),e.TgZ(72,"div",16)(73,"div",17)(74,"button",18),e._UZ(75,"i",19),e.qZA(),e._UZ(76,"input",22),e.qZA()(),e.TgZ(77,"div",16)(78,"button",23),e.NdJ("click",function(){return a.btnrecovery()}),e._uU(79," Enviar "),e._UZ(80,"i",24),e.qZA()()()()()()()()()()),2&t&&(e.xp6(10),e.AsE("",a.userData.FIRST_NAME," ",a.userData.LAST_NAME,""),e.xp6(5),e.Oqu(a.userData.ROL_NAME),e.xp6(5),e.Oqu(a.userData.PHONE),e.xp6(5),e.Oqu(a.userData.EMAIL),e.xp6(5),e.Oqu(a.userData.BUSINESS.join(" || ")),e.xp6(5),e.Oqu(a.userData.POSITION),e.xp6(5),e.Oqu(a.userData.PHONE_OFFICE),e.xp6(6),e.Oqu(e.xi3(47,13,a.horaIngreso,"dd-MM-yyyy H:mm:s")),e.xp6(12),e.Gre("fa fa-chevron-",a.pos,""),e.xp6(3),e.Q6J("formGroup",a.formData))},dependencies:[m._Y,m.Fj,m.JJ,m.JL,m.sg,m.u,E.uU]}),n})();var j=v(371);function de(n,l){if(1&n&&(e.TgZ(0,"option",30),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function ue(n,l){if(1&n&&(e.TgZ(0,"option",30),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function me(n,l){if(1&n&&(e.TgZ(0,"option",30),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function pe(n,l){if(1&n&&(e.TgZ(0,"option",30),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function he(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.ALo(15,"date"),e.qZA(),e.TgZ(16,"td"),e._UZ(17,"span",31),e.qZA(),e.TgZ(18,"td")(19,"a",32),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw();return e.KtG(u.goToDetails(s.ID_HEADER,s.ID_DETAIL))}),e._UZ(20,"i",33),e.qZA()()()}if(2&n){const t=l.$implicit,a=e.oxw();e.xp6(2),e.Oqu(t.NAME_BUSINESS),e.xp6(2),e.Oqu(t.NAME_ESTABLISHMENT_REGION),e.xp6(2),e.Oqu(t.TipoTratamiento),e.xp6(2),e.Oqu(t.PRECEDENCE),e.xp6(2),e.Oqu(t.TYPE_RESIDUE),e.xp6(2),e.hij(" ",a.formatValue(t.VALUE)," "),e.xp6(2),e.Oqu(e.Dn7(15,8,t.FechaRetiro,"dd-MM-yyyy","UTC")),e.xp6(3),e.Q6J("ngClass",t.semaforo?"circle green-circle":"circle red-circle")}}const ge=function(n,l){return{"btn-info":n,"btn-primary":l}};function fe(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"li")(1,"button",34),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw();return e.KtG(u.pagTo(s))}),e._uU(2),e.qZA()()}if(2&n){const t=l.$implicit,a=e.oxw();e.xp6(1),e.Q6J("ngClass",e.WLB(2,ge,a.pos===t+1,a.pos!==t+1)),e.xp6(1),e.Oqu(t+1)}}let _e=(()=>{class n{constructor(t,a,i,s){this.productorService=t,this.establishmentService=a,this.router=i,this.location=s,this.dbStatements=[],this.db=[],this.pos=1,this.business_name=[],this.establishment_name=[],this.material_name=[],this.treatment_name=[],this.years=[],this.cant=0,this.filteredStatements=[],this.selectedBusiness="-1",this.selectedEstablishment="-1",this.selectedMaterial="-1",this.selectedYear="-1",this.filtersApplied=!1,this.autoFilter=!0}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.loadState();const t=this.location.getState(),a=t&&t.url&&!t.url.match(/\/consumidor\/statements\/\d+/);t.navigationId&&a&&this.resetFilters(),this.loadStatements().then(()=>{this.updateFilters(),this.filtersApplied||(this.filter(),this.pagTo(this.pos-1),this.filtersApplied=!0)})}formatValue(t){return t%1==0?t.toString():t.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})}resetFilters(){this.selectedBusiness="-1",this.selectedEstablishment="-1",this.selectedMaterial="-1",this.selectedYear="-1"}loadStatements(){return new Promise(t=>{o().fire({title:"Cargando Datos",text:"Se est\xe1n recuperando datos",timerProgressBar:!0,showConfirmButton:!1,allowEscapeKey:!1,allowOutsideClick:!1}),o().showLoading(),this.establishmentService.getDeclarationEstablishment().subscribe(a=>{a.status&&(a.status=a.status.sort((i,s)=>new Date(s.FechaRetiro).getTime()-new Date(i.FechaRetiro).getTime()),a.status.forEach(i=>{-1==this.business_name.indexOf(i.NAME_BUSINESS)&&this.business_name.push(i.NAME_BUSINESS),-1==this.establishment_name.indexOf(i.NAME_ESTABLISHMENT_REGION)&&this.establishment_name.push(i.NAME_ESTABLISHMENT_REGION),-1==this.years.indexOf(i.FechaRetiroTipeada)&&this.years.push(i.FechaRetiroTipeada),-1==this.material_name.indexOf(i.TYPE_RESIDUE)&&this.material_name.push(i.TYPE_RESIDUE),-1==this.treatment_name.indexOf(i.TipoTratamiento)&&this.treatment_name.push(i.TipoTratamiento)}),this.years.sort((i,s)=>s-i),this.dbStatements=a.status,this.cant=Math.ceil(this.dbStatements.length/10),this.db=this.dbStatements.slice(10*(this.pos-1),10*this.pos).sort((i,s)=>new Date(s.FechaRetiro).getTime()-new Date(i.FechaRetiro).getTime()).reverse(),o().close()),t()})})}filter(t=!1){t&&!this.autoFilter||(this.filteredStatements=this.dbStatements.filter(a=>!("-1"!==this.selectedBusiness&&a.NAME_BUSINESS!==this.selectedBusiness||"-1"!==this.selectedEstablishment&&a.NAME_ESTABLISHMENT_REGION!==this.selectedEstablishment||"-1"!==this.selectedMaterial&&a.PRECEDENCE!==this.selectedMaterial||"-1"!==this.selectedYear&&a.FechaRetiroTipeada!==this.selectedYear)),this.db=this.filteredStatements.slice(0,10).sort((a,i)=>new Date(i.FechaRetiro).getTime()-new Date(a.FechaRetiro).getTime()).reverse(),this.cant=Math.ceil(this.filteredStatements.length/10),this.saveState(),this.filtersApplied=!1)}updateFilters(){this.business_name=this.dbStatements.filter(t=>!("-1"!==this.selectedEstablishment&&t.NAME_ESTABLISHMENT_REGION!==this.selectedEstablishment||"-1"!==this.selectedMaterial&&t.PRECEDENCE!==this.selectedMaterial||"-1"!==this.selectedYear&&t.FechaRetiroTipeada!==this.selectedYear)).map(t=>t.NAME_BUSINESS).filter((t,a,i)=>i.indexOf(t)===a),this.establishment_name=this.dbStatements.filter(t=>!("-1"!==this.selectedBusiness&&t.NAME_BUSINESS!==this.selectedBusiness||"-1"!==this.selectedMaterial&&t.PRECEDENCE!==this.selectedMaterial||"-1"!==this.selectedYear&&t.FechaRetiroTipeada!==this.selectedYear)).map(t=>t.NAME_ESTABLISHMENT_REGION).filter((t,a,i)=>i.indexOf(t)===a),this.material_name=this.dbStatements.filter(t=>!("-1"!==this.selectedBusiness&&t.NAME_BUSINESS!==this.selectedBusiness||"-1"!==this.selectedEstablishment&&t.NAME_ESTABLISHMENT_REGION!==this.selectedEstablishment||"-1"!==this.selectedYear&&t.FechaRetiroTipeada!==this.selectedYear)).map(t=>t.PRECEDENCE).filter((t,a,i)=>i.indexOf(t)===a),this.years=this.dbStatements.filter(t=>!("-1"!==this.selectedBusiness&&t.NAME_BUSINESS!==this.selectedBusiness||"-1"!==this.selectedEstablishment&&t.NAME_ESTABLISHMENT_REGION!==this.selectedEstablishment||"-1"!==this.selectedMaterial&&t.PRECEDENCE!==this.selectedMaterial)).map(t=>t.FechaRetiroTipeada).filter((t,a,i)=>i.indexOf(t)===a).sort((t,a)=>a-t)}reset(){this.loadStatements()}pagTo(t){this.pos=t+1,this.db=this.filteredStatements.slice(10*t,10*(t+1)).sort((a,i)=>new Date(a.FechaRetiro).getTime()-new Date(i.FechaRetiro).getTime()).reverse()}next(){this.pos>=this.cant||(this.pos++,this.db=this.filteredStatements.slice(10*(this.pos-1),10*this.pos).sort((t,a)=>new Date(t.FechaRetiro).getTime()-new Date(a.FechaRetiro).getTime()).reverse())}previus(){this.pos-1<=0||this.pos>=this.cant+1||(this.pos=this.pos-1,this.db=this.filteredStatements.slice(10*(this.pos-1),10*this.pos).sort((t,a)=>new Date(t.FechaRetiro).getTime()-new Date(a.FechaRetiro).getTime()).reverse())}setArrayFromNumber(){return new Array(this.cant)}visiblePageNumbers(){const t=this.setArrayFromNumber().length,a=[];if(t<=15)for(let i=0;i<t;i++)a.push(i);else{let i=Math.max(0,this.pos-Math.floor(7.5)),s=Math.min(t-1,i+14);s-i+1<15&&(s=t-1,i=Math.max(0,s-14));for(let u=i;u<=s;u++)a.push(u)}return a}saveState(){localStorage.setItem("statementsState",JSON.stringify({selectedBusiness:this.selectedBusiness,selectedEstablishment:this.selectedEstablishment,selectedMaterial:this.selectedMaterial,selectedYear:this.selectedYear,pos:this.pos}))}loadState(){const t=JSON.parse(localStorage.getItem("statementsState")||"{}");t&&(this.selectedBusiness=t.selectedBusiness||"-1",this.selectedEstablishment=t.selectedEstablishment||"-1",this.selectedMaterial=t.selectedMaterial||"-1",this.selectedYear=t.selectedYear||"-1",this.pos=t.pos||1)}goToDetails(t,a){this.saveState(),this.router.navigate(["/consumidor/statements/",t,a])}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(j.u),e.Y36(k.d),e.Y36(x.F0),e.Y36(E.Ye))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-statements"]],decls:90,vars:10,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"declaracion"],[1,"box","box-form","mb-4"],[1,"row","align-items-end"],[1,"col-12","col-xl-2","mb-3","mb-xl-0"],[1,"form-label"],[1,"input-group"],["id","f_name",1,"form-select",3,"ngModel","ngModelChange","change"],["value","-1","selected",""],[3,"value",4,"ngFor","ngForOf"],["id","f_establishment",1,"form-select",3,"ngModel","ngModelChange","change"],["id","f_material",1,"form-select",3,"ngModel","ngModelChange","change"],["id","f_year",1,"form-select",3,"ngModel","ngModelChange","change"],[1,"col-12","col-xl-4","mb-3","mb-xl-0"],[1,"row"],[1,"col-6"],[1,"btn","btn-primary","col-12",3,"click"],[1,"table-responsive"],[1,"table","table-even","table-section","table-borderless","table-radius"],[1,"vertical-middle"],[4,"ngFor","ngForOf"],["aria-label","Navegaci\xf3n resultados"],[1,"pagination"],[1,"btn","btn-primary",3,"click"],[3,"value"],[3,"ngClass"],[1,"custom-cursor",3,"click"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","fa-fw","color-verde"],[1,"border","btn","btn-sm",3,"ngClass","click"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",6),e._uU(8,"Consulta de Declaraci\xf3n"),e.qZA()()(),e.TgZ(9,"section",7)(10,"h1"),e._uU(11,"Consulta de Declaraci\xf3n"),e.qZA(),e.TgZ(12,"div",8)(13,"div",9)(14,"div",10)(15,"label",11),e._uU(16,"Empresa:"),e.qZA(),e.TgZ(17,"div",12)(18,"select",13),e.NdJ("ngModelChange",function(s){return a.selectedBusiness=s})("change",function(){return a.updateFilters()}),e.TgZ(19,"option",14),e._uU(20,"Todos"),e.qZA(),e.YNc(21,de,2,2,"option",15),e.qZA()()(),e.TgZ(22,"div",10)(23,"label",11),e._uU(24,"Establecimiento"),e.qZA(),e.TgZ(25,"div",12)(26,"select",16),e.NdJ("ngModelChange",function(s){return a.selectedEstablishment=s})("change",function(){return a.updateFilters()}),e.TgZ(27,"option",14),e._uU(28,"Todos"),e.qZA(),e.YNc(29,ue,2,2,"option",15),e.qZA()()(),e.TgZ(30,"div",10)(31,"label",11),e._uU(32,"Material:"),e.qZA(),e.TgZ(33,"div",12)(34,"select",17),e.NdJ("ngModelChange",function(s){return a.selectedMaterial=s})("change",function(){return a.updateFilters()}),e.TgZ(35,"option",14),e._uU(36,"Todos"),e.qZA(),e.YNc(37,me,2,2,"option",15),e.qZA()()(),e.TgZ(38,"div",10)(39,"label",11),e._uU(40,"A\xf1o/Mes de retiro:"),e.qZA(),e.TgZ(41,"div",12)(42,"select",18),e.NdJ("ngModelChange",function(s){return a.selectedYear=s})("change",function(){return a.updateFilters()}),e.TgZ(43,"option",14),e._uU(44,"Todos"),e.qZA(),e.YNc(45,pe,2,2,"option",15),e.qZA()()(),e.TgZ(46,"div",19)(47,"div",20)(48,"div",21)(49,"button",22),e.NdJ("click",function(){return a.autoFilter=!1,a.filter(),a.pagTo(0)}),e._uU(50,"Mostrar"),e.qZA()()()()()(),e.TgZ(51,"div",23)(52,"table",24)(53,"thead",25)(54,"tr")(55,"th"),e._uU(56,"Empresa"),e.qZA(),e.TgZ(57,"th"),e._uU(58,"Establecimiento"),e.qZA(),e.TgZ(59,"th"),e._uU(60,"Tipo de tratamiento"),e.qZA(),e.TgZ(61,"th"),e._uU(62,"Material"),e.qZA(),e.TgZ(63,"th"),e._uU(64,"Subtipo"),e.qZA(),e.TgZ(65,"th"),e._uU(66,"Peso"),e.qZA(),e.TgZ(67,"th"),e._uU(68,"Fecha Retiro"),e.qZA(),e.TgZ(69,"th"),e._uU(70,"Estado"),e.qZA(),e.TgZ(71,"th"),e._uU(72,"Ver detalle"),e.qZA()()(),e.TgZ(73,"tbody"),e.YNc(74,he,21,12,"tr",26),e.qZA()()(),e.TgZ(75,"nav",27)(76,"ul",28)(77,"li")(78,"button",29),e.NdJ("click",function(){return a.pagTo(0)}),e._uU(79,"Primero"),e.qZA()(),e.TgZ(80,"li")(81,"button",29),e.NdJ("click",function(){return a.previus()}),e._uU(82,"Anterior"),e.qZA()(),e.YNc(83,fe,3,5,"li",26),e.TgZ(84,"li")(85,"button",29),e.NdJ("click",function(){return a.next()}),e._uU(86,"Siguiente"),e.qZA()(),e.TgZ(87,"li")(88,"button",29),e.NdJ("click",function(){return a.pagTo(a.cant-1)}),e._uU(89,"\xdaltimo"),e.qZA()()()()()()),2&t&&(e.xp6(18),e.Q6J("ngModel",a.selectedBusiness),e.xp6(3),e.Q6J("ngForOf",a.business_name),e.xp6(5),e.Q6J("ngModel",a.selectedEstablishment),e.xp6(3),e.Q6J("ngForOf",a.establishment_name),e.xp6(5),e.Q6J("ngModel",a.selectedMaterial),e.xp6(3),e.Q6J("ngForOf",a.material_name),e.xp6(5),e.Q6J("ngModel",a.selectedYear),e.xp6(3),e.Q6J("ngForOf",a.years),e.xp6(29),e.Q6J("ngForOf",a.db),e.xp6(9),e.Q6J("ngForOf",a.visiblePageNumbers()))},dependencies:[E.mk,E.sg,m.YN,m.Kr,m.EJ,m.JJ,m.On,E.uU],styles:["[_nghost-%COMP%]{width:90%!important;padding:1%}.circle[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%;display:inline-block;margin-right:5px}.green-circle[_ngcontent-%COMP%]{background-color:green}.red-circle[_ngcontent-%COMP%]{background-color:red}.custom-cursor[_ngcontent-%COMP%]{cursor:pointer}"]}),n})();var Q=v(574);const be=["fileInput"];function ve(n,l){if(1&n&&(e.TgZ(0,"option",25),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.s9C("value",t.ID),e.xp6(1),e.AsE("",t.CODE_BUSINESS," - ",t.NAME,"")}}let Te=(()=>{class n{constructor(t,a,i){this.consumer=t,this.businessService=a,this.establishmentService=i,this.dbBusiness=[]}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.loadStatements(),localStorage.removeItem("statementsState")}downloadExcel(){const t=document.getElementById("f_name").value;"-1"!=t?this.consumer.downloadExcel(t).subscribe({next:a=>{if(a){const i=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});let s=document.createElement("a");s.href=window.URL.createObjectURL(i),s.download="carga masiva",document.body.appendChild(s),s.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),s.remove(),window.URL.revokeObjectURL(s.href)}},error:a=>{o().fire({icon:"error",text:"Empresa no tiene ning\xfan establecimiento creado en el sistema . En caso de ser necesario, contacte al administrador del sistema."})}}):o().fire({icon:"error",text:"Debe seleccionar empresa"})}loadStatements(){o().fire({title:"Cargando Datos",text:"Se est\xe1 recuperando datos",timerProgressBar:!0,showConfirmButton:!1,allowEscapeKey:!1,allowOutsideClick:!1}),o().showLoading(),this.businessService.getBusinessByUser.subscribe(t=>{t.status&&(this.dbBusiness=t.data,o().close())})}onFileChange(t){const i=t.target;if(1!==i.files.length)return void o().fire({icon:"error",text:"Solo puede cargar un archivo a la vez"});const s=i.files[0];if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(s.type))return void o().fire({icon:"error",text:"Tipo de archivo incorrecto. Por favor, cargue un archivo Excel (.xls o .xlsx)"});const u=new FileReader;u.onload=f=>{const d=Q.ij(f.target.result,{type:"binary"});if(!d.SheetNames.includes("Carga Masiva"))return void o().fire({icon:"error",text:'No se encontr\xf3 la hoja "Carga Masiva" en el archivo'});const M=Q.P6.sheet_to_json(d.Sheets["Carga Masiva"],{header:1});this.processData(M)},u.readAsBinaryString(s),this.resetFileInput()}resetFileInput(){this.fileInput.nativeElement.value=""}processData(t){var a=this;return(0,G.Z)(function*(){if(0==t.length)return void o().fire({icon:"error",text:"Archivo inv\xe1lido. No tiene todas las columnas necesarias"});const i=t.slice(3).filter(T=>T.length>0&&T.some(_=>_)),s=[];if(!t[0][1])return void o().fire({icon:"error",text:"Error en fila 1. Campo RUT no puede venir vac\xedo"});let f=t[1][1];if(!f)return void o().fire({icon:"error",text:"Error en fila 2. Campo Raz\xf3n Social no puede venir vac\xedo"});let y=f.split(" - ");if(yield a.businessService.getBusinessByCode(y[0]).toPromise(),9!=t[2].length)return void o().fire({icon:"error",text:"Archivo inv\xe1lido. No tiene todas las columnas necesarias"});if(0==i.length)return void o().fire({icon:"info",text:"Archivo est\xe1 vac\xedo (faltan campos por rellenar)."});for(let T=0;T<i.length;T++){const _=i[T],h=T+4;if(0==_.length&&0==T)return void o().fire({icon:"error",text:"Archivo vac\xedo"});for(let V=T+1;V<i.length;V++){const U=i[V];if(U[0]===_[0]&&U[3]===_[3]&&U[4]===_[4]&&U[6]===_[6]&&U[1]===_[1]&&U[2]===_[2])return void o().fire({icon:"info",text:`Error en fila ${h}. Se repite en el archivo el mismo Establecimiento, Subcategor\xeda, Tratamiento y Gestor para esta Fecha de Retiro. Por favor, revisar.`})}const D=_[0];if(!D||""===D.trim())return void o().fire({icon:"error",text:`Error en fila ${h}. Campo   ID VU ESTABLECIMIENTO no puede venir vac\xedo`});if(!_[1])return void o().fire({icon:"error",text:`Error en fila ${h}. Campo SUBCATEGORIA no puede venir vac\xedo`});if(!_[2])return void o().fire({icon:"error",text:`Error en fila ${h}. Campo TIPO TRATAMIENTO no puede venir vac\xedo`});if(!_[3])return void o().fire({icon:"error",text:`Error en fila ${h}. Campo SUBTIPO no puede venir vac\xedo`});const Z=_[4],p=a.isValidDate(Z);if(!p.valid)return void o().fire({icon:"error",text:`Error en la fila ${h}. ${p.message}`});if(!_[5])return void o().fire({icon:"error",text:`Error en fila ${h}. Campo NUM GUIA DESPACHO no puede venir vac\xedo`});const c=_[6];if(!c)return void o().fire({icon:"error",text:`Error en fila ${h}. Campo GESTOR no puede venir vac\xedo`});let r=c.split(" - "),b=yield a.businessService.getBusinessByCode(r[2]).toPromise();if(1==r[0]&&(b=0),!_[7])return void o().fire({icon:"error",text:`Error en fila ${h}. Campo  ID VU GESTOR no puede venir vac\xedo`});if(null==_[8])return void o().fire({icon:"error",text:`Error en fila ${h}. Campo CANTIDAD (KG) no puede venir vac\xedo.`});const ke=_[8].toString().replace(",","."),O=parseFloat(ke);if(O<=0)return void o().fire({icon:"error",text:`Cantidad debe ser num\xe9rica mayor que cero en fila ${h}.`});if(isNaN(O)||!O)return void o().fire({icon:"error",text:`Cantidad no v\xe1lida en la fila ${h}. Aseg\xfarese de usar una coma como separador de decimales`});const N=a.convertPrecedence(_[1]);if(-1==N)return void o().fire({icon:"error",text:`Subcategor\xeda no v\xe1lida en fila: ${h}`});const B=a.convertTypeResidue(_[3]);if(-1==B)return void o().fire({icon:"error",text:`Tipo de residuo no v\xe1lido en fila: ${h}`});if(!(yield a.consumer.verifyMaterial(N,B).toPromise()).status)return void o().fire({icon:"error",text:`Error en fila ${h}. Subtipo no corresponde a la subcategor\xeda`});const J=a.convertTreatmentType(_[2]);if(-1==J)return void o().fire({icon:"error",text:`Tipo de tratamiento no v\xe1lido en fila: ${h}`});const Pe=a.convertDate(Z);let q=_[0].split(" - "),K=(yield a.establishmentService.getIdByEstablishment(q[0],q[1],q[2],q[3]).toPromise()).status[0].ID;const R=0===b?0:b.data.business[0].ID;if(!(yield a.consumer.checkRow({treatment:J,sub:B,gestor:R,date:Pe,idEstablishment:K}).toPromise()).status)return void o().fire({icon:"info",text:`La declaraci\xf3n de la fila ${h} ya ha sido declarada, Mismo tratamiento, material, subtipo y gestor para esta fecha`});if(q[1]!=r[1]&&0!=R)return void o().fire({icon:"error",text:`La regi\xf3n del gestor en la fila ${h} no coincide con la del establecimiento seleccionado.`});if(!(yield a.consumer.verifyGestor(r[2],N).toPromise()).status&&0!=R)return void o().fire({icon:"error",text:`Error en fila ${h}. Gestor no corresponde a la subcategor\xeda ni al establecimiento`});s.push({establishmentId:K,date:Z,precedence:N,typeResidue:B,quantity:O,LER:"",treatmentType:J,businessId:R})}const M=a.userData.ID,A=(new Date).toISOString().replace("T"," ").replace("Z","");for(const T of s){const _=T.date.split("/")[2];a.consumer.saveHeaderFromExcel({establishmentId:T.establishmentId,createdBy:M,createdAt:A,updatedAt:A,yearStatement:_}).subscribe(D=>{if(D.status){{const S={ID_HEADER:D.data.header.insertId,PRECEDENCE:T.precedence,TYPE_RESIDUE:T.typeResidue,VALUE:parseFloat(T.quantity.toFixed(2).replace(",",".")),DATE_WITHDRAW:a.convertDate(T.date),ID_GESTOR:T.businessId,LER:T.LER,TREATMENT_TYPE:T.treatmentType};a.consumer.saveDetailFromExcel(S).subscribe(C=>{C.status||o().fire({icon:"error",text:"Hubo un problema al guardar los datos en la tabla detail_industrial_consumer_form"})})}o().fire({icon:"success",text:"Se ha subido el archivo Excel correctamente y los datos se han guardado en la base de datos"})}else o().fire({icon:"error",text:"Hubo un problema al guardar los datos en la tabla header_industrial_consumer_form"})})}})()}isValidDate(t){if(typeof t>"u"||""===t.trim())return{valid:!1,message:"La fecha no puede estar vac\xeda."};const a=t.split("/");if(3!==a.length||isNaN(+a[0])||isNaN(+a[1])||isNaN(+a[2]))return{valid:!1,message:"El formato de la fecha es incorrecto. Formato requerido: DD/MM/AAAA"};const i=new Date(+a[2],+a[1]-1,+a[0]);return(new Date).setHours(0,0,0,0),i.getDate()!==+a[0]||i.getMonth()!==+a[1]-1||i.getFullYear()!==+a[2]?{valid:!1,message:"La fecha proporcionada no es v\xe1lida."}:{valid:!0,message:""}}convertPrecedence(t){switch(t){case"Papel/Cart\xf3n":return 1;case"Metal":return 2;case"Pl\xe1stico":return 3;case"Madera":return 4;case"Mezclados":return 5;default:return-1}}convertTypeResidue(t){switch(t){case"Papel":return 1;case"Papel Compuesto (cemento)":return 2;case"Caja Cart\xf3n":return 3;case"Esquineros Conos":return 4;case"Cart\xf3n RH":return 5;case"Papel Otros":return 6;case"Envase Aluminio":return 7;case"Malla o Reja (IBC)":return 8;case"Envase Hojalata":return 9;case"Esquineros Metal":return 10;case"Metal Otros":return 11;case"Pl\xe1stico Film Embalaje":return 12;case"Pl\xe1stico Envases Rigidos (Incl. Tapas)":return 13;case"Pl\xe1stico Saco o Maxisacos":return 14;case"Pl\xe1stico EPS (Poliestireno Expandido)":return 15;case"Pl\xe1stico Zuncho":return 16;case"Pl\xe1stico Otros":return 17;case"Caja de Madera":return 18;case"Pallet de Madera":return 19;case"EyE sin separaci\xf3n":return 20;default:return-1}}convertTreatmentType(t){switch(t){case"Reciclaje Mec\xe1nico":return 1;case"Valorizaci\xf3n Energ\xe9tica":return 2;case"Disposici\xf3n Final en RS":return 3;case"Reciclaje Interno":return 4;case"Preparaci\xf3n Reutilizaci\xf3n":return 5;case"DF en Relleno Seguridad":return 6;default:return-1}}convertDate(t){const a=t.split("/");return`${a[2]}-${a[1].padStart(2,"0")}-${a[0].padStart(2,"0")}`}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(P.h),e.Y36(L.m),e.Y36(k.d))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-bulk-upload"]],viewQuery:function(t,a){if(1&t&&e.Gf(be,5),2&t){let i;e.iGM(i=e.CRH())&&(a.fileInput=i.first)}},decls:35,vars:1,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"declaracion"],[1,"d-sm-flex","justify-content-between","mb-3","mb-md-0"],[1,"box","box-form","mb-4"],[1,"row","align-items-end"],[1,"col-12","col-xl-6","mb-3"],[1,"form-label"],[1,"input-group"],["id","f_name",1,"form-select"],["value","-1","selected",""],[3,"value",4,"ngFor","ngForOf"],[1,"row"],[1,"col-6"],[1,"btn","btn-primary","col-12","mb-2",3,"click"],[1,"fas","fa-download"],["type","file","id","file-input","accept",".xls,.xlsx,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",2,"display","none",3,"change"],["fileInput",""],[1,"btn","btn-primary","col-12",3,"click"],[1,"fas","fa-upload"],[3,"value"]],template:function(t,a){if(1&t){const i=e.EpF();e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",6),e._uU(8,"Carga Masiva"),e.qZA()()(),e.TgZ(9,"section",7)(10,"h1"),e._uU(11,"Carga Masiva"),e.qZA(),e._UZ(12,"div",8),e.TgZ(13,"div",9)(14,"div",10)(15,"div",11)(16,"label",12),e._uU(17,"Empresa:"),e.qZA(),e.TgZ(18,"div",13)(19,"select",14)(20,"option",15),e._uU(21,"Seleccionar Empresa"),e.qZA(),e.YNc(22,ve,2,3,"option",16),e.qZA()()(),e.TgZ(23,"div",11)(24,"div",17)(25,"div",18)(26,"button",19),e.NdJ("click",function(){return a.downloadExcel()}),e._UZ(27,"i",20),e._uU(28," Descargar Plantilla "),e.qZA()(),e.TgZ(29,"div",18)(30,"input",21,22),e.NdJ("change",function(u){return a.onFileChange(u)}),e.qZA(),e.TgZ(32,"button",23),e.NdJ("click",function(){e.CHM(i);const u=e.MAs(31);return e.KtG(u.click())}),e._UZ(33,"i",24),e._uU(34," Cargar "),e.qZA()()()()()()()()}2&t&&(e.xp6(22),e.Q6J("ngForOf",a.dbBusiness))},dependencies:[E.sg,m.YN,m.Kr],styles:["[_nghost-%COMP%]{width:90%!important;padding:1%}.circle[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%;display:inline-block;margin-right:5px}.green-circle[_ngcontent-%COMP%]{background-color:green}.red-circle[_ngcontent-%COMP%]{background-color:red}"]}),n})();function Ze(n,l){if(1&n&&(e.TgZ(0,"option",46),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.Q6J("value",t.value),e.xp6(1),e.Oqu(t.name)}}function Ae(n,l){1&n&&(e.TgZ(0,"p"),e._uU(1,"Debe seleccionar algun tipo de MV."),e.qZA())}function Ce(n,l){if(1&n&&(e.TgZ(0,"div",47),e.YNc(1,Ae,2,0,"p",45),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.MV.errors.required)}}function Ee(n,l){1&n&&(e.TgZ(0,"p"),e._uU(1,"El formato del archivo debe ser PDF, JPEG o JPG."),e.qZA())}function Se(n,l){1&n&&(e.TgZ(0,"p"),e._uU(1,"El tama\xf1o del archivo no debe superar 1 MB."),e.qZA())}function ye(n,l){if(1&n&&(e.TgZ(0,"div",47),e.YNc(1,Ee,2,0,"p",45),e.YNc(2,Se,2,0,"p",45),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.ARCHIVO.errors.invalidFileType),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.ARCHIVO.errors.invalidFileSize)}}function xe(n,l){1&n&&(e.TgZ(0,"div",48),e._uU(1," No se pueden subir m\xe1s de 3 archivos de verificaci\xf3n. "),e.qZA())}function Me(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"tr",51)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td")(4,"a",53),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.downloadFile(s.ID,s.FILE_NAME))}),e._uU(5),e.qZA()(),e.TgZ(6,"td")(7,"button",54),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.deleteMV(s.ID))}),e._uU(8," X "),e.qZA()()()}if(2&n){const t=l.$implicit;e.xp6(2),e.Oqu(t.TYPE_FILE_TIPEADO),e.xp6(3),e.Oqu(t.FILE_NAME)}}function De(n,l){if(1&n&&(e.TgZ(0,"div"),e._UZ(1,"div",49),e.TgZ(2,"table",50)(3,"thead")(4,"tr",51)(5,"th"),e._uU(6,"Tipo MV"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Nombre Archivo"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Eliminar"),e.qZA()()(),e.TgZ(11,"tbody"),e.YNc(12,Me,9,2,"tr",52),e.qZA()()()),2&n){const t=e.oxw();e.xp6(12),e.Q6J("ngForOf",t.MV_consulta)}}let Ie=(()=>{class n{constructor(t,a,i,s,u){this.productorService=t,this.ConsumerService=a,this.router=i,this.route=s,this.fb=u,this.maxFiles=3,this.dbStatements=[],this.db=[],this.pos=1,this.index=0,this.data_consulta=[],this.detail_consulta=[],this.MV_consulta=[],this.years=[],this.cant=0,this.selectedFile=null,this.listMV=[{name:"Guia de despacho",value:1},{name:"Factura gestor",value:2},{name:"Registro de peso",value:3},{name:"Fotograf\xeda retiro",value:4},{name:"Balance de masas",value:5},{name:"Otro",value:6}],this.attached=[],this.fileName=""}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.loadData(),this.loadDetail(),this.userForm=this.fb.group({MV:["",m.kI.required],ARCHIVO:[null,[m.kI.required,this.fileTypeValidator,this.fileSizeValidator]]})}loadData(){o().fire({title:"Cargando Datos",text:"Se est\xe1n recuperando datos",timerProgressBar:!0,showConfirmButton:!1,allowEscapeKey:!1,allowOutsideClick:!1}),o().showLoading(),this.ConsumerService.getFormConsulta(this.route.snapshot.params.id_header_).subscribe(a=>{a.status&&(this.data_consulta=a.data.header[0],o().close())})}loadDetail(){this.ConsumerService.getDeclarationByID(this.route.snapshot.params.id_header_,this.route.snapshot.params.id_detail).subscribe(i=>{i.status&&(this.detail_consulta=i.status[0],this.loadMV())})}loadMV(){this.ConsumerService.getMV(this.detail_consulta.ID_DETAIL).subscribe(t=>{t.status&&(this.MV_consulta=t.data.header)})}volver(){this.router.navigate(["/consumidor/statements"])}reset(){this.userForm.reset(),this.userForm.patchValue({MV:"",ARCHIVO:""})}formatDate(t){return new Date(t).toISOString().split("T")[0]}formatValue(t){return null==t?"":t%1==0?t.toString():t.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})}saveFile(){this.detail_consulta.FechaRetiro=this.formatDate(this.detail_consulta.FechaRetiro),this.ConsumerService.saveFile(this.detail_consulta.ID_DETAIL,this.fileName,this.fileBuffer,this.userForm.controls.MV.value).subscribe(t=>{t.status?(o().fire({icon:"success",text:"Medio de verificaci\xf3n guardado satisfactoriamente"}),this.loadMV()):console.log("error")})}deleteMV(t){this.ConsumerService.deleteById(t).subscribe(a=>{a.status?(o().fire({icon:"info",text:"Medio de verificaci\xf3n eliminado satisfactoriamente"}),this.loadMV()):console.log("error")})}onFileSelected(t){const a=t.target;if(a&&a.files&&a.files.length>0){const i=a.files[0];this.fileName=i.name,this.fileBuffer=i,this.selectedFile=a.files[0];const s=["pdf","jpeg","jpg"],u=this.selectedFile.name.split(".").pop()?.toLowerCase()||"";s.includes(u)?i.size>1048576?(this.userForm.controls.ARCHIVO.setErrors({invalidFileSize:!0}),this.userForm.controls.ARCHIVO.markAsTouched()):(this.userForm.controls.ARCHIVO.setErrors(null),this.userForm.controls.ARCHIVO.markAsTouched()):(this.userForm.controls.ARCHIVO.setErrors({invalidFileType:!0}),this.userForm.controls.ARCHIVO.markAsTouched())}else this.selectedFile=null}downloadFile(t,a){this.ConsumerService.downloadMV(t).subscribe(i=>{const s=new Blob([i],{type:i.type}),u=window.URL.createObjectURL(s),f=document.createElement("a");f.href=u,f.download=a,f.click(),window.URL.revokeObjectURL(u)},i=>{console.error("Error al descargar el archivo:",i)})}maxSizeValidator(t){return a=>{const i=a.value;return i&&i.size>t?{maxSizeExceeded:!0}:null}}fileTypeValidator(t){const a=t.value;return a&&!["application/pdf","image/jpeg"].includes(a.type)?{invalidFileType:!0}:null}fileSizeValidator(t){const a=t.value;return a&&a.size>1048576?{invalidFileSize:!0}:null}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(j.u),e.Y36(P.h),e.Y36(x.F0),e.Y36(x.gz),e.Y36(m.qu))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-statements-detail"]],decls:124,vars:23,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["href","#/consumidor/statements"],["aria-current","page",1,"breadcrumb-item","active"],[1,"declaracion"],[1,"table-responsive"],[1,"table-atributos"],[1,"attr-name"],[1,"attr-value"],[1,"separador"],[1,"table","table-even","table-section","table-borderless","table-radius"],[1,"vertical-middle"],[1,"text-center"],["data-bs-toggle","modal","data-bs-target","#exampleModal",1,"btn"],["aria-hidden","true",1,"fa","fa-book","fa-fw","fa-lg","color-blue"],[1,"text-end"],[1,"btn","btn-primary",3,"click"],["id","exampleModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade",3,"hidden.bs.modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title","fs-5"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"container"],[3,"formGroup"],["miFormulario","ngForm"],[1,"row"],[1,"col-md-6"],["for","inp_nom"],["formControlName","MV","id","inp_mv","required","",1,"form-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","text-danger pl-0",4,"ngIf"],["for","inp_archivo"],["type","file","formControlName","ARCHIVO","id","inp_archivo","accept","application/pdf, image/jpeg","required","",1,"form-control",3,"change"],["class","text-danger mt-2 text-end",4,"ngIf"],[1,"modal-footer"],["type","button","id","btnCloseModal","data-bs-dismiss","modal",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[2,"visibility","hidden"],[4,"ngIf"],[3,"value"],[1,"text-danger","pl-0"],[1,"text-danger","mt-2","text-end"],[2,"height","50px"],[1,"table-container","table","table-even","table-section","table-borderless","table-border","table-radius","d-lg-table"],[1,"text-center","w-100"],["class","text-center w-100",4,"ngFor","ngForOf"],[1,"file-link",3,"click"],["type","button",1,"btn","btn-danger","btn-sm","rounded-pill",3,"click"]],template:function(t,a){if(1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",3)(8,"a",6),e._UZ(9,"i",5),e._uU(10," Consulta de Declaraci\xf3n"),e.qZA()(),e.TgZ(11,"li",7),e._uU(12,"Detalle de Declaraci\xf3n"),e.qZA()()(),e.TgZ(13,"section",8)(14,"h1"),e._uU(15,"Detalle de Declaraci\xf3n"),e.qZA(),e.TgZ(16,"div",9)(17,"table",10)(18,"tbody")(19,"tr")(20,"td",11),e._uU(21,"Nombre de Empresa"),e.qZA(),e.TgZ(22,"td",12),e._uU(23),e.qZA()(),e.TgZ(24,"tr")(25,"td",11),e._uU(26,"ID Consumidor Industrial"),e.qZA(),e.TgZ(27,"td",12),e._uU(28),e.qZA()(),e.TgZ(29,"tr")(30,"td",11),e._uU(31,"Establecimiento"),e.qZA(),e.TgZ(32,"td",12),e._uU(33),e.qZA()(),e.TgZ(34,"tr")(35,"td",11),e._uU(36,"ID Establecimiento VU"),e.qZA(),e.TgZ(37,"td",12),e._uU(38),e.qZA()(),e.TgZ(39,"tr")(40,"td",11),e._uU(41,"Regi\xf3n"),e.qZA(),e.TgZ(42,"td",12),e._uU(43),e.qZA()(),e.TgZ(44,"tr")(45,"td",11),e._uU(46,"Comuna"),e.qZA(),e.TgZ(47,"td",12),e._uU(48),e.qZA()()()()(),e._UZ(49,"div",13),e.TgZ(50,"div",9)(51,"table",14)(52,"thead",15)(53,"tr")(54,"th",16),e._uU(55,"Subcategor\xeda"),e.qZA(),e.TgZ(56,"th",16),e._uU(57,"Tipo de tratamiento"),e.qZA(),e.TgZ(58,"th",16),e._uU(59,"Subtipo"),e.qZA(),e.TgZ(60,"th",16),e._uU(61,"Peso"),e.qZA(),e.TgZ(62,"th",16),e._uU(63,"Fecha Retiro"),e.qZA(),e.TgZ(64,"th",16),e._uU(65,"Gestor"),e.qZA(),e.TgZ(66,"th",16),e._uU(67,"MV"),e.qZA()()(),e.TgZ(68,"tbody")(69,"td",16),e._uU(70),e.qZA(),e.TgZ(71,"td",16),e._uU(72),e.qZA(),e.TgZ(73,"td",16),e._uU(74),e.qZA(),e.TgZ(75,"td"),e._uU(76),e.qZA(),e.TgZ(77,"td",16),e._uU(78),e.ALo(79,"date"),e.qZA(),e.TgZ(80,"td",16),e._uU(81),e.qZA(),e.TgZ(82,"td",16)(83,"button",17),e._UZ(84,"i",18),e.qZA()()()()(),e.TgZ(85,"div",19)(86,"button",20),e.NdJ("click",function(){return a.volver()}),e._uU(87,"Volver"),e.qZA()()()(),e.TgZ(88,"div",21),e.NdJ("hidden.bs.modal",function(){return a.reset()}),e.TgZ(89,"div",22)(90,"div",23)(91,"div",24)(92,"h1",25),e._uU(93,"Medios de verificaci\xf3n"),e.qZA(),e._UZ(94,"button",26),e.qZA(),e.TgZ(95,"div",27)(96,"div",28)(97,"form",29,30)(99,"div",31)(100,"div",32)(101,"label",33),e._uU(102,"Tipo MV"),e.qZA(),e.TgZ(103,"select",34)(104,"option",35),e._uU(105,"Selecciona MV"),e.qZA(),e.YNc(106,Ze,2,2,"option",36),e.qZA(),e.YNc(107,Ce,2,1,"div",37),e.qZA(),e.TgZ(108,"div",32)(109,"label",38),e._uU(110,"Archivo"),e.qZA(),e.TgZ(111,"input",39),e.NdJ("change",function(s){return a.onFileSelected(s)}),e.qZA(),e.YNc(112,ye,3,2,"div",37),e.qZA()(),e.YNc(113,xe,2,0,"div",40),e.TgZ(114,"div",41)(115,"button",42),e.NdJ("click",function(){return a.reset()}),e._uU(116,"Cerrar"),e.qZA(),e.TgZ(117,"button",43),e.NdJ("click",function(){return a.saveFile(),a.reset()}),e._uU(118,"Agregar"),e.qZA()(),e.TgZ(119,"div",44),e._uU(120,"a"),e.qZA(),e.TgZ(121,"div",44),e._uU(122,"a"),e.qZA(),e.YNc(123,De,13,1,"div",45),e.qZA()()()()()()),2&t){const i=e.MAs(98);e.xp6(23),e.Oqu(a.data_consulta.NombreEmpresa),e.xp6(5),e.Oqu(a.data_consulta.CodigoEmpresa),e.xp6(5),e.Oqu(a.data_consulta.Establecimiento),e.xp6(5),e.Oqu(a.data_consulta.ID_VU),e.xp6(5),e.Oqu(a.data_consulta.Region),e.xp6(5),e.Oqu(a.data_consulta.Comuna),e.xp6(22),e.Oqu(a.detail_consulta.PRECEDENCETIPEADO),e.xp6(2),e.Oqu(a.detail_consulta.TIPO_TRATAMIENTO_TIPEADO),e.xp6(2),e.Oqu(a.detail_consulta.TYPE_RESIDUE_TIPEADO),e.xp6(2),e.hij(" ",a.formatValue(a.detail_consulta.VALUE)," "),e.xp6(2),e.Oqu(e.Dn7(79,19,a.detail_consulta.FechaRetiro,"dd-MM-yyyy","UTC")),e.xp6(3),e.Oqu(a.detail_consulta.NombreGestor),e.xp6(16),e.Q6J("formGroup",a.userForm),e.xp6(9),e.Q6J("ngForOf",a.listMV),e.xp6(1),e.Q6J("ngIf",a.userForm.controls.MV.errors&&a.userForm.controls.MV.touched),e.xp6(5),e.Q6J("ngIf",a.userForm.controls.ARCHIVO.errors&&a.userForm.controls.ARCHIVO.touched),e.xp6(1),e.Q6J("ngIf",a.MV_consulta.length>=a.maxFiles),e.xp6(4),e.Q6J("disabled",i.invalid||a.MV_consulta.length>=a.maxFiles),e.xp6(6),e.Q6J("ngIf",a.MV_consulta&&a.MV_consulta.length>0)}},dependencies:[E.sg,E.O5,m._Y,m.YN,m.Kr,m.Fj,m.EJ,m.JJ,m.JL,m.Q7,m.sg,m.u,E.uU],styles:["table[_ngcontent-%COMP%]{border-collapse:collapse;width:100%}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding:8px;text-align:left;border-bottom:1px solid #ddd}th[_ngcontent-%COMP%]{background-color:#f2f2f2}.table-atributos[_ngcontent-%COMP%]{border-collapse:collapse;width:100%;border-radius:10px;overflow:hidden}.attr-name[_ngcontent-%COMP%]{background-color:#3c7c9c;color:#fff;width:25%}.table-atributos[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{width:25%;background-color:#3c7c9c;color:#fff;border-radius:6px 0 0 6px}.table-atributos[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{width:75%;background-color:#ececec;color:#000;border-radius:0 6px 6px 0}.attr-value[_ngcontent-%COMP%]{background-color:#ececec;width:75%;color:#000}[_nghost-%COMP%]{width:90%!important;padding:1%}.separador[_ngcontent-%COMP%]{height:1px;margin-top:20px;margin-bottom:20px;background-color:#ccc}.text-end[_ngcontent-%COMP%]{position:relative;margin-top:20px}.text-center[_ngcontent-%COMP%]{text-align:center}.file-link[_ngcontent-%COMP%]{color:#00f;text-decoration:underline;cursor:pointer}.file-link[_ngcontent-%COMP%]:hover{text-decoration:none}"]}),n})();var Fe=v(5332),w=v(2894);function Ue(n,l){if(1&n&&(e.TgZ(0,"option",16),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function qe(n,l){if(1&n&&(e.TgZ(0,"option",16),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.Q6J("value",t.ID),e.xp6(1),e.Oqu(t.NAME)}}const Oe=[{path:"",component:W.$,children:[{path:"home",component:oe},{path:"bulk-upload",component:Te},{path:"form",component:z,data:{show:!1}},{path:"form/:id",component:z,data:{show:!0}},{path:"profile",component:ce},{path:"statements",component:_e},{path:"statements/:id_header_/:id_detail",component:Ie},{path:"faq",component:X.v},{path:"dashboard-ci-gestor",component:(()=>{class n{constructor(t,a){this.dashboardService=t,this.businessService=a,this.years=[],this.currentYear=(new Date).getFullYear(),this.selectedYear=this.currentYear,this.view=[1200,400],this.view_barras=[600,400],this.gradient=!1,this.colorScheme={domain:["#08a47c","#FCB241","#d32f2f","#1976D2","#388E3C","#8E24AA","#FBC02D"]},this.lineChartData=[],this.barChartData=[],this.normalizedBarChartData=[],this.companies=[],this.selectedCompany="Todas"}ngOnInit(){for(let a=2023;a<=this.currentYear;a++)this.years.push(a);const t=JSON.parse(sessionStorage.getItem("user")||"{}");this.userId=t.ID,this.loadCompanies()}loadCompanies(){this.businessService.getBusinessByUserId(this.userId).subscribe(t=>{this.companies=[{ID:"Todas",NAME:"Todas"},...t.data],this.loadData(),this.loadBarChartData(),this.loadAllStackedChartData()})}loadData(){let t;if("Todas"===this.selectedCompany){t=this.companies.filter(i=>"Todas"!==i.ID).map(i=>i.ID);const a=t.join(",");this.dashboardService.getLinearDashboardArray(this.selectedYear,a).subscribe(i=>{this.lineChartData=i.data})}else this.dashboardService.getLinearDashboard(this.selectedYear,this.selectedCompany).subscribe(a=>{this.lineChartData=a.data})}onYearChange(){this.loadData(),this.loadBarChartData(),this.loadAllStackedChartData()}loadBarChartData(){let t;if("Todas"===this.selectedCompany){t=this.companies.filter(i=>"Todas"!==i.ID).map(i=>i.ID);const a=t.join(",");this.dashboardService.getBarChartDataByCompanyIdArray(this.selectedYear,a).subscribe(i=>{this.barChartData=i.data,this.barChartData[0].name=this.barChartData[0].name+" - "+this.selectedYear,this.barChartData[1].name=this.barChartData[1].name+" - "+this.selectedYear})}else this.dashboardService.getBarChartDataByCompanyId(this.selectedYear,this.selectedCompany).subscribe(a=>{this.barChartData=a.data,this.barChartData[0].name=this.barChartData[0].name+" - "+this.selectedYear,this.barChartData[1].name=this.barChartData[1].name+" - "+this.selectedYear})}loadAllStackedChartData(){let t;if("Todas"===this.selectedCompany){t=this.companies.filter(i=>"Todas"!==i.ID).map(i=>i.ID);const a=t.join(",");this.dashboardService.getStackedBarChartDataByCompanyIdArray(this.selectedYear,a).subscribe(i=>{this.normalizedBarChartData=i.data,this.normalizedBarChartData[0].name=this.normalizedBarChartData[0].name+" - "+this.selectedYear,this.normalizedBarChartData[1].name=this.normalizedBarChartData[1].name+" - "+this.selectedYear,this.normalizedBarChartData[2].name=this.normalizedBarChartData[2].name+" - "+this.selectedYear,this.normalizedBarChartData[3].name=this.normalizedBarChartData[3].name+" - "+this.selectedYear,this.normalizedBarChartData[4].name=this.normalizedBarChartData[4].name+" - "+this.selectedYear})}else this.dashboardService.getStackedBarChartDataByCompanyId(this.selectedYear,this.selectedCompany).subscribe(a=>{this.normalizedBarChartData=a.data,this.normalizedBarChartData[0].name=this.normalizedBarChartData[0].name+" - "+this.selectedYear,this.normalizedBarChartData[1].name=this.normalizedBarChartData[1].name+" - "+this.selectedYear,this.normalizedBarChartData[2].name=this.normalizedBarChartData[2].name+" - "+this.selectedYear,this.normalizedBarChartData[3].name=this.normalizedBarChartData[3].name+" - "+this.selectedYear,this.normalizedBarChartData[4].name=this.normalizedBarChartData[4].name+" - "+this.selectedYear})}onCompanyChange(){this.loadData(),this.loadBarChartData(),this.loadAllStackedChartData()}setFormato(t){const a="string"==typeof t?parseFloat(t.replace(/,/g,"")):t,i=Math.round(100*a)/100,[s,u]=i.toString().split("."),f=s.replace(/\B(?=(\d{3})+(?!\d))/g,".");return u&&"0"!==u?`${f},${u.padEnd(2,"0")}`:f}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Fe.s),e.Y36(L.m))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dashboard-ci-gestor"]],decls:33,vars:45,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"select-container"],[1,"select-btn",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[1,"gauge-container"],[2,"text-align","center","font-size","medium"],[3,"view","scheme","results","gradient","xAxis","yAxis","legend","legendTitle","showXAxisLabel","showYAxisLabel","xAxisLabel","yAxisLabel","yAxisTickFormatting"],[1,"row"],[1,"col-12","col-lg-6","mb-5"],[3,"view","scheme","results","gradient","xAxis","yAxis","legend","legendTitle","showXAxisLabel","showYAxisLabel","xAxisLabel","yAxisLabel","dataLabelFormatting","yAxisTickFormatting"],[3,"value"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",6),e._uU(8,"Dashboard CI - Gestores"),e.qZA()()(),e.TgZ(9,"div",7)(10,"label"),e._uU(11,"A\xf1o:"),e.qZA(),e.TgZ(12,"select",8),e.NdJ("ngModelChange",function(s){return a.selectedYear=s})("change",function(){return a.onYearChange()}),e.YNc(13,Ue,2,2,"option",9),e.qZA()(),e.TgZ(14,"div",7)(15,"label"),e._uU(16,"Empresa:"),e.qZA(),e.TgZ(17,"select",8),e.NdJ("ngModelChange",function(s){return a.selectedCompany=s})("change",function(){return a.onCompanyChange()}),e.YNc(18,qe,2,2,"option",9),e.qZA()(),e.TgZ(19,"div",10)(20,"div",11),e._uU(21," TONELADAS VALORIZADAS VS DECLARADAS POR MES"),e.qZA(),e._UZ(22,"ngx-charts-line-chart",12),e.qZA(),e.TgZ(23,"div",10)(24,"div",13)(25,"div",14)(26,"div",11),e._uU(27," TONELADAS VALORIZADAS VS DECLARADAS POR A\xd1O"),e.qZA(),e._UZ(28,"ngx-charts-bar-vertical",15),e.qZA(),e.TgZ(29,"div",14)(30,"div",11),e._uU(31," TONELADAS VALORIZADAS POR MATERIAL Y TRATAMIENTO POR A\xd1O "),e.qZA(),e._UZ(32,"ngx-charts-bar-vertical-stacked",15),e.qZA()()()()),2&t&&(e.xp6(12),e.Q6J("ngModel",a.selectedYear),e.xp6(1),e.Q6J("ngForOf",a.years),e.xp6(4),e.Q6J("ngModel",a.selectedCompany),e.xp6(1),e.Q6J("ngForOf",a.companies),e.xp6(4),e.Q6J("view",a.view)("scheme",a.colorScheme)("results",a.lineChartData)("gradient",a.gradient)("xAxis",!0)("yAxis",!0)("legend",!0)("legendTitle"," ")("showXAxisLabel",!0)("showYAxisLabel",!0)("xAxisLabel","Mes")("yAxisLabel","Toneladas")("yAxisTickFormatting",a.setFormato),e.xp6(6),e.Q6J("view",a.view_barras)("scheme",a.colorScheme)("results",a.barChartData)("gradient",a.gradient)("xAxis",!0)("yAxis",!0)("legend",!0)("legendTitle"," ")("showXAxisLabel",!0)("showYAxisLabel",!0)("xAxisLabel","")("yAxisLabel","Toneladas")("dataLabelFormatting",a.setFormato)("yAxisTickFormatting",a.setFormato),e.xp6(4),e.Q6J("view",a.view_barras)("scheme",a.colorScheme)("results",a.normalizedBarChartData)("gradient",a.gradient)("xAxis",!0)("yAxis",!0)("legend",!0)("legendTitle"," ")("showXAxisLabel",!0)("showYAxisLabel",!0)("xAxisLabel","Material")("yAxisLabel","Toneladas Valorizadas")("dataLabelFormatting",a.setFormato)("yAxisTickFormatting",a.setFormato))},dependencies:[E.sg,m.YN,m.Kr,m.EJ,m.JJ,m.On,w.K$,w.XK,w.Dw],styles:[".select-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:20px}label[_ngcontent-%COMP%]{display:inline-block;width:80px;font-size:18px;font-weight:700;margin-right:10px}.select-btn[_ngcontent-%COMP%]{background-color:#08a47c;color:#fff;border:none;border-radius:5px;padding:10px 20px;width:250px;-webkit-appearance:none;appearance:none;position:relative}.gauge-container[_ngcontent-%COMP%]{border:1px solid #08a47c;border-radius:15px;padding:20px;margin-top:20px;margin-bottom:20px;display:flex;flex-direction:column}"]}),n})()},{path:"**",redirectTo:"home",pathMatch:"full"}]}];let Ne=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[x.Bz.forChild(Oe),x.Bz]}),n})();var Be=v(4466);let Re=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[E.ez,Ne,Be.m,m.u5,m.UX,H.q4,w.a4]}),n})()}}]);