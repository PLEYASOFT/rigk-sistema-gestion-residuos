"use strict";(self.webpackChunkrigk_sg_web=self.webpackChunkrigk_sg_web||[]).push([[122],{122:(ui,k,d)=>{d.r(k),d.d(k,{ProductorStatementModule:()=>ri});var _=d(6895),b=d(5792),G=d(5226),c=d.n(G),V=d(727);class $ extends V.w0{constructor(a,e){super()}schedule(a,e=0){return this}}const w={setInterval(o,a,...e){const{delegate:i}=w;return i?.setInterval?i.setInterval(o,a,...e):setInterval(o,a,...e)},clearInterval(o){const{delegate:a}=w;return(a?.clearInterval||clearInterval)(o)},delegate:void 0};var Q=d(8737);const L={now:()=>(L.delegate||Date).now(),delegate:void 0};class E{constructor(a,e=E.now){this.schedulerActionCtor=a,this.now=e}schedule(a,e=0,i){return new this.schedulerActionCtor(this,a).schedule(i,e)}}E.now=L.now;const D=new class K extends E{constructor(a,e=E.now){super(a,e),this.actions=[],this._active=!1}flush(a){const{actions:e}=this;if(this._active)return void e.push(a);let i;this._active=!0;do{if(i=a.execute(a.state,a.delay))break}while(a=e.shift());if(this._active=!1,i){for(;a=e.shift();)a.unsubscribe();throw i}}}(class z extends ${constructor(a,e){super(a,e),this.scheduler=a,this.work=e,this.pending=!1}schedule(a,e=0){var i;if(this.closed)return this;this.state=a;const n=this.id,s=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(s,n,e)),this.pending=!0,this.delay=e,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,e),this}requestAsyncId(a,e,i=0){return w.setInterval(a.flush.bind(a,this),i)}recycleAsyncId(a,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;null!=e&&w.clearInterval(e)}execute(a,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(a,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(a,e){let n,i=!1;try{this.work(a)}catch(s){i=!0,n=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),n}unsubscribe(){if(!this.closed){const{id:a,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,(0,Q.P)(i,this),null!=a&&(this.id=this.recycleAsyncId(e,a,null)),this.delay=null,super.unsubscribe()}}}),j=D;var W=d(9751),X=d(3532);var nt=d(4004),ot=d(2529),t=d(8256),p=d(4006),Z=d(371),O=d(8195),st=d(4351),U=d(574),I=d(2227);const at=["table1"];function lt(o,a){if(1&o&&(t.TgZ(0,"tr",13)(1,"td",26),t._uU(2),t.qZA(),t.TgZ(3,"td",29),t._uU(4,"0"),t.qZA(),t.TgZ(5,"td",29),t._uU(6,"0"),t.qZA(),t.TgZ(7,"td",29),t._uU(8,"0"),t.qZA(),t.TgZ(9,"td",30),t._uU(10,"0 "),t.qZA()()),2&o){const e=a.$implicit,i=a.index;t.xp6(2),t.Oqu(e),t.xp6(1),t.MGl("id","prim_weight_",i+1,""),t.xp6(2),t.MGl("id","sec_weight_",i+1,""),t.xp6(2),t.MGl("id","ter_weight_",i+1,""),t.xp6(2),t.MGl("id","total_category_weight_",i+1,"")}}function rt(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"td",26),t._uU(2),t.qZA(),t.TgZ(3,"td",29),t._uU(4,"0"),t.qZA(),t.TgZ(5,"td",29),t._uU(6,"0"),t.qZA(),t.TgZ(7,"td",29),t._uU(8,"0"),t.qZA(),t.TgZ(9,"td",30),t._uU(10,"0 "),t.qZA(),t.TgZ(11,"td",30),t._uU(12,"$0"),t.qZA(),t.BQk()),2&o){const e=t.oxw(),i=e.$implicit,n=e.index;t.xp6(2),t.Oqu(i),t.xp6(1),t.MGl("id","actual_amount_",n,""),t.xp6(2),t.MGl("id","amount_anual_",n,""),t.xp6(2),t.MGl("id","total_neto",n,""),t.xp6(2),t.MGl("id","iva_",n,""),t.xp6(2),t.MGl("id","uf_clp_",n,"")}}function ut(o,a){if(1&o&&(t.TgZ(0,"tr",13),t.YNc(1,rt,13,6,"ng-container",31),t.qZA()),2&o){const e=a.$implicit;t.xp6(1),t.Q6J("ngIf","Retornables"!==e)}}let P=(()=>{class o{constructor(e,i,n,s){this.fb=e,this.productorService=i,this.actived=n,this.ratesService=s,this.tablas=["Reciclable","No Reciclable","Retornables / Reutilizables"],this.residuos=["Papel/Cart\xf3n Reciclable","Metal Reciclable","Pl\xe1stico Reciclable","No Reciclables","Retornables"],this.isSubmited=!1,this.isEdited=!1,this.id_business=0,this.year_statement=0,this.id_statement=null,this.detail=this.fb.group({precedence:[],hazard:[],recyclability:[1],type_residue:[1],value:[],amount:[]}),this.detailForm=[],this.headLastForm={},this.detailLastForm=[],this.tonSums={primario:Array.from({length:5},()=>0),secundario:Array.from({length:5},()=>0),terciario:Array.from({length:5},()=>0),tonSum:Array.from({length:5},()=>0),l_tonSum:Array.from({length:5},()=>0)},this.tonNoReciclable=0,this.tonNoReciclablePrim=0,this.tonNoReciclableSec=0,this.tonNoReciclableTer=0,this.tonRetPrim=0,this.tonRetSec=0,this.tonRetTer=0,this.tonRetornable=0,this.l_tonNoReciclable=0,this.l_tonRetornable=0,this.result=0,this.dif=Array.from({length:5},()=>0),this.ajuste=Array.from({length:5},()=>0),this.costoAnual=Array.from({length:5},()=>0),this.sumaAmount=0,this.sumaNeto=0,this.sumaIva=0,this.sumaUF=0,this.actived.queryParams.subscribe(l=>{this.id_business=l.id_business,this.year_statement=l.year})}ngAfterViewInit(){this.generateForm()}ngOnInit(){}generateForm(){this.detailLastForm=JSON.parse(sessionStorage.getItem("detailLastForm")),this.detailForm=JSON.parse(sessionStorage.getItem("detailForm"));for(let e=0;e<this.detailForm.length;e++){const i=this.detailForm[e];1==i.recyclability?(1==i.precedence&&(this.tonSums.primario[i?.type_residue-1]=this.tonSums.primario[i?.type_residue-1]+parseFloat(i?.value),this.result=this.tonSums.primario[i?.type_residue-1],4!=i?.type_residue&&(document.getElementById(`prim_weight_${i?.type_residue}`).innerHTML=this.setFormato(this.result),this.costoAnual[i?.type_residue-1]=this.result)),2==i.precedence&&(this.tonSums.secundario[i?.type_residue-1]=this.tonSums.secundario[i?.type_residue-1]+parseFloat(i?.value),this.result=this.tonSums.secundario[i?.type_residue-1],4!=i?.type_residue&&(document.getElementById(`sec_weight_${i?.type_residue}`).innerHTML=this.setFormato(this.result),this.costoAnual[i?.type_residue-1]=this.result)),3==i.precedence&&(this.tonSums.terciario[i?.type_residue-1]=this.tonSums.terciario[i?.type_residue-1]+parseFloat(i?.value),this.result=this.tonSums.terciario[i?.type_residue-1],4!=i?.type_residue&&(document.getElementById(`ter_weight_${i?.type_residue}`).innerHTML=this.setFormato(this.result),this.costoAnual[i?.type_residue-1]=this.result)),this.costoAnual[i?.type_residue-1]=this.tonSums.primario[i?.type_residue-1]+this.tonSums.secundario[i?.type_residue-1]+this.tonSums.terciario[i?.type_residue-1]):2==i.recyclability?4!=i?.type_residue&&(1==i.precedence&&(this.tonNoReciclablePrim=this.tonNoReciclablePrim+parseFloat(i?.value),this.result=this.tonNoReciclablePrim,document.getElementById("prim_weight_4").innerHTML=this.setFormato(this.result),this.costoAnual[3]=this.result),2==i.precedence&&(this.tonNoReciclableSec=this.tonNoReciclableSec+parseFloat(i?.value),this.result=this.tonNoReciclableSec,document.getElementById("sec_weight_4").innerHTML=this.setFormato(this.result),this.costoAnual[3]=this.result),3==i.precedence&&(this.tonNoReciclableTer=this.tonNoReciclableTer+parseFloat(i?.value),this.result=this.tonNoReciclableTer,document.getElementById("ter_weight_4").innerHTML=this.setFormato(this.result),this.costoAnual[3]=this.result),this.costoAnual[3]=this.tonNoReciclablePrim+this.tonNoReciclableSec+this.tonNoReciclableTer):3==i.recyclability&&(1==i.precedence&&(this.tonRetPrim=this.tonRetPrim+parseFloat(i?.value),this.result=this.tonRetPrim,document.getElementById("prim_weight_5").innerHTML=this.setFormato(this.result)),2==i.precedence&&(this.tonRetSec=this.tonRetSec+parseFloat(i?.value),this.result=this.tonRetSec,document.getElementById("sec_weight_5").innerHTML=this.setFormato(this.result)),3==i.precedence&&(this.tonRetTer=this.tonRetTer+parseFloat(i?.value),this.result=this.tonRetTer,document.getElementById("ter_weight_5").innerHTML=this.setFormato(this.result)),this.costoAnual[4]=this.tonRetPrim+this.tonRetSec+this.tonRetTer)}for(let e=1;e<=5;e++)this.result=parseFloat(document.getElementById(`prim_weight_${e}`).innerHTML.replace(/\./g,"").replace(",","."))+parseFloat(document.getElementById(`sec_weight_${e}`).innerHTML.replace(/\./g,"").replace(",","."))+parseFloat(document.getElementById(`ter_weight_${e}`).innerHTML.replace(/\./g,"").replace(",",".")),document.getElementById(`total_category_weight_${e}`).innerHTML=this.setFormato(this.result),this.sumaAmount=this.sumaAmount+this.result;document.getElementById("total_ton").innerHTML=this.setFormato(this.sumaAmount),document.getElementById("pom_total").innerHTML=document.getElementById("total_ton").innerHTML,this.ratesService.getCLP.pipe((0,st.b)(e=>{this.sumaAmount=0;for(let i=0;i<4;i++)document.getElementById(`actual_amount_${i}`).innerHTML=this.setFormato(e.data[i].price),document.getElementById(`amount_anual_${i}`).innerHTML=this.setFormato(e.data[i].price*this.costoAnual[i]),this.sumaAmount=this.sumaAmount+parseFloat((e.data[i].price*this.costoAnual[i]).toFixed(2))+parseFloat((e.data[i].price*this.ajuste[i]).toFixed(2)),this.sumaUF=this.sumaUF+parseFloat((e.data[i].price*this.costoAnual[i]).toFixed(2)),this.dif[i]=e.data[i].price*this.costoAnual[i]+e.data[i].price*this.ajuste[i];return document.getElementById("anual_amount").innerHTML=this.setFormato(this.sumaUF),this.ratesService.getUF})).subscribe(e=>{this.sumaAmount=0;for(let i=0;i<4;i++)this.sumaAmount=this.sumaAmount+this.dif[i]*e.data*1.19,document.getElementById(`total_neto${i}`).innerHTML="$"+this.setFormato((this.dif[i]*e.data).toFixed(0)),document.getElementById(`iva_${i}`).innerHTML="$"+this.setFormato(parseInt((this.dif[i]*e.data*1.19).toFixed(0))-parseInt((this.dif[i]*e.data).toFixed(0))),document.getElementById(`uf_clp_${i}`).innerHTML="$"+this.setFormato(parseInt((this.dif[i]*e.data*1.19).toFixed(0))),this.sumaNeto=this.sumaNeto+this.dif[i]*e.data,this.sumaIva=this.sumaIva+(this.dif[i]*e.data*1.19-this.dif[i]*e.data);document.getElementById("total_uf_clp").innerHTML="$"+this.setFormato(parseInt(this.sumaAmount.toFixed(0))),document.getElementById("amount_clp").innerHTML="$"+this.setFormato(parseInt(this.sumaAmount.toFixed(0))),document.getElementById("ajuste_amount").innerHTML="$"+this.setFormato(parseInt(this.sumaNeto.toFixed(0))),document.getElementById("total_amount_iva").innerHTML="$"+this.setFormato(parseInt(this.sumaIva.toFixed(0)))})}tableToExcel(){const e=U.P6.table_to_sheet(this.table.nativeElement,{raw:!0}),i=U.P6.book_new();U.P6.book_append_sheet(i,e,"Sheet1"),U.NC(i,"Tabla-Resumen.xlsx")}verifyNumber(e){return Number.isInteger(e)?e.toString():e.toFixed(2)}setFormato(e){const i="string"==typeof e?parseFloat(e.replace(/,/g,"")):e,n=Math.round(100*i)/100,[s,l]=n.toString().split("."),r=s.replace(/\B(?=(\d{3})+(?!\d))/g,".");return l&&"0"!==l?`${r},${l.padEnd(2,"0")}`:r}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(p.qu),t.Y36(Z.u),t.Y36(b.gz),t.Y36(I.z))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-summary-statement"]],viewQuery:function(e,i){if(1&e&&t.Gf(at,5),2&e){let n;t.iGM(n=t.CRH())&&(i.table=n.first)}},decls:127,vars:8,consts:[[1,"d-md-flex","justify-content-end"],[1,"btn",3,"click"],["aria-hidden","true",1,"fa","fa-file-excel-o","fa-fw","fa-lg"],[1,"table-responsive","mb-4"],["table1",""],[1,"row","w-100"],[1,"w-100"],[1,"w-100","table-responsive-md"],[1,"table","table-even","table-section","table-borderless","table-align-middle","table-border","table-radius","d-lg-table","table-statement"],["colspan","13",2,"margin-bottom","100px"],[1,"text-center","w-100"],[1,"mi-columna",2,"background-color","rgb(8, 148, 110)","color","white"],["class","text-end w-100",4,"ngFor","ngForOf"],[1,"text-end","w-100"],["colspan","4",1,"text-start",2,"background-color","rgb(8, 148, 110)","color","white"],["id","total_ton",2,"background-color","rgb(8, 148, 110)","color","white"],["colspan","13"],["id","table",1,"w-100"],["colspan","2",1,"text-start",2,"background-color","rgb(8, 148, 110)","color","white"],["id","anual_amount",2,"background-color","rgb(8, 148, 110)","color","white"],["id","ajuste_amount",2,"background-color","rgb(8, 148, 110)","color","white"],["id","total_amount_iva",2,"background-color","rgb(8, 148, 110)","color","white"],["id","total_uf_clp",2,"background-color","rgb(8, 148, 110)","color","white"],["id","mi-tabla"],["colspan","2"],[2,"background-color","rgb(8, 148, 110)","color","white"],[1,"text-start"],["id","pom_total"],["id","amount_clp"],[3,"id"],[2,"background-color","rgb(217, 217, 217)",3,"id"],[4,"ngIf"]],template:function(e,i){1&e&&(t.TgZ(0,"h1"),t._uU(1),t.qZA(),t.TgZ(2,"div",0)(3,"a",1),t.NdJ("click",function(){return i.tableToExcel()}),t._uU(4,"Exportar Excel "),t._UZ(5,"i",2),t.qZA()(),t.TgZ(6,"div",3,4)(8,"section")(9,"div",5)(10,"div",6)(11,"div",7)(12,"table",8)(13,"thead")(14,"tr")(15,"th",9),t._uU(16,"Resumen de EyE por subcategor\xeda"),t.qZA()()(),t._UZ(17,"p"),t.TgZ(18,"thead")(19,"tr",10)(20,"th",11),t._uU(21,"Subcategor\xeda"),t.qZA(),t.TgZ(22,"th",11),t._uU(23,"Primarios"),t.qZA(),t.TgZ(24,"th",11),t._uU(25,"Secundarios"),t.qZA(),t.TgZ(26,"th",11),t._uU(27,"Terciarios"),t.qZA(),t.TgZ(28,"th",11),t._uU(29,"Peso Total (Ton)"),t.qZA()()(),t.TgZ(30,"tbody"),t.YNc(31,lt,11,5,"tr",12),t.qZA(),t.TgZ(32,"tfoot")(33,"tr",13)(34,"td",14),t._uU(35,"Total (Peso)"),t.qZA(),t.TgZ(36,"td",15),t._uU(37,"0"),t.qZA()()()()()()(),t.TgZ(38,"tr")(39,"td",16),t._uU(40," No se considera los EyE de madera "),t.qZA()(),t._UZ(41,"p")(42,"p"),t.TgZ(43,"div",5)(44,"div",17,4)(46,"div",7)(47,"table",8)(48,"thead")(49,"tr")(50,"th",9),t._uU(51),t.qZA()()(),t._UZ(52,"p"),t.TgZ(53,"thead")(54,"tr",10)(55,"th",11),t._uU(56,"Subcategor\xeda"),t.qZA(),t.TgZ(57,"th",11),t._uU(58),t.qZA(),t.TgZ(59,"th",11),t._uU(60),t.qZA(),t.TgZ(61,"th",11),t._uU(62,"Total Neto (CL$)"),t.qZA(),t.TgZ(63,"th",11),t._uU(64,"IVA"),t.qZA(),t.TgZ(65,"th",11),t._uU(66,"Total (CL$) "),t.qZA()()(),t.TgZ(67,"tbody"),t.YNc(68,ut,2,1,"tr",12),t.qZA(),t.TgZ(69,"tfoot")(70,"tr",13)(71,"td",18),t._uU(72,"Total (Costo)"),t.qZA(),t.TgZ(73,"td",19),t._uU(74,"0"),t.qZA(),t.TgZ(75,"td",20),t._uU(76,"0"),t.qZA(),t.TgZ(77,"td",21),t._uU(78,"0"),t.qZA(),t.TgZ(79,"td",22),t._uU(80,"$0"),t.qZA()()()()()()(),t._UZ(81,"p"),t._uU(82," La factura se enviar\xe1 con el valor de la UF al momento de enviar la declaraci\xf3n. "),t._UZ(83,"p"),t.TgZ(84,"div",23)(85,"table",8)(86,"thead")(87,"tr")(88,"th",24),t._uU(89),t.qZA()()(),t._UZ(90,"p"),t.TgZ(91,"thead")(92,"tr",10)(93,"th",25),t._uU(94,"Total Subcategor\xedas de EyE"),t.qZA(),t.TgZ(95,"th",25),t._uU(96,"Total EyE"),t.qZA()()(),t.TgZ(97,"tbody")(98,"tr",10)(99,"td",26),t._uU(100,"Total EyE (Ton)"),t.qZA(),t.TgZ(101,"td",27),t._uU(102,"0"),t.qZA()()()()(),t._UZ(103,"p")(104,"p"),t.TgZ(105,"div",23)(106,"table",8)(107,"thead")(108,"tr")(109,"th",24),t._uU(110),t.qZA()()(),t._UZ(111,"p"),t.TgZ(112,"thead")(113,"tr",10)(114,"th",25),t._uU(115,"Material"),t.qZA(),t.TgZ(116,"th",25),t._uU(117,"Total UF"),t.qZA()()(),t.TgZ(118,"tbody")(119,"tr",10)(120,"td",26),t._uU(121,"Costo Total"),t.qZA(),t.TgZ(122,"td",28),t._uU(123,"0"),t.qZA()()()()(),t.TgZ(124,"tr")(125,"td",16),t._uU(126," El Costo Total en $CL se factura con el valor de la UF al momento de enviar la declaraci\xf3n. A ese Monto Neto se le agrega el IVA. "),t.qZA()()()()),2&e&&(t.xp6(1),t.hij(" Tabla Resumen ",+i.year_statement," "),t.xp6(30),t.Q6J("ngForOf",i.residuos),t.xp6(20),t.hij("Resumen de costos (UF) ",+i.year_statement+1,""),t.xp6(7),t.hij("Tarifa ",+i.year_statement+1," (UF)"),t.xp6(2),t.hij("Costo Anual ",i.year_statement," (UF)"),t.xp6(8),t.Q6J("ngForOf",i.residuos),t.xp6(21),t.hij("Total EyE declarados ",i.year_statement," (Ton)"),t.xp6(21),t.hij("Costo total ",+i.year_statement+1,""))},dependencies:[_.sg,_.O5],styles:[".d-none[_ngcontent-%COMP%]{display:none}#mi-tabla[_ngcontent-%COMP%]{width:25%!important}.mi-columna[_ngcontent-%COMP%]{width:100px}.columna-doble[_ngcontent-%COMP%]{width:200px}"]}),o})();function ct(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"td"),t._uU(1),t.qZA(),t.TgZ(2,"td",17),t._uU(3,"0"),t.qZA(),t.TgZ(4,"td")(5,"input",18),t.NdJ("change",function(n){t.CHM(e);const s=t.oxw().index,l=t.oxw().index,r=t.oxw();return t.KtG(r.updateValue(l+1,s+1,1,2,n.target))}),t.qZA()(),t.TgZ(6,"td",17),t._uU(7,"0"),t.qZA(),t.TgZ(8,"td")(9,"input",19),t.NdJ("change",function(n){t.CHM(e);const s=t.oxw().index,l=t.oxw().index,r=t.oxw();return t.KtG(r.updateValue(l+1,s+1,1,1,n.target))}),t.qZA()(),t.TgZ(10,"td",17),t._uU(11,"0"),t.qZA(),t.TgZ(12,"td")(13,"input",19),t.NdJ("change",function(n){t.CHM(e);const s=t.oxw().index,l=t.oxw().index,r=t.oxw();return t.KtG(r.updateValue(l+1,s+1,2,1,n.target))}),t.qZA()(),t.TgZ(14,"td",17),t._uU(15,"0"),t.qZA(),t.TgZ(16,"td")(17,"input",19),t.NdJ("change",function(n){t.CHM(e);const s=t.oxw().index,l=t.oxw().index,r=t.oxw();return t.KtG(r.updateValue(l+1,s+1,3,1,n.target))}),t.qZA()(),t.TgZ(18,"td"),t._UZ(19,"input",20),t.qZA(),t.TgZ(20,"td",21),t._uU(21,"0"),t.qZA(),t.TgZ(22,"td"),t._UZ(23,"input",22),t.qZA()}if(2&o){const e=t.oxw(),i=e.$implicit,n=e.index,s=t.oxw().index;t.xp6(1),t.Oqu(i),t.xp6(1),t.hYB("id","inp_l_",s+1,"_",n+1,"_1_2"),t.xp6(3),t.hYB("id","inp_",s+1,"_",n+1,"_1_2"),t.xp6(1),t.hYB("id","inp_l_",s+1,"_",n+1,"_1_1"),t.xp6(3),t.hYB("id","inp_",s+1,"_",n+1,"_1_1"),t.xp6(1),t.hYB("id","inp_l_",s+1,"_",n+1,"_2_1"),t.xp6(3),t.hYB("id","inp_",s+1,"_",n+1,"_2_1"),t.xp6(1),t.hYB("id","inp_l_",s+1,"_",n+1,"_3_1"),t.xp6(3),t.hYB("id","inp_",s+1,"_",n+1,"_3_1"),t.xp6(2),t.hYB("id","actual_dif_",s+1,"_",n+1,""),t.xp6(1),t.hYB("id","last_weight_",s+1,"_",n+1,""),t.xp6(3),t.hYB("id","actual_weight_",s+1,"_",n+1,"")}}function pt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"td",21),t._uU(1,"0"),t.qZA(),t.TgZ(2,"td",23)(3,"input",18),t.NdJ("change",function(n){t.CHM(e);const s=t.oxw().index,l=t.oxw().index,r=t.oxw();return t.KtG(r.updateValue(l+1,s+1,1,2,n.target))}),t.qZA()(),t.TgZ(4,"td",21),t._uU(5,"0"),t.qZA(),t.TgZ(6,"td",23)(7,"input",19),t.NdJ("change",function(n){t.CHM(e);const s=t.oxw().index,l=t.oxw().index,r=t.oxw();return t.KtG(r.updateValue(l+1,s+1,1,1,n.target))}),t.qZA()(),t.TgZ(8,"td",21),t._uU(9,"0"),t.qZA(),t.TgZ(10,"td",23)(11,"input",19),t.NdJ("change",function(n){t.CHM(e);const s=t.oxw().index,l=t.oxw().index,r=t.oxw();return t.KtG(r.updateValue(l+1,s+1,2,1,n.target))}),t.qZA()(),t.TgZ(12,"td",21),t._uU(13,"0"),t.qZA(),t.TgZ(14,"td",23)(15,"input",19),t.NdJ("change",function(n){t.CHM(e);const s=t.oxw().index,l=t.oxw().index,r=t.oxw();return t.KtG(r.updateValue(l+1,s+1,3,1,n.target))}),t.qZA()(),t.TgZ(16,"td",23),t._UZ(17,"input",24),t.qZA(),t.TgZ(18,"td",21),t._uU(19,"0"),t.qZA(),t.TgZ(20,"td",23),t._UZ(21,"input",24),t.qZA()}if(2&o){const e=t.oxw().index,i=t.oxw().index;t.hYB("id","inp_l_",i+1,"_",e+1,"_1_2"),t.xp6(3),t.hYB("id","inp_",i+1,"_",e+1,"_1_2"),t.xp6(1),t.hYB("id","inp_l_",i+1,"_",e+1,"_1_1"),t.xp6(3),t.hYB("id","inp_",i+1,"_",e+1,"_1_1"),t.xp6(1),t.hYB("id","inp_l_",i+1,"_",e+1,"_2_1"),t.xp6(3),t.hYB("id","inp_",i+1,"_",e+1,"_2_1"),t.xp6(1),t.hYB("id","inp_l_",i+1,"_",e+1,"_3_1"),t.xp6(3),t.hYB("id","inp_",i+1,"_",e+1,"_3_1"),t.xp6(2),t.hYB("id","actual_dif_",i+1,"_",e+1,""),t.xp6(1),t.hYB("id","last_weight_",i+1,"_",e+1,""),t.xp6(3),t.hYB("id","actual_weight_",i+1,"_",e+1,"")}}function dt(o,a){if(1&o&&(t.TgZ(0,"tr",15),t.ynx(1),t.YNc(2,ct,24,23,"ng-template",16),t.YNc(3,pt,22,22,"ng-template",16),t.BQk(),t.qZA()),2&o){const e=a.$implicit,i=t.oxw().$implicit;t.xp6(2),t.Q6J("ngIf","Envases compuestos"!==e||"Envases compuestos"===e&&"EyE No Reciclables"===i),t.xp6(1),t.Q6J("ngIf",!("Envases compuestos"!==e||"Envases compuestos"===e&&"EyE No Reciclables"===i))}}function mt(o,a){if(1&o&&(t.TgZ(0,"div",1)(1,"table",2)(2,"thead")(3,"tr")(4,"th",3),t._uU(5),t.qZA()()(),t.TgZ(6,"tbody")(7,"tr",4)(8,"td",5),t._uU(9),t.qZA(),t.TgZ(10,"td",6),t._uU(11,"Primarios No Peligrosos"),t.qZA(),t.TgZ(12,"td",6),t._uU(13,"Primarios Peligrosos"),t.qZA(),t.TgZ(14,"td",6),t._uU(15,"Secundarios"),t.qZA(),t.TgZ(16,"td",6),t._uU(17,"Terciarios"),t.qZA(),t.TgZ(18,"td"),t._uU(19),t.qZA(),t.TgZ(20,"td",6),t._uU(21,"Peso Total"),t.qZA()(),t.TgZ(22,"tr",7)(23,"td",8),t._uU(24),t.qZA(),t.TgZ(25,"td",9),t._uU(26),t.qZA(),t.TgZ(27,"td",8),t._uU(28),t.qZA(),t.TgZ(29,"td",9),t._uU(30),t.qZA(),t.TgZ(31,"td",8),t._uU(32),t.qZA(),t.TgZ(33,"td",9),t._uU(34),t.qZA(),t.TgZ(35,"td",8),t._uU(36),t.qZA(),t.TgZ(37,"td",9),t._uU(38),t.qZA(),t._UZ(39,"td",8),t.TgZ(40,"td",9),t._uU(41),t.qZA()(),t.YNc(42,dt,4,2,"tr",10),t.qZA(),t.TgZ(43,"tfoot")(44,"tr"),t._UZ(45,"td",11)(46,"span",12),t.TgZ(47,"td",6)(48,"div",13)(49,"span"),t._uU(50,"Peso (ton):"),t.qZA(),t._UZ(51,"span",14),t.qZA()()()()()()),2&o){const e=a.$implicit,i=a.index,n=t.oxw();t.xp6(5),t.AsE("Declaraci\xf3n REP ",e," a\xf1o ",n.year_statement," en toneladas"),t.xp6(4),t.Oqu(e),t.xp6(10),t.AsE("Dif. ",n.year_statement-1," vs ",n.year_statement," (%)"),t.xp6(5),t.Oqu(n.year_statement-1),t.xp6(2),t.Oqu(n.year_statement),t.xp6(2),t.Oqu(n.year_statement-1),t.xp6(2),t.Oqu(n.year_statement),t.xp6(2),t.Oqu(n.year_statement-1),t.xp6(2),t.Oqu(n.year_statement),t.xp6(2),t.Oqu(n.year_statement-1),t.xp6(2),t.Oqu(n.year_statement),t.xp6(3),t.Oqu(n.year_statement),t.xp6(1),t.Q6J("ngForOf",n.residuos),t.xp6(4),t.MGl("id","total_amount_",i+1,""),t.xp6(5),t.MGl("id","total_weight_",i+1,"")}}let _t=(()=>{class o{constructor(e,i,n,s,l,r){this.fb=e,this.productorService=i,this.router=n,this.actived=s,this.ratesService=l,this.currencyPipe=r,this.tablas=["EyE Reciclables","EyE No Reciclables","EyE Retornables / Reutilizables"],this.residuos=["Papel/Cart\xf3n","Metal","Pl\xe1stico","Madera","Envases compuestos"],this.showOtherEnvInNoRecyclableTable=!1,this.isSubmited=!1,this.isEdited=!1,this.id_business="",this.year_statement=0,this.id_statement=null,this.detail=this.fb.group({precedence:[],hazard:[],recyclability:[1],type_residue:[1],value:[],amount:[]}),this.detailForm=[],this.headLastForm={},this.detailLastForm=[],this.rates=[],this.lala=null,this.actived.queryParams.subscribe(u=>{this.id_business=u.id_business,this.year_statement=u.year})}ngOnDestroy(){this.lala?.unsubscribe()}ngOnInit(){c().fire({title:"Cargando Datos",text:"Se est\xe1 recuperando datos",timerProgressBar:!0,showConfirmButton:!1}),c().showLoading(),this.ratesService.getCLP.subscribe({next:e=>{this.rates=e.data,this.getDraftStatement(),this.getValueStatementByYear()},error:e=>{c().close(),c().fire({title:"\xa1Ups!",icon:"error",text:"No se logr\xf3 obtener el valor de la UF",showConfirmButton:!0}),console.log(e)}})}ngAfterViewChecked(){this.calculateDiff()}calculateDiff(){let s=0,l=0,r=0;for(let u=1;u<=5;u++){const m=parseFloat(document.getElementById(`actual_weight_1_${u}`).value.replace(",",".")),f=parseFloat(document.getElementById(`actual_weight_2_${u}`).value.replace(",",".")),g=parseFloat(document.getElementById(`actual_weight_3_${u}`).value.replace(",",".")),S=parseFloat(document.getElementById(`last_weight_1_${u}`).innerHTML.replace(",",".")),C=parseFloat(document.getElementById(`last_weight_2_${u}`).innerHTML.replace(",",".")),T=parseFloat(document.getElementById(`last_weight_3_${u}`).innerHTML.replace(",","."));let v=(m-S)/S*100,H=(f-C)/C*100,J=(g-T)/T*100;0==S&&(v=0),0==C&&(H=0),0==T&&(J=0),s+=parseFloat(document.getElementById(`actual_weight_1_${u}`).value.replace(",","."))||0,l+=parseFloat(document.getElementById(`actual_weight_2_${u}`).value.replace(",","."))||0,r+=parseFloat(document.getElementById(`actual_weight_3_${u}`).value.replace(",","."))||0,document.getElementById(`actual_dif_1_${u}`).value=`${0==S?0:v.toFixed(0)||0}%`,document.getElementById(`actual_dif_2_${u}`).value=`${0==C?0:H.toFixed(0)||0}%`,document.getElementById(`actual_dif_3_${u}`).value=`${0==T?0:J.toFixed(0)||0}%`}document.getElementById("total_amount_1").innerHTML=(0).toFixed(2).replace(".",","),document.getElementById("total_amount_2").innerHTML=(0).toFixed(2).replace(".",","),document.getElementById("total_amount_3").innerHTML=(0).toFixed(2).replace(".",","),document.getElementById("total_weight_1").innerHTML=s.toFixed(2).replace(".",","),document.getElementById("total_weight_2").innerHTML=l.toFixed(2).replace(".",","),document.getElementById("total_weight_3").innerHTML=r.toFixed(2).replace(".",",")}getDraftStatement(){this.detailForm=[],this.lala=this.productorService.getValueStatementByYear(this.id_business,this.year_statement,1).subscribe({next:e=>{if(e.status){e.data.header.STATE&&this.router.navigate(["/productor/home"]),this.id_statement=e.data.header.ID,sessionStorage.setItem("isEdited","true"),sessionStorage.setItem("id_statement",this.id_statement?.toString()||"null");for(let i=0;i<e.data.detail.length;i++){const n=e.data.detail[i];document.getElementById(`inp_${n?.RECYCLABILITY}_${n?.TYPE_RESIDUE}_${n?.PRECEDENCE}_${n?.HAZARD}`).value="0"}for(let i=0;i<e.data.detail.length;i++){const n=e.data.detail[i],s=this.toLowerKeys(n);if(0==n?.VALUE)continue;document.getElementById(`inp_${n?.RECYCLABILITY}_${n?.TYPE_RESIDUE}_${n?.PRECEDENCE}_${n?.HAZARD}`).value=n?.VALUE.toString().replace(".",",");const l=(parseFloat(document.getElementById(`actual_weight_${n?.RECYCLABILITY}_${n?.TYPE_RESIDUE}`).value.replace(",","."))||0)+parseFloat(n?.VALUE);let r=0;r=1==n.RECYCLABILITY&&n.TYPE_RESIDUE<=3?n?.VALUE*this.rates[n.TYPE_RESIDUE-1].price:2==n.RECYCLABILITY&&(n.TYPE_RESIDUE<=3||5==n.TYPE_RESIDUE)?n?.VALUE*this.rates[3].price:0,s.amount=r,this.detailForm.push(s),document.getElementById(`actual_weight_${n?.RECYCLABILITY}_${n?.TYPE_RESIDUE}`).value=l.toFixed(2).replace(".",",")}sessionStorage.setItem("detailForm",JSON.stringify(this.detailForm))}},error:e=>{c().close(),c().fire({icon:"error",text:e.msg,title:"\xa1Ups!"})}})}toLowerKeys(e){const i=Object.entries(e);return Object.fromEntries(i.map(([n,s])=>[n.toLowerCase(),s]))}updateValue(e,i,n,s,l){sessionStorage.setItem("isEdited","true");let r,u=0,m=0;/^[0-9]+(,[0-9]+)?$/.test(l.value)||(l.value=0);let g=parseFloat(l.value.replace(",","."));(!l.value||isNaN(g)||g<0)&&(g=0,l.value=0);for(let T=0;T<this.detailForm.length;T++){const v=this.detailForm[T];v.type_residue==i&&v.recyclability==e&&(u+=parseFloat(v.value||0)),v.type_residue==i&&v.precedence==n&&v.hazard==s&&v.recyclability==e&&(r=v)}if(0==this.detailForm.length&&(u=0),r){const T=this.detailForm.indexOf(r);u-={...this.detailForm[T]}.value,this.detailForm[T].value=g,u+=parseFloat(this.detailForm[T].value),m=1==e&&i<=3?g*this.rates[i-1].price:2==e&&(i<=3||5==i)?g*this.rates[3].price:0,this.detailForm[T].amount=m}else u+=g,m=1==e&&i<=3?g*this.rates[i-1].price:2==e&&(i<=3||5==i)?g*this.rates[3].price:0,this.detailForm.push({precedence:n,hazard:s,value:g,type_residue:i,amount:m,recyclability:e});m=1==e&&i<=3?(this.rates[i-1].price*u).toString():2==e&&(i<=3||5==i)?(this.rates[3].price*u).toString():"0",sessionStorage.setItem("detailForm",JSON.stringify(this.detailForm)),document.getElementById(`actual_weight_${e}_${i}`).value=`${u.toFixed(2).replace(".",",")}`;const C=u-parseFloat(document.getElementById(`last_weight_${e}_${i}`).innerHTML.replace(",","."));document.getElementById(`actual_dif_${e}_${i}`).value=`${C==1/0?100:C.toFixed(2).replace(".",",")||0} `,this.calculateDiff()}getValueStatementByYear(){this.productorService.getValueStatementByYear(this.id_business,this.year_statement-1,0).subscribe({next:i=>{i.status||(c().close(),c().fire({title:"Tuvimos problemas",text:i.msg,icon:"error"}).then(n=>{n.isConfirmed&&this.router.navigate(["/productor/home"])})),this.detailLastForm=i.data.detail,sessionStorage.setItem("detailLastForm",JSON.stringify(this.detailLastForm)||'""'),this.headLastForm=i.data.health,c().close(),this.detailLastForm?.forEach(n=>{document.getElementById(`inp_l_${n?.RECYCLABILITY}_${n?.TYPE_RESIDUE}_${n?.PRECEDENCE}_${n?.HAZARD}`).innerHTML=n?.VALUE.toFixed(2).replace(".",",");const s=(parseFloat(document.getElementById(`last_weight_${n?.RECYCLABILITY}_${n?.TYPE_RESIDUE}`).innerHTML.replace(",","."))||0)+parseFloat(n?.VALUE);document.getElementById(`last_weight_${n?.RECYCLABILITY}_${n.TYPE_RESIDUE}`).innerHTML=s.toFixed(2).replace(".",",")})},error:i=>{c().close(),c().fire({icon:"error",text:i.msg,title:"\xa1Ups!"})}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(p.qu),t.Y36(Z.u),t.Y36(b.F0),t.Y36(b.gz),t.Y36(I.z),t.Y36(_.H9))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-form-statement"]],decls:1,vars:1,consts:[["class","table-responsive mb-4",4,"ngFor","ngForOf"],[1,"table-responsive","mb-4"],[1,"table","table-even","table-section","table-borderless","table-align-middle","table-border","table-radius","table-statement"],["colspan","13"],[1,"text-center","fw-bold","bg-green-light"],["width","16%","rowspan","2",1,"text-start","bg-green","color-white",2,"font-size","18px"],["colspan","2"],[1,"text-center","bg-green-light-2"],["width","7%",1,"color-red"],["width","7%"],["class","text-end",4,"ngFor","ngForOf"],["colspan","10"],[2,"display","none",3,"id"],[1,"d-flex","justify-content-between"],[3,"id"],[1,"text-end"],[3,"ngIf"],[1,"bg-grey-light",3,"id"],["value","0","type","text","min","0",1,"form-control",3,"id","change"],["value","0","type","text","min","0",1,"form-control","form-control-sm",3,"id","change"],["value","0","readonly","","type","text",2,"border","none","background-color","transparent","text-align","center",3,"id"],[1,"bg-grey-light",2,"display","none",3,"id"],["value","0","readonly","",2,"border","none","background-color","transparent","text-align","center","font-weight","bold",3,"id"],[2,"display","none"],["value","0","readonly","","type","text",1,"form-control","form-control-sm",3,"id"]],template:function(e,i){1&e&&t.YNc(0,mt,52,17,"div",0),2&e&&t.Q6J("ngForOf",i.tablas)},dependencies:[_.sg,_.O5],styles:[".table-statement[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{border-radius:20px 20px 0 0!important}"]}),o})();var ht=d(5861);function gt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"tr")(1,"td",25)(2,"button",26),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.validate())}),t._uU(3,"Validar"),t.qZA()()()}}function ft(o,a){1&o&&(t.TgZ(0,"h2",27),t._uU(1,"Cargar orden de compra "),t.qZA())}function bt(o,a){1&o&&(t.TgZ(0,"p"),t._uU(1," El formato del archivo debe ser PDF. "),t.qZA())}function Tt(o,a){1&o&&(t.TgZ(0,"p"),t._uU(1," El tama\xf1o del archivo no debe superar 1 MB. "),t.qZA())}function vt(o,a){if(1&o&&(t.TgZ(0,"div",35),t.YNc(1,bt,2,0,"p",22),t.YNc(2,Tt,2,0,"p",22),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.userForm.controls.ARCHIVO.errors.invalidFileType),t.xp6(1),t.Q6J("ngIf",e.userForm.controls.ARCHIVO.errors.invalidFileSize)}}function yt(o,a){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.hij(" Quedan ",e.remaining," d\xedas para ingresar la OC ")}}function xt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"div",28)(2,"form",29)(3,"input",30),t.NdJ("change",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onFileSelected(n))}),t.qZA(),t.YNc(4,vt,3,2,"div",31),t.YNc(5,yt,2,1,"div",22),t.TgZ(6,"div",32)(7,"a",33),t._uU(8,"Volver a inicio"),t.qZA(),t.TgZ(9,"button",34),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.uploadDeclaration())}),t._uU(10,"Enviar declaraci\xf3n"),t.qZA()()()()()}if(2&o){const e=t.oxw();t.xp6(2),t.Q6J("formGroup",e.userForm),t.xp6(2),t.Q6J("ngIf",e.userForm.controls.ARCHIVO.errors&&e.userForm.controls.ARCHIVO.touched),t.xp6(1),t.Q6J("ngIf",e.isValidated),t.xp6(4),t.Q6J("disabled",!e.userForm.controls.ARCHIVO.valid)}}let Zt=(()=>{class o{constructor(e,i,n,s,l,r){this.businessService=e,this.productorService=i,this.rateService=n,this.actived=s,this.router=l,this.fb=r,this.year_statement=0,this.isValidated=!1,this.fileName="",this.selectedFile=null,this.isButtonVisible=!0,this.id_business="",this.name_business="",this.rut="",this.loc_address="",this.phone="",this.email="",this.am_first_name="",this.am_last_name="",this.giro="",this.invoice_name="",this.invoice_email="",this.invoice_phone="",this.amountString="$0",this.amount_current_year=0,this.amount_previous_year=0,this.uf=0,this.totalCLP="",this.porcentajeDiff="",this.remaining=-1,this.actived.queryParams.subscribe(u=>{this.id_business=u.id_business,this.year_statement=u.year})}ngOnInit(){this.isValidated=!1,this.isButtonVisible=!0,this.getResume(),this.getUf(),this.getBusiness(),this.getAmountDiff(),this.totalCLP=sessionStorage.getItem("totalCLP"),this.porcentajeDiff=sessionStorage.getItem("porcentajeDiff"),this.userForm=this.fb.group({ARCHIVO:[null,[p.kI.required,this.fileTypeValidator,this.fileSizeValidator]]})}ngOnDestroy(){sessionStorage.removeItem("state")}getUf(){this.rateService.getUF.subscribe(e=>{this.uf=e.data})}getBusiness(){this.businessService.getBusiness(this.id_business).subscribe({next:e=>{e.status&&(this.name_business=e.status[0].NAME,this.rut=e.status[0].VAT,this.loc_address=e.status[0].LOC_ADDRESS,this.phone=e.status[0].PHONE,this.email=e.status[0].EMAIL,this.am_first_name=e.status[0].AM_FIRST_NAME,this.am_last_name=e.status[0].AM_LAST_NAME,this.invoice_name=e.status[0].INVOICE_NAME,this.invoice_email=e.status[0].INVOICE_EMAIL,this.invoice_phone=e.status[0].INVOICE_PHONE,this.giro=e.status[0].GIRO)},error:e=>{c().close(),c().fire({icon:"error",text:e.msg,title:"\xa1Ups!"})}})}getResume(){this.actived.queryParams.subscribe(e=>{let i=e.year,n=e.id_business;c().fire({title:"Cargando datos...",allowOutsideClick:!1}),c().showLoading(),this.productorService.getResumeById(n,i).subscribe({next:s=>{this.resume=s,this.remaining=s.remaining,sessionStorage.setItem("state",this.resume.state),c().close(),2==this.resume.state&&(this.isValidated=!0,this.isButtonVisible=!1)},error:s=>{c().close(),c().fire({icon:"error",text:s.msg,title:"\xa1Ups!"}).then(l=>{l.isConfirmed&&this.router.navigate(["/productor"])})}})})}getAmountDiff(){this.amount_previous_year=0,this.amount_current_year=0,this.productorService.getValueStatementByYear(this.id_business,this.year_statement-1,0).subscribe({next:e=>{if(e.status&&e.data.detail.length>0){for(let i=0;i<e.data.detail.length;i++){const n=e.data.detail[i];0!=n.AMOUNT&&(this.amount_previous_year=this.amount_previous_year+parseFloat(n.AMOUNT)*this.uf)}this.amount_previous_year=this.amount_previous_year*parseFloat(this.porcentajeDiff)*.01*1.19,this.amountString="$"+this.amount_previous_year.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})}},error:e=>{c().close(),c().fire({icon:"error",text:e.msg,title:"\xa1Ups!"})}}),this.productorService.getValueStatementByYear(this.id_business,this.year_statement,1).subscribe({next:e=>{if(e.status&&e.data.detail.length>0){for(let i=0;i<e.data.detail.length;i++){const n=e.data.detail[i];0!=n.AMOUNT&&(this.amount_current_year=this.amount_current_year+parseFloat(n.AMOUNT)*this.uf)}this.amount_current_year=this.amount_current_year*parseFloat(this.porcentajeDiff)*.01*1.19}},error:e=>{c().close(),c().fire({icon:"error",text:e.msg,title:"\xa1Ups!"})}})}validate(){var e=this;return(0,ht.Z)(function*(){if((yield c().fire({title:"Confirmaci\xf3n",html:'<div style="text-align: justify; font-size: 0.8em;">Est\xe1 a punto de validar la declaraci\xf3n, a partir de este momento no va a poder cambiar los valores ingresados y el valor de la declaraci\xf3n quedar\xe1 fijado a la UF del d\xeda de hoy. Tiene un plazo de 7 d\xedas para subir la Orden de Compra en el campo que se habilitar\xe1 al cerrar este mensaje. Pasado este plazo, la declaraci\xf3n volver\xe1 a estado borrador y se recalcular\xe1 el valor de la UF.</div>',icon:"warning",showCancelButton:!0,confirmButtonText:"Aceptar",cancelButtonText:"Cancelar",reverseButtons:!0})).isConfirmed){const n=sessionStorage.getItem("id_statement");if(!n)return;e.productorService.validateStatement(n).subscribe({next:s=>{s.status&&(e.isValidated=!0,e.isButtonVisible=!1,sessionStorage.setItem("state","2"))},error:s=>{c().close(),c().fire({icon:"error",text:s.msg,title:"\xa1Ups!"})}})}})()}onFileSelected(e){const i=e.target;if(i&&i.files&&i.files.length>0){const n=i.files[0];this.fileName=n.name,this.fileBuffer=n,this.selectedFile=i.files[0];const s=["pdf"],l=this.selectedFile.name.split(".").pop()?.toLowerCase()||"";s.includes(l)?n.size>1048576?(this.userForm.controls.ARCHIVO.setErrors({invalidFileSize:!0}),this.userForm.controls.ARCHIVO.markAsTouched()):(this.userForm.controls.ARCHIVO.setErrors(null),this.userForm.controls.ARCHIVO.markAsTouched()):(this.userForm.controls.ARCHIVO.setErrors({invalidFileType:!0}),this.userForm.controls.ARCHIVO.markAsTouched())}else this.selectedFile=null}fileTypeValidator(e){const i=e.value;return i&&!["application/pdf","image/jpeg"].includes(i.type)?{invalidFileType:!0}:null}fileSizeValidator(e){const i=e.value;return i&&i.size>1048576?{invalidFileSize:!0}:null}uploadDeclaration(){this.userForm.get("ARCHIVO");const i=document.getElementById("inp_archivo").files,n=sessionStorage.getItem("id_statement");!n||(c().fire({title:"Subiendo archivo",text:"Espere mientras se sube el archivo...",showCancelButton:!1,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,didOpen:()=>{c().showLoading()}}),this.productorService.uploadOC(n,i).subscribe({next:s=>{c().close(),c().fire({icon:"success",title:"Archivo subido exitosamente",text:"La declaraci\xf3n se ha enviado correctamente.",showConfirmButton:!0}).then(()=>{window.location.href="/#"})},error:s=>{c().close(),c().fire({icon:"error",title:"Error al subir el archivo",text:"Ha ocurrido un error al subir la declaraci\xf3n. Por favor, int\xe9ntelo nuevamente.",showConfirmButton:!0})}}))}getTotalEyE(){return(parseFloat(this.resume?.metal.replace(",","."))+parseFloat(this.resume?.papel.replace(",","."))+parseFloat(this.resume?.plastico.replace(",","."))+parseFloat(this.resume?.no_reciclable.replace(",","."))||0).toFixed(2).replace(".",",")}getNeto(){return this.formatMoney(this.resume?.neto)}getIVA(){return this.formatMoney(this.resume?.iva)}getTotalFacturado(){let e=this.parseMoney(this.getNeto()),i=this.parseMoney(this.getIVA());return this.formatMoney((e+i).toFixed(0))}parseMoney(e){let i=e.replace(/\./g,"");return i=i.replace(",","."),parseFloat(i)}formatMoney(e){return parseFloat(e).toFixed(0).replace(".",",").replace(/\B(?=(\d{3})+(?!\d))/g,".")}formatNumber(e){if(!e)return"";const i=e.split(",");return i[0]=i[0].replace(/\B(?=(\d{3})+(?!\d))/g,"."),i.join(",")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(O.m),t.Y36(Z.u),t.Y36(I.z),t.Y36(b.gz),t.Y36(b.F0),t.Y36(p.qu))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-send-statement"]],decls:222,vars:18,consts:[["id","content",1,"w-100"],[1,"consulta-declaracion"],[1,"row"],[1,"col-12","col-lg-6","col-xl-4","d-flex"],[1,"box","box-semiradius","box-semiradius-secondary","box-header","mb-4","w-100"],[1,"box-header-h1"],[1,"list","list-data","list-data-tit-text-col","list-unstyled"],[1,"list-data__title"],["aria-hidden","true",1,"fa","fa-building","fa-fw","fa-lg"],[1,"list-data__text","flex-grow-1","ps-0"],["aria-hidden","true",1,"fa","fa-map-marker","fa-fw","fa-lg"],["aria-hidden","true",1,"fa","fa-envelope","fa-fw","fa-lg"],["aria-hidden","true",1,"fa","fa-user","fa-fw","fa-lg"],[1,"box-header-h1",2,"border-radius","1px"],["aria-hidden","true",1,"fa","fa-phone","fa-fw","fa-lg"],[2,"display","flex","justify-content","center"],[1,"table","table-even","table-section","table-borderless","table-align-middle","d-lg-table","table-statement"],["colspan","2",1,"box-header-h1",2,"text-align","center"],[1,"columna1"],[1,"columna2"],[2,"display","flex","justify-content","center","margin-top","25px"],["colspan","2",1,"box-header-h1",2,"border-radius","1px","text-align","center"],[4,"ngIf"],["class","box-header-h1","style","border-radius: 1px;margin-top: 7px;text-align: center;",4,"ngIf"],[1,"d-flex"],["colspan","2",2,"text-align","right"],[1,"btn","btn-primary",2,"width","150px",3,"click"],[1,"box-header-h1",2,"border-radius","1px","margin-top","7px","text-align","center"],[1,"mt-3",2,"margin","10px"],[3,"formGroup"],["type","file","formControlName","ARCHIVO","id","inp_archivo","accept","application/pdf","required","",1,"form-control",3,"change"],["class","text-danger pl-0",4,"ngIf"],[1,"button-container","mt-3",2,"display","flex","justify-content","space-between"],["href","#",1,"btn","btn-primary"],[1,"btn","btn-primary",3,"disabled","click"],[1,"text-danger","pl-0"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"section",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h2",5),t._uU(6,"Informaci\xf3n ProREP"),t.qZA(),t.TgZ(7,"ul",6)(8,"li")(9,"span",7),t._UZ(10,"i",8),t.qZA(),t.TgZ(11,"span",9)(12,"strong"),t._uU(13,"Nombre SG:"),t.qZA(),t._UZ(14,"br"),t._uU(15,"Corporaci\xf3n PROREP para la Gesti\xf3n de Residuos "),t.qZA()(),t.TgZ(16,"li")(17,"span",7),t._UZ(18,"i",8),t.qZA(),t.TgZ(19,"span",9)(20,"strong"),t._uU(21,"Rut:"),t.qZA(),t._UZ(22,"br"),t._uU(23,"65.216.268-1 "),t.qZA()(),t.TgZ(24,"li")(25,"span",7),t._UZ(26,"i",10),t.qZA(),t.TgZ(27,"span",9)(28,"strong"),t._uU(29,"Direcci\xf3n:"),t.qZA(),t._UZ(30,"br"),t._uU(31,"Avda. Andr\xe9s Bello 2777, of. 506, Las Condes, Santiago "),t.qZA()(),t.TgZ(32,"li")(33,"span",7),t._UZ(34,"i",8),t.qZA(),t.TgZ(35,"span",9)(36,"strong"),t._uU(37,"Giro:"),t.qZA(),t._UZ(38,"br"),t._uU(39,"Gesti\xf3n de Residuos de Envases y Embalajes no Domiciliarios "),t.qZA()(),t.TgZ(40,"li")(41,"span",7),t._UZ(42,"i",11),t.qZA(),t.TgZ(43,"span",9)(44,"strong"),t._uU(45,"Correo:"),t.qZA(),t._UZ(46,"br"),t._uU(47,"admin@prorep.cl "),t.qZA()(),t.TgZ(48,"li")(49,"span",7),t._UZ(50,"i",8),t.qZA(),t.TgZ(51,"span",9)(52,"strong"),t._uU(53,"Asunto:"),t.qZA(),t._UZ(54,"br"),t._uU(55,"Pago cumplimiento Ley REP y nombre del socio "),t.qZA()(),t.TgZ(56,"li")(57,"span",7),t._UZ(58,"i",12),t.qZA(),t.TgZ(59,"span",9)(60,"strong"),t._uU(61,"Encargada de facturaci\xf3n:"),t.qZA(),t._UZ(62,"br"),t._uU(63,"Lorena Calder\xf3n "),t.qZA()(),t.TgZ(64,"li")(65,"span",7),t._UZ(66,"i",8),t.qZA(),t.TgZ(67,"span",9)(68,"strong"),t._uU(69,"Banco:"),t.qZA(),t._UZ(70,"br"),t._uU(71,"Santander "),t.qZA()(),t.TgZ(72,"li")(73,"span",7),t._UZ(74,"i",8),t.qZA(),t.TgZ(75,"span",9)(76,"strong"),t._uU(77,"Cuenta Corriente"),t.qZA(),t._UZ(78,"br"),t._uU(79,"89412617 "),t.qZA()()()()(),t.TgZ(80,"div",3)(81,"div",4)(82,"h2",5),t._uU(83,"Informaci\xf3n para Facturaci\xf3n"),t.qZA(),t.TgZ(84,"ul",6)(85,"li")(86,"span",7),t._UZ(87,"i",8),t.qZA(),t.TgZ(88,"span",9)(89,"strong"),t._uU(90,"Nombre Empresa:"),t.qZA(),t._UZ(91,"br"),t._uU(92),t.qZA()(),t.TgZ(93,"li")(94,"span",7),t._UZ(95,"i",8),t.qZA(),t.TgZ(96,"span",9)(97,"strong"),t._uU(98,"Rut:"),t.qZA(),t._UZ(99,"br"),t._uU(100),t.qZA()(),t.TgZ(101,"li")(102,"span",7),t._UZ(103,"i",8),t.qZA(),t.TgZ(104,"span",9)(105,"strong"),t._uU(106,"Giro:"),t.qZA(),t._UZ(107,"br"),t._uU(108),t.qZA()(),t.TgZ(109,"li")(110,"span",7),t._UZ(111,"i",10),t.qZA(),t.TgZ(112,"span",9)(113,"strong"),t._uU(114,"Direcci\xf3n:"),t.qZA(),t._UZ(115,"br"),t._uU(116),t._UZ(117,"br"),t.qZA()()(),t.TgZ(118,"h6",13),t._uU(119,"Contraparte Finanzas"),t.qZA(),t.TgZ(120,"ul",6)(121,"li")(122,"span",7),t._UZ(123,"i",12),t.qZA(),t.TgZ(124,"span",9)(125,"strong"),t._uU(126,"Nombre:"),t.qZA(),t._UZ(127,"br"),t._uU(128),t.qZA()(),t.TgZ(129,"li")(130,"span",7),t._UZ(131,"i",11),t.qZA(),t.TgZ(132,"span",9)(133,"strong"),t._uU(134,"Correo:"),t.qZA(),t._UZ(135,"br"),t._uU(136),t.qZA()(),t.TgZ(137,"li")(138,"span",7),t._UZ(139,"i",14),t.qZA(),t.TgZ(140,"span",9)(141,"strong"),t._uU(142,"Tel\xe9fono:"),t.qZA(),t._UZ(143,"br"),t._uU(144),t.qZA()()()()(),t.TgZ(145,"div",3)(146,"div",4)(147,"div",15)(148,"table",16)(149,"thead",5)(150,"tr",5)(151,"th",17),t._uU(152,"Total EyE (ton)"),t.qZA()()(),t.TgZ(153,"tbody")(154,"tr")(155,"td",18)(156,"strong"),t._uU(157,"Papel/cart\xf3n Reciclable"),t.qZA()(),t.TgZ(158,"td",19)(159,"strong"),t._uU(160),t.qZA()()(),t.TgZ(161,"tr")(162,"td",18)(163,"strong"),t._uU(164,"Metal Reciclable"),t.qZA()(),t.TgZ(165,"td",19)(166,"strong"),t._uU(167),t.qZA()()(),t.TgZ(168,"tr")(169,"td",18)(170,"strong"),t._uU(171,"Pl\xe1stico Reciclable"),t.qZA()(),t.TgZ(172,"td",19)(173,"strong"),t._uU(174),t.qZA()()(),t.TgZ(175,"tr")(176,"td",18)(177,"strong"),t._uU(178,"No Reciclables"),t.qZA()(),t.TgZ(179,"td",19)(180,"strong"),t._uU(181),t.qZA()()(),t.TgZ(182,"tr")(183,"td",18)(184,"strong"),t._uU(185,"Total EyE"),t.qZA()(),t.TgZ(186,"td",19)(187,"strong"),t._uU(188),t.qZA()()()()()(),t.TgZ(189,"div",20)(190,"table",16)(191,"thead",5)(192,"tr",5)(193,"th",21),t._uU(194,"Total Facturado (CLP)"),t.qZA()()(),t.TgZ(195,"tbody")(196,"tr")(197,"td",18)(198,"strong"),t._uU(199,"Monto Neto"),t.qZA()(),t.TgZ(200,"td",19)(201,"strong"),t._uU(202),t.qZA()()(),t.TgZ(203,"tr")(204,"td",18)(205,"strong"),t._uU(206,"Monto I.V.A"),t.qZA()(),t.TgZ(207,"td",19)(208,"strong"),t._uU(209),t.qZA()()(),t.TgZ(210,"tr")(211,"td",18)(212,"strong"),t._uU(213,"Monto Total"),t.qZA()(),t.TgZ(214,"td",19)(215,"strong"),t._uU(216),t.qZA()()(),t.YNc(217,gt,4,0,"tr",22),t.qZA()()(),t.YNc(218,ft,2,0,"h2",23),t.YNc(219,xt,11,4,"div",22),t.qZA()(),t.TgZ(220,"div",24),t._uU(221," En caso de que la informaci\xf3n se\xf1alada est\xe9 err\xf3nea o desactualizada por favor contactarse al correo de soporte de plataforma ProREP: soporte@prorep.cl "),t.qZA()()()()),2&e&&(t.xp6(92),t.hij("",i.name_business," "),t.xp6(8),t.hij("",i.rut," "),t.xp6(8),t.hij("",i.giro," "),t.xp6(8),t.Oqu(i.loc_address),t.xp6(12),t.hij("",i.invoice_name," "),t.xp6(8),t.hij("",i.invoice_email," "),t.xp6(8),t.hij("",i.invoice_phone," "),t.xp6(16),t.Oqu(i.formatNumber(null==i.resume?null:i.resume.papel)),t.xp6(7),t.Oqu(i.formatNumber(null==i.resume?null:i.resume.metal)),t.xp6(7),t.Oqu(i.formatNumber(null==i.resume?null:i.resume.plastico)),t.xp6(7),t.Oqu(i.formatNumber(null==i.resume?null:i.resume.no_reciclable)),t.xp6(7),t.Oqu(i.formatNumber(i.getTotalEyE())),t.xp6(14),t.Oqu(null==i.resume?null:i.resume.neto),t.xp6(7),t.Oqu(null==i.resume?null:i.resume.iva),t.xp6(7),t.Oqu(null==i.resume?null:i.resume.total),t.xp6(1),t.Q6J("ngIf",i.isButtonVisible),t.xp6(1),t.Q6J("ngIf",i.isValidated),t.xp6(1),t.Q6J("ngIf",i.isValidated))},dependencies:[_.O5,p._Y,p.Fj,p.JJ,p.JL,p.Q7,p.sg,p.u],styles:[".btn-link[_ngcontent-%COMP%]{color:#777;text-decoration:underline;cursor:pointer;background:none;border:none;padding:0;font:inherit}.columna1[_ngcontent-%COMP%]{width:200px}.columna2[_ngcontent-%COMP%]{width:100px;text-align:right}"]}),o})();function At(o,a){if(1&o&&(t.TgZ(0,"p",11),t._uU(1),t.ALo(2,"date"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij("Borrador guardado a las: ",t.xi3(2,1,e.hour,"HH:mm:ss"),"")}}function Ct(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.changeStep(-1))}),t._uU(1,"Atr\xe1s"),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("disabled",e._saving||e.disableBackButton)}}function St(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.changeStep(1))}),t._uU(1,"Siguiente"),t.qZA()}}function Et(o,a){1&o&&t._UZ(0,"app-form-statement")}function It(o,a){1&o&&t._UZ(0,"app-summary-statement")}function wt(o,a){1&o&&t._UZ(0,"app-send-statement")}const M=function(o){return{active:o}};let Ut=(()=>{class o{constructor(e,i,n,s,l){this.fb=e,this.productorService=i,this.businessService=n,this.router=s,this.actived=l,this.tablas=["Reciclable","No Reciclable","Retornables / Reutilizados"],this.residuos=["Papel Cart\xf3n","Metal","Pl\xe1stico","Madera**","Envases compuestos"],this.position=1,this.hour=null,this.disableBackButton=!1,this.state=0,this.sessionCheck=null,this.isSubmited=!1,this.isEdited=!1,this._saving=!1,this.id_business=0,this.name_business="",this.rut_business="",this.year_statement=0,this.id_statement=null,this.detailForm=[],this.actived.queryParams.subscribe(r=>{this.id_business=r.id_business,this.year_statement=r.year}),this.getNameBusiness()}ngOnDestroy(){this.isSubmited||this.saveDraft(),sessionStorage.removeItem("id_statement"),sessionStorage.removeItem("detailForm"),sessionStorage.removeItem("saving"),sessionStorage.removeItem("detailLastForm"),null!==this.sessionCheck&&this.sessionCheck.unsubscribe()}ngOnInit(){sessionStorage.getItem("state")&&"2"==sessionStorage.getItem("state")&&(this.position=3),this.sessionCheck=function it(o=0,a=D){return o<0&&(o=0),function et(o=0,a,e=j){let i=-1;return null!=a&&((0,X.K)(a)?e=a:i=a),new W.y(n=>{let s=function tt(o){return o instanceof Date&&!isNaN(o)}(o)?+o-e.now():o;s<0&&(s=0);let l=0;return e.schedule(function(){n.closed||(n.next(l++),0<=i?this.schedule(void 0,i):n.complete())},s)})}(o,o,a)}(100).pipe((0,nt.U)(()=>parseInt(sessionStorage.getItem("state")||"0")),(0,ot.o)(e=>2!==e,!0)).subscribe(e=>{this.state!==e&&(this.state=e,this.updateBackButtonStatus())})}updateBackButtonStatus(){this.disableBackButton=2===this.state&&3===this.position}getNameBusiness(){this.businessService.getBusiness(this.id_business.toString()).subscribe({next:e=>{e.status&&(this.name_business=e.status[0].NAME,this.rut_business=e.status[0].VAT)},error:e=>{c().close(),c().fire({icon:"error",text:e.msg,title:"\xa1Ups!"})}})}saveDraft(){this._saving=!0;const e=sessionStorage.getItem("saving")||!1,i=sessionStorage.getItem("isEdited")||!1;this.id_statement=parseInt(sessionStorage.getItem("id_statement"))||null;const n=sessionStorage.getItem("detailForm"),s=JSON.parse(n||"[]");let l=!0;for(let u=0;u<s.length;u++)0!=s[u].value&&(l=!1);const r={id_business:this.id_business,year_statement:this.year_statement,state:!1,id_statement:this.id_statement};if(l&&3!==this.position)s.push({precedence:1,hazard:1,recyclability:1,type_residue:1,value:0,amount:0}),c().fire({icon:"question",title:"\xbfFormulario vacio?",text:"El formulario tiene todos los valores en cero. \xbfEstas seguro de guardar borrador?",showConfirmButton:!0,showCancelButton:!0,cancelButtonText:"Cancelar",confirmButtonText:"Guardar"}).then(u=>{if(u.isConfirmed)if(c().fire({title:"Guardando Datos",text:"Se est\xe1n guardando datos",timerProgressBar:!0,showConfirmButton:!1}),c().showLoading(),null!=this.id_statement||e){if(e)return;this.productorService.updateValuesStatement(this.id_statement,s,r).subscribe(m=>{m.status&&(this._saving=!1,this.hour=new Date,c().close())})}else sessionStorage.setItem("saving","true"),this.productorService.saveForm({header:r,detail:s}).subscribe(m=>{this.hour=new Date,this._saving=!1,m.status&&(sessionStorage.setItem("id_statement",m.data),c().close()),sessionStorage.removeItem("isEdited"),sessionStorage.removeItem("saving")});else this.position=1});else{if(null===n)return void(this._saving=!1);if(!i)return this.hour=new Date,void(this._saving=!1);if(null!=this.id_statement||e){if(e)return;this.productorService.updateValuesStatement(this.id_statement,s,r).subscribe(u=>{u.status&&(this._saving=!1,this.hour=new Date)})}else sessionStorage.setItem("saving","true"),this.productorService.saveForm({header:r,detail:s}).subscribe(u=>{this._saving=!1,this.hour=new Date,u.status&&sessionStorage.setItem("id_statement",u.data),sessionStorage.removeItem("saving"),sessionStorage.removeItem("isEdited")})}}updateFormState(){this.id_statement=parseInt(sessionStorage.getItem("id_statement"))||null,c().fire({icon:"question",title:"Confirmaci\xf3n Env\xedo",text:"Usted est\xe1 a punto de enviar su declaraci\xf3n. Una vez enviada, no podr\xe1 realizar modificaciones sobre la misma. \xbfEsta seguro de realizar el env\xedo?",showConfirmButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,showCancelButton:!0}).then(e=>{e.isConfirmed&&this.productorService.updateStateStatement(this.id_statement,!0).subscribe(i=>{c().fire({title:"Exito",text:"La declaraci\xf3n fue enviada exitosamente",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!0}).then(n=>{sessionStorage.removeItem("id_statement"),sessionStorage.removeItem("isEdited"),this.isSubmited=!0,this.router.navigate(["/productor/home"])})})})}changeStep(e){0!=this.position?(this.position>=1&&this.position<3&&e>0&&this.saveDraft(),e>0?this.position<3&&(this.position+=e):this.position>1&&(this.position+=e),this.updateBackButtonStatus()):this.position=1}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(p.qu),t.Y36(Z.u),t.Y36(O.m),t.Y36(b.F0),t.Y36(b.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-form"]],decls:35,vars:18,consts:[["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],["style","text-align: right;",4,"ngIf"],[1,"w-100",2,"width","100% !important"],[1,"table-responsive","mb-2","mb-lg-4"],[1,"list","list-process","list-unstyled"],[1,"list-process__dot",3,"ngClass"],[2,"text-align","right"],["class","btn btn-warning",3,"disabled","click",4,"ngIf"],["class","btn btn-primary",3,"click",4,"ngIf"],[4,"ngIf"],[1,"btn","btn-warning",3,"disabled","click"],[1,"btn","btn-primary",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),t._UZ(4,"i",4),t._uU(5," Inicio"),t.qZA()(),t.TgZ(6,"li",2)(7,"a",3),t._uU(8,"Consulta de Declaraci\xf3n"),t.qZA()(),t.TgZ(9,"li",5),t._uU(10),t.qZA()()(),t.TgZ(11,"h1"),t._uU(12,"Formulario"),t.qZA(),t._UZ(13,"hr")(14,"br")(15,"br"),t.YNc(16,At,3,4,"p",6),t.TgZ(17,"div",7)(18,"div",8)(19,"ul",9)(20,"li",10)(21,"a"),t._uU(22,"Formulario"),t.qZA()(),t.TgZ(23,"li",10)(24,"a"),t._uU(25,"Resumen"),t.qZA()(),t.TgZ(26,"li",10)(27,"a"),t._uU(28,"Facturaci\xf3n"),t.qZA()()()()(),t.TgZ(29,"div",11),t.YNc(30,Ct,2,1,"button",12),t.YNc(31,St,2,0,"button",13),t.qZA(),t.YNc(32,Et,1,0,"app-form-statement",14),t.YNc(33,It,1,0,"app-summary-statement",14),t.YNc(34,wt,1,0,"app-send-statement",14)),2&e&&(t.xp6(10),t.lnq("Declaraci\xf3n ",i.year_statement," - ",i.name_business,"(",i.rut_business,") "),t.xp6(6),t.Q6J("ngIf",null!=i.hour),t.xp6(4),t.Q6J("ngClass",t.VKq(12,M,1==i.position)),t.xp6(3),t.Q6J("ngClass",t.VKq(14,M,2==i.position)),t.xp6(3),t.Q6J("ngClass",t.VKq(16,M,3==i.position)),t.xp6(4),t.Q6J("ngIf",i.position>1),t.xp6(1),t.Q6J("ngIf",i.position<3),t.xp6(1),t.Q6J("ngIf",1==i.position),t.xp6(1),t.Q6J("ngIf",2==i.position),t.xp6(1),t.Q6J("ngIf",3==i.position))},dependencies:[_.mk,_.O5,P,_t,Zt,_.uU],styles:["[_nghost-%COMP%]{width:90%!important;padding:1%}"]}),o})();const Ft=function(o,a,e){return{"green-circle":o,"red-circle":a,"yellow-circle":e}};function qt(o,a){if(1&o&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._UZ(8,"span",34),t._uU(9),t.qZA()()),2&o){const e=a.$implicit,i=t.oxw();t.xp6(2),t.Oqu(e.CODE_BUSINESS),t.xp6(2),t.Oqu(e.NAME),t.xp6(2),t.Oqu(i.year),t.xp6(2),t.Q6J("ngClass",t.kEZ(5,Ft,1==i.businessById(e.ID).code,0==i.businessById(e.ID).code||-1==i.businessById(e.ID).code,2==i.businessById(e.ID).code)),t.xp6(1),t.hij(" ",i.businessById(e.ID).status," ")}}const Ot=function(o,a){return{"btn-info":o,"btn-primary":a}};function Mt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"button",35),t.NdJ("click",function(){const s=t.CHM(e).index,l=t.oxw();return t.KtG(l.pagTo(s))}),t._uU(2),t.qZA()()}if(2&o){const e=a.index,i=t.oxw();t.xp6(1),t.Q6J("ngClass",t.WLB(2,Ot,i.pos==e+1,i.pos!=e+1)),t.xp6(1),t.Oqu(e+1)}}let Bt=(()=>{class o{constructor(e,i,n,s){this.productorService=e,this.router=i,this.ratesService=n,this.businessServices=s,this.db=[],this.dbStatements=[],this.pos=1,this.business_name=[],this.years=[],this.cant=0,this.types=["EyE reciclables de papel/cart\xf3n","EyE reciclables de metal","EyE reciclables de pl\xe1sticos","EyE no reciclables"],this.year=(new Date).getFullYear()-1,this.rates=[],this.allStatement=[],this.allBusiness=[],this.decrypt=l=>{const r=Buffer.from(l,"base64");return Buffer.from(r).toString("utf-8")}}ngOnInit(){this.loadStatements(),this.ratesService.getRates(this.year).subscribe(i=>{i.status&&i.data.forEach(n=>{this.rates.push({name:this.types[n.type-1],price:n.price})})}),sessionStorage.getItem("user")&&this.openTermsAndConditions()}loadStatements(){const e=JSON.parse(sessionStorage.getItem("user")).ID;this.businessServices.getBusinessById(e,this.year.toString()).subscribe(i=>{this.allStatement=i.data.statements,this.allBusiness=i.data.business.sort((n,s)=>n.CODE_BUSINESS.toString().localeCompare(s.CODE_BUSINESS.toString())),this.cant=Math.ceil(this.allBusiness.length/10),this.db=this.allBusiness.slice(10*(this.pos-1),10*this.pos).sort((n,s)=>n.CODE_BUSINESS.toString().localeCompare(s.CODE_BUSINESS.toString()))})}businessById(e){const i=this.allStatement.find(l=>l.ID_BUSINESS==e);let n="",s=-1;if(null==i)n="No Enviado";else switch(s=i.STATE,i.STATE){case 1:n="Enviada";break;case 0:n="Borrador";break;case 2:n="Pendiente"}return{status:n,code:s}}filter(){const e=document.getElementById("f_name").value,i=document.getElementById("f_year").value,n=this.dbStatements.filter(s=>{if("-1"!=e&&s.NAME_BUSINESS==e){if("-1"==i)return s;if(s.YEAR_STATEMENT==i)return s}if("-1"==e){if("-1"==i)return s;if(s.YEAR_STATEMENT==i)return s}});this.db=n.slice(0,10).sort((s,l)=>s.CODE_BUSINESS.toString().localeCompare(l.CODE_BUSINESS.toString())),this.cant=Math.ceil(n.length/10)}reset(){this.loadStatements()}pagTo(e){this.pos=e+1,this.db=this.allBusiness.slice(10*e,10*(e+1)).sort((i,n)=>i.CODE_BUSINESS.toString().localeCompare(n.CODE_BUSINESS.toString()))}next(){this.pos>=this.cant||(this.pos++,this.db=this.allBusiness.slice(10*(this.pos-1),10*this.pos).sort((e,i)=>e.CODE_BUSINESS.toString().localeCompare(i.CODE_BUSINESS.toString())))}previus(){this.pos-1<=0||this.pos>=this.cant+1||(this.pos=this.pos-1,this.db=this.allBusiness.slice(10*(this.pos-1),10*this.pos).sort((e,i)=>e.CODE_BUSINESS.toString().localeCompare(i.CODE_BUSINESS.toString())))}navigateToForm(e,i,n,s=0){sessionStorage.setItem("state",s.toString()||"0"),sessionStorage.setItem("id_statement",n?.toString()||"null"),this.router.navigateByUrl(`/productor/form?year=${i}&id_business=${e}`)}setArrayFromNumber(){return new Array(this.cant)}logout(){this.router.navigate(["/auth/login"],{queryParams:{logout:!0}})}dowloadPdf(){this.productorService.downloadPDFTerminos().subscribe(e=>{const i=new Blob([e],{type:e.type}),n=window.URL.createObjectURL(i),s=document.createElement("a");s.href=n,s.download="Declaracion Jurada.pdf",s.click(),window.URL.revokeObjectURL(n)})}adjuntar(){var e=document.createElement("input");e.type="file",e.style.display="none",e.onchange=i=>{let s=i.target.files[0];s&&"application/pdf"===s.type&&s.size/1e3<=1e3?(this.file=s,this.productorService.uploadPDFTerminos(s).subscribe({next:l=>{l.status&&document.getElementById("modal_terminos_close").click()}})):c().fire({icon:"info",text:"El archivo debe ser PDF y debe pesar menos de 1MB"})},document.body.appendChild(e),e.click()}openTermsAndConditions(){this.productorService.veryfyPDFTerminos().subscribe(e=>{e.status||document.getElementById("modalDownloadPdfTerms").click()})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(Z.u),t.Y36(b.F0),t.Y36(I.z),t.Y36(O.m))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-home"]],decls:88,vars:2,consts:[["rel","stylesheet","href","https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css","integrity","sha512-*********","crossorigin","anonymous"],["id","content",2,"width","60vw","margin","0","padding","0"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],["aria-current","page",1,"breadcrumb-item"],["aria-hidden","true",1,"fa","fa-home"],[1,"inicio"],[1,"box","box-inicio"],[1,"row"],[1,"col-12","col-md-12"],[1,"h1"],["href","mailto:soporte@prorep.cl"],["href","tel:+56979168394",1,"color-white"],[1,"table-responsive"],[1,"table","table-even","table-section","table-borderless","table-radius"],[1,"vertical-middle"],[4,"ngFor","ngForOf"],["aria-label","Navegaci\xf3n resultados"],[1,"pagination"],[1,"btn","btn-primary",3,"click"],["type","button","id","modalDownloadPdfTerms","data-bs-toggle","modal","data-bs-target","#Modal",1,"btn","btn-primary","text-center","d-none"],["id","Modal","tabindex","-1","aria-labelledby","ModalLabel","aria-hidden","true","data-bs-backdrop","static",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header","text-center"],[1,"container"],[1,"fas","fa-exclamation-triangle","color-orange","fa-3x","icon-orange"],["id","ModalLabel",1,"modal-title","text-center"],["type","button","id","modal_terminos_close","data-bs-dismiss","modal","aria-label","Close",1,"btn-close","d-none"],[1,"modal-body","text-center"],["href","javascript:void(0)",3,"click"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[1,"circle",3,"ngClass"],[1,"border","btn","btn-sm",3,"ngClass","click"]],template:function(e,i){1&e&&(t._UZ(0,"link",0),t.TgZ(1,"div",1)(2,"nav",2)(3,"ol",3)(4,"li",4),t._UZ(5,"i",5),t._uU(6," Inicio"),t.qZA()()(),t.TgZ(7,"section",6)(8,"h1"),t._uU(9,"Inicio"),t.qZA(),t.TgZ(10,"div",7)(11,"div",8)(12,"div",9)(13,"h2",10),t._uU(14,"Bienvenido/a a Mi Declaraci\xf3n"),t.qZA(),t.TgZ(15,"p"),t._uU(16,"Como parte de las obligaciones que establece la Ley REP, los Productores deben informar la cantidad de EyE no domiciliarios (POM) puestos en el mercado el a\xf1o anterior."),t.qZA(),t.TgZ(17,"p"),t._uU(18,"ProREP pone a disposici\xf3n de sus socios la plataforma de declaraci\xf3n que dar\xe1 cumplimiento a la obligaci\xf3n de informar sus EyE."),t.qZA(),t.TgZ(19,"p"),t._uU(20,"La declaraci\xf3n de los EyE introducidos en el mercado el a\xf1o anterior deber\xe1 ser subida y enviada antes del 20 de marzo de cada a\xf1o"),t.qZA(),t.TgZ(21,"p"),t._uU(22,"En caso de problemas, errores, correcciones o dudas espec\xedficas contactarse con el \xc1rea de Soporte en el siguiente mail: "),t.TgZ(23,"a",11),t._uU(24,"soporte@prorep.cl"),t.qZA()(),t.TgZ(25,"h2",10),t._uU(26,"Contacto:"),t.qZA(),t.TgZ(27,"p")(28,"strong"),t._uU(29,"\xbfAlguna pregunta?"),t.qZA(),t._uU(30," P\xf3ngase en contacto con nuestro equipo de atenci\xf3n al cliente. "),t.qZA(),t.TgZ(31,"p"),t._uU(32,"Celular "),t.TgZ(33,"strong")(34,"a",12),t._uU(35,"+56 9 7916 8394"),t.qZA()()()()()(),t._UZ(36,"p"),t.TgZ(37,"div",13)(38,"table",14)(39,"thead",15)(40,"tr")(41,"th"),t._uU(42,"ID Empresa"),t.qZA(),t.TgZ(43,"th"),t._uU(44,"Nombre Empresa"),t.qZA(),t.TgZ(45,"th"),t._uU(46,"A\xf1o Declaraci\xf3n"),t.qZA(),t.TgZ(47,"th"),t._uU(48,"Estado"),t.qZA()()(),t.TgZ(49,"tbody"),t.YNc(50,qt,10,9,"tr",16),t.qZA()()(),t.TgZ(51,"nav",17)(52,"ul",18)(53,"li")(54,"button",19),t.NdJ("click",function(){return i.pagTo(0)}),t._uU(55,"Primero"),t.qZA()(),t.TgZ(56,"li")(57,"button",19),t.NdJ("click",function(){return i.previus()}),t._uU(58,"Anterior"),t.qZA()(),t.YNc(59,Mt,3,5,"li",16),t.TgZ(60,"li")(61,"button",19),t.NdJ("click",function(){return i.next()}),t._uU(62,"Siguiente"),t.qZA()(),t.TgZ(63,"li")(64,"button",19),t.NdJ("click",function(){return i.pagTo(i.cant-1)}),t._uU(65,"\xdaltimo"),t.qZA()()()()()(),t.TgZ(66,"button",20),t._uU(67," Launch demo modal\n"),t.qZA(),t.TgZ(68,"div",21)(69,"div",22)(70,"div",23)(71,"div",24)(72,"div",25),t._UZ(73,"i",26)(74,"br"),t.TgZ(75,"h2",27),t._uU(76,"T\xe9rminos y condiciones"),t.qZA()(),t._UZ(77,"button",28),t.qZA(),t.TgZ(78,"div",29)(79,"p"),t._uU(80,"Estimado usuario Productor, para empezar a operar en el sistema se solicita subir la declaraci\xf3n jurada que encontrar\xe1 en el siguiente link debidamente firmada."),t.qZA(),t.TgZ(81,"a",30),t.NdJ("click",function(){return i.dowloadPdf()}),t._uU(82,"Descargar t\xe9rminos y condiciones"),t.qZA()(),t.TgZ(83,"div",31)(84,"button",32),t.NdJ("click",function(){return i.logout()}),t._uU(85,"Cancelar"),t.qZA(),t.TgZ(86,"button",33),t.NdJ("click",function(){return i.adjuntar()}),t._uU(87,"Adjuntar"),t.qZA()()()()()),2&e&&(t.xp6(50),t.Q6J("ngForOf",i.db),t.xp6(9),t.Q6J("ngForOf",i.setArrayFromNumber()))},dependencies:[_.mk,_.sg],styles:[".circle[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%;display:inline-block;margin-right:5px}.green-circle[_ngcontent-%COMP%]{background-color:green}.red-circle[_ngcontent-%COMP%]{background-color:red}.yellow-circle[_ngcontent-%COMP%]{background-color:#ff0}body[_ngcontent-%COMP%]{font-family:Open Sans,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,Helvetica,Arial,sans-serif}.icon-orange[_ngcontent-%COMP%]{color:#f8bb86}"]}),o})();var Nt=d(4135),kt=d(263);let Lt=(()=>{class o{constructor(e,i,n,s){this.fb=e,this.authService=i,this.productorServices=n,this.router=s,this.pos="right",this.horaIngreso=new Date,this.formData=this.fb.group({actual:["",[p.kI.required]],password:["",[p.kI.required,p.kI.minLength(3)]],repeatPassword:["",[p.kI.required,p.kI.minLength(3)]]}),this.pos2="right"}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.horaIngreso=new Date(sessionStorage.getItem("horaIngreso"))}btnrecovery(){const{actual:e,password:i,repeatPassword:n}=this.formData.value;this.authService.modifyPassword(i,n,e).subscribe({next:s=>{s.status?(c().fire({title:"Cambio de contrase\xf1a",text:"La contrase\xf1a fue cambiada exitosamente",icon:"success"}),this.router.navigate(["/productor/home"])):(c().fire({title:"Validar informaci\xf3n",text:s.msg,icon:"error"}),this.formData.reset())},error:s=>{c().fire({title:"Formato inv\xe1lido",text:"Contrase\xf1a debe contener al menos 8 caracteres",icon:"error"})}})}displayModifyPassword(){this.pos="right"==this.pos?"down":"right"}displayModifyPassword2(){this.pos2="right"==this.pos2?"down":"right"}downloadTerminos(){this.productorServices.downloadPdfFirma().subscribe({next:e=>{if(e){const i=new Blob([e],{type:"application/pdf"});let n=document.createElement("a");n.href=window.URL.createObjectURL(i),n.download="Declaraci\xf3n Jurada Firmada",document.body.appendChild(n),n.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),n.remove(),window.URL.revokeObjectURL(n.href)}}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(p.qu),t.Y36(kt.e),t.Y36(Z.u),t.Y36(b.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-profile"]],decls:95,vars:20,consts:[[1,"container","mt-4"],[1,"mi-perfil"],[1,"box","box-mi-perfil","mb-5","d-flex","align-items-start"],[1,"list","list-data","list-data-title-green","column-md-2","gap-0","list-unstyled"],[1,"list-data__title"],[1,"list-data__text"],[1,"color-verde"],[1,"list","list-links","list-unstyled"],["id","accordionPanelsStayOpenExample",1,"accordion","accordion-flush"],[1,"accordion-item"],["id","panelsStayOpen-headingOne",1,"accordion-header"],["data-bs-toggle","collapse","data-bs-target","#panelsStayOpen-collapseOne",3,"click"],["aria-hidden","true"],["id","panelsStayOpen-collapseOne","aria-labelledby","panelsStayOpen-headingOne",1,"accordion-collapse","collapse"],[1,"accordion-body"],["autocomplete","off",1,"form-recovery",3,"formGroup"],[1,"mb-4"],[1,"input-group"],[1,"input-group-text","input-group-text-left"],["aria-hidden","true",1,"fa","fa-lock","fa-fw"],["type","password","id","password","formControlName","actual","placeholder","Contrase\xf1a actual",1,"form-control"],["type","password","id","password","formControlName","password","placeholder","Nueva contrase\xf1a",1,"form-control"],["type","password","id","repeatPassword","formControlName","repeatPassword","placeholder","Repetir contrase\xf1a",1,"form-control"],["type","button",1,"btn","btn-primary","btn-fa","w-100",3,"click"],["aria-hidden","true",1,"fa","fa-long-arrow-right","fa-fw"],["id","panelsStayOpen-headingTwo",1,"accordion-header"],["data-bs-toggle","collapse","data-bs-target","#panelsStayOpen-collapseTwo",3,"click"],["id","panelsStayOpen-collapseTwo","aria-labelledby","panelsStayOpen-headingTwo",1,"accordion-collapse","collapse"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"section",1)(2,"h1"),t._uU(3,"Mi Perfil"),t.qZA(),t.TgZ(4,"div",2)(5,"ul",3)(6,"li")(7,"span",4),t._uU(8,"Nombre Usuario"),t.qZA(),t.TgZ(9,"span",5),t._uU(10),t.qZA()(),t.TgZ(11,"li")(12,"span",4),t._uU(13,"Perfil"),t.qZA(),t.TgZ(14,"span",5),t._uU(15),t.qZA()(),t.TgZ(16,"li")(17,"span",4),t._uU(18,"Tel\xe9fono"),t.qZA(),t.TgZ(19,"span",5),t._uU(20),t.qZA()(),t.TgZ(21,"li")(22,"span",4),t._uU(23,"Correo"),t.qZA(),t.TgZ(24,"span",5),t._uU(25),t.qZA()(),t.TgZ(26,"li")(27,"span",4),t._uU(28,"Instituci\xf3n"),t.qZA(),t.TgZ(29,"span",5),t._uU(30),t.qZA()(),t.TgZ(31,"li")(32,"span",4),t._uU(33,"Cargo"),t.qZA(),t.TgZ(34,"span",5),t._uU(35),t.qZA()(),t.TgZ(36,"li")(37,"span",4),t._uU(38,"Tel\xe9fono Oficina"),t.qZA(),t.TgZ(39,"span",5),t._uU(40),t.qZA()(),t.TgZ(41,"li")(42,"span",4)(43,"b"),t._uU(44,"Fecha/ Hora ingreso"),t.qZA()(),t.TgZ(45,"span",5),t._uU(46),t.ALo(47,"date"),t.qZA()()()(),t.TgZ(48,"h2",6),t._uU(49,"Acciones"),t.qZA(),t.TgZ(50,"ul",7)(51,"div",8)(52,"div",9)(53,"h2",10)(54,"li",11),t.NdJ("click",function(){return i.displayModifyPassword()}),t.TgZ(55,"a")(56,"span"),t._uU(57,"Cambio de contrase\xf1a"),t.qZA(),t._UZ(58,"i",12),t.qZA()()(),t.TgZ(59,"div",13)(60,"div",14)(61,"form",15)(62,"div",16)(63,"div",17)(64,"button",18),t._UZ(65,"i",19),t.qZA(),t._UZ(66,"input",20),t.qZA()(),t.TgZ(67,"div",16)(68,"div",17)(69,"button",18),t._UZ(70,"i",19),t.qZA(),t._UZ(71,"input",21),t.qZA()(),t.TgZ(72,"div",16)(73,"div",17)(74,"button",18),t._UZ(75,"i",19),t.qZA(),t._UZ(76,"input",22),t.qZA()(),t.TgZ(77,"div",16)(78,"button",23),t.NdJ("click",function(){return i.btnrecovery()}),t._uU(79," Enviar "),t._UZ(80,"i",24),t.qZA()()()()()(),t.TgZ(81,"div",9)(82,"h2",25)(83,"li",26),t.NdJ("click",function(){return i.displayModifyPassword2()}),t.TgZ(84,"a")(85,"span"),t._uU(86,"Descargar Mi Declaraci\xf3n"),t.qZA(),t._UZ(87,"i",12),t.qZA()()(),t.TgZ(88,"div",27)(89,"div",14)(90,"form",15)(91,"div",16)(92,"button",23),t.NdJ("click",function(){return i.downloadTerminos()}),t._uU(93," Descargar "),t._UZ(94,"i",24),t.qZA()()()()()()()()()()),2&e&&(t.xp6(10),t.AsE("",i.userData.FIRST_NAME," ",i.userData.LAST_NAME,""),t.xp6(5),t.Oqu(i.userData.ROL_NAME),t.xp6(5),t.Oqu(i.userData.PHONE),t.xp6(5),t.Oqu(i.userData.EMAIL),t.xp6(5),t.Oqu(i.userData.BUSINESS.join(" || ")),t.xp6(5),t.Oqu(i.userData.POSITION),t.xp6(5),t.Oqu(i.userData.PHONE_OFFICE),t.xp6(6),t.Oqu(t.xi3(47,17,i.horaIngreso,"dd-MM-yyyy H:mm:s")),t.xp6(12),t.Gre("fa fa-chevron-",i.pos,""),t.xp6(3),t.Q6J("formGroup",i.formData),t.xp6(26),t.Gre("fa fa-chevron-",i.pos2,""),t.xp6(3),t.Q6J("formGroup",i.formData))},dependencies:[p._Y,p.Fj,p.JJ,p.JL,p.sg,p.u,_.uU],styles:[".accordion[_ngcontent-%COMP%]{border:none!important}.accordion-item[_ngcontent-%COMP%]{border:none}.accordion[_ngcontent-%COMP%]   .accordion-item[_ngcontent-%COMP%]:last-child{border:none}.accordion[_ngcontent-%COMP%]   .accordion-body[_ngcontent-%COMP%]{border:none}a[_ngcontent-%COMP%]{cursor:pointer}a[_ngcontent-%COMP%]:hover{color:#09a57b}.swal-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px}"]}),o})();var A=d(7340);let Dt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[_.ez]}),o})();var h=d(9592),B=d(1795);let Rt=(()=>{class o{constructor(e){this.el=e,this.iconPos="left",this.loadingIcon="pi pi-spinner pi-spin",this._loading=!1}ngAfterViewInit(){this._initialStyleClass=this.el.nativeElement.className,h.p.addMultipleClasses(this.el.nativeElement,this.getStyleClass()),(this.icon||this.loading)&&this.createIconEl();let e=document.createElement("span");this.icon&&!this.label&&e.setAttribute("aria-hidden","true"),e.className="p-button-label",this.label?e.appendChild(document.createTextNode(this.label)):e.innerHTML="&nbsp;",this.el.nativeElement.appendChild(e),this.initialized=!0}getStyleClass(){let e="p-button p-component";return this.icon&&!this.label&&(e+=" p-button-icon-only"),this.loading&&(e+=" p-disabled p-button-loading",!this.icon&&this.label&&(e+=" p-button-loading-label-only")),e}setStyleClass(){let e=this.getStyleClass();this.el.nativeElement.className=e+" "+this._initialStyleClass}createIconEl(){let e=document.createElement("span");e.className="p-button-icon",e.setAttribute("aria-hidden","true");let i=this.label?"p-button-icon-"+this.iconPos:null;i&&h.p.addClass(e,i);let n=this.getIconClass();n&&h.p.addMultipleClasses(e,n);let s=h.p.findSingle(this.el.nativeElement,".p-button-label");s?this.el.nativeElement.insertBefore(e,s):this.el.nativeElement.appendChild(e)}getIconClass(){return this.loading?"p-button-loading-icon "+this.loadingIcon:this._icon}setIconClass(){let e=h.p.findSingle(this.el.nativeElement,".p-button-icon");e?e.className=this.iconPos?"p-button-icon p-button-icon-"+this.iconPos+" "+this.getIconClass():"p-button-icon "+this.getIconClass():this.createIconEl()}removeIconElement(){let e=h.p.findSingle(this.el.nativeElement,".p-button-icon");this.el.nativeElement.removeChild(e)}get label(){return this._label}set label(e){this._label=e,this.initialized&&(h.p.findSingle(this.el.nativeElement,".p-button-label").textContent=this._label||"&nbsp;",(this.loading||this.icon)&&this.setIconClass(),this.setStyleClass())}get icon(){return this._icon}set icon(e){this._icon=e,this.initialized&&(this.setIconClass(),this.setStyleClass())}get loading(){return this._loading}set loading(e){this._loading=e,this.initialized&&(this.loading||this.icon?this.setIconClass():this.removeIconElement(),this.setStyleClass())}ngOnDestroy(){this.initialized=!1}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(t.SBq))},o.\u0275dir=t.lG2({type:o,selectors:[["","pButton",""]],hostAttrs:[1,"p-element"],inputs:{iconPos:"iconPos",loadingIcon:"loadingIcon",label:"label",icon:"icon",loading:"loading"}}),o})(),Yt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[_.ez,B.T]}),o})();var x=d(805),y=d(982),N=d(3718);const Ht=["container"],Jt=["in"],Gt=["multiIn"],Vt=["multiContainer"],$t=["ddBtn"],Qt=["items"],zt=["scroller"],Kt=function(o,a){return{"p-autocomplete-dd-input":o,"p-disabled":a}};function jt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"input",8,9),t.NdJ("click",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onInputClick(n))})("input",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onInput(n))})("keydown",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onKeydown(n))})("keyup",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onKeyup(n))})("focus",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onInputFocus(n))})("blur",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onInputBlur(n))})("change",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onInputChange(n))})("paste",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onInputPaste(n))}),t.qZA()}if(2&o){const e=t.oxw();t.Tol(e.inputStyleClass),t.Q6J("ngStyle",e.inputStyle)("autocomplete",e.autocomplete)("ngClass",t.WLB(20,Kt,e.dropdown,e.disabled))("value",e.inputFieldValue)("readonly",e.readonly)("disabled",e.disabled),t.uIk("type",e.type)("id",e.inputId)("required",e.required)("name",e.name)("autofocus",e.autofocus)("placeholder",e.placeholder)("size",e.size)("maxlength",e.maxlength)("tabindex",e.tabindex)("aria-label",e.ariaLabel)("aria-labelledby",e.ariaLabelledBy)("aria-required",e.required)}}function Wt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"i",10),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.clear())}),t.qZA()}}function Xt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"i",10),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.clear())}),t.qZA()}}function te(o,a){1&o&&t.GkF(0)}function ee(o,a){if(1&o&&(t.TgZ(0,"span",22),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(1),t.Oqu(i.resolveFieldData(e))}}function ie(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"span",23),t.NdJ("click",function(){t.CHM(e),t.oxw();const n=t.MAs(1),s=t.oxw(2);return t.KtG(s.removeItem(n))}),t.qZA()}}const F=function(o){return{$implicit:o}};function ne(o,a){if(1&o&&(t.TgZ(0,"li",17,18),t.YNc(2,te,1,0,"ng-container",19),t.YNc(3,ee,2,1,"span",20),t.YNc(4,ie,1,0,"span",21),t.qZA()),2&o){const e=a.$implicit,i=t.oxw(2);t.xp6(2),t.Q6J("ngTemplateOutlet",i.selectedItemTemplate)("ngTemplateOutletContext",t.VKq(4,F,e)),t.xp6(1),t.Q6J("ngIf",!i.selectedItemTemplate),t.xp6(1),t.Q6J("ngIf",!i.disabled&&!i.readonly)}}const oe=function(o,a){return{"p-disabled":o,"p-focus":a}};function se(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"ul",11,12),t.NdJ("click",function(){t.CHM(e);const n=t.MAs(5);return t.KtG(n.focus())}),t.YNc(2,ne,5,6,"li",13),t.TgZ(3,"li",14)(4,"input",15,16),t.NdJ("input",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onInput(n))})("click",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onInputClick(n))})("keydown",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onKeydown(n))})("keyup",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onKeyup(n))})("focus",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onInputFocus(n))})("blur",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onInputBlur(n))})("change",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onInputChange(n))})("paste",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onInputPaste(n))}),t.qZA()()()}if(2&o){const e=t.oxw();t.Q6J("ngClass",t.WLB(20,oe,e.disabled,e.focus)),t.xp6(2),t.Q6J("ngForOf",e.value),t.xp6(2),t.Tol(e.inputStyleClass),t.Q6J("disabled",e.disabled)("readonly",e.readonly)("autocomplete",e.autocomplete)("ngStyle",e.inputStyle),t.uIk("type",e.type)("id",e.inputId)("placeholder",e.value&&e.value.length?null:e.placeholder)("tabindex",e.tabindex)("maxlength",e.maxlength)("autofocus",e.autofocus)("aria-label",e.ariaLabel)("aria-labelledby",e.ariaLabelledBy)("aria-required",e.required)("aria-controls",e.listId)("aria-expanded",e.overlayVisible)("aria-activedescendant","p-highlighted-option")}}function ae(o,a){1&o&&t._UZ(0,"i",24)}function le(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",25,26),t.NdJ("click",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.handleDropdownClick(n))}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("icon",e.dropdownIcon)("disabled",e.disabled),t.uIk("aria-label",e.dropdownAriaLabel)("tabindex",e.tabindex)}}function re(o,a){1&o&&t.GkF(0)}function ue(o,a){1&o&&t.GkF(0)}const R=function(o,a){return{$implicit:o,options:a}};function ce(o,a){if(1&o&&t.YNc(0,ue,1,0,"ng-container",19),2&o){const e=a.$implicit,i=a.options;t.oxw(2);const n=t.MAs(6);t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.WLB(2,R,e,i))}}function pe(o,a){1&o&&t.GkF(0)}const de=function(o){return{options:o}};function me(o,a){if(1&o&&t.YNc(0,pe,1,0,"ng-container",19),2&o){const e=a.options,i=t.oxw(4);t.Q6J("ngTemplateOutlet",i.loaderTemplate)("ngTemplateOutletContext",t.VKq(2,de,e))}}function _e(o,a){1&o&&(t.ynx(0),t.YNc(1,me,1,4,"ng-template",36),t.BQk())}const q=function(o){return{height:o}};function he(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"p-scroller",33,34),t.NdJ("onLazyLoad",function(n){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onLazyLoad.emit(n))}),t.YNc(2,ce,1,5,"ng-template",35),t.YNc(3,_e,2,0,"ng-container",31),t.qZA()}if(2&o){const e=t.oxw(2);t.Akn(t.VKq(8,q,e.scrollHeight)),t.Q6J("items",e.suggestions)("itemSize",e.virtualScrollItemSize||e._itemSize)("autoSize",!0)("lazy",e.lazy)("options",e.virtualScrollOptions),t.xp6(3),t.Q6J("ngIf",e.loaderTemplate)}}function ge(o,a){1&o&&t.GkF(0)}const fe=function(){return{}};function be(o,a){if(1&o&&(t.ynx(0),t.YNc(1,ge,1,0,"ng-container",19),t.BQk()),2&o){t.oxw();const e=t.MAs(6),i=t.oxw();t.xp6(1),t.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",t.WLB(3,R,i.suggestions,t.DdM(2,fe)))}}function Te(o,a){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit,i=t.oxw(4);t.xp6(1),t.Oqu(i.getOptionGroupLabel(e)||"empty")}}function ve(o,a){1&o&&t.GkF(0)}function ye(o,a){1&o&&t.GkF(0)}function xe(o,a){if(1&o&&(t.TgZ(0,"li",41),t.YNc(1,Te,2,1,"span",31),t.YNc(2,ve,1,0,"ng-container",19),t.qZA(),t.YNc(3,ye,1,0,"ng-container",19)),2&o){const e=a.$implicit,i=t.oxw(2).options,n=t.MAs(5),s=t.oxw(2);t.Q6J("ngStyle",t.VKq(6,q,i.itemSize+"px")),t.xp6(1),t.Q6J("ngIf",!s.groupTemplate),t.xp6(1),t.Q6J("ngTemplateOutlet",s.groupTemplate)("ngTemplateOutletContext",t.VKq(8,F,e)),t.xp6(1),t.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",t.VKq(10,F,s.getOptionGroupChildren(e)))}}function Ze(o,a){if(1&o&&(t.ynx(0),t.YNc(1,xe,4,12,"ng-template",40),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",e)}}function Ae(o,a){1&o&&t.GkF(0)}function Ce(o,a){if(1&o&&(t.ynx(0),t.YNc(1,Ae,1,0,"ng-container",19),t.BQk()),2&o){const e=t.oxw().$implicit,i=t.MAs(5);t.xp6(1),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(2,F,e))}}function Se(o,a){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit,i=t.oxw(4);t.xp6(1),t.Oqu(i.resolveFieldData(e))}}function Ee(o,a){1&o&&t.GkF(0)}const Ie=function(o){return{"p-highlight":o}},we=function(o,a){return{$implicit:o,index:a}};function Ue(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"li",44),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw(4);return t.KtG(l.selectItem(s))}),t.YNc(1,Se,2,1,"span",31),t.YNc(2,Ee,1,0,"ng-container",19),t.qZA()}if(2&o){const e=a.$implicit,i=a.index,n=t.oxw(2).options,s=t.oxw(2);t.Q6J("ngStyle",t.VKq(6,q,n.itemSize+"px"))("ngClass",t.VKq(8,Ie,e===s.highlightOption))("id",s.highlightOption==e?"p-highlighted-option":""),t.xp6(1),t.Q6J("ngIf",!s.itemTemplate),t.xp6(1),t.Q6J("ngTemplateOutlet",s.itemTemplate)("ngTemplateOutletContext",t.WLB(10,we,e,n.getOptions?n.getOptions(i):i))}}function Fe(o,a){if(1&o&&(t.ynx(0),t._uU(1),t.BQk()),2&o){const e=t.oxw(5);t.xp6(1),t.hij(" ",e.emptyMessageLabel," ")}}function qe(o,a){1&o&&t.GkF(0,null,47)}function Oe(o,a){if(1&o&&(t.TgZ(0,"li",45),t.YNc(1,Fe,2,1,"ng-container",46),t.YNc(2,qe,2,0,"ng-container",29),t.qZA()),2&o){const e=t.oxw(2).options,i=t.oxw(2);t.Q6J("ngStyle",t.VKq(4,q,e.itemSize+"px")),t.xp6(1),t.Q6J("ngIf",!i.emptyTemplate)("ngIfElse",i.empty),t.xp6(1),t.Q6J("ngTemplateOutlet",i.emptyTemplate)}}function Me(o,a){if(1&o&&(t.YNc(0,Ue,3,13,"li",42),t.YNc(1,Oe,3,6,"li",43)),2&o){const e=a.$implicit,i=t.oxw(3);t.Q6J("ngForOf",e),t.xp6(1),t.Q6J("ngIf",i.noResults&&i.showEmptyMessage)}}function Be(o,a){if(1&o&&(t.TgZ(0,"ul",37,38),t.YNc(2,Ze,2,1,"ng-container",31),t.YNc(3,Ce,2,4,"ng-container",31),t.YNc(4,Me,2,2,"ng-template",null,39,t.W1O),t.qZA()),2&o){const e=a.options,i=t.oxw(2);t.Akn(e.contentStyle),t.Q6J("ngClass",e.contentStyleClass),t.uIk("id",i.listId),t.xp6(2),t.Q6J("ngIf",i.group),t.xp6(1),t.Q6J("ngIf",!i.group)}}function Ne(o,a){1&o&&t.GkF(0)}const ke=function(){return["p-autocomplete-panel p-component"]},Le=function(o,a){return{showTransitionParams:o,hideTransitionParams:a}},De=function(o){return{value:"visible",params:o}};function Pe(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",27,28),t.NdJ("click",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onOverlayClick(n))})("@overlayAnimation.start",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onOverlayAnimationStart(n))})("@overlayAnimation.done",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.onOverlayAnimationEnd(n))}),t.YNc(2,re,1,0,"ng-container",29),t.YNc(3,he,4,10,"p-scroller",30),t.YNc(4,be,2,6,"ng-container",31),t.YNc(5,Be,6,6,"ng-template",null,32,t.W1O),t.YNc(7,Ne,1,0,"ng-container",29),t.qZA()}if(2&o){const e=t.oxw();t.Tol(e.panelStyleClass),t.Udp("max-height",e.virtualScroll?"auto":e.scrollHeight),t.Q6J("ngClass",t.DdM(11,ke))("ngStyle",e.panelStyle)("@overlayAnimation",t.VKq(15,De,t.WLB(12,Le,e.showTransitionOptions,e.hideTransitionOptions))),t.xp6(2),t.Q6J("ngTemplateOutlet",e.headerTemplate),t.xp6(1),t.Q6J("ngIf",e.virtualScroll),t.xp6(1),t.Q6J("ngIf",!e.virtualScroll),t.xp6(3),t.Q6J("ngTemplateOutlet",e.footerTemplate)}}const Re=function(o,a){return{"p-autocomplete p-component":!0,"p-autocomplete-dd":o,"p-autocomplete-multiple":a}},Ye={provide:p.JU,useExisting:(0,t.Gpc)(()=>Y),multi:!0};let Y=(()=>{class o{constructor(e,i,n,s,l,r){this.el=e,this.renderer=i,this.cd=n,this.differs=s,this.config=l,this.overlayService=r,this.minLength=1,this.delay=300,this.scrollHeight="200px",this.lazy=!1,this.type="text",this.autoZIndex=!0,this.baseZIndex=0,this.dropdownIcon="pi pi-chevron-down",this.unique=!0,this.completeOnFocus=!1,this.showClear=!1,this.dropdownMode="blank",this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.autocomplete="off",this.completeMethod=new t.vpe,this.onSelect=new t.vpe,this.onUnselect=new t.vpe,this.onFocus=new t.vpe,this.onBlur=new t.vpe,this.onDropdownClick=new t.vpe,this.onClear=new t.vpe,this.onKeyUp=new t.vpe,this.onShow=new t.vpe,this.onHide=new t.vpe,this.onLazyLoad=new t.vpe,this.onModelChange=()=>{},this.onModelTouched=()=>{},this.overlayVisible=!1,this.focus=!1,this.inputFieldValue=null,this.inputValue=null,this.differ=s.find([]).create(null),this.listId=(0,y.Th)()+"_list"}get itemSize(){return this._itemSize}set itemSize(e){this._itemSize=e,console.warn("The itemSize property is deprecated, use virtualScrollItemSize property instead.")}get suggestions(){return this._suggestions}set suggestions(e){this._suggestions=e,this.handleSuggestionsChange()}ngAfterViewChecked(){this.suggestionsUpdated&&this.overlay&&this.overlay.offsetParent&&(setTimeout(()=>{this.overlay&&this.alignOverlay()},1),this.suggestionsUpdated=!1),this.highlightOptionChanged&&(setTimeout(()=>{if(this.overlay&&this.itemsWrapper){let e=h.p.findSingle(this.overlay,"li.p-highlight");e&&h.p.scrollInView(this.itemsWrapper,e)}},1),this.highlightOptionChanged=!1)}handleSuggestionsChange(){null!=this._suggestions&&this.loading&&(this.highlightOption=null,this._suggestions.length?(this.noResults=!1,this.show(),this.suggestionsUpdated=!0,this.autoHighlight&&(this.highlightOption=this._suggestions[0])):(this.noResults=!0,this.showEmptyMessage?(this.show(),this.suggestionsUpdated=!0):this.hide()),this.loading=!1)}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"item":default:this.itemTemplate=e.template;break;case"group":this.groupTemplate=e.template;break;case"selectedItem":this.selectedItemTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"empty":this.emptyTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"loader":this.loaderTemplate=e.template}})}writeValue(e){this.value=e,this.filled=this.value&&""!=this.value,this.updateInputField(),this.cd.markForCheck()}getOptionGroupChildren(e){return this.optionGroupChildren?y.gb.resolveFieldData(e,this.optionGroupChildren):e.items}getOptionGroupLabel(e){return this.optionGroupLabel?y.gb.resolveFieldData(e,this.optionGroupLabel):null!=e.label?e.label:e}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}onInput(e){if(!this.inputKeyDown&&h.p.isIE())return;this.timeout&&clearTimeout(this.timeout);let i=e.target.value;this.inputValue=i,!this.multiple&&!this.forceSelection&&this.onModelChange(i),0===i.length&&!this.multiple&&(this.hide(),this.onClear.emit(e),this.onModelChange(i)),i.length>=this.minLength?this.timeout=setTimeout(()=>{this.search(e,i)},this.delay):this.hide(),this.updateFilledState(),this.inputKeyDown=!1}onInputClick(e){this.documentClickListener&&(this.inputClick=!0)}search(e,i){null!=i&&(this.loading=!0,this.completeMethod.emit({originalEvent:e,query:i}))}selectItem(e,i=!0){this.forceSelectionUpdateModelTimeout&&(clearTimeout(this.forceSelectionUpdateModelTimeout),this.forceSelectionUpdateModelTimeout=null),this.multiple?(this.multiInputEL.nativeElement.value="",this.value=this.value||[],(!this.isSelected(e)||!this.unique)&&(this.value=[...this.value,e],this.onModelChange(this.value))):(this.inputEL.nativeElement.value=this.resolveFieldData(e),this.value=e,this.onModelChange(this.value)),this.onSelect.emit(e),this.updateFilledState(),i&&(this.itemClicked=!0,this.focusInput())}show(){if(this.multiInputEL||this.inputEL){let e=this.multiple?this.multiInputEL.nativeElement.ownerDocument.activeElement==this.multiInputEL.nativeElement:this.inputEL.nativeElement.ownerDocument.activeElement==this.inputEL.nativeElement;!this.overlayVisible&&e&&(this.overlayVisible=!0)}}clear(){this.multiple?this.value=null:(this.inputValue=null,this.inputEL.nativeElement.value=""),this.updateFilledState(),this.onModelChange(this.value),this.onClear.emit()}onOverlayAnimationStart(e){switch(e.toState){case"visible":this.overlay=e.element,this.itemsWrapper=this.virtualScroll?h.p.findSingle(this.overlay,".p-scroller"):this.overlay,this.virtualScroll&&this.scroller?.setContentEl(this.itemsViewChild.nativeElement),this.appendOverlay(),this.autoZIndex&&y.P9.set("overlay",this.overlay,this.baseZIndex+this.config.zIndex.overlay),this.alignOverlay(),this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener(),this.onShow.emit(e);break;case"void":this.onOverlayHide()}}onOverlayAnimationEnd(e){"void"===e.toState&&this.autoZIndex&&y.P9.clear(e.element)}onOverlayClick(e){this.overlayService.add({originalEvent:e,target:this.el.nativeElement})}appendOverlay(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.overlay):h.p.appendChild(this.overlay,this.appendTo),this.overlay.style.minWidth||(this.overlay.style.minWidth=h.p.getWidth(this.el.nativeElement.children[0])+"px"))}resolveFieldData(e){let i=this.field?y.gb.resolveFieldData(e,this.field):e;return void 0!==i?i:""}restoreOverlayAppend(){this.overlay&&this.appendTo&&this.el.nativeElement.appendChild(this.overlay)}alignOverlay(){this.appendTo?h.p.absolutePosition(this.overlay,this.multiple?this.multiContainerEL.nativeElement:this.inputEL.nativeElement):h.p.relativePosition(this.overlay,this.multiple?this.multiContainerEL.nativeElement:this.inputEL.nativeElement)}hide(){this.overlayVisible=!1,this.cd.markForCheck()}handleDropdownClick(e){if(this.overlayVisible)this.hide();else{this.focusInput();let i=this.multiple?this.multiInputEL.nativeElement.value:this.inputEL.nativeElement.value;"blank"===this.dropdownMode?this.search(e,""):"current"===this.dropdownMode&&this.search(e,i),this.onDropdownClick.emit({originalEvent:e,query:i})}}focusInput(){this.multiple?this.multiInputEL.nativeElement.focus():this.inputEL.nativeElement.focus()}get emptyMessageLabel(){return this.emptyMessage||this.config.getTranslation(x.ws.EMPTY_MESSAGE)}removeItem(e){let i=h.p.index(e),n=this.value[i];this.value=this.value.filter((s,l)=>l!=i),this.onModelChange(this.value),this.updateFilledState(),this.onUnselect.emit(n)}onKeydown(e){if(this.overlayVisible)switch(e.which){case 40:if(this.group){let n=this.findOptionGroupIndex(this.highlightOption,this.suggestions);if(-1!==n){let s=n.itemIndex+1;s<this.getOptionGroupChildren(this.suggestions[n.groupIndex]).length?(this.highlightOption=this.getOptionGroupChildren(this.suggestions[n.groupIndex])[s],this.highlightOptionChanged=!0):this.suggestions[n.groupIndex+1]&&(this.highlightOption=this.getOptionGroupChildren(this.suggestions[n.groupIndex+1])[0],this.highlightOptionChanged=!0)}else this.highlightOption=this.getOptionGroupChildren(this.suggestions[0])[0]}else{let n=this.findOptionIndex(this.highlightOption,this.suggestions);if(-1!=n){var i=n+1;i!=this.suggestions.length&&(this.highlightOption=this.suggestions[i],this.highlightOptionChanged=!0)}else this.highlightOption=this.suggestions[0]}e.preventDefault();break;case 38:if(this.group){let n=this.findOptionGroupIndex(this.highlightOption,this.suggestions);if(-1!==n){let s=n.itemIndex-1;if(s>=0)this.highlightOption=this.getOptionGroupChildren(this.suggestions[n.groupIndex])[s],this.highlightOptionChanged=!0;else if(s<0){let l=this.suggestions[n.groupIndex-1];l&&(this.highlightOption=this.getOptionGroupChildren(l)[this.getOptionGroupChildren(l).length-1],this.highlightOptionChanged=!0)}}}else{let n=this.findOptionIndex(this.highlightOption,this.suggestions);n>0&&(this.highlightOption=this.suggestions[n-1],this.highlightOptionChanged=!0)}e.preventDefault();break;case 13:this.highlightOption&&(this.selectItem(this.highlightOption),this.hide()),e.preventDefault();break;case 27:this.hide(),e.preventDefault();break;case 9:this.highlightOption&&this.selectItem(this.highlightOption),this.hide()}else 40===e.which&&this.suggestions?this.search(e,e.target.value):e.ctrlKey&&"z"===e.key&&!this.multiple?(this.inputEL.nativeElement.value=this.resolveFieldData(null),this.value="",this.onModelChange(this.value)):e.ctrlKey&&"z"===e.key&&this.multiple&&(this.value.pop(),this.onModelChange(this.value),this.updateFilledState());if(this.multiple&&8===e.which&&this.value&&this.value.length&&!this.multiInputEL.nativeElement.value){this.value=[...this.value];const n=this.value.pop();this.onModelChange(this.value),this.updateFilledState(),this.onUnselect.emit(n)}this.inputKeyDown=!0}onKeyup(e){this.onKeyUp.emit(e)}onInputFocus(e){!this.itemClicked&&this.completeOnFocus&&this.search(e,this.multiple?this.multiInputEL.nativeElement.value:this.inputEL.nativeElement.value),this.focus=!0,this.onFocus.emit(e),this.itemClicked=!1}onInputBlur(e){this.focus=!1,this.onModelTouched(),this.onBlur.emit(e)}onInputChange(e){if(this.forceSelection){let i=!1,n=e.target.value.trim();if(this.suggestions)for(let s of this.suggestions){let l=this.field?y.gb.resolveFieldData(s,this.field):s;if(l&&n===l.trim()){i=!0,this.forceSelectionUpdateModelTimeout=setTimeout(()=>{this.selectItem(s,!1)},250);break}}i||(this.multiple?this.multiInputEL.nativeElement.value="":(this.value=null,this.inputEL.nativeElement.value=""),this.onClear.emit(e),this.onModelChange(this.value),this.updateFilledState())}}onInputPaste(e){this.onKeydown(e)}isSelected(e){let i=!1;if(this.value&&this.value.length)for(let n=0;n<this.value.length;n++)if(y.gb.equals(this.value[n],e,this.dataKey)){i=!0;break}return i}findOptionIndex(e,i){let n=-1;if(i)for(let s=0;s<i.length;s++)if(y.gb.equals(e,i[s])){n=s;break}return n}findOptionGroupIndex(e,i){let n,s;if(i)for(let l=0;l<i.length&&(n=l,s=this.findOptionIndex(e,this.getOptionGroupChildren(i[l])),-1===s);l++);return-1!==s?{groupIndex:n,itemIndex:s}:-1}updateFilledState(){this.filled=this.multiple?this.value&&this.value.length||this.multiInputEL&&this.multiInputEL.nativeElement&&""!=this.multiInputEL.nativeElement.value:this.inputFieldValue&&""!=this.inputFieldValue||this.inputEL&&this.inputEL.nativeElement&&""!=this.inputEL.nativeElement.value}updateInputField(){let e=this.resolveFieldData(this.value);this.inputFieldValue=e,this.inputEL&&this.inputEL.nativeElement&&(this.inputEL.nativeElement.value=e),this.updateFilledState()}bindDocumentClickListener(){this.documentClickListener||(this.documentClickListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","click",i=>{3!==i.which&&(!this.inputClick&&!this.isDropdownClick(i)&&this.hide(),this.inputClick=!1,this.cd.markForCheck())}))}isDropdownClick(e){if(this.dropdown){let i=e.target;return i===this.dropdownButton.nativeElement||i.parentNode===this.dropdownButton.nativeElement}return!1}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener)}unbindDocumentResizeListener(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}onWindowResize(){this.overlayVisible&&!h.p.isTouchDevice()&&this.hide()}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new h.V(this.containerEL.nativeElement,()=>{this.overlayVisible&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}onOverlayHide(){this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.overlay=null,this.onHide.emit()}ngOnDestroy(){this.forceSelectionUpdateModelTimeout&&(clearTimeout(this.forceSelectionUpdateModelTimeout),this.forceSelectionUpdateModelTimeout=null),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.overlay&&y.P9.clear(this.overlay),this.restoreOverlayAppend(),this.onOverlayHide()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(t.SBq),t.Y36(t.Qsj),t.Y36(t.sBO),t.Y36(t.ZZ4),t.Y36(x.b4),t.Y36(x.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["p-autoComplete"]],contentQueries:function(e,i,n){if(1&e&&t.Suo(n,x.jx,4),2&e){let s;t.iGM(s=t.CRH())&&(i.templates=s)}},viewQuery:function(e,i){if(1&e&&(t.Gf(Ht,5),t.Gf(Jt,5),t.Gf(Gt,5),t.Gf(Vt,5),t.Gf($t,5),t.Gf(Qt,5),t.Gf(zt,5)),2&e){let n;t.iGM(n=t.CRH())&&(i.containerEL=n.first),t.iGM(n=t.CRH())&&(i.inputEL=n.first),t.iGM(n=t.CRH())&&(i.multiInputEL=n.first),t.iGM(n=t.CRH())&&(i.multiContainerEL=n.first),t.iGM(n=t.CRH())&&(i.dropdownButton=n.first),t.iGM(n=t.CRH())&&(i.itemsViewChild=n.first),t.iGM(n=t.CRH())&&(i.scroller=n.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:6,hostBindings:function(e,i){2&e&&t.ekj("p-inputwrapper-filled",i.filled)("p-inputwrapper-focus",i.focus&&!i.disabled||i.overlayVisible)("p-autocomplete-clearable",i.showClear&&!i.disabled)},inputs:{minLength:"minLength",delay:"delay",style:"style",panelStyle:"panelStyle",styleClass:"styleClass",panelStyleClass:"panelStyleClass",inputStyle:"inputStyle",inputId:"inputId",inputStyleClass:"inputStyleClass",placeholder:"placeholder",readonly:"readonly",disabled:"disabled",scrollHeight:"scrollHeight",lazy:"lazy",virtualScroll:"virtualScroll",virtualScrollItemSize:"virtualScrollItemSize",virtualScrollOptions:"virtualScrollOptions",maxlength:"maxlength",name:"name",required:"required",size:"size",appendTo:"appendTo",autoHighlight:"autoHighlight",forceSelection:"forceSelection",type:"type",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",ariaLabel:"ariaLabel",dropdownAriaLabel:"dropdownAriaLabel",ariaLabelledBy:"ariaLabelledBy",dropdownIcon:"dropdownIcon",unique:"unique",group:"group",completeOnFocus:"completeOnFocus",showClear:"showClear",field:"field",dropdown:"dropdown",showEmptyMessage:"showEmptyMessage",dropdownMode:"dropdownMode",multiple:"multiple",tabindex:"tabindex",dataKey:"dataKey",emptyMessage:"emptyMessage",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",autofocus:"autofocus",autocomplete:"autocomplete",optionGroupChildren:"optionGroupChildren",optionGroupLabel:"optionGroupLabel",itemSize:"itemSize",suggestions:"suggestions"},outputs:{completeMethod:"completeMethod",onSelect:"onSelect",onUnselect:"onUnselect",onFocus:"onFocus",onBlur:"onBlur",onDropdownClick:"onDropdownClick",onClear:"onClear",onKeyUp:"onKeyUp",onShow:"onShow",onHide:"onHide",onLazyLoad:"onLazyLoad"},features:[t._Bn([Ye])],decls:9,vars:14,consts:[[3,"ngClass","ngStyle"],["container",""],["class","p-autocomplete-input p-inputtext p-component","aria-autocomplete","list","role","searchbox",3,"ngStyle","class","autocomplete","ngClass","value","readonly","disabled","click","input","keydown","keyup","focus","blur","change","paste",4,"ngIf"],["class","p-autocomplete-clear-icon pi pi-times",3,"click",4,"ngIf"],["class","p-autocomplete-multiple-container p-component p-inputtext",3,"ngClass","click",4,"ngIf"],["class","p-autocomplete-loader pi pi-spinner pi-spin",4,"ngIf"],["type","button","pButton","","class","p-autocomplete-dropdown","pRipple","",3,"icon","disabled","click",4,"ngIf"],[3,"ngClass","max-height","ngStyle","class","click",4,"ngIf"],["aria-autocomplete","list","role","searchbox",1,"p-autocomplete-input","p-inputtext","p-component",3,"ngStyle","autocomplete","ngClass","value","readonly","disabled","click","input","keydown","keyup","focus","blur","change","paste"],["in",""],[1,"p-autocomplete-clear-icon","pi","pi-times",3,"click"],[1,"p-autocomplete-multiple-container","p-component","p-inputtext",3,"ngClass","click"],["multiContainer",""],["class","p-autocomplete-token",4,"ngFor","ngForOf"],[1,"p-autocomplete-input-token"],["aria-autocomplete","list","role","searchbox","aria-haspopup","true",3,"disabled","readonly","autocomplete","ngStyle","input","click","keydown","keyup","focus","blur","change","paste"],["multiIn",""],[1,"p-autocomplete-token"],["token",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","p-autocomplete-token-label",4,"ngIf"],["class","p-autocomplete-token-icon pi pi-times-circle",3,"click",4,"ngIf"],[1,"p-autocomplete-token-label"],[1,"p-autocomplete-token-icon","pi","pi-times-circle",3,"click"],[1,"p-autocomplete-loader","pi","pi-spinner","pi-spin"],["type","button","pButton","","pRipple","",1,"p-autocomplete-dropdown",3,"icon","disabled","click"],["ddBtn",""],[3,"ngClass","ngStyle","click"],["panel",""],[4,"ngTemplateOutlet"],[3,"items","style","itemSize","autoSize","lazy","options","onLazyLoad",4,"ngIf"],[4,"ngIf"],["buildInItems",""],[3,"items","itemSize","autoSize","lazy","options","onLazyLoad"],["scroller",""],["pTemplate","content"],["pTemplate","loader"],["role","listbox",1,"p-autocomplete-items",3,"ngClass"],["items",""],["itemslist",""],["ngFor","",3,"ngForOf"],[1,"p-autocomplete-item-group",3,"ngStyle"],["role","option","class","p-autocomplete-item","pRipple","",3,"ngStyle","ngClass","id","click",4,"ngFor","ngForOf"],["class","p-autocomplete-empty-message",3,"ngStyle",4,"ngIf"],["role","option","pRipple","",1,"p-autocomplete-item",3,"ngStyle","ngClass","id","click"],[1,"p-autocomplete-empty-message",3,"ngStyle"],[4,"ngIf","ngIfElse"],["empty",""]],template:function(e,i){1&e&&(t.TgZ(0,"span",0,1),t.YNc(2,jt,2,23,"input",2),t.YNc(3,Wt,1,0,"i",3),t.YNc(4,Xt,1,0,"i",3),t.YNc(5,se,6,23,"ul",4),t.YNc(6,ae,1,0,"i",5),t.YNc(7,le,2,4,"button",6),t.YNc(8,Pe,8,17,"div",7),t.qZA()),2&e&&(t.Tol(i.styleClass),t.Q6J("ngClass",t.WLB(11,Re,i.dropdown,i.multiple))("ngStyle",i.style),t.xp6(2),t.Q6J("ngIf",!i.multiple),t.xp6(1),t.Q6J("ngIf",!i.multiple&&i.filled&&!i.disabled&&i.showClear),t.xp6(1),t.Q6J("ngIf",i.multiple&&i.filled&&!i.disabled&&i.showClear),t.xp6(1),t.Q6J("ngIf",i.multiple),t.xp6(1),t.Q6J("ngIf",i.loading),t.xp6(1),t.Q6J("ngIf",i.dropdown),t.xp6(1),t.Q6J("ngIf",i.overlayVisible))},dependencies:[_.mk,_.sg,_.O5,_.tP,_.PC,Rt,x.jx,B.H,N.T],styles:[".p-autocomplete{display:inline-flex;position:relative}.p-autocomplete-loader{position:absolute;top:50%;margin-top:-.5rem}.p-autocomplete-dd .p-autocomplete-input{flex:1 1 auto;width:1%}.p-autocomplete-dd .p-autocomplete-input,.p-autocomplete-dd .p-autocomplete-multiple-container{border-top-right-radius:0;border-bottom-right-radius:0}.p-autocomplete-dd .p-autocomplete-dropdown{border-top-left-radius:0;border-bottom-left-radius:0}.p-autocomplete .p-autocomplete-panel{min-width:100%;top:0;left:0}.p-autocomplete-panel{position:absolute;overflow:auto}.p-autocomplete-items{margin:0;padding:0;list-style-type:none}.p-autocomplete-item{cursor:pointer;white-space:nowrap;position:relative;overflow:hidden}.p-autocomplete-multiple-container{margin:0;padding:0;list-style-type:none;cursor:text;overflow:hidden;display:flex;align-items:center;flex-wrap:wrap}.p-autocomplete-token{cursor:default;display:inline-flex;align-items:center;flex:0 0 auto}.p-autocomplete-token-icon{cursor:pointer}.p-autocomplete-input-token{flex:1 1 auto;display:inline-flex}.p-autocomplete-input-token input{border:0 none;outline:0 none;background-color:transparent;margin:0;padding:0;box-shadow:none;border-radius:0;width:100%}.p-fluid .p-autocomplete{display:flex}.p-fluid .p-autocomplete-dd .p-autocomplete-input{width:1%}.p-autocomplete-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-autocomplete-clearable{position:relative}\n"],encapsulation:2,data:{animation:[(0,A.X$)("overlayAnimation",[(0,A.eR)(":enter",[(0,A.oB)({opacity:0,transform:"scaleY(0.8)"}),(0,A.jt)("{{showTransitionParams}}")]),(0,A.eR)(":leave",[(0,A.jt)("{{hideTransitionParams}}",(0,A.oB)({opacity:0}))])])]},changeDetection:0}),o})(),He=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[_.ez,Dt,Yt,x.m8,B.T,N.v,x.m8,N.v]}),o})();function Je(o,a){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.xp6(1),t.Oqu(e.label)}}function Ge(o,a){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.xp6(1),t.Oqu(e.label)}}function Ve(o,a){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.xp6(1),t.Oqu(e.label)}}function $e(o,a){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.xp6(1),t.Oqu(e.label)}}function Qe(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,s=t.oxw();return t.KtG(s.downloadPDF(n.CODE_BUSINESS,n.YEAR_STATEMENT))}),t._UZ(1,"i",31),t.qZA()}}function ze(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,s=t.oxw();return t.KtG(s.navigateToForm(n.CODE_BUSINESS,n.YEAR_STATEMENT,n.ID,n.STATE))}),t._UZ(1,"i",32),t.qZA()}}function Ke(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,s=t.oxw();return t.KtG(s.navigateToForm(n.CODE_BUSINESS,n.YEAR_STATEMENT,n.ID,n.STATE))}),t._UZ(1,"i",33),t.qZA()}}function je(o,a){if(1&o&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.ALo(13,"date"),t.qZA(),t.TgZ(14,"td",28),t.YNc(15,Qe,2,0,"button",29),t.YNc(16,ze,2,0,"button",29),t.YNc(17,Ke,2,0,"button",29),t.qZA()()),2&o){const e=a.$implicit;t.xp6(2),t.Oqu(e.CODE_BUSINESS),t.xp6(2),t.Oqu(e.NAME_BUSINESS),t.xp6(2),t.Oqu(e.YEAR_STATEMENT),t.xp6(2),t.Oqu(1==e.STATE?"Enviada":0==e.STATE?"Borrador":"Pendiente"),t.xp6(2),t.Oqu(e.AMOUNT.toFixed(2).replace(".",",")),t.xp6(2),t.Oqu(t.xi3(13,9,e.UPDATED_AT,"dd-MM-yyyy H:mm:ss")),t.xp6(3),t.Q6J("ngIf",1==e.STATE),t.xp6(1),t.Q6J("ngIf",0==e.STATE),t.xp6(1),t.Q6J("ngIf",2==e.STATE)}}const We=function(o,a){return{"btn-info":o,"btn-primary":a}};function Xe(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"button",34),t.NdJ("click",function(){const s=t.CHM(e).index,l=t.oxw();return t.KtG(l.pagTo(s))}),t._uU(2),t.qZA()()}if(2&o){const e=a.index,i=t.oxw();t.xp6(1),t.Q6J("ngClass",t.WLB(2,We,i.pos==e+1,i.pos!=e+1)),t.xp6(1),t.Oqu(e+1)}}let ti=(()=>{class o{constructor(e,i){this.productorService=e,this.router=i,this.dbStatements=[],this.filtered=[],this.db=[],this.pos=1,this.business_name=[],this.business_year=[],this.years=[],this.cant=0,this.selectedYear="-1",this.filteredBusinesses=[],this.filteredYear=[],this.form=new p.cw({BUSINESS:new p.NI(null,p.kI.required),YEAR:new p.NI(null,p.kI.required)})}ngOnInit(){this.loadStatements()}filterBusinesses(e){const i=e.query.toLowerCase();this.filteredBusinesses=this.business_name.filter(n=>n.label.toLowerCase().includes(i)),this.filteredBusinesses.length>0?this.filteredBusinesses.unshift({label:"Todos",value:"-1"}):this.filteredBusinesses=[{label:"Todos",value:"-1"}]}filterYear(e){const i=e.query;this.filteredYear=this.business_year.filter(n=>n.label.toString().startsWith(i)),this.filteredYear.length>0?this.filteredYear.unshift({label:"Todos",value:"-1"}):this.filteredYear=[{label:"Todos",value:"-1"}]}loadStatements(){this.productorService.getStatementByUser.subscribe(e=>{if(e.status){const i=e.data.sort((l,r)=>r.YEAR_STATEMENT-l.YEAR_STATEMENT);let n=new Set,s=new Set;i.forEach(l=>{n.add(l.CODE_BUSINESS+" \u2014 "+l.NAME_BUSINESS),-1==this.years.indexOf(l.YEAR_STATEMENT)&&(this.years.push(l.YEAR_STATEMENT),s.add(l.YEAR_STATEMENT))}),e.data=e.data.sort((l,r)=>new Date(r.UPDATED_AT).getTime()-new Date(l.UPDATED_AT).getTime()),this.business_year=Array.from(s).map(l=>({label:l,value:l})),this.business_name=Array.from(n).map(l=>({label:l,value:l})),this.years.sort((l,r)=>r-l),this.dbStatements=i,this.filtered=e.data,this.cant=Math.ceil(this.dbStatements.length/10),this.db=this.dbStatements.slice(0,10).sort((l,r)=>new Date(r.UPDATED_AT).getTime()-new Date(l.UPDATED_AT).getTime())}})}updateFiltersBusiness(e){let i;if(e&&"input"==e.type){const l=this.form.get("BUSINESS");l&&l.value&&(i=l.value)}else i=e&&e.value;if("Todos"==i&&(i=-1),-1==i||null==i){let l=new Set,r=this.dbStatements.slice();return this.dbStatements.sort((u,m)=>m.YEAR_STATEMENT-u.YEAR_STATEMENT).forEach(u=>{l.add(u.YEAR_STATEMENT)}),this.business_year=Array.from(l).map(u=>({label:u,value:u})),void(this.dbStatements=r)}i=i.replace(/.* \u2014 \s*/,"");const n=this.dbStatements.filter(l=>{if("-1"!=i&&l.NAME_BUSINESS==i)return l});let s=new Set;n.forEach(l=>{s.add(l.YEAR_STATEMENT)}),this.business_year=Array.from(s).map(l=>({label:l,value:l}))}updateFiltersYears(e){let i;if(e&&"input"==e.type){const l=this.form.get("YEAR");l&&l.value&&(i=l.value)}else i=e&&e.value;if("Todos"==i&&(i=-1),-1==i||null==i){let l=new Set;return this.dbStatements.forEach(r=>{l.add(r.CODE_BUSINESS+" \u2014 "+r.NAME_BUSINESS)}),void(this.business_name=Array.from(l).map(r=>({label:r,value:r})))}i=i.toString().replace(/.* \u2014 \s*/,"");const n=this.dbStatements.filter(l=>{if("-1"!=i&&l.YEAR_STATEMENT==i)return l});let s=new Set;n.forEach(l=>{s.add(l.CODE_BUSINESS+" \u2014 "+l.NAME_BUSINESS)}),this.business_name=Array.from(s).map(l=>({label:l,value:l}))}filter(){let e,i,n,s;const l=this.form.get("BUSINESS"),r=this.form.get("YEAR");if(l&&l.value&&r&&r.value){l.value&&(n="string"==typeof l.value?1:Object.keys(l.value).length),r.value&&(s="string"==typeof r.value?1:Object.keys(r.value).length),n>1?s>1?(e=l.value.value,i=r.value.value):(e=l.value.value,i="Todos"==r.value?-1:r.value):s>1?"Todos"==l.value?(e=-1,i=r.value.value):(e=l.value,i=r.value):"Todos"==l.value?(e=-1,i="Todos"==r.value?-1:r.value):"Todos"==r.value?(e=l.value,i=-1):(e=l.value,i=r.value),-1!=e&&(e=e.toString().replace(/.* \u2014 \s*/,""));let u=this.business_name;if(this.business_name=this.business_name.map(m=>({value:m.value.replace(/.* \u2014 \s*/,""),label:m.label.replace(/.* \u2014 \s*/,"")})),-1==e||this.business_name.some(m=>m.value===e)){if(this.business_name=u,null!=i&&!isNaN(Number(i))){this.business_name=u;const m=this.dbStatements.filter(f=>{if("-1"!=e&&f.NAME_BUSINESS==e){if("-1"==i)return f;if(f.YEAR_STATEMENT==i)return f}if("-1"==e){if("-1"==i)return f;if(f.YEAR_STATEMENT==i)return f}});return this.pos=1,this.filtered=m,this.db=m.slice(0,10).sort((f,g)=>new Date(g.UPDATED_AT).getTime()-new Date(f.UPDATED_AT).getTime()),void(this.cant=Math.ceil(m.length/10))}this.business_name=u,c().fire({title:"Error",text:"Debe ingresar un a\xf1o v\xe1lido.",icon:"error",confirmButtonText:"Aceptar"})}else this.business_name=u,c().fire({title:"Error",text:"Debe ingresar una empresa o a\xf1o v\xe1lido.",icon:"error",confirmButtonText:"Aceptar"})}else c().fire({title:"Error",text:"Debe seleccionar empresa y a\xf1o.",icon:"error",confirmButtonText:"Aceptar"})}reset(){this.loadStatements()}pagTo(e){this.pos=e+1,this.db=this.filtered.slice(10*e,10*(e+1)).sort((i,n)=>new Date(n.UPDATED_AT).getTime()-new Date(i.UPDATED_AT).getTime())}next(){this.pos>=this.cant||(this.pos++,this.db=this.filtered.slice(10*(this.pos-1),10*this.pos).sort((e,i)=>new Date(i.UPDATED_AT).getTime()-new Date(e.UPDATED_AT).getTime()))}previus(){this.pos-1<=0||this.pos>=this.cant+1||(this.pos=this.pos-1,this.db=this.filtered.slice(10*(this.pos-1),10*this.pos).sort((e,i)=>new Date(i.UPDATED_AT).getTime()-new Date(e.UPDATED_AT).getTime()))}downloadPDF(e,i){c().fire({title:"Espere",text:"Generando PDF",showConfirmButton:!1}),c().showLoading(),this.productorService.downloadPDF(e,i).subscribe(n=>{const s=new Blob([n],{type:"application/pdf"});let l=document.createElement("a");l.href=window.URL.createObjectURL(s),l.download=`Reporte_${i}`,document.body.appendChild(l),l.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),l.remove(),window.URL.revokeObjectURL(l.href),c().close()})}navigateToForm(e,i,n,s=0){sessionStorage.setItem("state",s.toString()||"0"),sessionStorage.setItem("id_statement",n?.toString()||"null"),this.router.navigateByUrl(`/productor/form?year=${i}&id_business=${e}`)}setArrayFromNumber(){return new Array(this.cant)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(Z.u),t.Y36(b.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-statements"]],decls:69,vars:7,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"declaracion"],[1,"d-sm-flex","justify-content-between","mb-3","mb-md-0"],[1,"box","box-form","mb-4",3,"formGroup"],[1,"row","align-items-end"],[1,"col-12","col-xl-4","mb-3","mb-xl-0"],[1,"form-label"],["formControlName","BUSINESS","field","label","placeholder","Buscar empresa",1,"custom-autocomplete",3,"suggestions","dropdown","completeMethod","input","onSelect"],["pTemplate","item"],["pTemplate","selectedItem"],["formControlName","YEAR","field","label","placeholder","Buscar A\xf1o",1,"custom-autocomplete",3,"suggestions","dropdown","completeMethod","input","onSelect"],[1,"row"],[1,"col-6"],[1,"btn","btn-primary","col-12",2,"height","2.875rem","border-radius",".25rem",3,"click"],[1,"table-responsive"],[1,"table","table-even","table-section","table-borderless","table-radius"],[1,"vertical-middle"],[1,"text-uppercase","text-center","text-nowrap"],[4,"ngFor","ngForOf"],["aria-label","Navegaci\xf3n resultados"],[1,"pagination"],[1,"btn","btn-primary",3,"click"],[1,"text-center","text-nowrap"],["class","btn",3,"click",4,"ngIf"],[1,"btn",3,"click"],["aria-hidden","true",1,"fa","fa-file-pdf-o","fa-fw","fa-lg","color-blue"],["aria-hidden","true",1,"fa","fa-file-text-o","fa-fw","fa-lg",2,"color","red"],["aria-hidden","true",1,"fa","fa-file-text-o","fa-fw","fa-lg",2,"color","#DEC300"],[1,"border","btn","btn-sm",3,"ngClass","click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),t._UZ(5,"i",5),t._uU(6," Inicio"),t.qZA()(),t.TgZ(7,"li",6),t._uU(8,"Consulta de Declaraci\xf3n"),t.qZA()()(),t.TgZ(9,"section",7)(10,"h1"),t._uU(11,"Consulta Declaraciones"),t.qZA(),t._UZ(12,"div",8),t.TgZ(13,"div",9)(14,"div",10)(15,"div",11)(16,"label",12),t._uU(17,"EMPRESAS:"),t.qZA(),t._UZ(18,"br"),t.TgZ(19,"p-autoComplete",13),t.NdJ("completeMethod",function(s){return i.filterBusinesses(s)})("input",function(s){return i.updateFiltersBusiness(s)})("onSelect",function(s){return i.updateFiltersBusiness(s)}),t.YNc(20,Je,2,1,"ng-template",14),t.YNc(21,Ge,2,1,"ng-template",15),t.qZA()(),t.TgZ(22,"div",11)(23,"label",12),t._uU(24,"A\xf1o:"),t.qZA(),t._UZ(25,"br"),t.TgZ(26,"p-autoComplete",16),t.NdJ("completeMethod",function(s){return i.filterYear(s)})("input",function(s){return i.updateFiltersYears(s)})("onSelect",function(s){return i.updateFiltersYears(s)}),t.YNc(27,Ve,2,1,"ng-template",14),t.YNc(28,$e,2,1,"ng-template",15),t.qZA()(),t.TgZ(29,"div",11)(30,"div",17)(31,"div",18)(32,"button",19),t.NdJ("click",function(){return i.filter()}),t._uU(33,"Mostrar"),t.qZA()()()()()(),t.TgZ(34,"div",20)(35,"table",21)(36,"thead",22)(37,"tr")(38,"th"),t._uU(39,"ID Empresa"),t.qZA(),t.TgZ(40,"th"),t._uU(41,"Nombre Empresa"),t.qZA(),t.TgZ(42,"th"),t._uU(43,"A\xf1o Declaraci\xf3n"),t.qZA(),t.TgZ(44,"th"),t._uU(45,"Estado"),t.qZA(),t.TgZ(46,"th"),t._uU(47,"Monto Total (UF)"),t.qZA(),t.TgZ(48,"th"),t._uU(49,"Fecha Env\xedo"),t.qZA(),t.TgZ(50,"th",23),t._uU(51,"Acci\xf3n"),t.qZA()()(),t.TgZ(52,"tbody"),t.YNc(53,je,18,12,"tr",24),t.qZA()()(),t.TgZ(54,"nav",25)(55,"ul",26)(56,"li")(57,"button",27),t.NdJ("click",function(){return i.pagTo(0)}),t._uU(58,"Primero"),t.qZA()(),t.TgZ(59,"li")(60,"button",27),t.NdJ("click",function(){return i.previus()}),t._uU(61,"Anterior"),t.qZA()(),t.YNc(62,Xe,3,5,"li",24),t.TgZ(63,"li")(64,"button",27),t.NdJ("click",function(){return i.next()}),t._uU(65,"Siguiente"),t.qZA()(),t.TgZ(66,"li")(67,"button",27),t.NdJ("click",function(){return i.pagTo(i.cant-1)}),t._uU(68,"\xdaltimo"),t.qZA()()()()()()),2&e&&(t.xp6(13),t.Q6J("formGroup",i.form),t.xp6(6),t.Q6J("suggestions",i.filteredBusinesses)("dropdown",!0),t.xp6(7),t.Q6J("suggestions",i.filteredYear)("dropdown",!0),t.xp6(27),t.Q6J("ngForOf",i.db),t.xp6(9),t.Q6J("ngForOf",i.setArrayFromNumber()))},dependencies:[_.mk,_.sg,_.O5,p.JJ,p.JL,p.sg,p.u,Y,x.jx,_.uU],styles:["[_nghost-%COMP%]{width:90%!important;padding:1%}  .custom-autocomplete .p-autocomplete{width:100%;max-height:300px}  .custom-autocomplete .p-autocomplete-dropdown{width:10%;max-height:300px;background-color:#08a47c}  .select .form-select{width:50!important}"]}),o})();var ei=d(9314);function ii(o,a){if(1&o&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&o){const e=a.$implicit,i=a.index,n=t.oxw();t.xp6(1),t.AsE("+(",e.price,"UF x POM ",n.typex[i],")")}}function ni(o,a){if(1&o&&(t.TgZ(0,"li")(1,"span"),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()),2&o){const e=a.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.price)}}const si=[{path:"",component:Nt.$,children:[{path:"home",component:Bt},{path:"rates",component:(()=>{class o{constructor(e,i){this.ratesService=e,this.router=i,this.types=["EyE reciclables de papel/cart\xf3n","EyE reciclables de metal","EyE reciclables de pl\xe1sticos","EyE no reciclables"],this.typex=["Papel/cart\xf3n","Metal","Pl\xe1stico","No Reciclable"],this.year=(new Date).getFullYear(),this.rates=[]}ngOnInit(){this.ratesService.getRates(this.year).subscribe({next:e=>{e.status&&(e.data.length<4&&c().fire({icon:"info",text:`Las tarifas del a\xf1o ${this.year} no han sido ingresadas. Por favor contacte al administrador`}).then(i=>{i.isConfirmed&&this.router.navigate(["/productor/home"])}),e.data.forEach(i=>{this.rates.push({name:this.types[i.type-1],price:i.price})}))},error:e=>{c().fire({icon:"error",text:"Algo sali\xf3 mal"}),this.router.navigate(["/productor/home"])}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(I.z),t.Y36(b.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-rates"]],decls:39,vars:2,consts:[["id","content"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"inicio"],[1,"box","box-inicio"],[1,"row"],[1,"col-12","col-md-7"],["src","assets/images/rigk_eq.png",1,"img-fluid"],[4,"ngFor","ngForOf"],[1,"col-12","col-md-5"],[1,"pt-4","pt-md-0","mt-3","mt-md-0","border-top","border-top-md-0"],[1,"list","list-tarifas","list-unstyled"],[1,"d-block","bg-blue","color-white"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),t._UZ(5,"i",5),t._uU(6," Inicio"),t.qZA()(),t.TgZ(7,"li",6),t._uU(8,"Tarifas"),t.qZA()()(),t.TgZ(9,"section",7)(10,"h1"),t._uU(11,"Tarifas"),t.qZA(),t.TgZ(12,"div",8)(13,"div",9)(14,"div",10)(15,"p"),t._uU(16," El costo anual que deber\xe1 pagar en marzo del a\xf1o correspondiente al cumplimiento: "),t._UZ(17,"img",11),t.qZA(),t._uU(18," donde: "),t.TgZ(19,"ul")(20,"li"),t._uU(21,"P es el precio tarifa UF por tonelada"),t.qZA(),t.TgZ(22,"li"),t._uU(23,"Q son las toneladas declaradas"),t.qZA()(),t._UZ(24,"br"),t._uU(25," Ejemplo: "),t._UZ(26,"br")(27,"br"),t.TgZ(28,"b"),t._uU(29,"Costo Anual ="),t.qZA(),t.YNc(30,ii,2,2,"p",12),t.qZA(),t.TgZ(31,"div",13)(32,"div",14)(33,"p"),t._uU(34,"Las tarifas por subcategor\xeda son de car\xe1cter anual por lo que estar\xe1n vigentes por todo el a\xf1o 2023."),t.qZA(),t.TgZ(35,"ul",15)(36,"li",16),t._uU(37,"Tarifas por tonelada (UF)"),t.qZA(),t.YNc(38,ni,5,2,"li",12),t.qZA()()()()()()()),2&e&&(t.xp6(30),t.Q6J("ngForOf",i.rates),t.xp6(8),t.Q6J("ngForOf",i.rates))},dependencies:[_.sg]}),o})()},{path:"form",component:Ut},{path:"profile",component:Lt},{path:"statements",component:ti},{path:"summary",component:P},{path:"faq",component:ei.v},{path:"**",redirectTo:"home",pathMatch:"full"}]}];let ai=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[b.Bz.forChild(si),b.Bz]}),o})();var li=d(4466);let ri=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[_.H9],imports:[_.ez,ai,li.m,p.u5,p.UX,He]}),o})()}}]);