"use strict";(self.webpackChunkrigk_sg_web=self.webpackChunkrigk_sg_web||[]).push([[999],{2999:(Ae,y,m)=>{m.r(y),m.d(y,{ConsumerStatementModule:()=>Ze});var g=m(6895),Z=m(2045),D=m(9314),B=m(4135),R=m(5226),d=m.n(R),k=m(4128),P=m(4004),e=m(8256),F=m(9821),E=m(554),x=m(8195),J=m(3813),l=m(4006),w=m(8446);function L(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"p-multiSelect",43),e.NdJ("ngModelChange",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.selectedEstablishment=i)})("onChange",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.onEstablishmentChange(i))}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("readonly",-1!=t.id_establishment)("options",t.establishments)("ngModel",t.selectedEstablishment)("selectionLimit",1)("selectedItemsLabel","{0} Empresas seleccionadas")}}function Y(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"div",44)(1,"div",45)(2,"button",46),e.NdJ("click",function(){const o=e.CHM(t).index,u=e.oxw();return e.KtG(u.addRow(o))}),e._uU(3,"Agregar l\xednea"),e.qZA()(),e.TgZ(4,"h2",47),e._uU(5),e.qZA(),e.TgZ(6,"table",48)(7,"thead")(8,"tr")(9,"th"),e._uU(10,"Tipo Tratamiento"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Subtipo"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"LER"),e.qZA(),e.TgZ(15,"th")(16,"span",49),e._uU(17,"Peso (kg)"),e.qZA(),e.TgZ(18,"span",50),e._uU(19,"Kg."),e.qZA()(),e.TgZ(20,"th")(21,"span",49),e._uU(22,"Fecha"),e.qZA(),e.TgZ(23,"span",50),e._uU(24,"Fec. de retiro"),e.qZA()(),e.TgZ(25,"th"),e._uU(26,"Gestor"),e.qZA(),e.TgZ(27,"th"),e._uU(28,"Medios de verificaci\xf3n"),e.qZA(),e.TgZ(29,"th"),e._uU(30,"Eliminar"),e.qZA()()(),e.TgZ(31,"tbody",51),e._UZ(32,"tr"),e.qZA(),e.TgZ(33,"tfoot")(34,"tr")(35,"td",52),e._uU(36,"TOTAL:"),e.qZA(),e.TgZ(37,"td",53),e._uU(38,"0"),e.qZA()()()()()}if(2&a){const t=s.$implicit,n=s.index,i=e.oxw();e.xp6(2),e.Q6J("disabled",-1==i.id_establishment),e.xp6(3),e.hij(" ",t,""),e.xp6(1),e.MGl("id","table_",n+1,""),e.xp6(25),e.MGl("id","tr_",n+1,""),e.xp6(6),e.MGl("id","table_td_",n+1,"")}}function V(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"button",54),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.saveForm())}),e._uU(1,"Enviar Declaraci\xf3n"),e.qZA()}}function $(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"button",55),e.NdJ("click",function(){const o=e.CHM(t).$implicit,u=e.oxw();return e.KtG(u.deleteFile(o))}),e._uU(7,"X"),e.qZA()()()}if(2&a){const t=s.$implicit,n=e.oxw();e.xp6(2),e.hij(" ",n.lable_type[t.type-1]," "),e.xp6(2),e.hij(" ",t.file.name," ")}}let I=(()=>{class a{constructor(t,n,i,o,u,b){this.establishmentService=t,this.consumerService=n,this.business=i,this.router=o,this.actived=u,this.managerService=b,this.tables=["Papel/Cart\xf3n","Metal","Pl\xe1stico Total","Madera"],this.e=1,this.materials=[{_id:1,child:[{id:1,name:"Papel"},{id:2,name:"Papel Compuesto (cemento)"},{id:3,name:"Caja Cart\xf3n"},{id:4,name:"Otro"}]},{_id:2,child:[{id:5,name:"Envase Aluminio"},{id:6,name:"Malla o Reja (IBC)"},{id:7,name:"Envase Hojalata"},{id:8,name:"Otro"}]},{_id:3,child:[{id:9,name:"Pl\xe1stico Film Embalaje"},{id:10,name:"Pl\xe1stico Envases R\xedgidos (Incl. Tapas)"},{id:11,name:"Pl\xe1stico Sacos o Maxisacos"},{id:12,name:"Pl\xe1stico EPS (Poliestireno Expandido)"},{id:13,name:"Pl\xe1stico Zuncho"},{id:14,name:"Otro"}]},{_id:4,child:[{id:15,name:"Caja de Madera"},{id:16,name:"Pallet de Madera"}]}],this.disableAll=!1,this.treatment_type=["Reciclaje Mec\xe1nico","Valorizaci\xf3n Energ\xe9tica","Disposici\xf3n Final en RS"],this.total_tables=[0,0,0],this.id_establishment=-1,this.region="",this.establishments=[],this.selectedEstablishment=[],this.attached=[],this.managers=[],this.id_business="0",this.year_statement=0,this.establishment="",this.goTo="/consumidor/",this.data=[],this.lable_type=["Guia de Despacho","Factura Gestor","Registro de peso","Fotograf\xeda Retiro","Otro"],this.business_name="",this.business_code="",this.newData=[],this.rowSelected=0,this.tableSelected=0,this.tmpFile=[],this.filess=[],this.actived.data.subscribe(T=>{T.show?this.disableAll=!0:this.actived.queryParams.subscribe(f=>{this.id_business=f.id_business,this.year_statement=f.year,this.business_code=f.code,this.loadEstablishments(),this.business.getBusiness(f.code).subscribe(A=>{this.business_name=A.status[0].NAME})})})}ngOnInit(){}reset(){this.id_establishment=-1;const t=document.getElementById("table_1")?.getElementsByTagName("tbody")[0],n=document.getElementById("table_2")?.getElementsByTagName("tbody")[0],i=document.getElementById("table_3")?.getElementsByTagName("tbody")[0],o=document.getElementById("table_4")?.getElementsByTagName("tbody")[0],u=t?.rows,b=n?.rows,T=i?.rows,f=o?.rows;for(;0!=u.length;)t?.deleteRow(0);for(;0!=b.length;)n?.deleteRow(0);for(;0!=T.length;)i?.deleteRow(0);for(;0!=f.length;)o?.deleteRow(0);this.selectedEstablishment=null,document.getElementById("table_td_1").innerHTML="0",document.getElementById("table_td_2").innerHTML="0",document.getElementById("table_td_3").innerHTML="0",document.getElementById("table_td_4").innerHTML="0"}getManagersForMaterial(t){return(this.managers.find(i=>i.material===t)?.managers||[]).map(i=>({name:i.BUSINESS_NAME,id:i.ID_BUSINESS}))}onEstablishmentChange(t){this.establishmentService.getEstablishmentByID(this.selectedEstablishment).subscribe(n=>{n.status?(this.region=n.status[0].REGION,this.id_establishment=n.status[0].ID,this.fetchManagersForAllMaterials(n.status[0].REGION)):this.managers=[]})}fetchManagersForAllMaterials(t){const n=this.materials.filter(i=>void 0!==i._id).map(i=>this.managerService.getManagersByMaterial(i._id,t).pipe((0,P.U)(o=>({material:i._id,managers:o.status}))));(0,k.D)(n).subscribe(i=>{this.managers=i})}loadEstablishments(){"0"!=this.id_business&&this.establishmentService.getEstablishment(this.id_business.toString()).subscribe({next:t=>{this.establishments=[],t.status.forEach(n=>{n.name=`${n.NAME_ESTABLISHMENT} - ${n.REGION}`,this.establishments.push(n)})}})}saveForm(){if(0==this.newData.length)return void d().fire({icon:"info",text:"Formulario est\xe1 vac\xedo"});let t=null;(!this.selectedEstablishment[0]||0==this.selectedEstablishment[0])&&(t="Falta establecimiento");for(let i=0;i<this.newData.length;i++){const o=this.newData[i];if(0==o.value&&(""!=o.date||o.gestor>0||"0"!=o.treatment||"0"!=o.sub)){t="Falta ingresar peso";break}if(o.value>0&&(""==o.date||0==o.gestor||"0"==o.treatment||"0"==o.sub)){t="Falta ingresar tipo tratamiento, subtipo, fecha de retiro o gestor";break}if(0==o.value&&(""==o.date||0==o.gestor||"0"==o.treatment||"0"==o.sub)){this.newData.splice(i,1),0==this.newData.length&&(t="Formulario est\xe1 vac\xedo");break}}t?d().fire({icon:"info",text:t}):(d().fire({icon:"info",title:"Espere...",text:"Enviando formulario"}),d().showLoading(),this.consumerService.save({header:{year:this.year_statement,establishment:this.selectedEstablishment[0]},detail:this.newData}).subscribe({next:i=>{d().close(),i.status&&d().fire({icon:"success",text:"Declaraci\xf3n guardada satisfactoriamente"}).then(o=>{o.isConfirmed&&this.router.navigate(["/consumidor"])})},error:i=>{d().close(),d().fire({icon:"error",text:"Ocurri\xf3 un error mientras se enviaba el formulario."})}}))}goBack(){this.router.navigate([this.goTo])}getId(t){alert("row"+t.parentNode.parentNode.rowIndex+" - column"+t.parentNode.cellIndex)}addRow(t){const n=document.getElementById(`table_${t+1}`)?.getElementsByTagName("tbody")[0],i=n.rows.length,o=this.materials.find(p=>p._id==t+1);let u="";for(let p=0;p<o.child.length;p++){const r=o.child[p];u+=`<option value="${r.id}">${r.name}</option>`}let b="";const T=this.getManagersForMaterial(t+1);for(let p=0;p<T.length;p++){const r=T[p];b+=`<option value="${r.id}">${r.name}</option>`}const f=`\n    <tr id="tr">\n                        <td style="padding-left: 20px;">\n                            <select class="form-select" id="inp_treatment_${t+1}_${i}">\n                                <option value="0">Seleccione Tratamiento</option>\n                                <option value="1">Reciclaje Mec\xe1nico</option>\n                                <option value="2">Valorizaci\xf3n Energ\xe9tica</option>\n                                <option value="3">Disposici\xf3n Final en RS</option>\n                                \n                            </select>\n                        </td>\n                        <td>\n                            <select class="form-select" id="inp_sub_${t+1}_${i}">\n                                <option value="0">Seleccione Subtipo</option>\n                                ${u}\n                            </select>\n                        </td>\n                        <td>\n                            <input type="text" class="form-control" placeholder="LER" id="inp_ler_${t+1}_${i}">\n                        </td>\n                        \x3c!-- <td>Papel</td> --\x3e\n                        <td>\n                            <input [disabled]="disableAll" class="form-control form-control-sm text-end w-50px"\n                                id="inp_value_${t+1}_${i}" type="text" value="0"\n                                >\n                        </td>\n                        <td>\n                            <input [disabled]="disableAll" class="form-control text-start w-auto" type="date"\n                                id="inp_date_${t+1}_${i}" placeholder="00/00/0000"\n                                >\n                        </td>\n                        <td>\n                            <select [disabled]="disableAll" class="form-select w-auto" id="inp_gestor_${t+1}_${i}"\n                                >\n                                <option value="-1" selected>Seleccione</option>\n                                <option value="0">Reciclaje Interno</option>\n                                ${b}\n                                \x3c!-- <option *ngFor="let manager of getManagersForMaterial(type.id)" [value]="manager">{{\n                                    manager }}</option> --\x3e\n                            </select>\n                        </td>\n                        <td>\n                          <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal" id="btn_${t+1}_${i}_modal">Ver</button>\n                        </td>\n                        <td>\n                            \x3c!-- eliminar --\x3e\n                            <button class="btn btn-sm btn-danger" id="btn_${t+1}_${i}">X</button>\n                        </td>\n                    </tr>\n    `,A=n?.insertRow(n.rows.length);A.innerHTML=f;const Te=document.getElementById(`btn_${t+1}_${i}`),ve=document.getElementById(`btn_${t+1}_${i}_modal`),c=this.newData,C=document.getElementById(`inp_ler_${t+1}_${i}`);C.onchange=function(){-1==c.findIndex(r=>r.row==i&&r.residue==t+1)?c.push({row:i,residue:t+1,sub:"0",treatment:"",ler:C.value,value:0,date:"",gestor:"0",files:[]}):c[t].ler=C.value};const q=document.getElementById(`inp_treatment_${t+1}_${i}`);q.onchange=()=>{-1==c.findIndex(r=>r.row==i&&r.residue==t+1)?c.push({row:i,residue:t+1,sub:"0",treatment:q.value,ler:"",value:0,date:"",gestor:"0",files:[]}):c[t].treatment=q.value};const v=document.getElementById(`inp_sub_${t+1}_${i}`);v.onchange=()=>{if(c.findIndex(_=>_.residue==t+1&&_.sub==v.value)>-1)return d().fire({icon:"warning",text:"Subtipo ya fue registrado"}),void(v.value="0");-1==c.findIndex(_=>_.row==i&&_.residue==t+1)?c.push({row:i,residue:t+1,sub:v.value,treatment:"",ler:"",value:0,date:"",gestor:"0",files:[]}):c[t].sub=v.value};const M=document.getElementById(`inp_value_${t+1}_${i}`);M.onchange=()=>{-1==c.findIndex(_=>_.row==i&&_.residue==t+1)?c.push({row:i,residue:t+1,sub:"0",treatment:"0",ler:"",value:M.value,date:"",gestor:"0",files:[]}):c[t].value=M.value;let r=0;for(let _=0;_<c.length;_++)r+=parseFloat(c[_].value.replace(",","."));document.getElementById(`table_td_${t+1}`).innerHTML=r.toString().replace(".",",")};const S=document.getElementById(`inp_date_${t+1}_${i}`);S.onchange=()=>{-1==c.findIndex(r=>r.row==i&&r.residue==t+1)?c.push({row:i,residue:t+1,sub:"0",treatment:"0",ler:"",value:0,date:S.value,gestor:"0",files:[]}):c[t].date=S.value};const U=document.getElementById(`inp_gestor_${t+1}_${i}`);U.onchange=()=>{-1==c.findIndex(r=>r.row==i&&r.residue==t+1)?c.push({row:i,residue:t+1,sub:"0",treatment:"0",ler:"",value:0,date:"",gestor:U.value,files:[]}):c[t].gestor=U.value},Te.onclick=()=>{const p=c.findIndex(h=>h.row==i&&h.residue==t+1);c.splice(p,1);let r=0;for(let h=0;h<c.length;h++)r+=parseFloat(c[h].value.replace(",","."));document.getElementById(`table_td_${t+1}`).innerHTML=r.toString().replace(".",",");const _=n?.rows;for(let h=0;h<_.length;h++)if(_[h]==A){n?.deleteRow(h);break}},ve.onclick=()=>{this.tableSelected=t+1,this.rowSelected=i,document.getElementById("id_table_none").innerHTML=`${t+1}`,document.getElementById("id_row_none").innerHTML=`${i}`;const p=c.findIndex(r=>r.row==i&&r.residue==t+1);if(-1==p)return c.push({row:i,residue:t+1,sub:"0",treatment:"0",ler:"",value:0,date:"",gestor:"0",files:[]}),void(this.filess=[]);this.filess=c[p].files||[]}}addFile(){let t=document.getElementById("inp_select_mv").value;const n=this.newData.findIndex(i=>i.residue==this.tableSelected&&i.row==this.rowSelected);if(-1!=n){if(3==this.newData[n].files.length)return d().fire({icon:"info",text:"Se permite m\xe1ximo 3 medios de verificaci\xf3n"}),document.getElementById("inp_select_mv").value="0",void(document.getElementById("inp_file_0").value="");if(this.newData[n].files.findIndex(i=>i.type==t)>-1)return d().fire({icon:"warning",text:"Tipo de Medio de Verificaci\xf3n ya fue agregado"}),document.getElementById("inp_select_mv").value="0",void(document.getElementById("inp_file_0").value="");this.newData[n].files.push({type:t,file:this.tmpFile[0]}),document.getElementById("inp_select_mv").value="0",document.getElementById("inp_file_0").value=""}}selectFile(t){const n=t.target;return 0==n.files.length&&(document.getElementById("inp_file_0").value=""),n.files[0].size/1e3>1e3?(d().fire({icon:"info",text:"Archivo excede el tama\xf1o permitido (1Mb)."}),void(document.getElementById("inp_file_0").value="")):"image"!=n.files[0].type.split("/")[0]&&"application/pdf"!=n.files[0].type?(d().fire({icon:"info",text:"Tipo de archivo no permitido."}),void(document.getElementById("inp_file_0").value="")):void(this.tmpFile=t.target.files)}deleteFile(t){const n=this.newData.findIndex(i=>i.residue==this.tableSelected&&i.row==this.rowSelected);if(n>-1&&this.newData[n].files){const i=this.newData[n].files.findIndex(o=>o.type==t.type&&o.file.name==t.file.name);-1==i&&alert("aa"),this.newData[n].files.splice(i,1)}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(F.d),e.Y36(E.h),e.Y36(x.m),e.Y36(Z.F0),e.Y36(Z.gz),e.Y36(J.b))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-form"]],decls:105,vars:8,consts:[["id",""],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"formulario-ci"],[1,"btn","btn-primary",3,"click"],[1,"row","mb-3"],[1,"container","text-end"],[1,"btn","btn-sm","btn-warning",3,"click"],[1,"table","table-even","table-section","table-borderless","table-border","table-header-green","table-align-middle","text-nowrap"],[1,"th"],[1,"td"],["optionLabel","name","optionValue","ID_ESTABLISHMENT","defaultLabel","Seleccione Establecimiento",3,"readonly","options","ngModel","selectionLimit","selectedItemsLabel","ngModelChange","onChange",4,"ngIf"],["class","table-responsive mb-4",4,"ngFor","ngForOf"],["class","btn btn-primary px-5 mb-4",3,"click",4,"ngIf"],["id","exampleModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title","fs-5"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"container"],[1,"row"],[1,"col-md-12"],["id","id_table_none",1,"d-none"],["id","id_row_none",1,"d-none"],["id","inp_select_mv",1,"form-select"],["value","0"],["value","1"],["value","2"],["value","3"],["value","4"],["value","5"],["id","inp_file_0","type","file",1,"form-control",3,"change"],[1,"col-md-12","text-end"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"row","mt-5"],[4,"ngFor","ngForOf"],["data-bs-dismiss","modal","aria-label","Close",1,"btn","btn-primary","mt-3"],["optionLabel","name","optionValue","ID_ESTABLISHMENT","defaultLabel","Seleccione Establecimiento",3,"readonly","options","ngModel","selectionLimit","selectedItemsLabel","ngModelChange","onChange"],[1,"table-responsive","mb-4"],[1,"text-end"],[1,"btn","btn-primary","mb-1",3,"disabled","click"],[1,"table-header-div","table-header-div-blue"],[1,"table","table-even","table-section","table-borderless","table-border","table-header-green","table-align-middle","text-nowrap",3,"id"],[1,"d-none","d-lg-block"],[1,"d-lg-none"],[3,"id"],["colspan","1"],["colspan","7",3,"id"],[1,"btn","btn-primary","px-5","mb-4",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",6),e._uU(8,"Formulario Consumidor Industrial"),e.qZA()()(),e.TgZ(9,"section",7)(10,"button",8),e.NdJ("click",function(){return n.goBack()}),e._uU(11,"Volver"),e.qZA(),e.TgZ(12,"h1"),e._uU(13,"Formulario Consumidor Industrial"),e.qZA(),e.TgZ(14,"div",9)(15,"div",10)(16,"button",11),e.NdJ("click",function(){return n.reset()}),e._uU(17,"Borrar Formulario"),e.qZA()(),e.TgZ(18,"table",12)(19,"thead")(20,"tr")(21,"th",13),e._uU(22,"Nombre Empresa"),e.qZA(),e.TgZ(23,"td",14),e._uU(24),e.qZA()(),e.TgZ(25,"tr")(26,"th"),e._uU(27,"ID Empresa"),e.qZA(),e.TgZ(28,"td",14),e._uU(29),e.qZA()(),e.TgZ(30,"tr")(31,"th"),e._uU(32,"Establecimiento"),e.qZA(),e.TgZ(33,"td",14),e.YNc(34,L,1,5,"p-multiSelect",15),e.qZA()(),e.TgZ(35,"tr")(36,"th"),e._uU(37,"ID Establecimiento"),e.qZA(),e.TgZ(38,"td",14),e._uU(39),e.qZA()(),e.TgZ(40,"tr")(41,"th"),e._uU(42,"Regi\xf3n"),e.qZA(),e.TgZ(43,"td",14),e._uU(44),e.qZA()()()()(),e.YNc(45,Y,39,5,"div",16),e.YNc(46,V,2,0,"button",17),e.qZA()(),e.TgZ(47,"div",18)(48,"div",19)(49,"div",20)(50,"div",21)(51,"h1",22),e._uU(52,"Medios de Verificaci\xf3n"),e.qZA(),e._UZ(53,"button",23),e.qZA(),e.TgZ(54,"div",24)(55,"div",25)(56,"div",26)(57,"div",27)(58,"p",28),e._uU(59,"eee"),e.qZA(),e.TgZ(60,"p",29),e._uU(61,"eee"),e.qZA(),e.TgZ(62,"table",12)(63,"thead")(64,"tr")(65,"th"),e._uU(66,"Tipo MV"),e.qZA(),e.TgZ(67,"th"),e._uU(68,"Archivo"),e.qZA()()(),e.TgZ(69,"tbody")(70,"tr")(71,"td")(72,"select",30)(73,"option",31),e._uU(74,"Seleccione Tipo MV"),e.qZA(),e.TgZ(75,"option",32),e._uU(76,"Guia de Despacho"),e.qZA(),e.TgZ(77,"option",33),e._uU(78,"Factura Gestor"),e.qZA(),e.TgZ(79,"option",34),e._uU(80,"Registro de peso"),e.qZA(),e.TgZ(81,"option",35),e._uU(82,"Fotograf\xeda Retiro"),e.qZA(),e.TgZ(83,"option",36),e._uU(84,"Otro"),e.qZA()()(),e.TgZ(85,"td")(86,"input",37),e.NdJ("change",function(o){return n.selectFile(o)}),e.qZA()()()()()(),e.TgZ(87,"div",38)(88,"button",39),e.NdJ("click",function(){return n.addFile()}),e._uU(89,"Agregar"),e.qZA()()(),e.TgZ(90,"div",40)(91,"div",27)(92,"table",12)(93,"thead")(94,"tr")(95,"th"),e._uU(96,"Tipo MV"),e.qZA(),e.TgZ(97,"th"),e._uU(98,"Nombre Archivo"),e.qZA(),e.TgZ(99,"th"),e._uU(100,"Eliminar"),e.qZA()()(),e.TgZ(101,"tbody"),e.YNc(102,$,8,2,"tr",41),e.qZA()()()()(),e.TgZ(103,"button",42),e._uU(104,"Cerrar"),e.qZA()()()()()),2&t&&(e.xp6(24),e.Oqu(n.business_code),e.xp6(5),e.Oqu(n.business_name),e.xp6(5),e.Q6J("ngIf",!n.disableAll),e.xp6(5),e.Oqu(-1!=n.id_establishment?n.id_establishment:""),e.xp6(5),e.Oqu(-1!=n.id_establishment?n.region:""),e.xp6(1),e.Q6J("ngForOf",n.tables),e.xp6(1),e.Q6J("ngIf",!n.disableAll),e.xp6(56),e.Q6J("ngForOf",n.filess))},dependencies:[g.sg,g.O5,l.YN,l.Kr,l.JJ,l.On,w.NU],styles:["[_nghost-%COMP%]{width:90%!important;padding:1%}[_nghost-%COMP%]     .p-multiselect{min-width:15rem;font-size:10px;border-radius:100px!important}.td[_ngcontent-%COMP%]{background-color:#faebd7}.th[_ngcontent-%COMP%]{width:150px!important}"]}),a})();var H=m(2227);let G=(()=>{class a{constructor(t){this.ratesService=t,this.types=["EyE reciclables de papel/cart\xf3n","EyE reciclables de metal","EyE reciclables de pl\xe1sticos","EyE no reciclables"],this.year=(new Date).getFullYear(),this.rates=[]}ngOnInit(){this.ratesService.getRates(this.year).subscribe(t=>{t.status&&t.data.forEach(n=>{this.rates.push({name:this.types[n.type-1],price:n.price})})})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(H.z))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-home"]],decls:22,vars:0,consts:[["id","content"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],["aria-current","page",1,"breadcrumb-item"],["aria-hidden","true",1,"fa","fa-home"],[1,"inicio"],[1,"box","box-inicio"],[1,"col-12","col-md-8"],[1,"h1"],[2,"visibility","hidden"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3),e._UZ(4,"i",4),e._uU(5," Inicio"),e.qZA()()(),e.TgZ(6,"section",5)(7,"h1"),e._uU(8,"Inicio"),e.qZA(),e.TgZ(9,"div",6)(10,"div")(11,"div",7)(12,"h2",8),e._uU(13,"Bienvenido/a a M\xf3dulo de Consumidor Industrial"),e.qZA(),e.TgZ(14,"p",9),e._uU(15,"Como parte de las obligaciones que establece la Ley REP, los Productores deben informar la cantidad de EyE no domiciliarios (POM) puestos en el mercado el a\xf1o anterior."),e.qZA(),e.TgZ(16,"p",9),e._uU(17,"ProREP pone a disposici\xf3n de sus socios la plataforma de declaraci\xf3n que dar\xe1 cumplimiento a la obligaci\xf3n de informar sus EyE."),e.qZA(),e.TgZ(18,"p",9),e._uU(19,"La informaci\xf3n deber\xe1 subirse en los meses de enero y febrero."),e.qZA(),e.TgZ(20,"p",9),e._uU(21,"En caso de tener dudas con respecto a su declaraci\xf3n puede ver los tutoriales y preguntas frecuentes."),e.qZA()()()()()())}}),a})();var Q=m(263);let j=(()=>{class a{constructor(t,n,i){this.fb=t,this.authService=n,this.router=i,this.pos="right",this.horaIngreso=new Date,this.formData=this.fb.group({actual:["",[l.kI.required]],password:["",[l.kI.required,l.kI.minLength(3)]],repeatPassword:["",[l.kI.required,l.kI.minLength(3)]]})}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.horaIngreso=new Date(sessionStorage.getItem("horaIngreso"))}btnrecovery(){const{actual:t,password:n,repeatPassword:i}=this.formData.value;this.authService.modifyPassword(n,i,t).subscribe({next:o=>{o.status?(d().fire({title:"Cambio de contrase\xf1a",text:"La contrase\xf1a fue cambiada exitosamente",icon:"success"}),this.router.navigate(["/auth/login"])):(d().fire({title:"Validar informaci\xf3n",text:o.msg,icon:"error"}),this.formData.reset())},error:o=>{d().fire({title:"Formato inv\xe1lido",text:"Contrase\xf1a debe contener al menos 8 caracteres",icon:"error"})}})}displayModifyPassword(){this.pos="right"==this.pos?"down":"right"}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(l.qu),e.Y36(Q.e),e.Y36(Z.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-profile"]],decls:81,vars:16,consts:[[1,"container","mt-4"],[1,"mi-perfil"],[1,"box","box-mi-perfil","mb-5","d-flex","align-items-start"],[1,"list","list-data","list-data-title-green","column-md-2","gap-0","list-unstyled"],[1,"list-data__title"],[1,"list-data__text"],[1,"color-verde"],[1,"list","list-links","list-unstyled"],["id","accordionPanelsStayOpenExample",1,"accordion","accordion-flush"],[1,"accordion-item"],["id","panelsStayOpen-headingOne",1,"accordion-header"],["data-bs-toggle","collapse","data-bs-target","#panelsStayOpen-collapseOne",3,"click"],["aria-hidden","true"],["id","panelsStayOpen-collapseOne","aria-labelledby","panelsStayOpen-headingOne",1,"accordion-collapse","collapse"],[1,"accordion-body"],["autocomplete","off",1,"form-recovery",3,"formGroup"],[1,"mb-4"],[1,"input-group"],[1,"input-group-text","input-group-text-left"],["aria-hidden","true",1,"fa","fa-lock","fa-fw"],["type","password","id","password","formControlName","actual","placeholder","Contrase\xf1a actual",1,"form-control"],["type","password","id","password","formControlName","password","placeholder","Nueva contrase\xf1a",1,"form-control"],["type","password","id","repeatPassword","formControlName","repeatPassword","placeholder","Repetir contrase\xf1a",1,"form-control"],["type","button",1,"btn","btn-primary","btn-fa","w-100",3,"click"],["aria-hidden","true",1,"fa","fa-long-arrow-right","fa-fw"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"section",1)(2,"h1"),e._uU(3,"Mi Perfil"),e.qZA(),e.TgZ(4,"div",2)(5,"ul",3)(6,"li")(7,"span",4),e._uU(8,"Nombre Usuario"),e.qZA(),e.TgZ(9,"span",5),e._uU(10),e.qZA()(),e.TgZ(11,"li")(12,"span",4),e._uU(13,"Perfil"),e.qZA(),e.TgZ(14,"span",5),e._uU(15),e.qZA()(),e.TgZ(16,"li")(17,"span",4),e._uU(18,"Tel\xe9fono M\xf3vil"),e.qZA(),e.TgZ(19,"span",5),e._uU(20),e.qZA()(),e.TgZ(21,"li")(22,"span",4),e._uU(23,"Correo"),e.qZA(),e.TgZ(24,"span",5),e._uU(25),e.qZA()(),e.TgZ(26,"li")(27,"span",4),e._uU(28,"Instituci\xf3n"),e.qZA(),e.TgZ(29,"span",5),e._uU(30),e.qZA()(),e.TgZ(31,"li")(32,"span",4),e._uU(33,"Cargo"),e.qZA(),e.TgZ(34,"span",5),e._uU(35),e.qZA()(),e.TgZ(36,"li")(37,"span",4),e._uU(38,"Tel\xe9fono Oficina"),e.qZA(),e.TgZ(39,"span",5),e._uU(40),e.qZA()(),e.TgZ(41,"li")(42,"span",4)(43,"b"),e._uU(44,"Fecha/ Hora ingreso"),e.qZA()(),e.TgZ(45,"span",5),e._uU(46),e.ALo(47,"date"),e.qZA()()()(),e.TgZ(48,"h2",6),e._uU(49,"Acciones"),e.qZA(),e.TgZ(50,"ul",7)(51,"div",8)(52,"div",9)(53,"h2",10)(54,"li",11),e.NdJ("click",function(){return n.displayModifyPassword()}),e.TgZ(55,"a")(56,"span"),e._uU(57,"Cambio de contrase\xf1a"),e.qZA(),e._UZ(58,"i",12),e.qZA()()(),e.TgZ(59,"div",13)(60,"div",14)(61,"form",15)(62,"div",16)(63,"div",17)(64,"button",18),e._UZ(65,"i",19),e.qZA(),e._UZ(66,"input",20),e.qZA()(),e.TgZ(67,"div",16)(68,"div",17)(69,"button",18),e._UZ(70,"i",19),e.qZA(),e._UZ(71,"input",21),e.qZA()(),e.TgZ(72,"div",16)(73,"div",17)(74,"button",18),e._UZ(75,"i",19),e.qZA(),e._UZ(76,"input",22),e.qZA()(),e.TgZ(77,"div",16)(78,"button",23),e.NdJ("click",function(){return n.btnrecovery()}),e._uU(79," Enviar "),e._UZ(80,"i",24),e.qZA()()()()()()()()()()),2&t&&(e.xp6(10),e.AsE("",n.userData.FIRST_NAME," ",n.userData.LAST_NAME,""),e.xp6(5),e.Oqu(n.userData.ROL_NAME),e.xp6(5),e.Oqu(n.userData.PHONE),e.xp6(5),e.Oqu(n.userData.EMAIL),e.xp6(5),e.Oqu(n.userData.BUSINESS),e.xp6(5),e.Oqu(n.userData.POSITION),e.xp6(5),e.Oqu(n.userData.PHONE_OFFICE),e.xp6(6),e.Oqu(e.xi3(47,13,n.horaIngreso,"dd-MM-yyyy H:mm:s")),e.xp6(12),e.Gre("fa fa-chevron-",n.pos,""),e.xp6(3),e.Q6J("formGroup",n.formData))},dependencies:[l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,g.uU]}),a})();var O=m(371);function z(a,s){if(1&a&&(e.TgZ(0,"option",30),e._uU(1),e.qZA()),2&a){const t=s.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function K(a,s){if(1&a&&(e.TgZ(0,"option",30),e._uU(1),e.qZA()),2&a){const t=s.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function X(a,s){if(1&a&&(e.TgZ(0,"option",30),e._uU(1),e.qZA()),2&a){const t=s.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function W(a,s){if(1&a&&(e.TgZ(0,"option",30),e._uU(1),e.qZA()),2&a){const t=s.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function ee(a,s){if(1&a&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.ALo(15,"date"),e.qZA(),e.TgZ(16,"td"),e._UZ(17,"span",31),e.qZA(),e.TgZ(18,"td")(19,"a",32),e._UZ(20,"i",33),e.qZA()()()),2&a){const t=s.$implicit;e.xp6(2),e.Oqu(t.NAME_BUSINESS),e.xp6(2),e.Oqu(t.NAME_ESTABLISHMENT_REGION),e.xp6(2),e.Oqu(t.TipoTratamiento),e.xp6(2),e.Oqu(t.PRECEDENCE),e.xp6(2),e.Oqu(t.TYPE_RESIDUE),e.xp6(2),e.Oqu(t.VALUE),e.xp6(2),e.Oqu(e.xi3(15,9,t.FechaRetiro,"dd-MM-yyyy")),e.xp6(3),e.Q6J("ngClass",t.semaforo?"circle green-circle":"circle red-circle"),e.xp6(2),e.Q6J("href","#/consumidor/statements/"+t.ID_HEADER+"/"+t.ID_DETAIL,e.LSH)}}const te=function(a,s){return{"btn-info":a,"btn-primary":s}};function ne(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"li")(1,"button",34),e.NdJ("click",function(){const o=e.CHM(t).index,u=e.oxw();return e.KtG(u.pagTo(o))}),e._uU(2),e.qZA()()}if(2&a){const t=s.index,n=e.oxw();e.xp6(1),e.Q6J("ngClass",e.WLB(2,te,n.pos==t+1,n.pos!=t+1)),e.xp6(1),e.Oqu(t+1)}}let ie=(()=>{class a{constructor(t,n){this.productorService=t,this.establishmentService=n,this.dbStatements=[],this.db=[],this.pos=1,this.business_name=[],this.establishment_name=[],this.material_name=[],this.treatment_name=[],this.years=[],this.cant=0,this.filteredStatements=[],this.selectedBusiness="-1",this.selectedEstablishment="-1",this.selectedMaterial="-1",this.selectedYear="-1"}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.loadStatements(),this.updateFilters(),this.filter()}loadStatements(){d().fire({title:"Cargando Datos",text:"Se est\xe1 recuperando datos",timerProgressBar:!0,showConfirmButton:!1,allowEscapeKey:!1,allowOutsideClick:!1}),d().showLoading(),this.establishmentService.getDeclarationEstablishment().subscribe(t=>{t.status&&(t.status=t.status.sort((n,i)=>i.YEAR_STATEMENT-n.YEAR_STATEMENT),t.status.forEach(n=>{-1==this.business_name.indexOf(n.NAME_BUSINESS)&&this.business_name.push(n.NAME_BUSINESS),-1==this.establishment_name.indexOf(n.NAME_ESTABLISHMENT_REGION)&&this.establishment_name.push(n.NAME_ESTABLISHMENT_REGION),-1==this.years.indexOf(n.FechaRetiroTipeada)&&this.years.push(n.FechaRetiroTipeada),-1==this.material_name.indexOf(n.TYPE_RESIDUE)&&this.material_name.push(n.TYPE_RESIDUE),-1==this.treatment_name.indexOf(n.TipoTratamiento)&&this.treatment_name.push(n.TipoTratamiento)}),this.years.sort((n,i)=>i-n),this.dbStatements=t.status,this.cant=Math.ceil(this.dbStatements.length/10),this.db=this.dbStatements.slice(0,10).sort((n,i)=>i.YEAR_STATEMENT-n.YEAR_STATEMENT),d().close())})}filter(){this.filteredStatements=this.dbStatements.filter(t=>!("-1"!==this.selectedBusiness&&t.NAME_BUSINESS!==this.selectedBusiness||"-1"!==this.selectedEstablishment&&t.NAME_ESTABLISHMENT_REGION!==this.selectedEstablishment||"-1"!==this.selectedMaterial&&t.PRECEDENCE!==this.selectedMaterial||"-1"!==this.selectedYear&&t.FechaRetiroTipeada!==this.selectedYear)),this.db=this.filteredStatements.slice(0,10).sort((t,n)=>n.FechaRetiroTipeada-t.FechaRetiroTipeada),this.cant=Math.ceil(this.filteredStatements.length/10)}updateFilters(){this.business_name=this.dbStatements.filter(t=>!("-1"!==this.selectedEstablishment&&t.NAME_ESTABLISHMENT_REGION!==this.selectedEstablishment||"-1"!==this.selectedMaterial&&t.PRECEDENCE!==this.selectedMaterial||"-1"!==this.selectedYear&&t.FechaRetiroTipeada!==this.selectedYear)).map(t=>t.NAME_BUSINESS).filter((t,n,i)=>i.indexOf(t)===n),this.establishment_name=this.dbStatements.filter(t=>!("-1"!==this.selectedBusiness&&t.NAME_BUSINESS!==this.selectedBusiness||"-1"!==this.selectedMaterial&&t.PRECEDENCE!==this.selectedMaterial||"-1"!==this.selectedYear&&t.FechaRetiroTipeada!==this.selectedYear)).map(t=>t.NAME_ESTABLISHMENT_REGION).filter((t,n,i)=>i.indexOf(t)===n),this.material_name=this.dbStatements.filter(t=>!("-1"!==this.selectedBusiness&&t.NAME_BUSINESS!==this.selectedBusiness||"-1"!==this.selectedEstablishment&&t.NAME_ESTABLISHMENT_REGION!==this.selectedEstablishment||"-1"!==this.selectedYear&&t.FechaRetiroTipeada!==this.selectedYear)).map(t=>t.PRECEDENCE).filter((t,n,i)=>i.indexOf(t)===n),this.years=this.dbStatements.filter(t=>!("-1"!==this.selectedBusiness&&t.NAME_BUSINESS!==this.selectedBusiness||"-1"!==this.selectedEstablishment&&t.NAME_ESTABLISHMENT_REGION!==this.selectedEstablishment||"-1"!==this.selectedMaterial&&t.PRECEDENCE!==this.selectedMaterial)).map(t=>t.FechaRetiroTipeada).filter((t,n,i)=>i.indexOf(t)===n).sort((t,n)=>n-t)}reset(){this.loadStatements()}pagTo(t){this.pos=t+1,this.db=this.filteredStatements.slice(10*t,10*(t+1)).sort((n,i)=>i.YEAR_STATEMENT-n.YEAR_STATEMENT)}next(){this.pos>=this.cant||(this.pos++,this.db=this.filteredStatements.slice(10*(this.pos-1),10*this.pos).sort((t,n)=>n.YEAR_STATEMENT-t.YEAR_STATEMENT))}previus(){this.pos-1<=0||this.pos>=this.cant+1||(this.pos=this.pos-1,this.db=this.filteredStatements.slice(10*(this.pos-1),10*this.pos).sort((t,n)=>n.YEAR_STATEMENT-t.YEAR_STATEMENT))}setArrayFromNumber(){return new Array(this.cant)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(O.u),e.Y36(F.d))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-statements"]],decls:90,vars:10,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"declaracion"],[1,"box","box-form","mb-4"],[1,"row","align-items-end"],[1,"col-12","col-xl-2","mb-3","mb-xl-0"],[1,"form-label"],[1,"input-group"],["id","f_name",1,"form-select",3,"ngModel","ngModelChange","change"],["value","-1","selected",""],[3,"value",4,"ngFor","ngForOf"],["id","f_establishment",1,"form-select",3,"ngModel","ngModelChange","change"],["id","f_material",1,"form-select",3,"ngModel","ngModelChange","change"],["id","f_year",1,"form-select",3,"ngModel","ngModelChange","change"],[1,"col-12","col-xl-4","mb-3","mb-xl-0"],[1,"row"],[1,"col-6"],[1,"btn","btn-primary","col-12",3,"click"],[1,"table-responsive"],[1,"table","table-even","table-section","table-borderless","table-radius"],[1,"vertical-middle"],[4,"ngFor","ngForOf"],["aria-label","Navegaci\xf3n resultados"],[1,"pagination"],[1,"btn","btn-primary",3,"click"],[3,"value"],[3,"ngClass"],[3,"href"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","fa-fw","color-verde"],[1,"border","btn","btn-sm",3,"ngClass","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",6),e._uU(8,"Consulta de Declaraci\xf3n"),e.qZA()()(),e.TgZ(9,"section",7)(10,"h1"),e._uU(11,"Consulta de Declaraci\xf3n"),e.qZA(),e.TgZ(12,"div",8)(13,"div",9)(14,"div",10)(15,"label",11),e._uU(16,"Empresa:"),e.qZA(),e.TgZ(17,"div",12)(18,"select",13),e.NdJ("ngModelChange",function(o){return n.selectedBusiness=o})("change",function(){return n.updateFilters()}),e.TgZ(19,"option",14),e._uU(20,"Todos"),e.qZA(),e.YNc(21,z,2,2,"option",15),e.qZA()()(),e.TgZ(22,"div",10)(23,"label",11),e._uU(24,"Establecimiento"),e.qZA(),e.TgZ(25,"div",12)(26,"select",16),e.NdJ("ngModelChange",function(o){return n.selectedEstablishment=o})("change",function(){return n.updateFilters()}),e.TgZ(27,"option",14),e._uU(28,"Todos"),e.qZA(),e.YNc(29,K,2,2,"option",15),e.qZA()()(),e.TgZ(30,"div",10)(31,"label",11),e._uU(32,"Material:"),e.qZA(),e.TgZ(33,"div",12)(34,"select",17),e.NdJ("ngModelChange",function(o){return n.selectedMaterial=o})("change",function(){return n.updateFilters()}),e.TgZ(35,"option",14),e._uU(36,"Todos"),e.qZA(),e.YNc(37,X,2,2,"option",15),e.qZA()()(),e.TgZ(38,"div",10)(39,"label",11),e._uU(40,"A\xf1o/Mes de retiro:"),e.qZA(),e.TgZ(41,"div",12)(42,"select",18),e.NdJ("ngModelChange",function(o){return n.selectedYear=o})("change",function(){return n.updateFilters()}),e.TgZ(43,"option",14),e._uU(44,"Todos"),e.qZA(),e.YNc(45,W,2,2,"option",15),e.qZA()()(),e.TgZ(46,"div",19)(47,"div",20)(48,"div",21)(49,"button",22),e.NdJ("click",function(){return n.filter(),n.pagTo(0)}),e._uU(50,"Mostrar"),e.qZA()()()()()(),e.TgZ(51,"div",23)(52,"table",24)(53,"thead",25)(54,"tr")(55,"th"),e._uU(56,"Empresa"),e.qZA(),e.TgZ(57,"th"),e._uU(58,"Establecimiento"),e.qZA(),e.TgZ(59,"th"),e._uU(60,"Tipo de tratamiento"),e.qZA(),e.TgZ(61,"th"),e._uU(62,"Material"),e.qZA(),e.TgZ(63,"th"),e._uU(64,"Subtipo"),e.qZA(),e.TgZ(65,"th"),e._uU(66,"Peso"),e.qZA(),e.TgZ(67,"th"),e._uU(68,"Fecha Retiro"),e.qZA(),e.TgZ(69,"th"),e._uU(70,"Estado"),e.qZA(),e.TgZ(71,"th"),e._uU(72,"Ver detalle"),e.qZA()()(),e.TgZ(73,"tbody"),e.YNc(74,ee,21,12,"tr",26),e.qZA()()(),e.TgZ(75,"nav",27)(76,"ul",28)(77,"li")(78,"button",29),e.NdJ("click",function(){return n.pagTo(0)}),e._uU(79,"Primero"),e.qZA()(),e.TgZ(80,"li")(81,"button",29),e.NdJ("click",function(){return n.previus()}),e._uU(82,"Anterior"),e.qZA()(),e.YNc(83,ne,3,5,"li",26),e.TgZ(84,"li")(85,"button",29),e.NdJ("click",function(){return n.next()}),e._uU(86,"Siguiente"),e.qZA()(),e.TgZ(87,"li")(88,"button",29),e.NdJ("click",function(){return n.pagTo(n.cant-1)}),e._uU(89,"\xdaltimo"),e.qZA()()()()()()),2&t&&(e.xp6(18),e.Q6J("ngModel",n.selectedBusiness),e.xp6(3),e.Q6J("ngForOf",n.business_name),e.xp6(5),e.Q6J("ngModel",n.selectedEstablishment),e.xp6(3),e.Q6J("ngForOf",n.establishment_name),e.xp6(5),e.Q6J("ngModel",n.selectedMaterial),e.xp6(3),e.Q6J("ngForOf",n.material_name),e.xp6(5),e.Q6J("ngModel",n.selectedYear),e.xp6(3),e.Q6J("ngForOf",n.years),e.xp6(29),e.Q6J("ngForOf",n.db),e.xp6(9),e.Q6J("ngForOf",n.setArrayFromNumber()))},dependencies:[g.mk,g.sg,l.YN,l.Kr,l.EJ,l.JJ,l.On,g.uU],styles:["[_nghost-%COMP%]{width:90%!important;padding:1%}.circle[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%;display:inline-block;margin-right:5px}.green-circle[_ngcontent-%COMP%]{background-color:green}.red-circle[_ngcontent-%COMP%]{background-color:red}"]}),a})();function ae(a,s){if(1&a&&(e.TgZ(0,"option",22),e._uU(1),e.qZA()),2&a){const t=s.$implicit;e.s9C("value",t.ID),e.xp6(1),e.Oqu(t.NAME)}}function se(a,s){if(1&a&&(e.TgZ(0,"option",45),e._uU(1),e.qZA()),2&a){const t=s.$implicit;e.Q6J("value",t.value),e.xp6(1),e.Oqu(t.name)}}function le(a,s){1&a&&(e.TgZ(0,"p"),e._uU(1,"Debe seleccionar algun tipo de MV."),e.qZA())}function re(a,s){if(1&a&&(e.TgZ(0,"div",46),e.YNc(1,le,2,0,"p",44),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.MV.errors.required)}}function de(a,s){1&a&&(e.TgZ(0,"p"),e._uU(1,"El formato del archivo debe ser PDF, JPEG o JPG."),e.qZA())}function ce(a,s){1&a&&(e.TgZ(0,"p"),e._uU(1,"El tama\xf1o del archivo no debe superar 1 MB."),e.qZA())}function ue(a,s){if(1&a&&(e.TgZ(0,"div",46),e.YNc(1,de,2,0,"p",44),e.YNc(2,ce,2,0,"p",44),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.userForm.controls.ARCHIVO.errors.invalidFileType),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.ARCHIVO.errors.invalidFileSize)}}function me(a,s){1&a&&(e.TgZ(0,"div",47),e._uU(1," No se pueden subir m\xe1s de 3 archivos de verificaci\xf3n. "),e.qZA())}function pe(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"tr",50)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td")(4,"a",52),e.NdJ("click",function(){const o=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.downloadFile(o.ID,o.FILE_NAME))}),e._uU(5),e.qZA()(),e.TgZ(6,"td")(7,"button",53),e.NdJ("click",function(){const o=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.deleteMV(o.ID))}),e._uU(8," X "),e.qZA()()()}if(2&a){const t=s.$implicit;e.xp6(2),e.Oqu(t.TYPE_FILE_TIPEADO),e.xp6(3),e.Oqu(t.FILE_NAME)}}function _e(a,s){if(1&a&&(e.TgZ(0,"div"),e._UZ(1,"div",48),e.TgZ(2,"table",49)(3,"thead")(4,"tr",50)(5,"th"),e._uU(6,"Tipo MV"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Nombre Archivo"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Eliminar"),e.qZA()()(),e.TgZ(11,"tbody"),e.YNc(12,pe,9,2,"tr",51),e.qZA()()()),2&a){const t=e.oxw();e.xp6(12),e.Q6J("ngForOf",t.MV_consulta)}}const ge=[{path:"",component:B.$,children:[{path:"home",component:G},{path:"bulk-upload",component:(()=>{class a{constructor(t,n){this.consumer=t,this.businessService=n,this.dbBusiness=[]}ngOnInit(){this.loadStatements()}downloadExcel(){const t=document.getElementById("f_name").value;"-1"!=t?this.consumer.downloadExcel(t).subscribe(n=>{const i=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});let o=document.createElement("a");o.href=window.URL.createObjectURL(i),o.download="carga masiva",document.body.appendChild(o),o.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),o.remove(),window.URL.revokeObjectURL(o.href)}):d().fire({icon:"error",text:"Debe seleccionar empresa"})}loadStatements(){d().fire({title:"Cargando Datos",text:"Se est\xe1 recuperando datos",timerProgressBar:!0,showConfirmButton:!1,allowEscapeKey:!1,allowOutsideClick:!1}),d().showLoading(),this.businessService.getBusinessByUser.subscribe(t=>{t.status&&(this.dbBusiness=t.data,d().close())})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(E.h),e.Y36(x.m))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-bulk-upload"]],decls:33,vars:1,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"declaracion"],[1,"d-sm-flex","justify-content-between","mb-3","mb-md-0"],[1,"box","box-form","mb-4"],[1,"row","align-items-end"],[1,"col-12","col-xl-4","mb-3","mb-xl-0"],[1,"form-label"],[1,"input-group"],["id","f_name",1,"form-select"],["value","-1","selected",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-12","col-xl-3","mb-5","mb-xl-0"],["id","inp_year","type","number","placeholder","A\xd1O Declaraci\xf3n",1,"form-control"],[1,"row"],[1,"col-6"],[1,"btn","btn-primary","col-12",3,"click"],[3,"value"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",6),e._uU(8,"Carga Masiva"),e.qZA()()(),e.TgZ(9,"section",7)(10,"h1"),e._uU(11,"Carga Masiva"),e.qZA(),e._UZ(12,"div",8),e.TgZ(13,"div",9)(14,"div",10)(15,"div",11)(16,"label",12),e._uU(17,"Empresa:"),e.qZA(),e.TgZ(18,"div",13)(19,"select",14)(20,"option",15),e._uU(21,"Seleccionar Empresa"),e.qZA(),e.YNc(22,ae,2,2,"option",16),e.qZA()()(),e.TgZ(23,"div",17)(24,"label",12),e._uU(25,"A\xf1o:"),e.qZA(),e.TgZ(26,"div",13),e._UZ(27,"input",18),e.qZA()(),e.TgZ(28,"div",11)(29,"div",19)(30,"div",20)(31,"button",21),e.NdJ("click",function(){return n.downloadExcel()}),e._uU(32,"Descargar Excel"),e.qZA()()()()()()()()),2&t&&(e.xp6(22),e.Q6J("ngForOf",n.dbBusiness))},dependencies:[g.sg,l.YN,l.Kr],styles:["[_nghost-%COMP%]{width:90%!important;padding:1%}.circle[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%;display:inline-block;margin-right:5px}.green-circle[_ngcontent-%COMP%]{background-color:green}.red-circle[_ngcontent-%COMP%]{background-color:red}"]}),a})()},{path:"form",component:I,data:{show:!1}},{path:"form/:id",component:I,data:{show:!0}},{path:"profile",component:j},{path:"statements",component:ie},{path:"statements/:id_header_/:id_detail",component:(()=>{class a{constructor(t,n,i,o,u){this.productorService=t,this.ConsumerService=n,this.router=i,this.route=o,this.fb=u,this.maxFiles=3,this.dbStatements=[],this.db=[],this.pos=1,this.index=0,this.data_consulta=[],this.detail_consulta=[],this.MV_consulta=[],this.years=[],this.cant=0,this.selectedFile=null,this.listMV=[{name:"Guia de despacho",value:1},{name:"Factura gestor",value:2},{name:"Registro de peso",value:3},{name:"Fotograf\xeda retiro",value:4},{name:"Otro",value:5}],this.attached=[],this.fileName=""}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.loadData(),this.loadDetail(),this.userForm=this.fb.group({MV:["",l.kI.required],ARCHIVO:[null,[l.kI.required,this.fileTypeValidator,this.fileSizeValidator]]})}loadData(){d().fire({title:"Cargando Datos",text:"Se est\xe1 recuperando datos",timerProgressBar:!0,showConfirmButton:!1,allowEscapeKey:!1,allowOutsideClick:!1}),d().showLoading(),this.ConsumerService.getFormConsulta(this.route.snapshot.params.id_header_).subscribe(n=>{n.status&&(this.data_consulta=n.data.header[0],d().close())})}loadDetail(){this.ConsumerService.getDeclarationByID(this.route.snapshot.params.id_header_,this.route.snapshot.params.id_detail).subscribe(i=>{i.status&&(this.detail_consulta=i.status[0],this.loadMV())})}loadMV(){this.ConsumerService.getMV(this.detail_consulta.ID_DETAIL).subscribe(t=>{t.status&&(this.MV_consulta=t.data.header)})}volver(){this.router.navigate(["/consumidor/statements"])}reset(){this.userForm.reset(),this.userForm.patchValue({MV:"",ARCHIVO:""})}formatDate(t){return new Date(t).toISOString().split("T")[0]}saveFile(){this.detail_consulta.FechaRetiro=this.formatDate(this.detail_consulta.FechaRetiro),this.ConsumerService.saveFile(this.detail_consulta.ID_DETAIL,this.fileName,this.fileBuffer,this.userForm.controls.MV.value).subscribe(t=>{t.status?(d().fire({icon:"success",text:"Medio de verificaci\xf3n guardado satisfactoriamente"}),this.loadMV()):console.log("error")})}deleteMV(t){this.ConsumerService.deleteById(t).subscribe(n=>{n.status?(d().fire({icon:"info",text:"Medio de verificaci\xf3n eliminado satisfactoriamente"}),this.loadMV()):console.log("error")})}onFileSelected(t){const n=t.target;if(n&&n.files&&n.files.length>0){const i=n.files[0];this.fileName=i.name,this.fileBuffer=i,this.selectedFile=n.files[0];const o=["pdf","jpeg","jpg"],u=this.selectedFile.name.split(".").pop()?.toLowerCase()||"";o.includes(u)?i.size>1048576?(this.userForm.controls.ARCHIVO.setErrors({invalidFileSize:!0}),this.userForm.controls.ARCHIVO.markAsTouched()):(this.userForm.controls.ARCHIVO.setErrors(null),this.userForm.controls.ARCHIVO.markAsTouched()):(this.userForm.controls.ARCHIVO.setErrors({invalidFileType:!0}),this.userForm.controls.ARCHIVO.markAsTouched())}else this.selectedFile=null}downloadFile(t,n){this.ConsumerService.downloadMV(t).subscribe(i=>{const o=new Blob([i],{type:i.type}),u=window.URL.createObjectURL(o),b=document.createElement("a");b.href=u,b.download=n,b.click(),window.URL.revokeObjectURL(u)},i=>{console.error("Error al descargar el archivo:",i)})}maxSizeValidator(t){return n=>{const i=n.value;return i&&i.size>t?{maxSizeExceeded:!0}:null}}fileTypeValidator(t){const n=t.value;return n&&!["application/pdf","image/jpeg"].includes(n.type)?{invalidFileType:!0}:null}fileSizeValidator(t){const n=t.value;return n&&n.size>1048576?{invalidFileSize:!0}:null}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(O.u),e.Y36(E.h),e.Y36(Z.F0),e.Y36(Z.gz),e.Y36(l.qu))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-statements-detail"]],decls:123,vars:22,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"declaracion"],[1,"table-responsive"],[1,"table-atributos"],[1,"attr-name"],[1,"attr-value"],[1,"separador"],[1,"table","table-even","table-section","table-borderless","table-radius"],[1,"vertical-middle"],[1,"text-center"],["data-bs-toggle","modal","data-bs-target","#exampleModal",1,"btn"],["aria-hidden","true",1,"fa","fa-book","fa-fw","fa-lg","color-blue"],[1,"text-end"],[1,"btn","btn-primary",3,"click"],["id","exampleModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade",3,"hidden.bs.modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title","fs-5"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"container"],[3,"formGroup"],["miFormulario","ngForm"],[1,"row"],[1,"col-md-6"],["for","inp_nom"],["formControlName","MV","id","inp_mv","required","",1,"form-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","text-danger pl-0",4,"ngIf"],["for","inp_archivo"],["type","file","formControlName","ARCHIVO","id","inp_archivo","accept","application/pdf, image/jpeg","required","",1,"form-control",3,"change"],["class","text-danger mt-2 text-end",4,"ngIf"],[1,"modal-footer"],["type","button","id","btnCloseModal","data-bs-dismiss","modal",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[2,"visibility","hidden"],[4,"ngIf"],[3,"value"],[1,"text-danger","pl-0"],[1,"text-danger","mt-2","text-end"],[2,"height","50px"],[1,"table-container","table","table-even","table-section","table-borderless","table-border","table-radius","d-lg-table"],[1,"text-center","w-100"],["class","text-center w-100",4,"ngFor","ngForOf"],[1,"file-link",3,"click"],["type","button",1,"btn","btn-danger","btn-sm","rounded-pill",3,"click"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),e._UZ(5,"i",5),e._uU(6," Inicio"),e.qZA()(),e.TgZ(7,"li",3)(8,"a",4),e._UZ(9,"i",5),e._uU(10," Consulta de Declaraci\xf3n"),e.qZA()(),e.TgZ(11,"li",6),e._uU(12,"Detalle de Declaraci\xf3n"),e.qZA()()(),e.TgZ(13,"section",7)(14,"h1"),e._uU(15,"Detalle de Declaraci\xf3n"),e.qZA(),e.TgZ(16,"div",8)(17,"table",9)(18,"tbody")(19,"tr")(20,"td",10),e._uU(21,"Nombre de Empresa"),e.qZA(),e.TgZ(22,"td",11),e._uU(23),e.qZA()(),e.TgZ(24,"tr")(25,"td",10),e._uU(26,"ID de Empresa"),e.qZA(),e.TgZ(27,"td",11),e._uU(28),e.qZA()(),e.TgZ(29,"tr")(30,"td",10),e._uU(31,"Establecimiento"),e.qZA(),e.TgZ(32,"td",11),e._uU(33),e.qZA()(),e.TgZ(34,"tr")(35,"td",10),e._uU(36,"ID Establecimiento"),e.qZA(),e.TgZ(37,"td",11),e._uU(38),e.qZA()(),e.TgZ(39,"tr")(40,"td",10),e._uU(41,"Regi\xf3n"),e.qZA(),e.TgZ(42,"td",11),e._uU(43),e.qZA()()()()(),e._UZ(44,"div",12),e.TgZ(45,"div",8)(46,"table",13)(47,"thead",14)(48,"tr")(49,"th",15),e._uU(50,"Tipo de tratamiento"),e.qZA(),e.TgZ(51,"th",15),e._uU(52,"Material"),e.qZA(),e.TgZ(53,"th",15),e._uU(54,"Subtipo"),e.qZA(),e.TgZ(55,"th",15),e._uU(56,"LER"),e.qZA(),e.TgZ(57,"th",15),e._uU(58,"Peso"),e.qZA(),e.TgZ(59,"th",15),e._uU(60,"Fecha Retiro"),e.qZA(),e.TgZ(61,"th",15),e._uU(62,"Gestor"),e.qZA(),e.TgZ(63,"th",15),e._uU(64,"MV"),e.qZA()()(),e.TgZ(65,"tbody")(66,"td",15),e._uU(67),e.qZA(),e.TgZ(68,"td",15),e._uU(69),e.qZA(),e.TgZ(70,"td",15),e._uU(71),e.qZA(),e.TgZ(72,"td",15),e._uU(73),e.qZA(),e.TgZ(74,"td",15),e._uU(75),e.qZA(),e.TgZ(76,"td",15),e._uU(77),e.ALo(78,"date"),e.qZA(),e.TgZ(79,"td",15),e._uU(80),e.qZA(),e.TgZ(81,"td",15)(82,"button",16),e._UZ(83,"i",17),e.qZA()()()()(),e.TgZ(84,"div",18)(85,"button",19),e.NdJ("click",function(){return n.volver()}),e._uU(86,"Volver"),e.qZA()()()(),e.TgZ(87,"div",20),e.NdJ("hidden.bs.modal",function(){return n.reset()}),e.TgZ(88,"div",21)(89,"div",22)(90,"div",23)(91,"h1",24),e._uU(92,"Medios de verificaci\xf3n"),e.qZA(),e._UZ(93,"button",25),e.qZA(),e.TgZ(94,"div",26)(95,"div",27)(96,"form",28,29)(98,"div",30)(99,"div",31)(100,"label",32),e._uU(101,"Tipo MV"),e.qZA(),e.TgZ(102,"select",33)(103,"option",34),e._uU(104,"Selecciona MV"),e.qZA(),e.YNc(105,se,2,2,"option",35),e.qZA(),e.YNc(106,re,2,1,"div",36),e.qZA(),e.TgZ(107,"div",31)(108,"label",37),e._uU(109,"Archivo"),e.qZA(),e.TgZ(110,"input",38),e.NdJ("change",function(o){return n.onFileSelected(o)}),e.qZA(),e.YNc(111,ue,3,2,"div",36),e.qZA()(),e.YNc(112,me,2,0,"div",39),e.TgZ(113,"div",40)(114,"button",41),e.NdJ("click",function(){return n.reset()}),e._uU(115,"Cerrar"),e.qZA(),e.TgZ(116,"button",42),e.NdJ("click",function(){return n.saveFile(),n.reset()}),e._uU(117,"Agregar"),e.qZA()(),e.TgZ(118,"div",43),e._uU(119,"a"),e.qZA(),e.TgZ(120,"div",43),e._uU(121,"a"),e.qZA(),e.YNc(122,_e,13,1,"div",44),e.qZA()()()()()()),2&t){const i=e.MAs(97);e.xp6(23),e.Oqu(n.data_consulta.NombreEmpresa),e.xp6(5),e.Oqu(n.data_consulta.CodigoEmpresa),e.xp6(5),e.Oqu(n.data_consulta.Establecimiento),e.xp6(5),e.Oqu(n.data_consulta.IDEstablecimiento),e.xp6(5),e.Oqu(n.data_consulta.Region),e.xp6(24),e.Oqu(n.detail_consulta.TIPO_TRATAMIENTO_TIPEADO),e.xp6(2),e.Oqu(n.detail_consulta.PRECEDENCETIPEADO),e.xp6(2),e.Oqu(n.detail_consulta.TYPE_RESIDUE_TIPEADO),e.xp6(2),e.Oqu(n.detail_consulta.LER),e.xp6(2),e.Oqu(n.detail_consulta.VALUE),e.xp6(2),e.Oqu(e.xi3(78,19,n.detail_consulta.FechaRetiro,"dd-MM-yyyy")),e.xp6(3),e.Oqu(n.detail_consulta.NombreGestor),e.xp6(16),e.Q6J("formGroup",n.userForm),e.xp6(9),e.Q6J("ngForOf",n.listMV),e.xp6(1),e.Q6J("ngIf",n.userForm.controls.MV.errors&&n.userForm.controls.MV.touched),e.xp6(5),e.Q6J("ngIf",n.userForm.controls.ARCHIVO.errors&&n.userForm.controls.ARCHIVO.touched),e.xp6(1),e.Q6J("ngIf",n.MV_consulta.length>=n.maxFiles),e.xp6(4),e.Q6J("disabled",i.invalid||n.MV_consulta.length>=n.maxFiles),e.xp6(6),e.Q6J("ngIf",n.MV_consulta&&n.MV_consulta.length>0)}},dependencies:[g.sg,g.O5,l._Y,l.YN,l.Kr,l.Fj,l.EJ,l.JJ,l.JL,l.Q7,l.sg,l.u,g.uU],styles:["table[_ngcontent-%COMP%]{border-collapse:collapse;width:100%}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding:8px;text-align:left;border-bottom:1px solid #ddd}th[_ngcontent-%COMP%]{background-color:#f2f2f2}.table-atributos[_ngcontent-%COMP%]{border-collapse:collapse;width:100%;border-radius:10px;overflow:hidden}.attr-name[_ngcontent-%COMP%]{background-color:#3c7c9c;color:#fff;width:25%}.table-atributos[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{width:25%;background-color:#3c7c9c;color:#fff;border-radius:6px 0 0 6px}.table-atributos[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{width:75%;background-color:#ececec;color:#000;border-radius:0 6px 6px 0}.attr-value[_ngcontent-%COMP%]{background-color:#ececec;width:75%;color:#000}[_nghost-%COMP%]{width:90%!important;padding:1%}.separador[_ngcontent-%COMP%]{height:1px;margin-top:20px;margin-bottom:20px;background-color:#ccc}.text-end[_ngcontent-%COMP%]{position:relative;margin-top:20px}.text-center[_ngcontent-%COMP%]{text-align:center}.file-link[_ngcontent-%COMP%]{color:#00f;text-decoration:underline;cursor:pointer}.file-link[_ngcontent-%COMP%]:hover{text-decoration:none}"]}),a})()},{path:"faq",component:D.v},{path:"**",redirectTo:"home",pathMatch:"full"}]}];let be=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[Z.Bz.forChild(ge),Z.Bz]}),a})();var fe=m(4466);let Ze=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[g.ez,be,fe.m,l.u5,l.UX,w.q4]}),a})()}}]);