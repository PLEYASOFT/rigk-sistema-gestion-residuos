"use strict";(self.webpackChunkrigk_sg_web=self.webpackChunkrigk_sg_web||[]).push([[311],{7311:(ut,b,_)=>{_.r(b),_.d(b,{ConsumerStatementModule:()=>_t});var m=_(6895),h=_(2045),E=_(9314),v=_(4135),A=_(5226),p=_.n(A),C=_(4128),F=_(4004),t=_(8256),T=_(9821),y=_(554),S=_(3813),u=_(4006),x=_(8446);function w(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"p-multiSelect",15),t.NdJ("ngModelChange",function(n){t.CHM(e);const a=t.oxw();return t.KtG(a.selectedEstablishment=n)})("onChange",function(n){t.CHM(e);const a=t.oxw();return t.KtG(a.onEstablishmentChange(n))}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("options",e.establishments)("ngModel",e.selectedEstablishment)("selectionLimit",1)("selectedItemsLabel","{0} Empresas seleccionadas")}}function U(o,r){if(1&o&&(t.TgZ(0,"h4"),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij("Establecimiento: ",e.establishment,"")}}function q(o,r){if(1&o&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.name)}}function N(o,r){1&o&&t._UZ(0,"td",27)}function I(o,r){1&o&&t._UZ(0,"td",27)}function M(o,r){1&o&&t._UZ(0,"td",27)}function Y(o,r){1&o&&t._UZ(0,"td",28)}function J(o,r){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.name)}}function $(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"td")(1,"input",30),t.NdJ("change",function(n){t.CHM(e);const a=t.oxw().$implicit,s=t.oxw().index,l=t.oxw();return t.KtG(l.updateVal(s,a.id,n.target))}),t.qZA()()}if(2&o){const e=t.oxw().$implicit,i=t.oxw().index,n=t.oxw();t.xp6(1),t.hYB("id","inp_1_",i,"_",e.id,""),t.Q6J("disabled",n.disableAll)}}function O(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"td")(1,"input",31),t.NdJ("change",function(n){t.CHM(e);const a=t.oxw().$implicit,s=t.oxw().index,l=t.oxw();return t.KtG(l.updateDate(s,a.id,n.target))}),t.qZA()()}if(2&o){const e=t.oxw().$implicit,i=t.oxw().index,n=t.oxw();t.xp6(1),t.hYB("id","inp_2_",i,"_",e.id,""),t.Q6J("disabled",n.disableAll)}}function P(o,r){if(1&o&&(t.TgZ(0,"option",36),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function B(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"td")(1,"select",32),t.NdJ("change",function(n){t.CHM(e);const a=t.oxw().$implicit,s=t.oxw().index,l=t.oxw();return t.KtG(l.updateGestor(s,a.id,n.target))}),t.TgZ(2,"option",33),t._uU(3,"Seleccione"),t.qZA(),t.TgZ(4,"option",34),t._uU(5,"Reciclaje Interno"),t.qZA(),t.YNc(6,P,2,2,"option",35),t.qZA()()}if(2&o){const e=t.oxw().$implicit,i=t.oxw().index,n=t.oxw();t.xp6(1),t.hYB("id","inp_3_",i,"_",e.id,""),t.Q6J("disabled",n.disableAll),t.xp6(5),t.Q6J("ngForOf",n.getManagersForMaterial(e.id))}}function R(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"input",48),t.NdJ("change",function(n){t.CHM(e);const a=t.oxw(2).$implicit,s=t.oxw().index,l=t.oxw();return t.KtG(l.uploadFile(s,a.id,n.target,1))}),t.qZA()}if(2&o){const e=t.oxw(2).$implicit,i=t.oxw().index,n=t.oxw();t.hYB("id","f_1_",i,"_",e.id,""),t.Q6J("disabled",n.disableAll)}}function k(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"button",49),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,a=t.oxw().index,s=t.oxw();return t.KtG(s.downloadFile(a,n.id,1))}),t._UZ(1,"i",50),t.qZA()}if(2&o){const e=t.oxw(2).$implicit,i=t.oxw().index;t.hYB("id","pdf_1_",i,"_",e.id,"")}}function D(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"input",48),t.NdJ("change",function(n){t.CHM(e);const a=t.oxw(2).$implicit,s=t.oxw().index,l=t.oxw();return t.KtG(l.uploadFile(s,a.id,n.target,2))}),t.qZA()}if(2&o){const e=t.oxw(2).$implicit,i=t.oxw().index,n=t.oxw();t.hYB("id","f_2_",i,"_",e.id,""),t.Q6J("disabled",n.disableAll)}}function L(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"button",49),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,a=t.oxw().index,s=t.oxw();return t.KtG(s.downloadFile(a,n.id,2))}),t._UZ(1,"i",50),t.qZA()}if(2&o){const e=t.oxw(2).$implicit,i=t.oxw().index;t.hYB("id","pdf_2_",i,"_",e.id,"")}}function Q(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"input",48),t.NdJ("change",function(n){t.CHM(e);const a=t.oxw(2).$implicit,s=t.oxw().index,l=t.oxw();return t.KtG(l.uploadFile(s,a.id,n.target,3))}),t.qZA()}if(2&o){const e=t.oxw(2).$implicit,i=t.oxw().index,n=t.oxw();t.hYB("id","f_3_",i,"_",e.id,""),t.Q6J("disabled",n.disableAll)}}function H(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"button",49),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,a=t.oxw().index,s=t.oxw();return t.KtG(s.downloadFile(a,n.id,3))}),t._UZ(1,"i",50),t.qZA()}if(2&o){const e=t.oxw(2).$implicit,i=t.oxw().index;t.hYB("id","pdf_3_",i,"_",e.id,"")}}function G(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"td")(1,"div",37)(2,"select",38),t.NdJ("change",function(n){t.CHM(e);const a=t.oxw().$implicit,s=t.oxw().index,l=t.oxw();return t.KtG(l.updateType(s,a.id,n.target,1))}),t.TgZ(3,"option",39),t._uU(4,"Seleccione Tipo M.V"),t.qZA(),t.TgZ(5,"option",34),t._uU(6,"Guia de despacho"),t.qZA(),t.TgZ(7,"option",40),t._uU(8,"Factura Gestor"),t.qZA(),t.TgZ(9,"option",41),t._uU(10,"Registro de peso"),t.qZA(),t.TgZ(11,"option",42),t._uU(12,"Fotograf\xeda Retiro"),t.qZA(),t.TgZ(13,"option",43),t._uU(14,"Otro"),t.qZA()(),t.YNc(15,R,1,3,"input",44),t.YNc(16,k,2,2,"button",45),t.TgZ(17,"button",46),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw().index,s=t.oxw();return t.KtG(s.deleteSelectedFile(a,n.id,1))}),t._UZ(18,"i",47),t._uU(19," Eliminar Selecci\xf3n"),t.qZA()(),t.TgZ(20,"div",37)(21,"select",38),t.NdJ("change",function(n){t.CHM(e);const a=t.oxw().$implicit,s=t.oxw().index,l=t.oxw();return t.KtG(l.updateType(s,a.id,n.target,2))}),t.TgZ(22,"option",39),t._uU(23,"Seleccione Tipo M.V"),t.qZA(),t.TgZ(24,"option",34),t._uU(25,"Guia de despacho"),t.qZA(),t.TgZ(26,"option",40),t._uU(27,"Factura Gestor"),t.qZA(),t.TgZ(28,"option",41),t._uU(29,"Registro de peso"),t.qZA(),t.TgZ(30,"option",42),t._uU(31,"Fotograf\xeda Retiro"),t.qZA(),t.TgZ(32,"option",43),t._uU(33,"Otro"),t.qZA()(),t.YNc(34,D,1,3,"input",44),t.YNc(35,L,2,2,"button",45),t.TgZ(36,"button",46),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw().index,s=t.oxw();return t.KtG(s.deleteSelectedFile(a,n.id,2))}),t._UZ(37,"i",47),t._uU(38," Eliminar Selecci\xf3n"),t.qZA()(),t.TgZ(39,"div",37)(40,"select",38),t.NdJ("change",function(n){t.CHM(e);const a=t.oxw().$implicit,s=t.oxw().index,l=t.oxw();return t.KtG(l.updateType(s,a.id,n.target,3))}),t.TgZ(41,"option",39),t._uU(42,"Seleccione Tipo M.V"),t.qZA(),t.TgZ(43,"option",34),t._uU(44,"Guia de despacho"),t.qZA(),t.TgZ(45,"option",40),t._uU(46,"Factura Gestor"),t.qZA(),t.TgZ(47,"option",41),t._uU(48,"Registro de peso"),t.qZA(),t.TgZ(49,"option",42),t._uU(50,"Fotograf\xeda Retiro"),t.qZA(),t.TgZ(51,"option",43),t._uU(52,"Otro"),t.qZA()(),t.YNc(53,Q,1,3,"input",44),t.YNc(54,H,2,2,"button",45),t.TgZ(55,"button",46),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,a=t.oxw().index,s=t.oxw();return t.KtG(s.deleteSelectedFile(a,n.id,3))}),t._UZ(56,"i",47),t._uU(57," Eliminar Selecci\xf3n"),t.qZA()()()}if(2&o){const e=t.oxw().$implicit,i=t.oxw().index,n=t.oxw();t.xp6(2),t.hYB("id","inp_f_1_",i,"_",e.id,""),t.Q6J("disabled",n.disableAll),t.xp6(13),t.Q6J("ngIf",!n.disableAll),t.xp6(1),t.Q6J("ngIf",n.disableAll),t.xp6(1),t.hYB("id","btn_f_1_",i,"_",e.id,""),t.xp6(4),t.hYB("id","inp_f_2_",i,"_",e.id,""),t.Q6J("disabled",n.disableAll),t.xp6(13),t.Q6J("ngIf",!n.disableAll),t.xp6(1),t.Q6J("ngIf",n.disableAll),t.xp6(1),t.hYB("id","btn_f_2_",i,"_",e.id,""),t.xp6(4),t.hYB("id","inp_f_3_",i,"_",e.id,""),t.Q6J("disabled",n.disableAll),t.xp6(13),t.Q6J("ngIf",!n.disableAll),t.xp6(1),t.Q6J("ngIf",n.disableAll),t.xp6(1),t.hYB("id","btn_f_3_",i,"_",e.id,"")}}function K(o,r){if(1&o&&(t.TgZ(0,"tr"),t.YNc(1,q,2,1,"td",24),t.YNc(2,N,1,0,"td",24),t.YNc(3,I,1,0,"td",24),t.YNc(4,M,1,0,"td",24),t.YNc(5,Y,1,0,"td",25),t.YNc(6,J,2,1,"td",26),t.YNc(7,$,2,3,"td",12),t.YNc(8,O,2,3,"td",12),t.YNc(9,B,7,4,"td",12),t.YNc(10,G,58,21,"td",12),t.qZA()),2&o){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf",!e.id),t.xp6(1),t.Q6J("ngIf",!e.id),t.xp6(1),t.Q6J("ngIf",!e.id),t.xp6(1),t.Q6J("ngIf",!e.id),t.xp6(1),t.Q6J("ngIf",!e.id),t.xp6(1),t.Q6J("ngIf",e.id),t.xp6(1),t.Q6J("ngIf",e.id),t.xp6(1),t.Q6J("ngIf",e.id),t.xp6(1),t.Q6J("ngIf",e.id),t.xp6(1),t.Q6J("ngIf",e.id)}}function j(o,r){if(1&o&&(t.TgZ(0,"div",16)(1,"h2",17),t._uU(2),t.qZA(),t.TgZ(3,"table",18)(4,"thead")(5,"tr")(6,"th"),t._uU(7,"Material"),t.qZA(),t.TgZ(8,"th")(9,"span",19),t._uU(10,"Peso (kg)"),t.qZA(),t.TgZ(11,"span",20),t._uU(12,"Kg."),t.qZA()(),t.TgZ(13,"th")(14,"span",19),t._uU(15,"Fecha de retiro"),t.qZA(),t.TgZ(16,"span",20),t._uU(17,"Fec. de retiro"),t.qZA()(),t.TgZ(18,"th"),t._uU(19,"Gestor"),t.qZA(),t.TgZ(20,"th",21),t._uU(21,"Medios de verificaci\xf3n"),t.qZA()()(),t.TgZ(22,"tbody"),t.YNc(23,K,11,10,"tr",22),t.qZA(),t.TgZ(24,"tfoot")(25,"tr")(26,"td",21),t._uU(27,"TOTAL:"),t.qZA(),t.TgZ(28,"td",23),t._uU(29),t.ALo(30,"number"),t.qZA()()()()()),2&o){const e=r.$implicit,i=r.index,n=t.oxw();t.xp6(2),t.hij(" ",e,""),t.xp6(21),t.Q6J("ngForOf",n.materials),t.xp6(6),t.Oqu(t.xi3(30,3,n.total_tables[i],"1.2-2"))}}function V(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"button",51),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.saveForm())}),t._uU(1,"Enviar Declaraci\xf3n"),t.qZA()}}let Z=(()=>{class o{constructor(e,i,n,a,s){this.establishmentService=e,this.consumerService=i,this.router=n,this.actived=a,this.managerService=s,this.materials=[{name:"Papel/Cart\xf3n"},{id:1,name:"Papel"},{id:2,name:"Papel Compuesto (cemento)"},{id:3,name:"Caja Cart\xf3n"},{id:4,name:"Otro"},{name:"Metal"},{id:5,name:"Envase Aluminio"},{id:6,name:"Malla o Reja (IBC)"},{id:7,name:"Envase Hojalata"},{id:8,name:"Otro"},{name:"Pl\xe1stico Total"},{id:9,name:"Pl\xe1stico Film Embalaje"},{id:10,name:"Pl\xe1stico Envases R\xedgidos (Incl. Tapas)"},{id:11,name:"Pl\xe1stico Sacos o Maxisacos"},{id:12,name:"Pl\xe1stico EPS (Poliestireno Expandido)"},{id:13,name:"Pl\xe1stico Zuncho"},{id:14,name:"Otro"},{name:"Madera"},{id:15,name:"Caja de Madera"},{id:16,name:"Pallet de Madera"}],this.disableAll=!1,this.tables=["Reciclaje Mec\xe1nico","Valorizaci\xf3n Energ\xe9tica","Disposici\xf3n Final en RS"],this.total_tables=[0,0,0],this.id_establishment=-1,this.establishments=[],this.selectedEstablishment=[],this.attached=[],this.managers=[],this.id_business="0",this.year_statement=0,this.establishment="",this.goTo="/consumidor/",this.data=[],this.actived.data.subscribe(l=>{l.show?(this.loadForm(this.actived.snapshot.params.id),this.disableAll=!0):this.actived.queryParams.subscribe(d=>{this.id_business=d.id_business,this.year_statement=d.year,this.loadEstablishments()})})}ngOnInit(){}getManagersForMaterial(e){return(this.managers.find(n=>n.material===e)?.managers||[]).map(n=>n.BUSINESS_NAME||"Reciclaje Interno")}onEstablishmentChange(e){this.establishmentService.getEstablishmentByID(this.selectedEstablishment).subscribe(i=>{i.status?this.fetchManagersForAllMaterials(i.status[0].REGION):this.managers=[]})}fetchManagersForAllMaterials(e){const i=this.materials.filter(n=>void 0!==n.id).map(n=>this.managerService.getManagersByMaterial(n.id,e).pipe((0,F.U)(a=>({material:n.id,managers:a.status}))));(0,C.D)(i).subscribe(n=>{this.managers=n})}loadForm(e){p().fire({title:"Cargando Datos",text:"Se est\xe1 recuperando datos",timerProgressBar:!0,showConfirmButton:!1}),p().showLoading(),this.goTo="/consumidor/statements",this.consumerService.getForm(e).subscribe({next:i=>{const{header:n,detail:a,attached:s}=i.data;this.id_business=n.ID_BUSINESS,this.establishment=n.NAME_ESTABLISHMENT,this.attached=s;for(let d=0;d<a.length;d++){const c=a[d];document.getElementById(`inp_1_${c.PRECEDENCE}_${c.TYPE_RESIDUE}`).value=c.VALUE.toString().replace(".",","),document.getElementById(`inp_2_${c.PRECEDENCE}_${c.TYPE_RESIDUE}`).value=c.DATE_WITHDRAW.split("T")[0],document.getElementById(`inp_3_${c.PRECEDENCE}_${c.TYPE_RESIDUE}`).value=c.ID_GESTOR,this.total_tables[c.PRECEDENCE]+=c.VALUE}for(let d=0;d<s.length;d++){const c=s[d];for(let f=0;f<3;f++){const g=f;if("0"==document.getElementById(`inp_f_${g+1}_${c.PRECEDENCE}_${c.TYPE_RESIDUE}`).value){document.getElementById(`inp_f_${g+1}_${c.PRECEDENCE}_${c.TYPE_RESIDUE}`).value=c.TYPE_FILE,document.getElementById(`pdf_${g+1}_${c.PRECEDENCE}_${c.TYPE_RESIDUE}`).classList.remove("d-none");break}}}p().close()}})}loadEstablishments(){"0"!=this.id_business&&this.establishmentService.getEstablishment(this.id_business.toString()).subscribe({next:e=>{this.establishments=[],e.status.forEach(i=>{i.name=`${i.NAME_ESTABLISHMENT} - ${i.REGION}`,this.establishments.push(i)})}})}updateVal(e,i,n){if(-1!=n.value.indexOf("."))return void(n.value=0);/^[0-9]+(,[0-9]+)?$/.test(n.value)||(n.value=0);let s=parseFloat(n.value.replace(",","."));(!n.value||isNaN(s)||s<0)&&(s=0,n.value=0);const l=this.data.find(d=>d?.residue==i&&d?.table==e);l?l.val=s:this.data.push({table:e,residue:i,val:s,date_withdraw:"",id_gestor:0}),this.total_tables[e]=0;for(let d=0;d<this.data.length;d++){const c=this.data[d];c.table==e&&(this.total_tables[e]+=c.val)}}updateGestor(e,i,n){const a=this.data.find(s=>s?.residue==i&&s?.table==e);a?a.id_gestor=n.value:this.data.push({table:e,residue:i,id_gestor:n.value,date_withdraw:"",val:0})}updateDate(e,i,n){const a=this.data.find(s=>s?.residue==i&&s?.table==e);a?a.date_withdraw=n.value:this.data.push({table:e,residue:i,date_withdraw:n.value,id_gestor:0,val:0})}uploadFile(e,i,n,a){if(0==n.files.length&&(document.getElementById(`btn_f_${a}_${e}_${i}`)?.classList.add("d-none"),document.getElementById(`f_${a}_${e}_${i}`).value=""),n.files[0].size/1e3>1e3)return p().fire({icon:"info",text:"Archivo excede el tama\xf1o permitido (1Mb)."}),document.getElementById(`btn_f_${a}_${e}_${i}`)?.classList.add("d-none"),void(document.getElementById(`f_${a}_${e}_${i}`).value="");const s=this.attached.findIndex(l=>l.col==a&&l.table==e&&l.residue==i);-1==s?this.attached.push({table:e,residue:i,col:a,type:this.attached[s]?.type||0,file:n.files[0]}):this.attached[s].file=n.files[0],document.getElementById(`btn_f_${a}_${e}_${i}`)?.classList.remove("d-none")}updateType(e,i,n,a){const s=this.attached.findIndex(l=>l.col==a&&l.table==e&&l.residue==i);-1==s?this.attached.push({table:e,residue:i,col:a,file:null,type:n.value}):this.attached[s].type=n.value}saveForm(){if(0==this.data.length)return void p().fire({icon:"error",text:"Formulario est\xe1 vac\xedo"});let e=null;(!this.selectedEstablishment[0]||0==this.selectedEstablishment[0])&&(e="Falta establecimiento");for(let a=0;a<this.data.length;a++){const s=this.data[a];if(0==s.val&&(""!=s.date_withdraw||s.id_gestor>0)){e="Falta ingresar peso";break}if(s.val>0&&(""==s.date_withdraw||0==s.id_gestor)){e="Falta ingresar fecha de retiro o gestor";break}if(0==s.val&&(""==s.date_withdraw||0==s.id_gestor)){this.data.splice(a,1),0==this.data.length&&(e="Formulario est\xe1 vac\xedo");break}}if(e)p().fire({icon:"error",text:e});else{for(let a=0;a<this.attached.length;a++){const s=this.attached[a];(0==s.type&&null!=s.file||s.type>0&&null==s.file)&&(e="Falta seleccionar tipo de M.V o archivo")}e?p().fire({icon:"error",text:e}):(p().fire({icon:"info",title:"Espere...",text:"Enviando formulario"}),p().showLoading(),this.consumerService.save({header:{year:this.year_statement,establishment:this.selectedEstablishment[0]},detail:{data:this.data,attached:this.attached},attached:this.attached}).subscribe({next:a=>{p().close(),a.status&&p().fire({icon:"success",text:"Declaraci\xf3n guardada satisfactoriamente"}).then(s=>{s.isConfirmed&&this.router.navigate(["/consumidor"])})},error:a=>{p().close(),p().fire({icon:"error",text:"Ocurri\xf3 un error mientras se enviaba el formulario."})}}))}}downloadFile(e,i,n){const a=this.attached.filter(c=>c.PRECEDENCE==e&&c.TYPE_RESIDUE==i);if(a.length>0){const c=a[n-1];var s=new Blob([new Uint8Array(c.FILE.data)],{type:"Buffer"}),l=document.createElement("a");l.href=window.URL.createObjectURL(s),l.download=c.FILE_NAME,l.click()}}deleteSelectedFile(e,i,n){const a=this.attached.findIndex(s=>s.col==n&&s.table==e&&s.residue==i);a>-1&&this.attached.splice(a,1),document.getElementById(`btn_f_${n}_${e}_${i}`)?.classList.add("d-none"),document.getElementById(`inp_f_${n}_${e}_${i}`).value="0",document.getElementById(`f_${n}_${e}_${i}`).value=""}goBack(){this.router.navigate([this.goTo])}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(T.d),t.Y36(y.h),t.Y36(h.F0),t.Y36(h.gz),t.Y36(S.b))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-form"]],decls:20,vars:4,consts:[["id",""],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"formulario-ci"],[1,"btn","btn-primary",3,"click"],[1,"row","mb-3"],[1,"col-md-5"],["optionLabel","name","optionValue","ID_ESTABLISHMENT","defaultLabel","Seleccione Establecimiento",3,"options","ngModel","selectionLimit","selectedItemsLabel","ngModelChange","onChange",4,"ngIf"],[4,"ngIf"],["class","table-responsive mb-4",4,"ngFor","ngForOf"],["class","btn btn-primary px-5 mb-4",3,"click",4,"ngIf"],["optionLabel","name","optionValue","ID_ESTABLISHMENT","defaultLabel","Seleccione Establecimiento",3,"options","ngModel","selectionLimit","selectedItemsLabel","ngModelChange","onChange"],[1,"table-responsive","mb-4"],[1,"table-header-div","table-header-div-blue"],[1,"table","table-even","table-section","table-borderless","table-border","table-header-green","table-align-middle","text-nowrap"],[1,"d-none","d-lg-block"],[1,"d-lg-none"],["colspan","1"],[4,"ngFor","ngForOf"],["colspan","7"],["style","background-color: lightgray;",4,"ngIf"],["colspan","3","style","background-color: lightgray;",4,"ngIf"],["style","padding-left: 20px;",4,"ngIf"],[2,"background-color","lightgray"],["colspan","3",2,"background-color","lightgray"],[2,"padding-left","20px"],["type","text","value","0",1,"form-control","form-control-sm","text-end","w-50px",3,"disabled","id","change"],["type","date","placeholder","00/00/0000",1,"form-control","text-start","w-auto",3,"disabled","id","change"],[1,"form-select","w-auto",3,"disabled","id","change"],["value","0","selected",""],["value","1"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"border","p-2"],[1,"form-select",3,"id","disabled","change"],["value","0"],["value","2"],["value","3"],["value","4"],["value","5"],["type","file","class","form-control",3,"id","disabled","change",4,"ngIf"],["class","btn btn-sm d-none",3,"id","click",4,"ngIf"],[1,"btn","d-none",3,"id","click"],[1,"fa","fa-trash"],["type","file",1,"form-control",3,"id","disabled","change"],[1,"btn","btn-sm","d-none",3,"id","click"],[1,"fa","fa-file-pdf-o","fa-fw","fa-lg","color-blue"],[1,"btn","btn-primary","px-5","mb-4",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),t._UZ(5,"i",5),t._uU(6," Inicio"),t.qZA()(),t.TgZ(7,"li",6),t._uU(8,"Formulario Consumidor Industrial"),t.qZA()()(),t.TgZ(9,"section",7)(10,"button",8),t.NdJ("click",function(){return i.goBack()}),t._uU(11,"Volver"),t.qZA(),t.TgZ(12,"h1"),t._uU(13,"Formulario Consumidor Industrial"),t.qZA(),t.TgZ(14,"div",9)(15,"div",10),t.YNc(16,w,1,4,"p-multiSelect",11),t.YNc(17,U,2,1,"h4",12),t.qZA()(),t.YNc(18,j,31,6,"div",13),t.YNc(19,V,2,0,"button",14),t.qZA()()),2&e&&(t.xp6(16),t.Q6J("ngIf",!i.disableAll),t.xp6(1),t.Q6J("ngIf",i.disableAll),t.xp6(1),t.Q6J("ngForOf",i.tables),t.xp6(1),t.Q6J("ngIf",!i.disableAll))},dependencies:[m.sg,m.O5,u.YN,u.Kr,u.JJ,u.On,x.NU,m.JJ],styles:["[_nghost-%COMP%]{width:90%!important;padding:1%}"]}),o})();var z=_(2227);let X=(()=>{class o{constructor(e){this.ratesService=e,this.types=["EyE reciclables de papel/cart\xf3n","EyE reciclables de metal","EyE reciclables de pl\xe1sticos","EyE no reciclables"],this.year=(new Date).getFullYear(),this.rates=[]}ngOnInit(){this.ratesService.getRates(this.year).subscribe(e=>{e.status&&e.data.forEach(i=>{this.rates.push({name:this.types[i.type-1],price:i.price})})})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(z.z))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-home"]],decls:22,vars:0,consts:[["id","content"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],["aria-current","page",1,"breadcrumb-item"],["aria-hidden","true",1,"fa","fa-home"],[1,"inicio"],[1,"box","box-inicio"],[1,"col-12","col-md-8"],[1,"h1"],[2,"visibility","hidden"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3),t._UZ(4,"i",4),t._uU(5," Inicio"),t.qZA()()(),t.TgZ(6,"section",5)(7,"h1"),t._uU(8,"Inicio"),t.qZA(),t.TgZ(9,"div",6)(10,"div")(11,"div",7)(12,"h2",8),t._uU(13,"Bienvenido/a a M\xf3dulo de Consumidor Industrial"),t.qZA(),t.TgZ(14,"p",9),t._uU(15,"Como parte de las obligaciones que establece la Ley REP, los Productores deben informar la cantidad de EyE no domiciliarios (POM) puestos en el mercado el a\xf1o anterior."),t.qZA(),t.TgZ(16,"p",9),t._uU(17,"ProREP pone a disposici\xf3n de sus socios la plataforma de declaraci\xf3n que dar\xe1 cumplimiento a la obligaci\xf3n de informar sus EyE."),t.qZA(),t.TgZ(18,"p",9),t._uU(19,"La informaci\xf3n deber\xe1 subirse en los meses de enero y febrero."),t.qZA(),t.TgZ(20,"p",9),t._uU(21,"En caso de tener dudas con respecto a su declaraci\xf3n puede ver los tutoriales y preguntas frecuentes."),t.qZA()()()()()())}}),o})();var W=_(263);let tt=(()=>{class o{constructor(e,i,n){this.fb=e,this.authService=i,this.router=n,this.pos="right",this.horaIngreso=new Date,this.formData=this.fb.group({actual:["",[u.kI.required]],password:["",[u.kI.required,u.kI.minLength(3)]],repeatPassword:["",[u.kI.required,u.kI.minLength(3)]]})}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.horaIngreso=new Date(sessionStorage.getItem("horaIngreso"))}btnrecovery(){const{actual:e,password:i,repeatPassword:n}=this.formData.value;this.authService.modifyPassword(i,n,e).subscribe({next:a=>{a.status?(p().fire({title:"Cambio de contrase\xf1a",text:"La contrase\xf1a fue cambiada exitosamente",icon:"success"}),this.router.navigate(["/auth/login"])):(p().fire({title:"Validar informaci\xf3n",text:a.msg,icon:"error"}),this.formData.reset())},error:a=>{p().fire({title:"Formato inv\xe1lido",text:"Contrase\xf1a debe contener al menos 8 caracteres",icon:"error"})}})}displayModifyPassword(){this.pos="right"==this.pos?"down":"right"}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(u.qu),t.Y36(W.e),t.Y36(h.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-profile"]],decls:81,vars:16,consts:[[1,"container","mt-4"],[1,"mi-perfil"],[1,"box","box-mi-perfil","mb-5","d-flex","align-items-start"],[1,"list","list-data","list-data-title-green","column-md-2","gap-0","list-unstyled"],[1,"list-data__title"],[1,"list-data__text"],[1,"color-verde"],[1,"list","list-links","list-unstyled"],["id","accordionPanelsStayOpenExample",1,"accordion","accordion-flush"],[1,"accordion-item"],["id","panelsStayOpen-headingOne",1,"accordion-header"],["data-bs-toggle","collapse","data-bs-target","#panelsStayOpen-collapseOne",3,"click"],["aria-hidden","true"],["id","panelsStayOpen-collapseOne","aria-labelledby","panelsStayOpen-headingOne",1,"accordion-collapse","collapse"],[1,"accordion-body"],["autocomplete","off",1,"form-recovery",3,"formGroup"],[1,"mb-4"],[1,"input-group"],[1,"input-group-text","input-group-text-left"],["aria-hidden","true",1,"fa","fa-lock","fa-fw"],["type","password","id","password","formControlName","actual","placeholder","Contrase\xf1a actual",1,"form-control"],["type","password","id","password","formControlName","password","placeholder","Nueva contrase\xf1a",1,"form-control"],["type","password","id","repeatPassword","formControlName","repeatPassword","placeholder","Repetir contrase\xf1a",1,"form-control"],["type","button",1,"btn","btn-primary","btn-fa","w-100",3,"click"],["aria-hidden","true",1,"fa","fa-long-arrow-right","fa-fw"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"section",1)(2,"h1"),t._uU(3,"Mi Perfil"),t.qZA(),t.TgZ(4,"div",2)(5,"ul",3)(6,"li")(7,"span",4),t._uU(8,"Nombre Usuario"),t.qZA(),t.TgZ(9,"span",5),t._uU(10),t.qZA()(),t.TgZ(11,"li")(12,"span",4),t._uU(13,"Perfil"),t.qZA(),t.TgZ(14,"span",5),t._uU(15),t.qZA()(),t.TgZ(16,"li")(17,"span",4),t._uU(18,"Tel\xe9fono M\xf3vil"),t.qZA(),t.TgZ(19,"span",5),t._uU(20),t.qZA()(),t.TgZ(21,"li")(22,"span",4),t._uU(23,"Correo"),t.qZA(),t.TgZ(24,"span",5),t._uU(25),t.qZA()(),t.TgZ(26,"li")(27,"span",4),t._uU(28,"Instituci\xf3n"),t.qZA(),t.TgZ(29,"span",5),t._uU(30),t.qZA()(),t.TgZ(31,"li")(32,"span",4),t._uU(33,"Cargo"),t.qZA(),t.TgZ(34,"span",5),t._uU(35),t.qZA()(),t.TgZ(36,"li")(37,"span",4),t._uU(38,"Tel\xe9fono Oficina"),t.qZA(),t.TgZ(39,"span",5),t._uU(40),t.qZA()(),t.TgZ(41,"li")(42,"span",4)(43,"b"),t._uU(44,"Fecha/ Hora ingreso"),t.qZA()(),t.TgZ(45,"span",5),t._uU(46),t.ALo(47,"date"),t.qZA()()()(),t.TgZ(48,"h2",6),t._uU(49,"Acciones"),t.qZA(),t.TgZ(50,"ul",7)(51,"div",8)(52,"div",9)(53,"h2",10)(54,"li",11),t.NdJ("click",function(){return i.displayModifyPassword()}),t.TgZ(55,"a")(56,"span"),t._uU(57,"Cambio de contrase\xf1a"),t.qZA(),t._UZ(58,"i",12),t.qZA()()(),t.TgZ(59,"div",13)(60,"div",14)(61,"form",15)(62,"div",16)(63,"div",17)(64,"button",18),t._UZ(65,"i",19),t.qZA(),t._UZ(66,"input",20),t.qZA()(),t.TgZ(67,"div",16)(68,"div",17)(69,"button",18),t._UZ(70,"i",19),t.qZA(),t._UZ(71,"input",21),t.qZA()(),t.TgZ(72,"div",16)(73,"div",17)(74,"button",18),t._UZ(75,"i",19),t.qZA(),t._UZ(76,"input",22),t.qZA()(),t.TgZ(77,"div",16)(78,"button",23),t.NdJ("click",function(){return i.btnrecovery()}),t._uU(79," Enviar "),t._UZ(80,"i",24),t.qZA()()()()()()()()()()),2&e&&(t.xp6(10),t.AsE("",i.userData.FIRST_NAME," ",i.userData.LAST_NAME,""),t.xp6(5),t.Oqu(i.userData.ROL_NAME),t.xp6(5),t.Oqu(i.userData.PHONE),t.xp6(5),t.Oqu(i.userData.EMAIL),t.xp6(5),t.Oqu(i.userData.BUSINESS),t.xp6(5),t.Oqu(i.userData.POSITION),t.xp6(5),t.Oqu(i.userData.PHONE_OFFICE),t.xp6(6),t.Oqu(t.xi3(47,13,i.horaIngreso,"dd-MM-yyyy H:mm:s")),t.xp6(12),t.Gre("fa fa-chevron-",i.pos,""),t.xp6(3),t.Q6J("formGroup",i.formData))},dependencies:[u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u,m.uU]}),o})();var et=_(371);function it(o,r){if(1&o&&(t.TgZ(0,"option",31),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.s9C("value",e),t.xp6(1),t.Oqu(e)}}function nt(o,r){if(1&o&&(t.TgZ(0,"option",31),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.s9C("value",e),t.xp6(1),t.Oqu(e)}}function ot(o,r){if(1&o&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.ALo(7,"date"),t.qZA(),t.TgZ(8,"td"),t._UZ(9,"span",32),t.qZA(),t.TgZ(10,"td")(11,"a",33),t._UZ(12,"i",34),t.qZA()()()),2&o){const e=r.$implicit;t.xp6(2),t.Oqu(e.NAME_BUSINESS),t.xp6(2),t.Oqu(e.NAME_ESTABLISHMENT),t.xp6(2),t.Oqu(t.xi3(7,5,e.CREATED_AT,"dd-MM-yyyy H:m:ss")),t.xp6(3),t.Q6J("ngClass",e.semaforo?"circle green-circle":"circle red-circle"),t.xp6(2),t.Q6J("href","#/consumidor/form/"+e.ID_HEADER,t.LSH)}}const at=function(o,r){return{"btn-info":o,"btn-primary":r}};function st(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"li")(1,"button",35),t.NdJ("click",function(){const a=t.CHM(e).index,s=t.oxw();return t.KtG(s.pagTo(a))}),t._uU(2),t.qZA()()}if(2&o){const e=r.index,i=t.oxw();t.xp6(1),t.Q6J("ngClass",t.WLB(2,at,i.pos==e+1,i.pos!=e+1)),t.xp6(1),t.Oqu(e+1)}}const lt=[{path:"",component:v.$,children:[{path:"home",component:X},{path:"form",component:Z,data:{show:!1}},{path:"form/:id",component:Z,data:{show:!0}},{path:"profile",component:tt},{path:"statements",component:(()=>{class o{constructor(e,i){this.productorService=e,this.establishmentService=i,this.dbStatements=[],this.db=[],this.pos=1,this.business_name=[],this.years=[],this.cant=0}ngOnInit(){this.userData=JSON.parse(sessionStorage.getItem("user")),this.loadStatements()}loadStatements(){p().fire({title:"Cargando Datos",text:"Se est\xe1 recuperando datos",timerProgressBar:!0,showConfirmButton:!1,allowEscapeKey:!1,allowOutsideClick:!1}),p().showLoading(),this.establishmentService.getDeclarationEstablishment().subscribe(e=>{e.status&&(e.status=e.status.sort((i,n)=>n.YEAR_STATEMENT-i.YEAR_STATEMENT),e.status.forEach(i=>{-1==this.business_name.indexOf(i.NAME_BUSINESS)&&this.business_name.push(i.NAME_BUSINESS),-1==this.years.indexOf(i.YEAR_STATEMENT)&&this.years.push(i.YEAR_STATEMENT)}),this.years.sort((i,n)=>n-i),this.dbStatements=e.status,this.cant=Math.ceil(this.dbStatements.length/10),this.db=this.dbStatements.slice(0,10).sort((i,n)=>n.YEAR_STATEMENT-i.YEAR_STATEMENT),p().close())})}filter(){const e=document.getElementById("f_name").value,i=document.getElementById("f_year").value,n=this.dbStatements.filter(a=>{if("-1"!=e&&a.NAME_BUSINESS==e){if("-1"==i)return a;if(a.YEAR_STATEMENT==i)return a}if("-1"==e){if("-1"==i)return a;if(a.YEAR_STATEMENT==i)return a}});this.db=n.slice(0,10).sort((a,s)=>s.YEAR_STATEMENT-a.YEAR_STATEMENT),this.cant=Math.ceil(n.length/10)}reset(){this.loadStatements()}pagTo(e){this.pos=e+1,this.db=this.dbStatements.slice(10*e,10*(e+1)).sort((i,n)=>n.YEAR_STATEMENT-i.YEAR_STATEMENT)}next(){this.pos>=this.cant||(this.pos++,this.db=this.dbStatements.slice(10*(this.pos-1),10*this.pos).sort((e,i)=>i.YEAR_STATEMENT-e.YEAR_STATEMENT))}previus(){this.pos-1<=0||this.pos>=this.cant+1||(this.pos=this.pos-1,this.db=this.dbStatements.slice(10*(this.pos-1),10*this.pos).sort((e,i)=>i.YEAR_STATEMENT-e.YEAR_STATEMENT))}setArrayFromNumber(){return new Array(this.cant)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(et.u),t.Y36(T.d))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-statements"]],decls:70,vars:4,consts:[[1,"container","mt-4"],["aria-label","breadcrumb",1,"breadcrumbs","d-none","d-lg-block"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],["aria-hidden","true",1,"fa","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"declaracion"],[1,"d-sm-flex","justify-content-between","mb-3","mb-md-0"],[1,"box","box-form","mb-4"],[1,"row","align-items-end"],[1,"col-12","col-xl-4","mb-3","mb-xl-0"],[1,"form-label"],[1,"input-group"],["id","f_name",1,"form-select"],["value","-1","selected",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-12","col-xl-1","text-xl-center","mb-3","mb-xl-0"],[1,"mb-xl-2"],[1,"col-12","col-xl-3","mb-5","mb-xl-0"],["id","f_year",1,"form-select"],[1,"row"],[1,"col-6"],[1,"btn","btn-primary","col-12",3,"click"],[1,"table-responsive"],[1,"table","table-even","table-section","table-borderless","table-radius"],[1,"vertical-middle"],[4,"ngFor","ngForOf"],["aria-label","Navegaci\xf3n resultados"],[1,"pagination"],[1,"btn","btn-primary",3,"click"],[3,"value"],[3,"ngClass"],[3,"href"],["aria-hidden","true",1,"fa","fa-eye","fa-lg","fa-fw","color-verde"],[1,"border","btn","btn-sm",3,"ngClass","click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"nav",1)(2,"ol",2)(3,"li",3)(4,"a",4),t._UZ(5,"i",5),t._uU(6," Inicio"),t.qZA()(),t.TgZ(7,"li",6),t._uU(8,"Consulta de Declaraci\xf3n"),t.qZA()()(),t.TgZ(9,"section",7)(10,"h1"),t._uU(11,"Consulta de Declaraci\xf3n"),t.qZA(),t._UZ(12,"div",8),t.TgZ(13,"div",9)(14,"div",10)(15,"div",11)(16,"label",12),t._uU(17,"Empresa:"),t.qZA(),t.TgZ(18,"div",13)(19,"select",14)(20,"option",15),t._uU(21,"Todos"),t.qZA(),t.YNc(22,it,2,2,"option",16),t.qZA()()(),t.TgZ(23,"div",17)(24,"div",18),t._uU(25,"y/o"),t.qZA()(),t.TgZ(26,"div",19)(27,"label",12),t._uU(28,"A\xf1o:"),t.qZA(),t.TgZ(29,"div",13)(30,"select",20)(31,"option",15),t._uU(32,"Todos"),t.qZA(),t.YNc(33,nt,2,2,"option",16),t.qZA()()(),t.TgZ(34,"div",11)(35,"div",21)(36,"div",22)(37,"button",23),t.NdJ("click",function(){return i.filter()}),t._uU(38,"Mostrar"),t.qZA()()()()()(),t.TgZ(39,"div",24)(40,"table",25)(41,"thead",26)(42,"tr")(43,"th"),t._uU(44,"Nombre Empresa"),t.qZA(),t.TgZ(45,"th"),t._uU(46,"Establecimiento"),t.qZA(),t.TgZ(47,"th"),t._uU(48,"Fecha declaraci\xf3n"),t.qZA(),t.TgZ(49,"th"),t._uU(50,"Estado"),t.qZA(),t.TgZ(51,"th"),t._uU(52,"Ver detalle"),t.qZA()()(),t.TgZ(53,"tbody"),t.YNc(54,ot,13,8,"tr",27),t.qZA()()(),t.TgZ(55,"nav",28)(56,"ul",29)(57,"li")(58,"button",30),t.NdJ("click",function(){return i.pagTo(0)}),t._uU(59,"Primero"),t.qZA()(),t.TgZ(60,"li")(61,"button",30),t.NdJ("click",function(){return i.previus()}),t._uU(62,"Anterior"),t.qZA()(),t.YNc(63,st,3,5,"li",27),t.TgZ(64,"li")(65,"button",30),t.NdJ("click",function(){return i.next()}),t._uU(66,"Siguiente"),t.qZA()(),t.TgZ(67,"li")(68,"button",30),t.NdJ("click",function(){return i.pagTo(i.cant-1)}),t._uU(69,"\xdaltimo"),t.qZA()()()()()()),2&e&&(t.xp6(22),t.Q6J("ngForOf",i.business_name),t.xp6(11),t.Q6J("ngForOf",i.years),t.xp6(21),t.Q6J("ngForOf",i.db),t.xp6(9),t.Q6J("ngForOf",i.setArrayFromNumber()))},dependencies:[m.mk,m.sg,u.YN,u.Kr,m.uU],styles:["[_nghost-%COMP%]{width:90%!important;padding:1%}.circle[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%;display:inline-block;margin-right:5px}.green-circle[_ngcontent-%COMP%]{background-color:green}.red-circle[_ngcontent-%COMP%]{background-color:red}"]}),o})()},{path:"faq",component:E.v},{path:"**",redirectTo:"home",pathMatch:"full"}]}];let ct=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[h.Bz.forChild(lt),h.Bz]}),o})();var dt=_(4466);let _t=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[m.ez,ct,dt.m,u.u5,u.UX,x.q4]}),o})()}}]);