"use strict";(self.webpackChunkrigk_sg_web=self.webpackChunkrigk_sg_web||[]).push([[489],{6489:(U,m,a)=>{a.r(m),a.d(m,{AuthModule:()=>y});var c=a(6895),d=a(2045),o=a(4006),t=a(8256),p=a(263);function f(e,s){if(1&e&&(t.TgZ(0,"div",24),t._uU(1),t.qZA()),2&e){const i=t.oxw();t.xp6(1),t.hij(" ",i.msg," ")}}let g=(()=>{class e{constructor(i,r,n,l){this.fb=i,this.authService=r,this.router=n,this.actived=l,this.error=!1,this.msg="",this.rol="",this.formData=this.fb.group({user:["",[o.kI.required,o.kI.email]],password:["",[o.kI.required,o.kI.minLength(8)]]}),this.actived.queryParams.subscribe(A=>{A.logout&&sessionStorage.clear()})}ngOnInit(){sessionStorage.getItem("token")&&this.router.navigate(["/productor"])}btnLogin(){const{user:i,password:r}=this.formData.value;this.authService.login(i,r).subscribe({next:n=>{if(n.body.status){const l=new Date;sessionStorage.setItem("user",JSON.stringify(n.body.data.user)),sessionStorage.setItem("horaIngreso",l.toString()),this.rol=JSON.parse(sessionStorage.getItem("user")),"Productor"==this.rol.ROL_NAME?this.router.navigate(["/productor"]):"Admin"==this.rol.ROL_NAME?this.router.navigate(["/mantenedor"]):"Consumidor"==this.rol.ROL_NAME&&this.router.navigate(["/consumidor"])}else this.error=!0,this.msg=n.body.msg},error:n=>{this.error=!0,this.msg=n.msg}})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(o.qu),t.Y36(p.e),t.Y36(d.F0),t.Y36(d.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-login"]],decls:34,vars:2,consts:[["lang","es"],["charset","UTF-8"],["http-equiv","X-UA-Compatible","content","IE=edge"],["name","viewport","content","width=device-width, initial-scale=1.0"],["rel","preconnect","href","https://fonts.googleapis.com"],["rel","preconnect","href","https://fonts.gstatic.com","crossorigin",""],["href","https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,400;0,700;1,300;1,700&display=swap","rel","stylesheet"],[1,"body-login"],[1,"container","d-flex"],[1,"box","box-login","text-center","col-12","col-md-6","col-xl-4","position-relative"],[1,"mb-4"],["href","login.component.html"],["src","assets/images/logo-prorep-w.png","width","240","alt","Ir al inicio"],["autocomplete","off",1,"form-login",3,"formGroup","ngSubmit"],[1,"input-group"],[1,"input-group-text","input-group-text-left"],["aria-hidden","true",1,"fa","fa-user","fa-fw"],["type","user","id","usuario","formControlName","user","placeholder","Usuario",1,"form-control"],["aria-hidden","true",1,"fa","fa-lock","fa-fw"],["type","password","id","password","formControlName","password","placeholder","Contrase\xf1a",1,"form-control"],["class","event","style","color: red; font-style: italic; font-weight: bolder; margin-bottom: 5%; font-size: small;",4,"ngIf"],["type","submit",1,"btn","btn-primary","btn-fa","w-100"],["aria-hidden","true",1,"fa","fa-long-arrow-right","fa-fw"],["routerLink","/auth/sendCode","href","#",1,"text-center"],[1,"event",2,"color","red","font-style","italic","font-weight","bolder","margin-bottom","5%","font-size","small"]],template:function(i,r){1&i&&(t.TgZ(0,"html",0)(1,"head"),t._UZ(2,"meta",1)(3,"meta",2)(4,"meta",3),t.TgZ(5,"title"),t._uU(6,"PROREP"),t.qZA(),t._UZ(7,"link",4)(8,"link",5)(9,"link",6),t.qZA(),t.TgZ(10,"body",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"a",11),t._UZ(15,"img",12),t.qZA()(),t.TgZ(16,"form",13),t.NdJ("ngSubmit",function(){return r.btnLogin()}),t.TgZ(17,"div",10)(18,"div",14)(19,"button",15),t._UZ(20,"i",16),t.qZA(),t._UZ(21,"input",17),t.qZA()(),t.TgZ(22,"div",10)(23,"div",14)(24,"button",15),t._UZ(25,"i",18),t.qZA(),t._UZ(26,"input",19),t.qZA()(),t.YNc(27,f,2,1,"div",20),t.TgZ(28,"div",10)(29,"button",21),t._uU(30,"Iniciar Sesi\xf3n "),t._UZ(31,"i",22),t.qZA()(),t.TgZ(32,"a",23),t._uU(33,"\xbfOlvid\xf3 su contrase\xf1a?"),t.qZA()()()()()()),2&i&&(t.xp6(16),t.Q6J("formGroup",r.formData),t.xp6(11),t.Q6J("ngIf",r.error))},dependencies:[c.O5,d.yS,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u]}),e})();var h=a(5226),u=a.n(h);function v(e,s){1&e&&(t.TgZ(0,"div",10)(1,"div",17)(2,"button",18),t._UZ(3,"i",19),t.qZA(),t._UZ(4,"input",20),t.qZA()())}function Z(e,s){1&e&&(t.TgZ(0,"div",10)(1,"div",10)(2,"div",17)(3,"button",18),t._UZ(4,"i",19),t.qZA(),t._UZ(5,"input",21),t.qZA()(),t.TgZ(6,"div",17)(7,"button",18),t._UZ(8,"i",19),t.qZA(),t._UZ(9,"input",22),t.qZA()())}function b(e,s){1&e&&(t.TgZ(0,"div",10)(1,"div",10)(2,"div",17)(3,"button",18),t._UZ(4,"i",19),t.qZA(),t._UZ(5,"input",21),t.qZA()(),t.TgZ(6,"div",10)(7,"div",17)(8,"button",18),t._UZ(9,"i",19),t.qZA(),t._UZ(10,"input",23),t.qZA()(),t.TgZ(11,"div",10)(12,"div",17)(13,"button",18),t._UZ(14,"i",24),t.qZA(),t._UZ(15,"input",25),t.qZA()(),t.TgZ(16,"div",10)(17,"div",17)(18,"button",18),t._UZ(19,"i",24),t.qZA(),t._UZ(20,"input",26),t.qZA()()())}const C=[{path:"",children:[{path:"login",component:g},{path:"sendCode",component:(()=>{class e{constructor(i,r,n){this.fb=i,this.authService=r,this.router=n,this.step=0,this.msg="",this.formData=this.fb.group({user:["",[o.kI.required,o.kI.email]],code:["",[o.kI.required,o.kI.minLength(6),o.kI.maxLength(6)]],password:["",[o.kI.required,o.kI.minLength(3)]],repeatPassword:["",[o.kI.required,o.kI.minLength(3)]]})}btnSendCode(){if(0==this.step){const{user:i}=this.formData.value;this.authService.sendCode(i).subscribe(r=>{r.status?this.step++:u().fire({title:"Correo no es  correcto, intente nuevamente",icon:"error"})})}if(1==this.step){const{user:i,code:r}=this.formData.value;this.authService.verifyCode(r,i).subscribe({next:n=>{n.status?this.step++:(this.msg=n.msg,u().fire({title:this.msg,icon:"error"}))},error:n=>{this.msg=n.msg}})}if(2==this.step){const{user:i,password:r,repeatPassword:n}=this.formData.value;this.authService.recovery(i,r,n).subscribe({next:l=>{l.status?(u().fire({title:"Contrase\xf1a modificada exitosamente",icon:"success"}),this.router.navigate(["/auth/login"])):(this.msg=l.msg,u().fire({title:this.msg,icon:"error"}))},error:l=>{this.msg=l.msg,u().fire({title:this.msg,icon:"error"})}})}}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(o.qu),t.Y36(p.e),t.Y36(d.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-send-code"]],decls:24,vars:4,consts:[["lang","es"],["charset","UTF-8"],["http-equiv","X-UA-Compatible","content","IE=edge"],["name","viewport","content","width=device-width, initial-scale=1.0"],["rel","preconnect","href","https://fonts.googleapis.com"],["rel","preconnect","href","https://fonts.gstatic.com","crossorigin",""],["href","https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,400;0,700;1,300;1,700&display=swap","rel","stylesheet"],[1,"body-login"],[1,"container","d-flex"],[1,"box","box-login","text-center","col-12","col-md-6","col-xl-4","position-relative"],[1,"mb-4"],["href","send-code.component.html"],["src","assets/images/logo-prorep-w.png","width","240","alt","Ir al inicio"],["autocomplete","off",1,"form-sendCode",3,"formGroup","ngSubmit"],["class","mb-4",4,"ngIf"],["type","submit",1,"btn","btn-primary","btn-fa","w-100"],["aria-hidden","true",1,"fa","fa-long-arrow-right","fa-fw"],[1,"input-group"],[1,"input-group-text","input-group-text-left"],["aria-hidden","true",1,"fa","fa-user","fa-fw"],["type","user","id","usuario","formControlName","user","placeholder","Ingrese su correo",1,"form-control"],["type","user","readonly","","id","usuario","formControlName","user","placeholder","Ingrese su correo",1,"form-control"],["type","code","id","code","formControlName","code","placeholder","Ingrese c\xf3digo",1,"form-control"],["type","code","readonly","","id","code","formControlName","code","placeholder","Ingrese c\xf3digo",1,"form-control"],["aria-hidden","true",1,"fa","fa-lock","fa-fw"],["type","password","id","password","formControlName","password","placeholder","Nueva contrase\xf1a",1,"form-control"],["type","password","id","repeatPassword","formControlName","repeatPassword","placeholder","Repetir contrase\xf1a",1,"form-control"]],template:function(i,r){1&i&&(t.TgZ(0,"html",0)(1,"head"),t._UZ(2,"meta",1)(3,"meta",2)(4,"meta",3),t.TgZ(5,"title"),t._uU(6,"PROREP"),t.qZA(),t._UZ(7,"link",4)(8,"link",5)(9,"link",6),t.qZA(),t.TgZ(10,"body",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"a",11),t._UZ(15,"img",12),t.qZA()(),t.TgZ(16,"form",13),t.NdJ("ngSubmit",function(){return r.btnSendCode()}),t.YNc(17,v,5,0,"div",14),t.YNc(18,Z,10,0,"div",14),t.YNc(19,b,21,0,"div",14),t.TgZ(20,"div",10)(21,"button",15),t._uU(22,"Enviar "),t._UZ(23,"i",16),t.qZA()()()()()()()),2&i&&(t.xp6(16),t.Q6J("formGroup",r.formData),t.xp6(1),t.Q6J("ngIf",0==r.step),t.xp6(1),t.Q6J("ngIf",1==r.step),t.xp6(1),t.Q6J("ngIf",r.step>=2))},dependencies:[c.O5,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u]}),e})()},{path:"**",redirectTo:"login",pathMatch:"full"}]}];let w=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[d.Bz.forChild(C),d.Bz]}),e})(),y=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[c.ez,w,o.u5,o.UX]}),e})()}}]);